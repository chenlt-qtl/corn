(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"6rwq":function(e,t,n){e.exports={view:"view___Rzvos",toc:"toc___3FSw_",title:"title___1f_Bg",text:"text___1QBN0"}},Gztv:function(e,t,n){e.exports={toolbar:"toolbar___3M9Xg",buttons:"buttons___1MeMU",status:"status___HHsQA",yellow:"yellow___1X8oL",warning:"warning___36A0x",green:"green___vRCy7",main:"main___3vV_G",content:"content___vaGnd",title:"title___2ugCE"}},TcXl:function(e,t,n){e.exports={color0:"color0___yRifW",color1:"color1___5opj9",color2:"color2___3_IIO",color3:"color3___DwDA2",color4:"color4___3vbyK",color5:"color5___KruFH",color6:"color6___FqTTS",main:"main___2Q90t",icon:"icon___27iSw",label:"label___Zo2PJ",item:"item___2lvkE",shortLogo:"shortLogo___3YGJ7",active:"active___1FXFo",modal:"modal___3Kerv",title:"title___2dRPT",buttons:"buttons___2vAD4"}},xDFs:function(e,t,n){e.exports={content:"content___5m2gZ",menu:"menu___3fSYr",menuContent:"menuContent___2SP-5",title:"title___1hXQc",button:"button___osRoe",fold:"fold___3F1HC",item:"item___1DisU",hidden:"hidden___lBY_E",show:"show___1eHZk",menuItem:"menuItem___3hdZz",label:"label___1F3IV",noteTitle:"noteTitle___1d8d-",addChild:"addChild___xeA-e",active:"active___nd--y",parents:"parents___3d1eC",addBtn:"addBtn___yt2Pd",favorate:"favorate___3D19U"}},xw1K:function(e,t,n){"use strict";n.r(t);n("T2oS");var a=n("W9HT"),c=n("q1tI"),o=n.n(c),r=n("9kvl"),l=(n("/zsF"),n("PArb")),i=(n("+L6B"),n("2/Rp")),u=(n("qVdP"),n("jsC+")),s=(n("/xke"),n("TeRw")),d=n("k1fw"),m=n("oBTY"),f=(n("lUTK"),n("BvKs")),v=n("tJVT"),_=(n("2qtc"),n("kLXV")),h=n("73BT"),p=n("djQt"),b=n("RCxd"),E=n("UESt"),y=n("8Skl"),O=n("xvlK"),g=n("5bA4"),j=n("xDFs"),M=n.n(j),N=(n("Mwp2"),n("VXEj")),w=n("eFNv"),k=n("w5pM"),C=n("4i/N"),I=n("TcXl"),x=n.n(I),T=n("0Owb"),S=(n("5NDa"),n("5rEg")),A=(n("miYZ"),n("tsqr")),F=n("9og8"),R=(n("y8nQ"),n("Vl3Y")),L=n("WmNS"),q=n.n(L),B=n("bPPy"),D={labelCol:{span:6},wrapperCol:{span:12}},V=function(e){var t=e.modalVisible,n=e.onCancel,a=e.note,r=R["a"].useForm(),l=Object(v["a"])(r,1),i=l[0];return Object(c["useEffect"])((function(){i.setFieldsValue(a)}),[a]),o.a.createElement(_["a"],{title:"\u8be6\u7ec6\u4fe1\u606f",visible:t,onCancel:function(){return n(!1)},style:{top:20},onOk:Object(F["a"])(q.a.mark((function e(){var t,c,o,r,l;return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.validateFields();case 2:return t=e.sent,c=Object(d["a"])(Object(d["a"])({},a),t),e.next=6,Object(B["j"])(c);case 6:o=e.sent,r=o.success,l=o.message,r?(A["default"].success("\u64cd\u4f5c\u6210\u529f!"),n(!0)):A["default"].error(l);case 10:case"end":return e.stop()}}),e)})))},o.a.createElement(R["a"],Object(T["a"])({},D,{form:i}),o.a.createElement(R["a"].Item,{label:"\u6807\u9898",name:"name",rules:[{required:!0,message:"Please input your title!"}]},o.a.createElement(S["a"],null))))},P=V,H=n("c+yx"),Q=function(e){var t=Object(c["useState"])([]),n=Object(v["a"])(t,2),a=n[0],r=n[1],l=Object(c["useState"])(!1),u=Object(v["a"])(l,2),s=u[0],d=u[1],f=Object(c["useState"])(!1),h=Object(v["a"])(f,2),p=h[0],b=h[1],E=Object(c["useState"])({}),y=Object(v["a"])(E,2),O=y[0],g=y[1];Object(c["useEffect"])((function(){j()}),[]);var j=function(){e.dispatch({type:"note/queryChildren",payload:"0"}).then((function(e){if(e){var t=e.result;t.length>0&&I(t[0].id,t[0].name),r(Object(m["a"])(t))}}))},M=function(){b(!0),g({name:"",id:Object(H["c"])()})},I=function(t,n){e.dispatch({type:"noteMenu/updateActiveTop",payload:{id:t,name:n}})},T=function(){d(!1)},S=function(){d(!0)},A=function(e){b(!0),g(e)},F=function(e){},R=function(e){e&&j(),b(!1)},L=function(){return o.a.createElement("div",{className:x.a.main},o.a.createElement("ul",null,a.map((function(t){var n=t.id===e.noteMenu.activeTopId;return o.a.createElement("li",{key:t.id,onClick:function(){return I(t.id,t.name)},className:"".concat(x.a.item," ").concat(n?x.a.active:"")},o.a.createElement("div",{className:x.a.shortLogo},t.name.substr(0,1)),o.a.createElement("div",{className:x.a.label},t.name))}))),o.a.createElement("div",{className:x.a.icon},o.a.createElement(w["a"],{onClick:S})),o.a.createElement(_["a"],{visible:s,closable:!1,footer:null,style:{top:20}},o.a.createElement("div",{className:x.a.modal},o.a.createElement("div",{className:x.a.title},o.a.createElement("span",null,"\u7ba1\u7406\u7b14\u8bb0\u672c"),o.a.createElement("div",{className:x.a.buttons},o.a.createElement(i["a"],{type:"text",onClick:M},o.a.createElement(k["a"],null)),o.a.createElement(i["a"],{type:"text",onClick:T},o.a.createElement(C["a"],null)))),o.a.createElement(N["b"],{dataSource:a,renderItem:function(e){return o.a.createElement(N["b"].Item,{actions:[o.a.createElement("a",{onClick:function(){A(e)}},"edit"),o.a.createElement("a",{onClick:function(){F(e.id)}},"delete")]},e.name)}}))),o.a.createElement(P,{onCancel:R,note:O,modalVisible:p}))};return L()},z=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(Q),K=_["a"].confirm,U=[{id:"open",name:"\u6700\u8fd1\u6253\u5f00",icon:o.a.createElement(h["a"],null)},{id:"favorate",name:"\u6536\u85cf\u5939",icon:o.a.createElement(p["a"],{className:M.a.favorate})}],X={fontSize:"10px"},G=function(e,t){var n=Object(c["useState"])(!1),a=Object(v["a"])(n,2),r=a[0],_=a[1],h=Object(c["useState"])(""),p=Object(v["a"])(h,2),j=p[0],N=p[1],w=Object(c["useState"])([]),k=Object(v["a"])(w,2),C=k[0],I=k[1];Object(c["useEffect"])((function(){e.refreshMenu(2)}),[e.noteMenu.activeMenu1Id]),Object(c["useEffect"])((function(){e.refreshMenu(3)}),[e.noteMenu.activeMenu2Id]);var x=function(e){return"favorate"==e.id||"open"==e.id?o.a.createElement(o.a.Fragment,null):o.a.createElement(f["a"],{onClick:function(t){return R(t,e)}},o.a.createElement(f["a"].Item,{key:"add"},"\u589e\u52a0\u5b50\u7b14\u8bb0"),o.a.createElement(f["a"].Item,{key:"del"},"\u5220\u9664"))},T=function(e,t){I(e?C.filter((function(e){return e!=t})):[t].concat(Object(m["a"])(C)))},S=function(t){var n=F(t),a=n.id,c=n.title,o=n.level;"open"!=a&&"favorate"!=a&&e.dispatch({type:"note/queryNote",payload:a}),1==o?(e.dispatch({type:"noteMenu/refreshActiveMenu1Id",payload:{id:a,title:c}}),N("")):2==o?(e.dispatch({type:"noteMenu/refreshActiveMenu2Id",payload:{id:a,title:c}}),N("")):N(a)},A=function(t){t==e.noteMenu.activeMenu1Id?e.dispatch({type:"noteMenu/refreshMenu3",payload:[]}):t==e.noteMenu.activeTopId&&(e.dispatch({type:"noteMenu/refreshMenu2",payload:[]}),e.dispatch({type:"noteMenu/refreshMenu3",payload:[]})),e.onAddNote(t)},F=function(e){var t,n=e.key||e.id,a=e.title||e.name;return t="favorate"==n||"open"==n?1:Object(H["a"])(e.parentIds),Object(d["a"])(Object(d["a"])({},e),{},{id:n,title:a,level:t})},R=function(t,n){var a=t.key,c=F(n),r=c.id,l=c.title,i=c.level;"add"==a||"del"==a&&K({title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(l,"?"),icon:o.a.createElement(b["a"],null),onOk:function(){e.dispatch({type:"note/deleteNote",payload:r}).then((function(){s["default"]["info"]({message:"\u5220\u9664\u6210\u529f"}),e.refreshMenu(i)}))}})},L=function(e){var t=e.level,n=e.id;if(t>=3){if(!e.leaf)return C.includes(n)?o.a.createElement(E["a"],{style:X,onClick:function(){return T(!0,n)}}):o.a.createElement(y["a"],{style:X,onClick:function(){return T(!1,n)}})}else if(e.icon)return e.icon},q=function e(t,n){if(t)return o.a.createElement("ul",null,t.map((function(t){var a=F(t),c=a.id,r=a.title,l=a.level,i=void 0===l?0:l,s=(i||0)>=3;return o.a.createElement("li",{key:c},o.a.createElement(u["a"],{overlay:x(t),trigger:["contextMenu"]},o.a.createElement("div",{className:"".concat(M.a.menu1Item," ").concat(n==c?M.a.active:"")},o.a.createElement("div",{className:M.a.label,onClick:function(){return S(t)},style:{paddingLeft:"".concat(s?8*(i-3)+12:12,"px")}},L(a),o.a.createElement("div",{className:M.a.noteTitle},"\xa0\xa0",r),i<=3&&"open"!=c&&"favorate"!=c?o.a.createElement("span",{className:M.a.addChild,onClick:function(e){e.stopPropagation(),e.preventDefault(),A(c)}},o.a.createElement(O["a"],{title:"\u589e\u52a0\u5b50\u7b14\u8bb0"})):""))),!t.children||C.includes(c)?"":e(t.children,n))})))},B=function(){var t=e.noteMenu,n=t.menu1Item,a=t.menu2Item,c=t.menu3Item;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"".concat(M.a.content," ").concat(r?M.a.hidden:M.a.show)},o.a.createElement("div",{className:M.a.fold},o.a.createElement(i["a"],{type:"primary",size:"small",onClick:function(){return _(!r)},shape:"circle",icon:r?o.a.createElement(E["a"],null):o.a.createElement(g["a"],null)})),o.a.createElement("div",{className:M.a.menu},o.a.createElement(z,null),o.a.createElement("div",{className:M.a.menuContent},o.a.createElement("div",{className:M.a.title},e.noteMenu.title1),o.a.createElement("ul",null,q(U,e.noteMenu.activeMenu1Id),o.a.createElement(l["a"],null),q(n,e.noteMenu.activeMenu1Id)),o.a.createElement("div",{className:M.a.button},o.a.createElement(i["a"],{block:!0,onClick:function(){return A(e.noteMenu.activeTopId)}},"\u589e\u52a0"))),a.length>0?o.a.createElement("div",{className:M.a.menuContent},o.a.createElement("div",{className:M.a.title},e.noteMenu.title2),q(a,e.noteMenu.activeMenu2Id),o.a.createElement("div",{className:M.a.button},o.a.createElement(i["a"],{block:!0,onClick:function(){return A(e.noteMenu.activeMenu1Id)}},"\u589e\u52a0"))):"",c.length>0?o.a.createElement("div",{className:M.a.menuContent},o.a.createElement("div",{className:M.a.title},e.noteMenu.title3),q(c,j),o.a.createElement("div",{className:M.a.button},o.a.createElement(i["a"],{block:!0,onClick:function(){return A(e.noteMenu.activeMenu2Id)}},"\u589e\u52a0"))):"")))};return B()},J=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(G),Y=n("uMRc"),Z=n("u2V1"),W=n("ye1Q"),$=n("G3dp"),ee=n("9BLJ"),te=n("Gztv"),ne=n.n(te),ae=n("6rwq"),ce=n.n(ae),oe=n("RVw9"),re=n("56rK"),le=n.n(re),ie=(n("i8oR"),n("DlQD")),ue=n.n(ie),se=n("FIf5"),de=n.n(se),me=(n("bi5S"),n("fWQN")),fe=n("mtLc"),ve=(n("5GOC"),n("JsLm")),_e=n("LvDl"),he=ve["a"].Link,pe=function(){function e(){var t=this;Object(me["a"])(this,e),this.anchors=void 0,this.tocItems=[],this.i=0,this.reset=function(){t.tocItems=[],t.anchors=[],t.i=0},this.i=0,this.anchors=[],this.tocItems=[]}return Object(fe["a"])(e,[{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=(n||e)+this.i++;this.anchors.push(a);var c={anchor:a,level:t,text:e},o=this.tocItems;if(0===o.length)o.push(c);else{var r=Object(_e["last"])(o);if(c.level>r.level)for(var l=r.level+1;l<=6;l++){var i=r,u=i.children;if(!u){r.children=[c];break}if(r=Object(_e["last"])(u),c.level<=r.level){u.push(c);break}}else o.push(c)}return a}},{key:"renderToc",value:function(e){var t=this;return e.map((function(e){return o.a.createElement(he,{key:e.anchor,href:"#".concat(e.anchor),title:e.text},e.children&&t.renderToc(e.children))}))}},{key:"render",value:function(){return o.a.createElement(ve["a"],{affix:!1,showInkInFixed:!0},this.renderToc(this.tocItems))}}]),e}(),be=new pe,Ee=new ue.a.Renderer;Ee.heading=function(e,t,n){var a=be.add(e,t);return'<a id="'.concat(a,'" href="#').concat(a,'" class="anchor-fix"><h').concat(t,">").concat(e,"</h").concat(t,"></a>\n")},ue.a.setOptions({renderer:Ee,highlight:function(e){return de.a.highlightAuto(e).value},gfm:!0,pedantic:!1,sanitize:!1,tables:!0,breaks:!1,smartLists:!1,smartypants:!1}),le.a.use(re["Plugins"].TabInsert,{tabMapValue:1});var ye=o.a.forwardRef((function(e,t){var n=Object(c["useState"])(""),a=Object(v["a"])(n,2),r=a[0],l=a[1],i=Object(c["useState"])(!0),u=Object(v["a"])(i,2),s=u[0],d=u[1],m=Object(c["useState"])(""),f=Object(v["a"])(m,2),_=f[0],h=f[1];Object(c["useEffect"])((function(){var t=e.note.showNote.text||"";l(t),y(t),d(!0)}),[e.note.showNote]);var p=function(t){t.html;var n=t.text;l(n),e.handleChange()},b=function(){e.saveContent(r)},E=function(e,t){var n=new FileReader;n.onload=Object(F["a"])(q.a.mark((function e(){var a,c,o;return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=function(e){var t=e.split(","),n=t[0].match(/:(.*?);/)[1],a=atob(t[1]),c=a.length,o=new Uint8Array(c);while(c--)o[c]=a.charCodeAt(c);return new Blob([o],{type:n})},c=a(n.result),console.log(c),e.next=5,Object(B["k"])(n.result);case 5:o=e.sent,o.success?t(o.result):console.log(o.message);case 7:case"end":return e.stop()}}),e)}))),n.readAsDataURL(e)},y=function(e){be.reset();var t=ue()(e);return h(t),t},O=function(){var t=e.displayIndex;return o.a.createElement(o.a.Fragment,null,1==t?o.a.createElement("div",{className:ce.a.text,style:{display:1==t?"block":"none"}},o.a.createElement(le.a,{value:r,style:{height:"600px"},renderHTML:y,onChange:p,onImageUpload:E,onBlur:b})):"",0==t?o.a.createElement("div",{className:ce.a.view},s?o.a.createElement("div",{className:ce.a.toc},o.a.createElement("div",{className:ce.a.title},o.a.createElement("span",null,"\u5927\u7eb2"),o.a.createElement(C["a"],{onClick:function(){d(!1)}})),be&&be.render()):o.a.createElement(oe["a"],{onClick:function(){d(!0)}}),o.a.createElement("div",{className:ce.a.text},o.a.createElement(le.a,{value:r,style:{border:0},renderHTML:function(){return _},config:{view:{menu:!1,md:!1}},readOnly:!0}))):"")};return O()})),Oe=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}),null,null,{forwardRef:!0})(ye),ge=S["a"].TextArea,je={0:o.a.createElement(Y["a"],{twoToneColor:"#52c41a"}),1:o.a.createElement(Z["a"],{twoToneColor:"#f1c40f"}),2:o.a.createElement(W["a"],null)},Me="group",Ne=o.a.forwardRef((function(e,t){var n=Object(c["useRef"])(),a=Object(c["useState"])(""),r=Object(v["a"])(a,2),l=r[0],i=r[1],u=Object(c["useState"])(null),s=Object(v["a"])(u,2),m=s[0],f=s[1],h=Object(c["useState"])(""),p=Object(v["a"])(h,2),b=p[0],E=p[1],y=Object(c["useState"])(!1),O=Object(v["a"])(y,2),g=O[0],j=O[1],M=Object(c["useState"])(-1),N=Object(v["a"])(M,2),w=N[0],k=N[1];Object(c["useImperativeHandle"])(t,(function(){return{handleAddNote:function(t){console.log("handleAddNote");var n=Object(H["c"])();f(1);var a={name:"\u65b0\u6587\u6863",parentId:t,id:n};E("\u65b0\u6587\u6863"),e.dispatch({type:"note/refreshShowNote",payload:a})}}}));var C=function(){j(!1)},I=function(e){var t=e.target.value;i(t)},x=function(e){f(1)},T=function(e){E(e.target.value),f(1)};Object(c["useEffect"])((function(){A(e.note.showNote)}),[e.note.showNote]);var A=function(e){console.log("handleShowNote"),E(e.name),k(0),f(0)},F=function(t,n){if(0!=m){var a,c=Object(d["a"])({},e.note.showNote);if(c.id)f(2),c.name=b,"title"==t?a="note/updateNoteTitle":(a="note/updateNoteText",c.text=n),e.dispatch({type:a,payload:c}).then((function(n){if(n){if(c.createTime)"title"==t&&e.refreshMenu(Object(H["a"])(c.parentIds));else{var a=n.result;c=a,e.refreshMenu(Object(H["a"])(a.parentIds))}e.dispatch({type:"openNotes/updateOpenNote",payload:c}),e.note.activeNoteId==c.id&&f(0)}}))}},R=function(e,t){"title"==t?F(t):e.relatedTarget&&e.relatedTarget.getAttribute("group")==Me||F(t)},L=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:ne.a.main},e.children,o.a.createElement("div",{className:ne.a.content},o.a.createElement("div",{className:ne.a.buttons}," ",0==w?o.a.createElement($["a"],{onClick:function(){return k(1)}}):o.a.createElement(ee["a"],{onClick:function(){k(0)}}),je[m]),o.a.createElement("div",{className:ne.a.title},o.a.createElement(S["a"],{maxLength:100,ref:n,value:b,onBlur:function(e){return R(e,"title")},onInput:T})),o.a.createElement(Oe,{handleChange:x,displayIndex:w,saveContent:function(e){return F("content",e)}}))),o.a.createElement(_["a"],{visible:g,onOk:C,onCancel:function(){return j(!1)}},o.a.createElement("div",{style:{marginBottom:"10px"}},"Source code"),o.a.createElement(ge,{value:l,rows:10,onChange:I})))};return L()})),we=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}),null,null,{forwardRef:!0})(Ne),ke=function(e){var t=Object(c["useRef"])(),n=function(t){var n,a="note/queryChildren";1==t?n=e.noteMenu.activeTopId:2==t?n=e.noteMenu.activeMenu1Id:(t=3,a="note/queryTabTree",n=e.noteMenu.activeMenu2Id),n?e.dispatch({type:a,payload:n}).then((function(n){if(n){var a=n.result;e.dispatch({type:"noteMenu/refreshMenu".concat(t),payload:a})}})):e.dispatch({type:"noteMenu/refreshMenu".concat(t),payload:[]})},r=function(e){t.current.handleAddNote(e)},l=function(){var c=e.loading.effects["note/queryNote"]||e.loading.effects["note/deleteNote"]||e.loading.effects["note/queryTabTree"]||e.loading.effects["note/queryChildren"]||!1;return o.a.createElement(a["a"],{spinning:c},o.a.createElement(we,{ref:t,refreshMenu:n},o.a.createElement(J,{refreshMenu:n,onAddNote:r})))};return l()};t["default"]=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(ke)}}]);