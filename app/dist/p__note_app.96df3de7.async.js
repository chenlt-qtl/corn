(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{Gztv:function(e,t,n){e.exports={toolbar:"toolbar___3M9Xg",buttons:"buttons___1MeMU",status:"status___HHsQA",yellow:"yellow___1X8oL",warning:"warning___36A0x",green:"green___vRCy7",main:"main___3vV_G",content:"content___vaGnd",title:"title___2ugCE",text:"text___11eiN"}},TcXl:function(e,t,n){e.exports={color0:"color0___yRifW",color1:"color1___5opj9",color2:"color2___3_IIO",color3:"color3___DwDA2",color4:"color4___3vbyK",color5:"color5___KruFH",color6:"color6___FqTTS",main:"main___2Q90t",icon:"icon___27iSw",label:"label___Zo2PJ",item:"item___2lvkE",shortLogo:"shortLogo___3YGJ7",active:"active___1FXFo",modal:"modal___3Kerv",title:"title___2dRPT",buttons:"buttons___2vAD4"}},xDFs:function(e,t,n){e.exports={content:"content___5m2gZ",menu:"menu___3fSYr",menuContent:"menuContent___2SP-5",title:"title___1hXQc",button:"button___osRoe",fold:"fold___3F1HC",item:"item___1DisU",hidden:"hidden___lBY_E",show:"show___1eHZk",menuItem:"menuItem___3hdZz",label:"label___1F3IV",noteTitle:"noteTitle___1d8d-",addChild:"addChild___xeA-e",active:"active___nd--y",parents:"parents___3d1eC",addBtn:"addBtn___yt2Pd",favorate:"favorate___3D19U"}},xw1K:function(e,t,n){"use strict";n.r(t);n("T2oS");var a=n("W9HT"),o=n("q1tI"),l=n.n(o),r=n("9kvl"),c=(n("/zsF"),n("PArb")),i=(n("+L6B"),n("2/Rp")),u=(n("qVdP"),n("jsC+")),s=(n("/xke"),n("TeRw")),m=n("k1fw"),d=n("oBTY"),f=(n("lUTK"),n("BvKs")),v=n("tJVT"),p=(n("2qtc"),n("kLXV")),E=n("73BT"),b=n("djQt"),_=n("RCxd"),h=n("UESt"),g=n("8Skl"),y=n("xvlK"),C=n("5bA4"),M=n("xDFs"),O=n.n(M),k=(n("Mwp2"),n("VXEj")),j=(n("miYZ"),n("tsqr")),N=n("eFNv"),w=n("w5pM"),I=n("4i/N"),T=n("TcXl"),S=n.n(T),x=n("0Owb"),F=(n("5NDa"),n("5rEg")),A=n("9og8"),R=(n("y8nQ"),n("Vl3Y")),H=n("WmNS"),B=n.n(H),L=n("bPPy"),q={labelCol:{span:6},wrapperCol:{span:12}},V=function(e){var t=e.modalVisible,n=e.onCancel,a=e.note,r=R["a"].useForm(),c=Object(v["a"])(r,1),i=c[0];return Object(o["useEffect"])((function(){i.setFieldsValue(a)}),[a]),l.a.createElement(p["a"],{title:"\u8be6\u7ec6\u4fe1\u606f",visible:t,onCancel:function(){return n(!1)},style:{top:20},onOk:Object(A["a"])(B.a.mark((function e(){var t,o,l,r,c;return B.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.validateFields();case 2:return t=e.sent,o=Object(m["a"])(Object(m["a"])({},a),t),e.next=6,Object(L["j"])(o);case 6:l=e.sent,r=l.success,c=l.message,r?(j["default"].success("\u64cd\u4f5c\u6210\u529f!"),n(!0)):j["default"].error(c);case 10:case"end":return e.stop()}}),e)})))},l.a.createElement(R["a"],Object(x["a"])({},q,{form:i}),l.a.createElement(R["a"].Item,{label:"\u6807\u9898",name:"name",rules:[{required:!0,message:"Please input your title!"}]},l.a.createElement(F["a"],null))))},P=V,D=n("c+yx"),U=function(e){var t=Object(o["useState"])([]),n=Object(v["a"])(t,2),a=n[0],r=n[1],c=Object(o["useState"])(!1),u=Object(v["a"])(c,2),s=u[0],m=u[1],f=Object(o["useState"])(!1),E=Object(v["a"])(f,2),b=E[0],_=E[1],h=Object(o["useState"])({}),g=Object(v["a"])(h,2),y=g[0],C=g[1];Object(o["useEffect"])((function(){M()}),[]);var M=function(){e.dispatch({type:"note/queryChildren",payload:"0"}).then((function(e){if(e){var t=e.result;t.length>0&&T(t[0].id,t[0].name),r(Object(d["a"])(t))}}))},O=function(){a.length>=10?j["default"].error("\u6700\u591a\u53ea\u80fd\u670910\u4e2a\u7b14\u8bb0\u672c"):(_(!0),C({name:"",id:Object(D["c"])()}))},T=function(t,n){e.dispatch({type:"noteMenu/updateActiveTop",payload:{id:t,name:n}})},x=function(){m(!1)},F=function(){m(!0)},A=function(e){_(!0),C(e)},R=function(e){},H=function(e){e&&M(),_(!1)},B=function(){return l.a.createElement("div",{className:S.a.main},l.a.createElement("ul",null,a.map((function(t){var n=t.id===e.noteMenu.activeTopId;return l.a.createElement("li",{key:t.id,onClick:function(){return T(t.id,t.name)},className:"".concat(S.a.item," ").concat(n?S.a.active:"")},l.a.createElement("div",{className:S.a.shortLogo},t.name.substr(0,1)),l.a.createElement("div",{className:S.a.label},t.name))}))),l.a.createElement("div",{className:S.a.icon},l.a.createElement(N["a"],{onClick:F})),l.a.createElement(p["a"],{visible:s,closable:!1,footer:null,style:{top:20}},l.a.createElement("div",{className:S.a.modal},l.a.createElement("div",{className:S.a.title},l.a.createElement("span",null,"\u7ba1\u7406\u7b14\u8bb0\u672c"),l.a.createElement("div",{className:S.a.buttons},l.a.createElement(i["a"],{type:"text",onClick:O},l.a.createElement(w["a"],null)),l.a.createElement(i["a"],{type:"text",onClick:x},l.a.createElement(I["a"],null)))),l.a.createElement(k["b"],{dataSource:a,renderItem:function(e){return l.a.createElement(k["b"].Item,{actions:[l.a.createElement("a",{onClick:function(){A(e)}},"edit"),l.a.createElement("a",{onClick:function(){R(e.id)}},"delete")]},e.name)}}))),l.a.createElement(P,{onCancel:H,note:y,modalVisible:b}))};return B()},X=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(U),K=p["a"].confirm,Y=[{id:"open",name:"\u6700\u8fd1\u6253\u5f00",icon:l.a.createElement(E["a"],null)},{id:"favorate",name:"\u6536\u85cf\u5939",icon:l.a.createElement(b["a"],{className:O.a.favorate})}],z={fontSize:"10px"},G=function(e,t){var n=Object(o["useState"])(!1),a=Object(v["a"])(n,2),r=a[0],p=a[1],E=Object(o["useState"])(""),b=Object(v["a"])(E,2),M=b[0],k=b[1],j=Object(o["useState"])([]),N=Object(v["a"])(j,2),w=N[0],I=N[1];Object(o["useEffect"])((function(){e.refreshMenu(2)}),[e.noteMenu.activeMenu1Id]),Object(o["useEffect"])((function(){e.refreshMenu(3)}),[e.noteMenu.activeMenu2Id]);var T=function(e){return"favorate"==e.id||"open"==e.id?l.a.createElement(l.a.Fragment,null):l.a.createElement(f["a"],{onClick:function(t){return R(t,e)}},l.a.createElement(f["a"].Item,{key:"add"},"\u589e\u52a0\u5b50\u7b14\u8bb0"),l.a.createElement(f["a"].Item,{key:"del"},"\u5220\u9664"))},S=function(e,t){I(e?w.filter((function(e){return e!=t})):[t].concat(Object(d["a"])(w)))},x=function(t){var n=A(t),a=n.id,o=n.title,l=n.level;"open"!=a&&"favorate"!=a&&e.dispatch({type:"note/queryNote",payload:a}),1==l?(e.dispatch({type:"noteMenu/refreshActiveMenu1Id",payload:{id:a,title:o}}),k("")):2==l?(e.dispatch({type:"noteMenu/refreshActiveMenu2Id",payload:{id:a,title:o}}),k("")):k(a)},F=function(t){t==e.noteMenu.activeMenu1Id?e.dispatch({type:"noteMenu/refreshMenu3",payload:[]}):t==e.noteMenu.activeTopId&&(e.dispatch({type:"noteMenu/refreshMenu2",payload:[]}),e.dispatch({type:"noteMenu/refreshMenu3",payload:[]})),e.onAddNote(t)},A=function(e){var t,n=e.key||e.id,a=e.title||e.name;return t="favorate"==n||"open"==n?1:Object(D["a"])(e.parentIds),Object(m["a"])(Object(m["a"])({},e),{},{id:n,title:a,level:t})},R=function(t,n){var a=t.key,o=A(n),r=o.id,c=o.title,i=o.level;"add"==a||"del"==a&&K({title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(c,"?"),icon:l.a.createElement(_["a"],null),onOk:function(){e.dispatch({type:"note/deleteNote",payload:r}).then((function(){s["default"]["info"]({message:"\u5220\u9664\u6210\u529f"}),e.refreshMenu(i)}))}})},H=function(e){var t=e.level,n=e.id;if(t>=3){if(!e.leaf)return w.includes(n)?l.a.createElement(h["a"],{style:z,onClick:function(){return S(!0,n)}}):l.a.createElement(g["a"],{style:z,onClick:function(){return S(!1,n)}})}else if(e.icon)return e.icon},B=function e(t,n){if(t)return l.a.createElement("ul",null,t.map((function(t){var a=A(t),o=a.id,r=a.title,c=a.level,i=void 0===c?0:c,s=(i||0)>=3;return l.a.createElement("li",{key:o},l.a.createElement(u["a"],{overlay:T(t),trigger:["contextMenu"]},l.a.createElement("div",{className:"".concat(O.a.menu1Item," ").concat(n==o?O.a.active:"")},l.a.createElement("div",{className:O.a.label,onClick:function(){return x(t)},style:{paddingLeft:"".concat(s?8*(i-3)+12:12,"px")}},H(a),l.a.createElement("div",{className:O.a.noteTitle},"\xa0\xa0",r),i<=3&&"open"!=o&&"favorate"!=o?l.a.createElement("span",{className:O.a.addChild,onClick:function(e){e.stopPropagation(),e.preventDefault(),F(o)}},l.a.createElement(y["a"],{title:"\u589e\u52a0\u5b50\u7b14\u8bb0"})):""))),!t.children||w.includes(o)?"":e(t.children,n))})))},L=function(){var t=e.noteMenu,n=t.menu1Item,a=t.menu2Item,o=t.menu3Item;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"".concat(O.a.content," ").concat(r?O.a.hidden:O.a.show)},l.a.createElement("div",{className:O.a.fold},l.a.createElement(i["a"],{type:"primary",size:"small",onClick:function(){return p(!r)},shape:"circle",icon:r?l.a.createElement(h["a"],null):l.a.createElement(C["a"],null)})),l.a.createElement("div",{className:O.a.menu},l.a.createElement(X,null),l.a.createElement("div",{className:O.a.menuContent},l.a.createElement("div",{className:O.a.title},e.noteMenu.title1),l.a.createElement("ul",null,B(Y,e.noteMenu.activeMenu1Id),l.a.createElement(c["a"],null),B(n,e.noteMenu.activeMenu1Id)),l.a.createElement("div",{className:O.a.button},l.a.createElement(i["a"],{block:!0,onClick:function(){return F(e.noteMenu.activeTopId)}},"\u589e\u52a0"))),a.length>0?l.a.createElement("div",{className:O.a.menuContent},l.a.createElement("div",{className:O.a.title},e.noteMenu.title2),B(a,e.noteMenu.activeMenu2Id),l.a.createElement("div",{className:O.a.button},l.a.createElement(i["a"],{block:!0,onClick:function(){return F(e.noteMenu.activeMenu1Id)}},"\u589e\u52a0"))):"",o.length>0?l.a.createElement("div",{className:O.a.menuContent},l.a.createElement("div",{className:O.a.title},e.noteMenu.title3),B(o,M),l.a.createElement("div",{className:O.a.button},l.a.createElement(i["a"],{block:!0,onClick:function(){return F(e.noteMenu.activeMenu2Id)}},"\u589e\u52a0"))):"")))};return L()},J=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(G),Q=n("uMRc"),Z=n("u2V1"),W=n("ye1Q"),$=n("Gztv"),ee=n.n($),te=n("G3dp"),ne=n("9BLJ"),ae=n("Xcxh"),oe=n("1M3H"),le=n.n(oe),re=n("56rK"),ce=n.n(re),ie=(n("i8oR"),new le.a);ce.a.use(re["Plugins"].TabInsert,{tabMapValue:1});var ue=l.a.forwardRef((function(e,t){var n=Object(o["useState"])(""),a=Object(v["a"])(n,2),r=a[0],c=a[1],i=Object(o["useState"])(0),u=Object(v["a"])(i,2),s=u[0],m=u[1],d=Object(o["useRef"])();Object(o["useEffect"])((function(){var t=e.note.showNote.text||"";m(0),c(t),d.current.innerHTML=t}),[e.note.showNote]);var f=function(t){var n=t.html,a=t.text;console.log("handleEditorChange",n,a),c(a),e.handleChange()},p=function(){console.log("save note",r),e.saveContent(r)},E=function(e,t){var n=new FileReader;n.onload=Object(A["a"])(B.a.mark((function e(){var a,o,l;return B.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=function(e){var t=e.split(","),n=t[0].match(/:(.*?);/)[1],a=atob(t[1]),o=a.length,l=new Uint8Array(o);while(o--)l[o]=a.charCodeAt(o);return new Blob([l],{type:n})},o=a(n.result),console.log(o),e.next=5,Object(L["k"])(n.result);case 5:l=e.sent,l.success?t(l.result):console.log(l.message);case 7:case"end":return e.stop()}}),e)}))),n.readAsDataURL(e)},b=l.a.createElement(te["a"],{onClick:function(){return m(1)}}),_=l.a.createElement(ne["a"],{onClick:function(){return m(0)}}),h=l.a.createElement(ae["a"],{onClick:function(){return m(2)}}),g=function(){return 0==s?l.a.createElement(l.a.Fragment,null,b,h):1==s?l.a.createElement(l.a.Fragment,null,_,h):2==s?l.a.createElement(l.a.Fragment,null,b,_):void 0},y=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:ee.a.buttons},g()),l.a.createElement("div",{style:{display:1==s?"block":"none"}},l.a.createElement(ce.a,{value:r,style:{height:"600px"},renderHTML:function(e){return ie.render(e)},onChange:f,config:{view:{html:!1}},onImageUpload:E,onBlur:p})),l.a.createElement("div",{style:{display:0==s?"block":"none"}},l.a.createElement(ce.a,{value:r,style:{border:0},renderHTML:function(e){return ie.render(e)},config:{view:{menu:!1,md:!1}},readOnly:!0})),l.a.createElement("div",{style:{display:2==s?"block":"none"}},l.a.createElement("div",{ref:d,suppressContentEditableWarning:"true",contentEditable:!0})))};return y()})),se=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}),null,null,{forwardRef:!0})(ue),me=F["a"].TextArea,de={0:l.a.createElement(Q["a"],{twoToneColor:"#52c41a"}),1:l.a.createElement(Z["a"],{twoToneColor:"#f1c40f"}),2:l.a.createElement(W["a"],null)},fe="group",ve=l.a.forwardRef((function(e,t){Object(o["useRef"])();var n=Object(o["useRef"])(),a=Object(o["useState"])(""),r=Object(v["a"])(a,2),c=r[0],i=r[1],u=Object(o["useState"])(null),s=Object(v["a"])(u,2),d=s[0],f=s[1],E=Object(o["useState"])(""),b=Object(v["a"])(E,2),_=b[0],h=b[1],g=Object(o["useState"])(!1),y=Object(v["a"])(g,2),C=y[0],M=y[1],O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";document.execCommand(e,!1,t)},k=function(){M(!0)};Object(o["useImperativeHandle"])(t,(function(){return{handleAddNote:function(t){console.log("handleAddNote");var n=Object(D["c"])();f(1);var a={name:"\u65b0\u6587\u6863",parentId:t,id:n};h("\u65b0\u6587\u6863"),e.dispatch({type:"note/refreshShowNote",payload:a})}}}));var j=function(){M(!1)},N=function(e){var t=e.target.value;i(t)},w=function(e){f(1)},I=function(e){h(e.target.value),f(1)};Object(o["useEffect"])((function(){T(e.note.showNote)}),[e.note.showNote]);var T=function(e){console.log("handleShowNote"),h(e.name),f(0)},S=function(t,n){if(0!=d){var a,o=Object(m["a"])({},e.note.showNote);if(o.id)f(2),o.name=_,"title"==t?a="note/updateNoteTitle":(a="note/updateNoteText",o.text=n),e.dispatch({type:a,payload:o}).then((function(n){if(n){if(o.createTime)"title"==t&&e.refreshMenu(Object(D["a"])(o.parentIds));else{var a=n.result;o=a,e.refreshMenu(Object(D["a"])(a.parentIds))}e.dispatch({type:"openNotes/updateOpenNote",payload:o}),e.note.activeNoteId==o.id&&f(0)}}))}},x=function(e,t){"title"==t?S(t):e.relatedTarget&&e.relatedTarget.getAttribute("group")==fe||S(t)},A=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:ee.a.toolbar,onBlur:function(e){return x(e,"content")}},l.a.createElement("div",{className:ee.a.buttons},l.a.createElement("a",{group:fe,onClick:k,href:"#"},"code"),l.a.createElement("a",{group:fe,onClick:function(){return O("bold")},href:"#"},l.a.createElement("b",null,"Bold")),l.a.createElement("a",{group:fe,onClick:function(){return O("italic")},href:"#"},l.a.createElement("em",null,"Italic")),l.a.createElement("a",{group:fe,onClick:function(){return O("underline")},href:"#"},l.a.createElement("u",null,l.a.createElement("b",null,"U"))),l.a.createElement("a",{group:fe,className:ee.a.yellow,onClick:function(){O("backColor","#FFEB9C"),O("foreColor","#9C6500")},href:"#"},"\u7a81\u51fa"),l.a.createElement("a",{group:fe,className:ee.a.green,onClick:function(){O("backColor","#C6EFCE"),O("foreColor","#006100")},href:"#"},"\u4f18\u79c0"),l.a.createElement("a",{group:fe,className:ee.a.warning,onClick:function(){O("backColor","#FFC7CE"),O("foreColor","#9C0006")},href:"#"},"\u8b66\u544a"),l.a.createElement("a",{group:fe,onClick:function(){return O("removeFormat")},href:"#"},l.a.createElement("b",null,"\u53bb\u9664\u683c\u5f0f")),l.a.createElement("a",{group:fe,onClick:function(){return O("insertHorizontalRule")},href:"#"},l.a.createElement("b",null,"\u6c34\u5e73\u7ebf")),l.a.createElement("a",{group:fe,onClick:function(){return O("insertHTML","&nbsp;&nbsp;&nbsp;-&nbsp;")},href:"#"},l.a.createElement("b",null,"*")),l.a.createElement("a",{group:fe,onClick:function(){return O("indent")},href:"#"},l.a.createElement("b",null,"Tab")),l.a.createElement("a",{group:fe,onClick:function(){return O("fontname","Microsoft YaHei")},href:"#"},l.a.createElement("span",{style:{fontFamily:"Microsoft YaHei"}},"\u96c5\u9ed1")),l.a.createElement("a",{group:fe,onClick:function(){return O("fontname","SimHei")},href:"#"},l.a.createElement("span",{style:{fontFamily:"SimHei"}},"\u9ed1\u4f53")),l.a.createElement("a",{group:fe,onClick:function(){return O("fontname","SimSun")},href:"#"},l.a.createElement("span",{style:{fontFamily:"SimSun"}},"\u5b8b\u4f53")),l.a.createElement("a",{group:fe,onClick:function(){return O("fontname","Courier New")},href:"#"},l.a.createElement("div",{style:{display:"inline-block",fontFamily:"Courier New"}},"Font")),l.a.createElement("a",{group:fe,onClick:function(){return O("fontname","Comic Sans MS")},href:"#"},l.a.createElement("div",{style:{display:"inline-block",fontFamily:"Comic Sans MS"}},"Font"))),l.a.createElement("div",{className:ee.a.status},de[d])),l.a.createElement("div",{className:ee.a.main},e.children,l.a.createElement("div",{className:ee.a.content},l.a.createElement("div",{className:ee.a.title},l.a.createElement(F["a"],{maxLength:100,ref:n,value:_,onBlur:function(e){return x(e,"title")},onInput:I})),l.a.createElement(se,{handleChange:w,saveContent:function(e){return S("content",e)}}))),l.a.createElement(p["a"],{visible:C,onOk:j,onCancel:function(){return M(!1)}},l.a.createElement("div",{style:{marginBottom:"10px"}},"Source code"),l.a.createElement(me,{value:c,rows:10,onChange:N})))};return A()})),pe=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}),null,null,{forwardRef:!0})(ve),Ee=function(e){var t=Object(o["useRef"])(),n=function(t){var n,a="note/queryChildren";1==t?n=e.noteMenu.activeTopId:2==t?n=e.noteMenu.activeMenu1Id:(t=3,a="note/queryTabTree",n=e.noteMenu.activeMenu2Id),n?e.dispatch({type:a,payload:n}).then((function(n){if(n){var a=n.result;e.dispatch({type:"noteMenu/refreshMenu".concat(t),payload:a})}})):e.dispatch({type:"noteMenu/refreshMenu".concat(t),payload:[]})},r=function(e){t.current.handleAddNote(e)},c=function(){var o=e.loading.effects["note/queryNote"]||e.loading.effects["note/deleteNote"]||e.loading.effects["note/queryTabTree"]||e.loading.effects["note/queryChildren"]||!1;return l.a.createElement(a["a"],{spinning:o},l.a.createElement(pe,{ref:t,refreshMenu:n},l.a.createElement(J,{refreshMenu:n,onAddNote:r})))};return c()};t["default"]=Object(r["b"])((function(e){var t=e.note,n=e.noteMenu,a=e.loading;return{note:t,noteMenu:n,loading:a}}))(Ee)}}]);