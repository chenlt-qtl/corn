(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"64vn":function(e,t,a){e.exports={out:"out___1NJRG",layout:"layout___2zGS4",noteTree:"noteTree___2otnc",found:"found___sM1Jg",toolbar:"toolbar___10I07",tree:"tree___fHhRh",openNotes:"openNotes___2o65o",parents:"parents___1iHq1",close:"close___28y1z",active:"active___34Wi9",text:"text___2kqvR",textStatus:"textStatus___Z4qzX",content:"content___3GbIN",title:"title___1_qeF",star:"star___1uPdk",favorate:"favorate___1YzrV",notFavorate:"notFavorate___2kvm0"}},MjzT:function(e,t,a){"use strict";a.r(t);a("T2oS");var n=a("W9HT"),o=a("tJVT"),r=(a("B9cy"),a("Ol7k")),c=a("q1tI"),l=a.n(c),i=a("64vn"),u=a.n(i),s=(a("cWXX"),a("/ezw")),d=a("oBTY"),m=(a("Znn+"),a("ZTPi")),p=a("djQt"),f=a("2PG1"),v=a("9kvl"),b=a("uuDW"),E=a.n(b),y=m["a"].TabPane,N={id:"open",name:"\u6700\u8fd1\u6253\u5f00"},h={id:"favorate",name:l.a.createElement(l.a.Fragment,null,"\u6536\u85cf\u5939  ",l.a.createElement(p["a"],{className:E.a.favorate}))},g=function(e){var t=Object(c["useState"])([]),a=Object(o["a"])(t,2),n=a[0],r=a[1],i=function(t){e.onTabChange(t)};Object(c["useEffect"])((function(){e.dispatch({type:"note/queryChildren",payload:"0"}).then((function(e){if(e){var t=e.result;r([N,h].concat(Object(d["a"])(t)))}}))}),[]);var u=e.loading.effects["note/queryChildren"],p=e.note.activeTabId;return l.a.createElement("div",null,l.a.createElement(s["a"],{title:!1,active:!0,paragraph:{rows:1},loading:u},l.a.createElement(m["a"],{defaultActiveKey:p,onChange:i},n.map((function(e,t){return l.a.createElement(y,{key:e.id,tab:l.a.createElement("span",null,t>0?"":l.a.createElement(f["a"],null),e.name)})})))),l.a.createElement("div",null,e.children))},_=Object(v["b"])((function(e){var t=e.note,a=e.loading;return{note:t,loading:a}}))(g),O=(a("ozfa"),a("MJZm")),j=(a("qVdP"),a("jsC+")),k=(a("lUTK"),a("BvKs")),w=(a("miYZ"),a("tsqr")),T=a("k1fw"),x=a("xvlK"),q=function e(t,a){var n=[];if(!a||""===a.trim())return{treeData:t,keys:n};var o=t.reduce((function(t,o){var r=[];if(o.children){var c=e(o.children,a);r=c.treeData,n.push.apply(n,Object(d["a"])(c.keys))}var i,u=new RegExp(a,"ig"),s=o.name.match(u);(s||r.length>0)&&(n.push.apply(n,Object(d["a"])(o.parentIds.split("/"))),i=s?C(u,a,o.name):l.a.createElement("span",null,o.name),t.push(Object(T["a"])(Object(T["a"])({},o),{},{title:i,children:r})));return t}),[]);return{treeData:o,keys:n}},C=function(e,t,a){var n,o=[],r=0;while(n=e.exec(a))o.push(a.substring(r,n.index)),r=n.index+t.length;return o.push(a.substring(r)),l.a.createElement("span",null,o.map((function(e,a){return a!=o.length-1?l.a.createElement(l.a.Fragment,null,e,l.a.createElement("span",{className:u.a.found},t)):e})))},F=function(e){var t=Object(c["useState"])(!0),a=Object(o["a"])(t,2),r=a[0],i=a[1],s=Object(c["useState"])(""),d=Object(o["a"])(s,2),m=d[0],p=d[1],f=Object(c["useState"])([]),v=Object(o["a"])(f,2),b=v[0],E=v[1],y=Object(c["useState"])([]),N=Object(o["a"])(y,2),h=N[0],g=N[1];Object(c["useEffect"])((function(){_()}),[e.note.treeData]);var _=function(){var t=q(e.note.treeData,m),a=t.keys,n=t.treeData;return g(n),Array.from(new Set(a))},T=function(e){p(e.target.value)},C=function(){var t=e.note.activeTabId,a={parentId:t,name:"\u65b0\u6587\u6863",text:" "};e.onAddNote(a)},F=function(){var t={},a=e.note.showNote;a&&a.id?(t={parentId:a.id,name:"\u65b0\u6587\u6863",text:" "},e.onAddNote(t)):w["b"].error("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u7b14\u8bb0\u672c")},S=l.a.createElement(k["a"],null,l.a.createElement(k["a"].Item,null,l.a.createElement("a",{onClick:C},"\u589e\u52a0\u5206\u533a")),l.a.createElement(k["a"].Item,null,l.a.createElement("a",{onClick:F},"\u589e\u52a0\u7b14\u8bb0"))),I=function(e){if(13===e.keyCode){i(!0);var t=_();E(t)}},D=function(e){E(e),i(!1)},R=function(t){t.length>0&&e.dispatch({type:"note/queryNote",payload:t[0]})},z=e.loading.effects["note/queryTabTree"];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:u.a.toolbar},l.a.createElement("input",{value:m,onChange:T,onKeyUp:I}),l.a.createElement(j["a"],{overlay:S},l.a.createElement("div",null,l.a.createElement(x["a"],null)))),l.a.createElement(n["a"],{spinning:z},l.a.createElement("div",{className:u.a.tree},l.a.createElement(O["a"],{onExpand:D,expandedKeys:b,autoExpandParent:r,treeData:h,onSelect:R,selectedKeys:e.note.selectedKeys}))))},S=Object(v["b"])((function(e){var t=e.openNotes,a=e.note,n=e.loading;return{openNotes:t,note:a,loading:n}}))(F),I=(a("R9oj"),a("ECub")),D=a("4i/N"),R=function(e){var t=function(t){e.dispatch({type:"note/queryNote",payload:t})},a=e.remove,n=e.listData,o=e.activeNoteId,r=e.loading;return l.a.createElement(s["a"],{active:!0,loading:r},n.length>0?n.map((function(e){return l.a.createElement("div",{key:e.id,className:e.id===o?u.a.active:""},a?l.a.createElement("span",{className:u.a.close},l.a.createElement(D["a"],{onClick:function(){a(e.id)}})):"",l.a.createElement("span",{onClick:function(){t(e.id)}},e.name,l.a.createElement("span",{className:u.a.parents},e.parents)))})):l.a.createElement(I["a"],null))},z=Object(v["b"])()(R),K=function(e){Object(c["useEffect"])((function(){e.dispatch({type:"openNotes/queryOpenNote"})}),[]);var t=function(t){var a=e.openNotes.openedNotes;e.dispatch({type:"openNotes/updateOpenNote",payload:a.filter((function(e){return e.id!=t}))}),e.dispatch({type:"note/refreshShowNote",payload:{text:" "}})},a=e.loading.effects["openNotes/queryOpenNote"];return l.a.createElement(z,{loading:a,remove:t,listData:e.openNotes.openedNotes,activeNoteId:e.note.showNote.id})},P=Object(v["b"])((function(e){var t=e.openNotes,a=e.note,n=e.loading;return{openNotes:t,note:a,loading:n}}))(K),A=function(e){Object(c["useEffect"])((function(){e.dispatch({type:"noteFavorite/query"})}),[]);var t=e.loading.effects["noteFavorite/query"];return l.a.createElement(z,{loading:t,listData:e.noteFavorite.notes,activeNoteId:e.note.showNote.id})},J=Object(v["b"])((function(e){var t=e.noteFavorite,a=e.note,n=e.loading;return{noteFavorite:t,note:a,loading:n}}))(A),B=(a("5NDa"),a("5rEg")),W=a("ye1Q"),Z=a("uMRc"),G=a("Tm+p"),H=a("UYf5"),M=a("LvDl"),V=a.n(M),Y=l.a.forwardRef((function(e,t){var a=e.note.showNote,n=e.noteFavorite.noteIds,r=Object(c["useRef"])(),i=Object(c["useState"])(""),s=Object(o["a"])(i,2),m=s[0],f=s[1];Object(c["useImperativeHandle"])(t,(function(){return{focusName:function(){r.current.focus()}}}),[r]);var v=function(t){e.dispatch({type:"note/refreshShowNote",payload:Object(T["a"])(Object(T["a"])({},a),{},{name:t.target.value})})},b=function(e){var t=window.tinymce.activeEditor.getContent(),n=Object(T["a"])(Object(T["a"])({},a),{},{text:t});y(n)},E=function(e){e?f(l.a.createElement(l.a.Fragment,null,"\u6b63\u5728\u4fdd\u5b58 ",l.a.createElement(W["a"],null))):(f(l.a.createElement(l.a.Fragment,null,"\u4fdd\u5b58\u6210\u529f ",l.a.createElement(Z["a"],{twoToneColor:"#52c41a"}))),setTimeout((function(){f("")}),1e3))},y=function(t){E(1),t.parentId&&(t.id?e.dispatch({type:"note/modifyNote",payload:t}).then((function(){E(0)})):e.dispatch({type:"note/addNote",payload:t}).then((function(t){if(t){var a=t.result;e.dispatch({type:"openNotes/updateOpenNote",payload:[a].concat(Object(d["a"])(e.openNotes.openedNotes))}),E(0)}})))},N=function(){return!!n.includes(a.id)},h=function(t){if(!V.a.isEmpty(a)){var o=[];o=t?Array.from(new Set([].concat(Object(d["a"])(n),[a.id]))):n.filter((function(e){return e!=a.id})),console.log(o),e.dispatch({type:"noteFavorite/edit",payload:o})}};return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:u.a.title},l.a.createElement(B["a"],{ref:r,value:a.name,onChange:v,onBlur:b}),l.a.createElement("div",{className:u.a.star},N()?l.a.createElement(p["a"],{onClick:function(){h(!1)},className:u.a.favorate}):l.a.createElement(G["a"],{onClick:function(){h(!0)},className:u.a.notFavorate}))),l.a.createElement("div",{className:u.a.text},l.a.createElement("div",{className:u.a.textStatus},m),l.a.createElement(H["a"],{value:a.text,onBlur:b,init:{height:"100vh",plugins:"table,code,lists,advlist,image,imagetools,codesample,pagebreak,nonbreaking",toolbar:"code | undo redo | bold italic strikethrough | \n                        fontsizeselect h2 h3 forecolor backcolor | \n                bullist numlist | image | pagebreak blockquote codesample removeformat",toolbar_sticky:!0,menubar:!1,branding:!1,nonbreaking_force_tab:!0}})))})),U=Object(v["b"])((function(e){var t=e.note,a=e.openNotes,n=e.noteFavorite,o=e.loading;return{note:t,openNotes:a,noteFavorite:n,loading:o}}),null,null,{forwardRef:!0})(Y),X=r["a"].Sider,Q=r["a"].Content,L=function(e){var t=Object(c["useState"])("open"),a=Object(o["a"])(t,2),i=a[0],s=a[1],d=Object(c["useRef"])(),m=function(t){s(t),"open"==t&&"favorate"==t||e.dispatch({type:"note/queryTabTree",payload:t})},p=function(t){d.current.focusName(),e.dispatch({type:"note/refreshShowNote",payload:t})},f=function(){var t=e.loading.effects["note/queryNote"];return l.a.createElement("div",{className:u.a.out},l.a.createElement(n["a"],{spinning:!!t},l.a.createElement(_,{onTabChange:m},l.a.createElement(r["a"],{className:u.a.layout},l.a.createElement(X,{className:u.a.openNotes,width:300,style:{display:"open"===i?"inline-block":"none"}},l.a.createElement(P,null)),l.a.createElement(X,{className:u.a.openNotes,width:300,style:{display:"favorate"===i?"inline-block":"none"}},l.a.createElement(J,null)),l.a.createElement(X,{className:u.a.noteTree,width:300,style:{display:"open"!=i&&"favorate"!=i?"inline-block":"none"}},l.a.createElement(S,{onAddNote:p})),l.a.createElement(Q,{className:u.a.content},l.a.createElement(U,{ref:d}))))))};return f()};t["default"]=Object(v["b"])((function(e){var t=e.note,a=e.loading;return{note:t,loading:a}}))(L)},uuDW:function(e,t,a){e.exports={favorate:"favorate___2TVmP"}}}]);