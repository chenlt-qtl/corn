(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"64vn":function(e,t,n){e.exports={out:"out___1NJRG",layout:"layout___2zGS4",noteTree:"noteTree___2otnc",found:"found___sM1Jg",toolbar:"toolbar___10I07",tree:"tree___fHhRh",openNotes:"openNotes___2o65o",parents:"parents___1iHq1",active:"active___34Wi9",text:"text___2kqvR",content:"content___3GbIN"}},MjzT:function(e,t,n){"use strict";n.r(t);n("T2oS");var a=n("W9HT"),o=n("tJVT"),r=(n("B9cy"),n("Ol7k")),c=n("q1tI"),l=n.n(c),i=n("64vn"),u=n.n(i),s=(n("cWXX"),n("/ezw")),d=n("oBTY"),p=(n("Znn+"),n("ZTPi")),f=n("2PG1"),m=n("9kvl"),b=p["a"].TabPane,v={id:"",name:"\u6700\u8fd1\u6253\u5f00"},y=function(e){var t=Object(c["useState"])([]),n=Object(o["a"])(t,2),a=n[0],r=n[1],i=function(t){e.onTabChange(t)};Object(c["useEffect"])((function(){e.dispatch({type:"note/queryChildren",payload:"0"}).then((function(e){if(e){var t=e.result;r([v].concat(Object(d["a"])(t)))}}))}),[]);var u=e.loading.effects["note/queryChildren"],m=e.note.activeTabId;return l.a.createElement("div",null,l.a.createElement(s["a"],{title:!1,active:!0,paragraph:{rows:1},loading:u},l.a.createElement(p["a"],{defaultActiveKey:m,onChange:i},a.map((function(e,t){return l.a.createElement(b,{key:e.id,tab:l.a.createElement("span",null,t>0?"":l.a.createElement(f["a"],null),e.name)})})))),l.a.createElement("div",null,e.children))},h=Object(m["b"])((function(e){var t=e.note,n=e.loading;return{note:t,loading:n}}))(y),N=(n("ozfa"),n("MJZm")),E=(n("qVdP"),n("jsC+")),g=(n("lUTK"),n("BvKs")),O=(n("miYZ"),n("tsqr")),j=n("k1fw"),_=n("xvlK"),k=function e(t,n){var a=[];if(!n||""===n.trim())return{treeData:t,keys:a};var o=t.reduce((function(t,o){var r=[];if(o.children){var c=e(o.children,n);r=c.treeData,a.push.apply(a,Object(d["a"])(c.keys))}var i,u=new RegExp(n,"ig"),s=o.name.match(u);(s||r.length>0)&&(a.push.apply(a,Object(d["a"])(o.parentIds.split("/"))),i=s?w(u,n,o.name):l.a.createElement("span",null,o.name),t.push(Object(j["a"])(Object(j["a"])({},o),{},{title:i,children:r})));return t}),[]);return{treeData:o,keys:a}},w=function(e,t,n){var a,o=[],r=0;while(a=e.exec(n))o.push(n.substring(r,a.index)),r=a.index+t.length;return o.push(n.substring(r)),l.a.createElement("span",null,o.map((function(e,n){return n!=o.length-1?l.a.createElement(l.a.Fragment,null,e,l.a.createElement("span",{className:u.a.found},t)):e})))},T=function(e){var t=Object(c["useState"])(!0),n=Object(o["a"])(t,2),r=n[0],i=n[1],s=Object(c["useState"])(""),d=Object(o["a"])(s,2),p=d[0],f=d[1],m=Object(c["useState"])([]),b=Object(o["a"])(m,2),v=b[0],y=b[1],h=Object(c["useState"])([]),j=Object(o["a"])(h,2),w=j[0],T=j[1];Object(c["useEffect"])((function(){x()}),[e.note.treeData]);var x=function(){var t=k(e.note.treeData,p),n=t.keys,a=t.treeData;return T(a),Array.from(new Set(n))},q=function(e){f(e.target.value)},C=function(){var t=e.note.activeTabId,n={parentId:t,name:"\u65b0\u6587\u6863",text:" "};e.onAddNote(n)},S=function(){var t={},n=e.note.showNote;n&&n.id?(t={parentId:n.id,name:"\u65b0\u6587\u6863",text:" "},e.onAddNote(t)):O["b"].error("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u7b14\u8bb0\u672c")},I=l.a.createElement(g["a"],null,l.a.createElement(g["a"].Item,null,l.a.createElement("a",{onClick:C},"\u589e\u52a0\u5206\u533a")),l.a.createElement(g["a"].Item,null,l.a.createElement("a",{onClick:S},"\u589e\u52a0\u7b14\u8bb0"))),D=function(e){if(13===e.keyCode){i(!0);var t=x();y(t)}},K=function(e){y(e),i(!1)},R=function(t){t.length>0&&e.dispatch({type:"note/queryNote",payload:t[0]})},J=e.loading.effects["note/queryTabTree"];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:u.a.toolbar},l.a.createElement("input",{value:p,onChange:q,onKeyUp:D}),l.a.createElement(E["a"],{overlay:I},l.a.createElement("div",null,l.a.createElement(_["a"],null)))),l.a.createElement(a["a"],{spinning:J},l.a.createElement("div",{className:u.a.tree},l.a.createElement(N["a"],{onExpand:K,expandedKeys:v,autoExpandParent:r,treeData:w,onSelect:R,selectedKeys:e.note.selectedKeys}))))},x=Object(m["b"])((function(e){var t=e.openNotes,n=e.note,a=e.loading;return{openNotes:t,note:n,loading:a}}))(T),q=n("4i/N"),C=function(e){Object(c["useEffect"])((function(){e.dispatch({type:"openNotes/queryOpenNote"})}),[]);var t=function(t){e.dispatch({type:"note/queryNote",payload:t})},n=function(t){var n=e.openNotes.openedNotes;e.dispatch({type:"openNotes/updateOpenNote",payload:n.filter((function(e){return e.id!=t}))})},a=e.loading.effects["openNotes/queryOpenNote"];return l.a.createElement(s["a"],{active:!0,loading:a},e.openNotes.openedNotes.map((function(a){return l.a.createElement("div",{key:a.id,className:a.id===e.note.showNote.id?u.a.active:""},l.a.createElement(q["a"],{onClick:function(){n(a.id)}}),l.a.createElement("span",{onClick:function(){t(a.id)}},a.name,l.a.createElement("span",{className:u.a.parents},a.parents)))})))},S=Object(m["b"])((function(e){var t=e.openNotes,n=e.note,a=e.loading;return{openNotes:t,note:n,loading:a}}))(C),I=(n("5NDa"),n("5rEg")),D=n("UYf5"),K=l.a.forwardRef((function(e,t){var n=e.note.showNote,a=Object(c["useRef"])();Object(c["useImperativeHandle"])(t,(function(){return{focusName:function(){a.current.focus()}}}),[a]);var o=function(t){e.dispatch({type:"note/refreshShowNote",payload:Object(j["a"])(Object(j["a"])({},n),{},{name:t.target.value})})},r=function(e){var t=window.tinymce.activeEditor.getContent(),a=Object(j["a"])(Object(j["a"])({},n),{},{text:t});i(a)},i=function(t){e.note.treeData;t.parentId&&(t.id?e.dispatch({type:"note/modifyNote",payload:t}):e.dispatch({type:"note/addNote",payload:t}).then((function(t){if(t){var n=t.result;e.dispatch({type:"openNotes/updateOpenNote",payload:[n].concat(Object(d["a"])(e.openNotes.openedNotes))})}})))};return l.a.createElement(l.a.Fragment,null,l.a.createElement(I["a"],{ref:a,value:n.name,onChange:o,onBlur:r}),l.a.createElement("div",{className:u.a.text},l.a.createElement(D["a"],{value:n.text,onBlur:r,init:{height:"100vh",plugins:"table,code,lists,advlist",toolbar:"code | undo redo | bold italic h2 h3 blockquote forecolor backcolor | \n                bullist numlist | link image",toolbar_sticky:!0,menubar:!1,branding:!1}})))})),R=Object(m["b"])((function(e){var t=e.note,n=e.openNotes,a=e.loading;return{note:t,openNotes:n,loading:a}}),null,null,{forwardRef:!0})(K),J=r["a"].Sider,A=r["a"].Content,B=function(e){var t=Object(c["useState"])(!0),n=Object(o["a"])(t,2),i=n[0],s=n[1],d=Object(c["useRef"])(),p=function(t){t?(s(!1),e.dispatch({type:"note/queryTabTree",payload:t})):s(!0)},f=function(t){d.current.focusName(),e.dispatch({type:"note/refreshShowNote",payload:t})},m=function(){var t=e.loading.effects["note/queryNote"];return l.a.createElement("div",{className:u.a.out},l.a.createElement(a["a"],{spinning:!!t},l.a.createElement(h,{onTabChange:p},l.a.createElement(r["a"],{className:u.a.layout},l.a.createElement(J,{className:u.a.openNotes,width:300,style:{display:i?"inline-block":"none"}},l.a.createElement(S,null)),l.a.createElement(J,{className:u.a.noteTree,width:300,style:{display:i?"none":"inline-block"}},l.a.createElement(x,{onAddNote:f})),l.a.createElement(A,{className:u.a.content},l.a.createElement(R,{ref:d}))))))};return m()};t["default"]=Object(m["b"])((function(e){var t=e.note,n=e.loading;return{note:t,loading:n}}))(B)}}]);