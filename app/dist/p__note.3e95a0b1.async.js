(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"64vn":function(e,t,a){e.exports={out:"out___1NJRG",layout:"layout___2zGS4",noteTree:"noteTree___2otnc",found:"found___sM1Jg",toolbar:"toolbar___10I07",tree:"tree___fHhRh",openNotes:"openNotes___2o65o",parents:"parents___1iHq1",active:"active___34Wi9",text:"text___2kqvR",content:"content___3GbIN"}},MjzT:function(e,t,a){"use strict";a.r(t);a("T2oS");var n=a("W9HT"),o=a("tJVT"),r=(a("B9cy"),a("Ol7k")),c=a("q1tI"),l=a.n(c),i=a("64vn"),u=a.n(i),s=(a("cWXX"),a("/ezw")),d=a("oBTY"),p=(a("Znn+"),a("ZTPi")),f=a("2PG1"),m=a("9kvl"),b=p["a"].TabPane,v={id:"",name:"\u6700\u8fd1\u6253\u5f00"},y=function(e){var t=Object(c["useState"])([]),a=Object(o["a"])(t,2),n=a[0],r=a[1],i=function(t){e.onTabChange(t)};Object(c["useEffect"])((function(){e.dispatch({type:"note/queryChildren",payload:"0"}).then((function(e){if(e){var t=e.result;r([v].concat(Object(d["a"])(t)))}}))}),[]);var u=e.loading.effects["note/queryChildren"],m=e.note.activeTabId;return l.a.createElement("div",null,l.a.createElement(s["a"],{title:!1,active:!0,paragraph:{rows:1},loading:u},l.a.createElement(p["a"],{defaultActiveKey:m,onChange:i},n.map((function(e,t){return l.a.createElement(b,{key:e.id,tab:l.a.createElement("span",null,t>0?"":l.a.createElement(f["a"],null),e.name)})})))),l.a.createElement("div",null,e.children))},h=Object(m["b"])((function(e){var t=e.note,a=e.loading;return{note:t,loading:a}}))(y),N=(a("ozfa"),a("MJZm")),E=(a("qVdP"),a("jsC+")),g=(a("lUTK"),a("BvKs")),O=(a("miYZ"),a("tsqr")),j=a("k1fw"),_=a("xvlK"),w=function e(t,a){var n=[];if(!a||""===a.trim())return{treeData:t,keys:n};var o=t.reduce((function(t,o){var r=[];if(o.children){var c=e(o.children,a);r=c.treeData,n.push.apply(n,Object(d["a"])(c.keys))}var i,u=new RegExp(a,"ig"),s=o.name.match(u);(s||r.length>0)&&(n.push.apply(n,Object(d["a"])(o.parentIds.split("/"))),i=s?k(u,a,o.name):l.a.createElement("span",null,o.name),t.push(Object(j["a"])(Object(j["a"])({},o),{},{title:i,children:r})));return t}),[]);return{treeData:o,keys:n}},k=function(e,t,a){var n,o=[],r=0;while(n=e.exec(a))o.push(a.substring(r,n.index)),r=n.index+t.length;return o.push(a.substring(r)),l.a.createElement("span",null,o.map((function(e,a){return a!=o.length-1?l.a.createElement(l.a.Fragment,null,e,l.a.createElement("span",{className:u.a.found},t)):e})))},T=function(e){var t=Object(c["useState"])(!0),a=Object(o["a"])(t,2),r=a[0],i=a[1],s=Object(c["useState"])(""),d=Object(o["a"])(s,2),p=d[0],f=d[1],m=Object(c["useState"])([]),b=Object(o["a"])(m,2),v=b[0],y=b[1],h=Object(c["useState"])([]),j=Object(o["a"])(h,2),k=j[0],T=j[1];Object(c["useEffect"])((function(){x()}),[e.note.treeData]);var x=function(){var t=w(e.note.treeData,p),a=t.keys,n=t.treeData;return T(n),Array.from(new Set(a))},q=function(e){f(e.target.value)},C=function(){var t=e.note.activeTabId,a={parentId:t,name:"\u65b0\u6587\u6863",text:" "};e.onAddNote(a)},S=function(){var t={},a=e.note.showNote;a&&a.id?(t={parentId:a.id,name:"\u65b0\u6587\u6863",text:" "},e.onAddNote(t)):O["b"].error("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u7b14\u8bb0\u672c")},I=l.a.createElement(g["a"],null,l.a.createElement(g["a"].Item,null,l.a.createElement("a",{onClick:C},"\u589e\u52a0\u5206\u533a")),l.a.createElement(g["a"].Item,null,l.a.createElement("a",{onClick:S},"\u589e\u52a0\u7b14\u8bb0"))),D=function(e){if(13===e.keyCode){i(!0);var t=x();y(t)}},K=function(e){y(e),i(!1)},R=function(t){t.length>0&&e.dispatch({type:"note/queryNote",payload:t[0]})},J=e.loading.effects["note/queryTabTree"];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:u.a.toolbar},l.a.createElement("input",{value:p,onChange:q,onKeyUp:D}),l.a.createElement(E["a"],{overlay:I},l.a.createElement("div",null,l.a.createElement(_["a"],null)))),l.a.createElement(n["a"],{spinning:J},l.a.createElement("div",{className:u.a.tree},l.a.createElement(N["a"],{onExpand:K,expandedKeys:v,autoExpandParent:r,treeData:k,onSelect:R,selectedKeys:e.note.selectedKeys}))))},x=Object(m["b"])((function(e){var t=e.openNotes,a=e.note,n=e.loading;return{openNotes:t,note:a,loading:n}}))(T),q=a("4i/N"),C=function(e){Object(c["useEffect"])((function(){e.dispatch({type:"openNotes/queryOpenNote"})}),[]);var t=function(t){e.dispatch({type:"note/queryNote",payload:t})},a=function(t){var a=e.openNotes.openedNotes;e.dispatch({type:"openNotes/updateOpenNote",payload:a.filter((function(e){return e.id!=t}))}),e.dispatch({type:"note/refreshShowNote",payload:{text:" "}})},n=e.loading.effects["openNotes/queryOpenNote"];return l.a.createElement(s["a"],{active:!0,loading:n},e.openNotes.openedNotes.map((function(n){return l.a.createElement("div",{key:n.id,className:n.id===e.note.showNote.id?u.a.active:""},l.a.createElement(q["a"],{onClick:function(){a(n.id)}}),l.a.createElement("span",{onClick:function(){t(n.id)}},n.name,l.a.createElement("span",{className:u.a.parents},n.parents)))})))},S=Object(m["b"])((function(e){var t=e.openNotes,a=e.note,n=e.loading;return{openNotes:t,note:a,loading:n}}))(C),I=(a("5NDa"),a("5rEg")),D=a("UYf5"),K=l.a.forwardRef((function(e,t){var a=e.note.showNote,n=Object(c["useRef"])();Object(c["useImperativeHandle"])(t,(function(){return{focusName:function(){n.current.focus()}}}),[n]);var o=function(t){e.dispatch({type:"note/refreshShowNote",payload:Object(j["a"])(Object(j["a"])({},a),{},{name:t.target.value})})},r=function(e){var t=window.tinymce.activeEditor.getContent(),n=Object(j["a"])(Object(j["a"])({},a),{},{text:t});i(n)},i=function(t){e.note.treeData;t.parentId&&(t.id?e.dispatch({type:"note/modifyNote",payload:t}):e.dispatch({type:"note/addNote",payload:t}).then((function(t){if(t){var a=t.result;e.dispatch({type:"openNotes/updateOpenNote",payload:[a].concat(Object(d["a"])(e.openNotes.openedNotes))})}})))};return l.a.createElement(l.a.Fragment,null,l.a.createElement(I["a"],{ref:n,value:a.name,onChange:o,onBlur:r}),l.a.createElement("div",{className:u.a.text},l.a.createElement(D["a"],{value:a.text,onBlur:r,init:{height:"100vh",plugins:"table,code,lists,advlist,image,imagetools",toolbar:"code | undo redo | bold italic strikethrough | \n                        fontsizeselect h2 h3 forecolor backcolor | \n                bullist numlist | image blockquote removeformat",toolbar_sticky:!0,menubar:!1,branding:!1}})))})),R=Object(m["b"])((function(e){var t=e.note,a=e.openNotes,n=e.loading;return{note:t,openNotes:a,loading:n}}),null,null,{forwardRef:!0})(K),J=r["a"].Sider,z=r["a"].Content,A=function(e){var t=Object(c["useState"])(!0),a=Object(o["a"])(t,2),i=a[0],s=a[1],d=Object(c["useRef"])(),p=function(t){t?(s(!1),e.dispatch({type:"note/queryTabTree",payload:t})):s(!0)},f=function(t){d.current.focusName(),e.dispatch({type:"note/refreshShowNote",payload:t})},m=function(){var t=e.loading.effects["note/queryNote"];return l.a.createElement("div",{className:u.a.out},l.a.createElement(n["a"],{spinning:!!t},l.a.createElement(h,{onTabChange:p},l.a.createElement(r["a"],{className:u.a.layout},l.a.createElement(J,{className:u.a.openNotes,width:300,style:{display:i?"inline-block":"none"}},l.a.createElement(S,null)),l.a.createElement(J,{className:u.a.noteTree,width:300,style:{display:i?"none":"inline-block"}},l.a.createElement(x,{onAddNote:f})),l.a.createElement(z,{className:u.a.content},l.a.createElement(R,{ref:d}))))))};return m()};t["default"]=Object(m["b"])((function(e){var t=e.note,a=e.loading;return{note:t,loading:a}}))(A)}}]);