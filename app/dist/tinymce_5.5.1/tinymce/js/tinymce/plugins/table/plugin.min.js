!function(){"use strict";var n=function(){},e=function(n){return function(){return n}},t=function(n){return n};function r(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}var o,u,i,c=function(n){return function(e){return!n(e)}},a=e(!1),l=e(!0),f=function(){return s},s=(o=function(n){return n.isNone()},{fold:function(n,e){return n()},is:a,isSome:a,isNone:l,getOr:i=function(n){return n},getOrThunk:u=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:i,orThunk:u,map:f,each:n,bind:f,exists:a,forall:l,filter:f,equals:o,equals_:o,toArray:function(){return[]},toString:e("none()")}),m=function(n){var t=e(n),r=function(){return u},o=function(e){return e(n)},u={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:l,isNone:a,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:r,orThunk:r,map:function(e){return m(e(n))},each:function(e){e(n)},bind:o,exists:o,forall:o,filter:function(e){return e(n)?u:s},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(a,(function(e){return t(n,e)}))}};return u},d={some:m,none:f,from:function(n){return null===n||void 0===n?s:m(n)}},g=function(n){return function(e){return r=typeof(t=e),(null===t?"null":"object"==r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r)===n;var t,r}},p=function(n){return function(e){return typeof e===n}},h=g("string"),v=g("object"),b=g("array"),w=p("boolean"),y=function(n){return!(null===(e=n)||void 0===e);var e},C=p("function"),S=p("number"),x=Array.prototype.slice,T=Array.prototype.indexOf,R=Array.prototype.push,D=function(n,e){return t=n,r=e,-1<T.call(t,r);var t,r},O=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},A=function(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t},B=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},E=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},I=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},P=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,(function(n){t=e(t,n)})),t},k=function(n,e,t){return E(n,(function(n){t=e(t,n)})),t},M=function(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return d.some(u);if(t(u,r))break}return d.none()}(n,e,a)},N=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return d.some(t);return d.none()},j=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!b(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);R.apply(e,n[t])}return e},_=function(n,e){return j(B(n,e))},W=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},z=function(n){return[n]},F=function(n){return 0===n.length?d.none():d.some(n[n.length-1])},L=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return d.none()},H=function(){return(H=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function q(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var u=arguments[e],i=0,c=u.length;i<c;i++,o++)r[o]=u[i];return r}var V,U=function(n){var e,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,e=n.apply(null,r)),e}},$=function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return K(r(1),r(2))},G=function(){return K(0,0)},K=function(n,e){return{major:n,minor:e}},X={nu:K,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?G():$(n,t)},unknown:G},Y=function(n,e){var t=String(e).toLowerCase();return M(n,(function(n){return n.search(t)}))},J=function(n,e){return Y(n,e).map((function(n){var t=X.detect(n.versionRegexes,e);return{current:n.name,version:t}}))},Q=function(n,e){return Y(n,e).map((function(n){var t=X.detect(n.versionRegexes,e);return{current:n.name,version:t}}))},Z=function(n,e,t){return""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},nn=function(n,e){return-1!==n.indexOf(e)},en=function(n,e){return Z(n,e,0)},tn=function(n,e){return Z(n,e,n.length-e.length)},rn=(V=/^\s+|\s+$/g,function(n){return n.replace(V,"")}),on=function(n){return 0<n.length},un=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,cn=function(n){return function(e){return nn(e,n)}},an=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return nn(n,"edge/")&&nn(n,"chrome")&&nn(n,"safari")&&nn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,un],search:function(n){return nn(n,"chrome")&&!nn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return nn(n,"msie")||nn(n,"trident")}},{name:"Opera",versionRegexes:[un,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:cn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:cn("firefox")},{name:"Safari",versionRegexes:[un,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(nn(n,"safari")||nn(n,"mobile/"))&&nn(n,"applewebkit")}}],ln=[{name:"Windows",search:cn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return nn(n,"iphone")||nn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:cn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:cn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:cn("linux"),versionRegexes:[]},{name:"Solaris",search:cn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:cn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:cn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],fn={browsers:e(an),oses:e(ln)},sn="Firefox",mn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(sn),isSafari:r("Safari")}},dn={unknown:function(){return mn({current:void 0,version:X.unknown()})},nu:mn,edge:e("Edge"),chrome:e("Chrome"),ie:e("IE"),opera:e("Opera"),firefox:e(sn),safari:e("Safari")},gn="Windows",pn="Android",hn="Solaris",vn="FreeBSD",bn="ChromeOS",wn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(gn),isiOS:r("iOS"),isAndroid:r(pn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(hn),isFreeBSD:r(vn),isChromeOS:r(bn)}},yn={unknown:function(){return wn({current:void 0,version:X.unknown()})},nu:wn,windows:e(gn),ios:e("iOS"),android:e(pn),linux:e("Linux"),osx:e("OSX"),solaris:e(hn),freebsd:e(vn),chromeos:e(bn)},Cn=function(n,t){var r,o,u,i,c,a,l,f,s,m,d,g,p=fn.browsers(),h=fn.oses(),v=J(p,n).fold(dn.unknown,dn.nu),b=Q(h,n).fold(yn.unknown,yn.nu);return{browser:v,os:b,deviceType:(o=v,u=n,i=t,c=(r=b).isiOS()&&!0===/ipad/i.test(u),a=r.isiOS()&&!c,l=r.isiOS()||r.isAndroid(),f=l||i("(pointer:coarse)"),s=c||!a&&l&&i("(min-device-width:768px)"),m=a||l&&!s,d=o.isSafari()&&r.isiOS()&&!1===/safari/i.test(u),g=!m&&!s&&!d,{isiPad:e(c),isiPhone:e(a),isTablet:e(s),isPhone:e(m),isTouch:e(f),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:e(d),isDesktop:e(g)})}},Sn=function(n){return window.matchMedia(n).matches},xn=U((function(){return Cn(navigator.userAgent,Sn)})),Tn=function(){return xn()},Rn=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},Dn={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Rn(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return Rn(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return Rn(t)},fromDom:Rn,fromPoint:function(n,e,t){return d.from(n.dom.elementFromPoint(e,t)).map(Rn)}},On=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},An=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Bn=function(n,e){return n.dom===e.dom},En=function(n,e){return t=n.dom,r=e.dom,o=t,u=r,i=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(u)&i);var t,r,o,u,i},In=function(n,e){return Tn().browser.isIE()?En(n,e):(t=e,r=n.dom,o=t.dom,r!==o&&r.contains(o));var t,r,o},Pn=On,kn=Object.keys,Mn=Object.hasOwnProperty,Nn=function(n,e){for(var t=kn(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},jn=function(n,e){return _n(n,(function(n,t){return{k:t,v:e(n,t)}}))},_n=function(n,e){var t={};return Nn(n,(function(n,r){var o=e(n,r);t[o.k]=o.v})),t},Wn=function(e,t){var r,o,u,i,c={};return r=t,i=c,o=function(n,e){i[e]=n},u=n,Nn(e,(function(n,e){(r(n,e)?o:u)(n,e)})),c},zn=function(n){return e=function(n){return n},t=[],Nn(n,(function(n,r){t.push(e(n,r))})),t;var e,t},Fn=function(n,e){return Ln(n,e)?d.from(n[e]):d.none()},Ln=function(n,e){return Mn.call(n,e)},Hn=["tfoot","thead","tbody","colgroup"],qn=function(n,e,t){return{element:n,rowspan:e,colspan:t}},Vn=function(n,e,t){return{element:n,cells:e,section:t}},Un=function(n,e){return{element:n,isNew:e}},$n=function(n,e){return{cells:n,section:e}},Gn=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),Kn=function(n){return n.dom.nodeType},Xn=function(n){return function(e){return Kn(e)===n}},Yn=function(n){return 8===Kn(n)||"#comment"===Gn(n)},Jn=Xn(1),Qn=Xn(3),Zn=Xn(9),ne=Xn(11),ee=function(n){return Dn.fromDom(n.dom.ownerDocument)},te=function(n){return Zn(n)?n:ee(n)},re=function(n){return d.from(n.dom.parentNode).map(Dn.fromDom)},oe=function(n,e){for(var t=C(e)?e:a,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Dn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},ue=function(n){return d.from(n.dom.previousSibling).map(Dn.fromDom)},ie=function(n){return d.from(n.dom.nextSibling).map(Dn.fromDom)},ce=function(n){return B(n.dom.childNodes,Dn.fromDom)},ae=function(n,e){var t=n.dom.childNodes;return d.from(t[e]).map(Dn.fromDom)},le=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),fe=e(le),se=le?function(n){return Dn.fromDom(n.dom.getRootNode())}:te,me=function(n){var e=se(n);return ne(e)?d.some(e):d.none()},de=function(n){return Dn.fromDom(n.dom.host)},ge=function(n){if(fe()&&y(n.target)){var e=Dn.fromDom(n.target);if(Jn(e)&&pe(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0===(r=t).length?d.none():d.some(r[0])}}var r;return d.from(n.target)},pe=function(n){return y(n.dom.shadowRoot)},he=function(n){var e=Qn(n)?n.dom.parentNode:n.dom;if(void 0===e||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return me(Dn.fromDom(e)).fold((function(){return o.body.contains(e)}),(t=he,r=de,function(n){return t(r(n))}))},ve=function(n){var e=n.dom.body;if(null===e||void 0===e)throw new Error("Body is not available yet");return Dn.fromDom(e)},be=function(n,e){var t=[];return E(ce(n),(function(n){e(n)&&(t=t.concat([n])),t=t.concat(be(n,e))})),t},we=function(n,e,t){return r=function(n){return On(n,e)},I(oe(n,t),r);var r},ye=function(n,e){return t=function(n){return On(n,e)},I(ce(n),t);var t},Ce=function(n,e){return t=e,o=void 0===(r=n)?document:r.dom,An(o)?[]:B(o.querySelectorAll(t),Dn.fromDom);var t,r,o};function Se(n,e,t,r,o){return n(t,r)?d.some(t):C(o)&&o(t)?d.none():e(t,r,o)}var xe,Te,Re,De=function(n,e,t){for(var r=n.dom,o=C(t)?t:a;r.parentNode;){r=r.parentNode;var u=Dn.fromDom(r);if(e(u))return d.some(u);if(o(u))break}return d.none()},Oe=function(n,e,t){return De(n,(function(n){return On(n,e)}),t)},Ae=function(n,e){return t=function(n){return On(n,e)},M(n.dom.childNodes,(function(n){return t(Dn.fromDom(n))})).map(Dn.fromDom);var t},Be=function(n,e){return t=e,o=void 0===(r=n)?document:r.dom,An(o)?d.none():d.from(o.querySelector(t)).map(Dn.fromDom);var t,r,o},Ee=function(n,e,t){return Se(On,Oe,n,e,t)},Ie=function(n,e,t){if(!(h(t)||w(t)||S(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},Pe=function(n,e,t){Ie(n.dom,e,t)},ke=function(n,e){var t=n.dom;Nn(e,(function(n,e){Ie(t,e,n)}))},Me=function(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t},Ne=function(n,e){return d.from(Me(n,e))},je=function(n,e){n.dom.removeAttribute(e)},_e=function(n){return k(n.dom.attributes,(function(n,e){return n[e.name]=e.value,n}),{})},We=function(n){return void 0!==n.style&&C(n.style.getPropertyValue)},ze=function(n,e,t){if(!h(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);We(n)&&n.style.setProperty(e,t)},Fe=function(n,e,t){var r=n.dom;ze(r,e,t)},Le=function(n,e){var t=n.dom;Nn(e,(function(n,e){ze(t,e,n)}))},He=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||he(n)?r:qe(t,e)},qe=function(n,e){return We(n)?n.style.getPropertyValue(e):""},Ve=function(n,e){var t=n.dom,r=qe(t,e);return d.from(r).filter((function(n){return 0<n.length}))},Ue=function(n,e){var t,r,o=n.dom;r=e,We(t=o)&&t.style.removeProperty(r),Ne(n,"style").map(rn).is("")&&je(n,"style")},$e=function(n,e,t){return void 0===t&&(t=0),Ne(n,e).map((function(n){return parseInt(n,10)})).getOr(t)},Ge=function(n,e){return $e(n,e,1)},Ke=function(n){return 1<Ge(n,"colspan")},Xe=function(n){return 1<Ge(n,"rowspan")},Ye=function(n,e){return parseInt(He(n,e),10)},Je=e(10),Qe=e(10),Ze=function(n,e){return nt(n,e,l)},nt=function(n,e,t){return _(ce(n),(function(n){return On(n,e)?t(n)?[n]:[]:nt(n,e,t)}))},et=function(n,e){return function(n,e,t){return void 0===t&&(t=a),t(e)?d.none():D(n,Gn(e))?d.some(e):Oe(e,n.join(","),(function(n){return On(n,"table")||t(n)}))}(["td","th"],n,e)},tt=function(n){return Ze(n,"th,td")},rt=function(n){return Ze(n,"col")},ot=function(n,e){return Ee(n,"table",e)},ut=function(n){return Ze(n,"tr")},it=function(n,e){return B(n,(function(n){if("colgroup"===Gn(n)){var t=B(rt(n),(function(n){var e=$e(n,"span",1);return qn(n,1,e)}));return Vn(n,t,"colgroup")}return t=B(tt(n),(function(n){var e=$e(n,"rowspan",1),t=$e(n,"colspan",1);return qn(n,e,t)})),Vn(n,t,e(n))}))},ct=function(n){return re(n).map((function(n){var e=Gn(n);return D(Hn,e)?e:"tbody"})).getOr("tbody")},at=function(n){var e=ut(n),t=q(Ze(n,"colgroup"),e);return it(t,ct)},lt=function(n,e){return n+","+e},ft=function(n,e){var t=_(n.all,(function(n){return n.cells}));return I(t,e)},st=function(n){var e={},t=[],r={},o=0,u=0,i=0;return E(n,(function(n){var c,a,l;"colgroup"===n.section?(a={},l=0,E(n.cells,(function(n){var e=n.colspan;A(e,(function(t){var r=l+t;a[r]={element:n.element,colspan:e,column:r}})),l+=e})),r=a):(c=[],E(n.cells,(function(n){for(var t=0;void 0!==e[lt(i,t)];)t++;for(var r={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:i,column:t},o=0;o<n.colspan;o++)for(var a=0;a<n.rowspan;a++){var l=t+o,f=lt(i+a,l);e[f]=r,u=Math.max(u,l+1)}c.push(r)})),o++,t.push(Vn(n.element,c,n.section)),i++)})),{grid:{rows:o,columns:u},access:e,all:t,columns:r}},mt={fromTable:function(n){var e=at(n);return st(e)},generate:st,getAt:function(n,e,t){var r=n.access[lt(e,t)];return void 0!==r?d.some(r):d.none()},findItem:function(n,e,t){var r=ft(n,(function(n){return t(e,n.element)}));return 0<r.length?d.some(r[0]):d.none()},filterItems:ft,justCells:function(n){return _(n.all,(function(n){return n.cells}))},justColumns:function(n){return zn(n.columns)},hasColumns:function(n){return 0<kn(n.columns).length},getColumnAt:function(n,e){return d.from(n.columns[e])}},dt=function(n,e){var t=e.column,r=e.column+e.colspan-1,o=e.row,u=e.row+e.rowspan-1;return t<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&u>=n.startRow},gt=function(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow},pt=function(n,e,t){var r=mt.findItem(n,e,Bn),o=mt.findItem(n,t,Bn);return r.bind((function(n){return o.map((function(e){return t=n,r=e,{startRow:Math.min(t.row,r.row),startCol:Math.min(t.column,r.column),finishRow:Math.max(t.row+t.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(t.column+t.colspan-1,r.column+r.colspan-1)};var t,r}))}))},ht=function(n,e,t){return pt(n,e,t).bind((function(e){return function(n,e){for(var t=!0,o=r(gt,e),u=e.startRow;u<=e.finishRow;u++)for(var i=e.startCol;i<=e.finishCol;i++)t=t&&mt.getAt(n,u,i).exists(o);return t?d.some(e):d.none()}(n,e)}))},vt=function(n,e,t){return pt(n,e,t).map((function(e){var t=mt.filterItems(n,r(dt,e));return B(t,(function(n){return n.element}))}))},bt=function(n,e){return mt.findItem(n,e,(function(n,e){return In(e,n)})).map((function(n){return n.element}))},wt=function(n,e,t){return ot(n).bind((function(r){var o,u,i,c,a=Ct(r);return o=a,u=n,i=e,c=t,mt.findItem(o,u,Bn).bind((function(n){var e=0<i?n.row+n.rowspan-1:n.row,t=0<c?n.column+n.colspan-1:n.column;return mt.getAt(o,e+i,t+c).map((function(n){return n.element}))}))}))},yt=function(n,e,t,r,o){var u=Ct(n),i=Bn(n,t)?d.some(e):bt(u,e),c=Bn(n,o)?d.some(r):bt(u,r);return i.bind((function(n){return c.bind((function(e){return vt(u,n,e)}))}))},Ct=mt.fromTable,St=function(n,e){re(n).each((function(t){t.dom.insertBefore(e.dom,n.dom)}))},xt=function(n,e){ie(n).fold((function(){re(n).each((function(n){Rt(n,e)}))}),(function(n){St(n,e)}))},Tt=function(n,e){ae(n,0).fold((function(){Rt(n,e)}),(function(t){n.dom.insertBefore(e.dom,t.dom)}))},Rt=function(n,e){n.dom.appendChild(e.dom)},Dt=function(n,e){St(n,e),Rt(e,n)},Ot=function(n,e){E(e,(function(t,r){var o=0===r?n:e[r-1];xt(o,t)}))},At=function(n,e){E(e,(function(e){Rt(n,e)}))},Bt=function(n){n.dom.textContent="",E(ce(n),(function(n){Et(n)}))},Et=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},It=function(n){var e,t=ce(n);0<t.length&&(e=n,E(t,(function(n){St(e,n)}))),Et(n)},Pt=(xe=Qn,Te="text",{get:function(n){if(!xe(n))throw new Error("Can only get "+Te+" value of a "+Te+" node");return Re(n).getOr("")},getOption:Re=function(n){return xe(n)?d.from(n.dom.nodeValue):d.none()},set:function(n,e){if(!xe(n))throw new Error("Can only set raw "+Te+" value of a "+Te+" node");n.dom.nodeValue=e}}),kt=function(n){return Pt.get(n)},Mt=function(n){return Pt.getOption(n)},Nt=function(n,e){return Pt.set(n,e)},jt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function _t(){return{up:e({selector:Oe,closest:Ee,predicate:De,all:oe}),down:e({selector:Ce,predicate:be}),styles:e({get:He,getRaw:Ve,set:Fe,remove:Ue}),attrs:e({get:Me,set:Pe,remove:je,copyTo:function(n,e){var t=_e(n);ke(e,t)}}),insert:e({before:St,after:xt,afterAll:Ot,append:Rt,appendAll:At,prepend:Tt,wrap:Dt}),remove:e({unwrap:It,remove:Et}),create:e({nu:Dn.fromTag,clone:function(n){return Dn.fromDom(n.dom.cloneNode(!1))},text:Dn.fromText}),query:e({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:ue,nextSibling:ie}),property:e({children:ce,name:Gn,parent:re,document:function(n){return te(n).dom},isText:Qn,isComment:Yn,isElement:Jn,getText:kt,setText:Nt,isBoundary:function(n){return!!Jn(n)&&("body"===Gn(n)||D(jt,Gn(n)))},isEmptyTag:function(n){return!!Jn(n)&&D(["br","img","hr","input"],Gn(n))},isNonEditable:function(n){return Jn(n)&&"false"===Me(n,"contenteditable")}}),eq:Bn,is:Pn}}var Wt=function(n,e,t,r){var o=e(n,t);return P(r,(function(t,r){var o=e(n,r);return zt(n,t,o)}),o)},zt=function(n,e,t){return e.bind((function(e){return t.filter(r(n.eq,e))}))},Ft=function(n,e,t){return 0<t.length?Wt(n,e,(r=t)[0],r.slice(1)):d.none();var r},Lt=function(n,e,t,o){void 0===o&&(o=a);var u=[e].concat(n.up().all(e)),i=[t].concat(n.up().all(t)),c=function(n){return N(n,o).fold((function(){return n}),(function(e){return n.slice(0,e+1)}))},l=c(u),f=c(i),s=M(l,(function(e){return O(f,(t=e,r(n.eq,t)));var t}));return{firstpath:l,secondpath:f,shared:s}},Ht=_t(),qt=function(n,e){return Ft(Ht,(function(e,t){return n(t)}),e)},Vt=function(n){return Oe(n,"table")},Ut=function(n,e,t){var r=function(n){return function(e){return void 0!==t&&t(e)||Bn(e,n)}};return Bn(n,e)?d.some({boxes:d.some([n]),start:n,finish:e}):Vt(n).bind((function(o){return Vt(e).bind((function(u){if(Bn(o,u))return d.some({boxes:(f=n,s=e,m=Ct(o),vt(m,f,s)),start:n,finish:e});if(In(o,u)){var i=0<(c=we(e,"td,th",r(o))).length?c[c.length-1]:e;return d.some({boxes:yt(o,n,o,e,u),start:n,finish:i})}if(In(u,o)){var c,a=0<(c=we(n,"td,th",r(u))).length?c[c.length-1]:n;return d.some({boxes:yt(u,n,o,e,u),start:n,finish:a})}return Lt(Ht,n,e,l).shared.bind((function(i){return Ee(i,"table",t).bind((function(t){var i=we(e,"td,th",r(t)),c=0<i.length?i[i.length-1]:e,a=we(n,"td,th",r(t)),l=0<a.length?a[a.length-1]:n;return d.some({boxes:yt(t,n,o,e,u),start:l,finish:c})}))}));var l,f,s,m}))}))},$t=function(n,e){var t=Ce(n,e);return 0<t.length?d.some(t):d.none()},Gt=function(n,e,t){return Be(n,e).bind((function(e){return Be(n,t).bind((function(n){return qt(Vt,[e,n]).map((function(t){return{first:e,last:n,table:t}}))}))}))},Kt=function(n,e,t,r,o){return u=o,M(n,(function(n){return On(n,u)})).bind((function(n){return wt(n,e,t).bind((function(n){return t=r,Oe(e=n,"table").bind((function(n){return Be(n,t).bind((function(n){return Ut(n,e).bind((function(n){return n.boxes.map((function(e){return{boxes:e,start:n.start,finish:n.finish}}))}))}))}));var e,t}))}));var u},Xt=$t,Yt=function(n,e,t){return Gt(n,e,t).bind((function(e){var t=function(e){return Bn(n,e)},r="thead,tfoot,tbody,table",o=Oe(e.first,r,t),u=Oe(e.last,r,t);return o.bind((function(n){return u.bind((function(t){return Bn(n,t)?(r=e.table,o=e.first,u=e.last,i=Ct(r),ht(i,o,u)):d.none();var r,o,u,i}))}))}))},Jt=function(n){if(!b(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],t={};return E(n,(function(r,o){var u=kn(r);if(1!==u.length)throw new Error("one and only one name per case");var i=u[0],c=r[i];if(void 0!==t[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!b(c))throw new Error("case arguments must be an array");e.push(i),t[i]=function(){var t=arguments.length;if(t!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+t);for(var r=new Array(t),u=0;u<r.length;u++)r[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(n){var t=kn(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));if(!W(e,(function(n){return D(t,n)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[i].apply(null,r)},log:function(n){console.log(n,{constructors:e,constructor:i,params:r})}}}})),t},Qt=Jt([{none:[]},{multiple:["elements"]},{single:["element"]}]),Zt=function(n,e,t,r){return n.fold(e,t,r)},nr=Qt.none,er=Qt.multiple,tr=Qt.single,rr=function(n,e,t){return{get:function(){return Xt(n(),t).fold((function(){return e().map(tr).getOrThunk(nr)}),(function(n){return er(n)}))}}},or=tinymce.util.Tools.resolve("tinymce.PluginManager"),ur=function(n,e,t,r){for(var o,u,i,c=e.grid.columns,a=e.grid.rows,l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<t.minRow||l>t.maxRow||s<t.minCol||s>t.maxCol||(mt.getAt(e,l,s).filter(r).isNone()?(o=f,u=n[l].element,i=Dn.fromTag("td"),Rt(i,Dn.fromTag("br")),(o?Rt:Tt)(u,i)):f=!0)},ir=function(n,e){var t,r,o,u,i,c,a,l,f,s,m=function(n){return On(n.element,e)},d=at(n),g=mt.generate(d),p=(r=m,o=(t=g).grid.columns,u=t.grid.rows,i=o,a=c=0,Nn(t.access,(function(n){var e,t,o,l;r(n)&&(t=(e=n.row)+n.rowspan-1,l=(o=n.column)+n.colspan-1,e<u?u=e:c<t&&(c=t),o<i?i=o:a<l&&(a=l))})),{minRow:u,minCol:i,maxRow:c,maxCol:a}),h="th:not("+e+"),td:not("+e+")",v=nt(n,"th,td",(function(n){return On(n,h)}));return E(v,Et),ur(d,g,p,m),f=p,s=I(Ze(l=n,"tr"),(function(n){return 0===n.dom.childElementCount})),E(s,Et),f.minCol!==f.maxCol&&f.minRow!==f.maxRow||E(Ze(l,"th,td"),(function(n){je(n,"rowspan"),je(n,"colspan")})),je(l,"width"),je(l,"height"),Ue(l,"width"),Ue(l,"height"),n},cr=function(n){return"img"===Gn(n)?1:Mt(n).fold((function(){return ce(n).length}),(function(n){return n.length}))},ar=["img","br"],lr=function(n){return Mt(n).filter((function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")})).isSome()||D(ar,Gn(n))},fr=function(n){return e=lr,(t=function(n){for(var r=0;r<n.childNodes.length;r++){var o=Dn.fromDom(n.childNodes[r]);if(e(o))return d.some(o);var u=t(n.childNodes[r]);if(u.isSome())return u}return d.none()})(n.dom);var e,t},sr=function(n){return mr(n,lr)},mr=function(n,e){var t=function(n){for(var r=ce(n),o=r.length-1;0<=o;o--){var u=r[o];if(e(u))return d.some(u);var i=t(u);if(i.isSome())return i}return d.none()};return t(n)},dr=function(n,e){return Dn.fromDom(n.dom.cloneNode(e))},gr=function(n){return dr(n,!1)},pr=function(n){return dr(n,!0)},hr=function(n,e){var t,r,o,u,i=(t=n,r=e,o=Dn.fromTag(r),u=_e(t),ke(o,u),o),c=ce(pr(n));return At(i,c),i},vr=function(){var n=Dn.fromTag("td");return Rt(n,Dn.fromTag("br")),n},br=function(){return Dn.fromTag("col")},wr=function(){return Dn.fromTag("colgroup")},yr=function(n,e,t){var r=hr(n,e);return Nn(t,(function(n,e){null===n?je(r,e):Pe(r,e,n)})),r},Cr=function(n){return n},Sr=function(n){return function(){return Dn.fromTag("tr",n.dom)}},xr=function(n,e,t){var r=function(n,e){var t,r,o,u;t=n.element,r=e,o=t.dom,u=r.dom,We(o)&&We(u)&&(u.style.cssText=o.style.cssText),Ue(e,"height"),1!==n.colspan&&Ue(n.element,"width")};return{col:function(e){var t=ee(e.element),o=Dn.fromTag(Gn(e.element),t.dom);return r(e,o),n(e.element,o),o},colgroup:wr,row:Sr(e),cell:function(e){var o,u,i,c=ee(e.element),a=Dn.fromTag(Gn(e.element),c.dom),l=t.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=0<l.length?(o=e.element,u=a,i=l,fr(o).map((function(n){var e=i.join(","),t=we(n,e,(function(n){return Bn(n,o)}));return P(t,(function(n,e){var t=gr(e);return je(t,"contenteditable"),Rt(n,t),t}),u)})).getOr(u)):a;return Rt(f,Dn.fromTag("br")),r(e,a),n(e.element,a),a},replace:yr,gap:vr}},Tr=function(n){return{col:br,colgroup:wr,row:Sr(n),cell:vr,replace:Cr,gap:vr}},Rr=function(n){return B(n,Dn.fromDom)},Dr=function(n){return Zt(n.get(),e([]),t,z)},Or="data-mce-selected",Ar="data-mce-first-selected",Br="data-mce-last-selected",Er={selected:Or,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:Ar,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:Br,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ir=function(n){return{element:n,mergable:d.none(),unmergable:d.none(),selection:[n]}},Pr=function(n,e,t){return{element:t,mergable:(u=e,i=Er,Zt(n.get(),d.none,(function(n){return n.length<=1?d.none():Yt(u,i.firstSelectedSelector,i.lastSelectedSelector).map((function(e){return{bounds:e,cells:n}}))}),d.none)),unmergable:(r=function(n,e){return Ne(n,e).exists((function(n){return 1<parseInt(n,10)}))},0<(o=Dr(n)).length&&W(o,(function(n){return r(n,"rowspan")||r(n,"colspan")}))?d.some(o):d.none()),selection:Dr(n)};var r,o,u,i},kr=function(e,t,r,o){e.on("BeforeGetContent",(function(r){!0===r.selection&&Zt(t.get(),n,(function(n){r.preventDefault(),ot(n[0]).map(pr).map((function(n){return[ir(n,"[data-mce-selected]")]})).each((function(n){var t;r.content="text"===r.format?B(n,(function(n){return n.dom.innerText})).join(""):(t=e,B(n,(function(n){return t.selection.serializer.serialize(n.dom,{})})).join(""))}))}),n)})),e.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&d.from(e.dom.getParent(e.selection.getStart(),"th,td")).each((function(t){var u=Dn.fromDom(t);ot(u).each((function(t){var i,c,a,l,f,s,m,d=I((i=n.content,(a=(c||document).createElement("div")).innerHTML=i,ce(Dn.fromDom(a))),(function(n){return"meta"!==Gn(n)}));1===d.length&&(m=d[0],"table"===Gn(m))&&(n.preventDefault(),l=Dn.fromDom(e.getDoc()),f=Tr(l),s={element:u,clipboard:d[0],generators:f},r.pasteCells(t,s).each((function(n){e.selection.setRng(n),e.focus(),o.clear(t)})))}))}))}))},Mr=Jt([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Nr=H({},Mr),jr=function(n,t,r,o,u){var i,c,a=n.slice(0),l=(c=t,0===(i=n).length?Nr.none():1===i.length?Nr.only(0):0===c?Nr.left(0,1):c===i.length-1?Nr.right(c-1,c):0<c&&c<i.length-1?Nr.middle(c-1,c,c+1):Nr.none()),f=e(B(a,e(0)));return l.fold(f,(function(n){return o.singleColumnWidth(a[n],r)}),(function(n,e){return u.calcLeftEdgeDeltas(a,n,e,r,o.minCellWidth(),o.isRelative)}),(function(n,e,t){return u.calcMiddleDeltas(a,n,e,t,r,o.minCellWidth(),o.isRelative)}),(function(n,e){return u.calcRightEdgeDeltas(a,n,e,r,o.minCellWidth(),o.isRelative)}))},_r=function(n){var e=n.grid,r=A(e.columns,t),o=A(e.rows,t);return B(r,(function(e){return Wr((function(){return _(o,(function(t){return mt.getAt(n,t,e).filter((function(n){return n.column===e})).toArray()}))}),(function(n){return 1===n.colspan}),(function(){return mt.getAt(n,0,e)}))}))},Wr=function(n,e,t){var r=n();return M(r,e).orThunk((function(){return d.from(r[0]).orThunk(t)})).map((function(n){return n.element}))},zr=function(n){var r=n.grid,o=A(r.rows,t),u=A(r.columns,t);return B(o,(function(t){return Wr((function(){return _(u,(function(r){return mt.getAt(n,t,r).filter((function(n){return n.row===t})).fold(e([]),(function(n){return[n]}))}))}),(function(n){return 1===n.rowspan}),(function(){return mt.getAt(n,t,0)}))}))},Fr=function(n,e){if(e<0||e>=n.length-1)return d.none();var t=n[e].fold((function(){var t,r,o=(t=n.slice(0,e),(r=x.call(t,0)).reverse(),r);return L(o,(function(n,e){return n.map((function(n){return{value:n,delta:e+1}}))}))}),(function(n){return d.some({value:n,delta:0})})),r=n[e+1].fold((function(){var t=n.slice(e+1);return L(t,(function(n,e){return n.map((function(n){return{value:n,delta:e+1}}))}))}),(function(n){return d.some({value:n,delta:1})}));return t.bind((function(n){return r.map((function(e){var t=e.delta+n.delta;return Math.abs(e.value-n.value)/t}))}))},Lr=function(n,e){return function(t){return"rtl"===Hr(t)?e:n}},Hr=function(n){return"rtl"===He(n,"direction")?"rtl":"ltr"};function qr(n,e){var t=function(t){var r=e(t);if(r<=0||null===r){var o=He(t,n);return parseFloat(o)||0}return r},r=function(n,e){return k(e,(function(e,t){var r=He(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)};return{set:function(e,t){if(!S(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom;We(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return o<e?e-o:0}}}var Vr,Ur,$r,Gr,Kr=qr("height",(function(n){var e=n.dom;return he(n)?e.getBoundingClientRect().height:e.offsetHeight})),Xr=function(n){return Kr.get(n)},Yr=function(n){return Kr.getOuter(n)},Jr=function(n,e){return{left:n,top:e,translate:function(t,r){return Jr(n+t,e+r)}}},Qr=Jr,Zr=function(n,e){return void 0!==n?n:void 0!==e?e:0},no=function(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return Qr(t.offsetLeft,t.offsetTop);var u=Zr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Zr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Zr(o.clientTop,t.clientTop),a=Zr(o.clientLeft,t.clientLeft);return eo(n).translate(i-a,u-c)},eo=function(n){var e,t=n.dom,r=t.ownerDocument.body;return r===t?Qr(r.offsetLeft,r.offsetTop):he(n)?(e=t.getBoundingClientRect(),Qr(e.left,e.top)):Qr(0,0)},to=qr("width",(function(n){return n.dom.offsetWidth})),ro=function(n){return to.get(n)},oo=function(n){return to.getOuter(n)},uo=function(n,e){return{row:n,y:e}},io=function(n,e){return{col:n,x:e}},co=function(n){return no(n).left+oo(n)},ao=function(n){return no(n).left},lo=function(n,e){return io(n,ao(e))},fo=function(n,e){return io(n,co(e))},so=function(n){return no(n).top},mo=function(n,e){return uo(n,so(e))},go=function(n,e){return uo(n,so(e)+Yr(e))},po=function(n,e,t){if(0===t.length)return[];var r=B(t.slice(1),(function(e,t){return e.map((function(e){return n(t,e)}))})),o=t[t.length-1].map((function(n){return e(t.length-1,n)}));return r.concat([o])},ho={delta:t,positions:function(n){return po(mo,go,n)},edge:so},vo=Lr({delta:t,edge:ao,positions:function(n){return po(lo,fo,n)}},{delta:function(n){return-n},edge:co,positions:function(n){return po(fo,lo,n)}}),bo={delta:function(n,e){return vo(e).delta(n,e)},positions:function(n,e){return vo(e).positions(n,e)},edge:function(n){return vo(n).edge(n)}},wo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},yo=(Ur="[eE][+-]?[0-9]+",Gr=["Infinity",(Vr="[0-9]+")+"\\."+($r=function(n){return"(?:"+n+")?"})(Vr)+$r(Ur),"\\."+Vr+$r(Ur),Vr+$r(Ur)].join("|"),new RegExp("^([+-]?(?:"+Gr+"))(.*)$")),Co=function(n,e){return d.from(yo.exec(n)).bind((function(n){var t,r=Number(n[1]),o=n[2];return t=o,O(e,(function(n){return O(wo[n],(function(n){return t===n}))}))?d.some({value:r,unit:o}):d.none()}))},So=function(){var n=Tn().browser;return n.isIE()||n.isEdge()},xo=function(n,e,t){return r=He(n,e),o=t,u=parseFloat(r),isNaN(u)?o:u;var r,o,u},To=function(n){return So()?(t=(e=n).dom.getBoundingClientRect().height,"border-box"===He(e,"box-sizing")?t:t-xo(e,"padding-top",0)-xo(e,"padding-bottom",0)-(xo(e,"border-top-width",0)+xo(e,"border-bottom-width",0))):xo(n,"height",Xr(n));var e,t},Ro=function(n){return So()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===He(e,"box-sizing")?t:t-xo(e,"padding-left",0)-xo(e,"padding-right",0)-(xo(e,"border-left-width",0)+xo(e,"border-right-width",0))):xo(n,"width",ro(n));var e,t},Do=/(\d+(\.\d+)?)%/,Oo=/(\d+(\.\d+)?)px|em/,Ao=function(n,e){var t,r=(t=n,d.from(t.dom.offsetParent).map(Dn.fromDom).getOr(ve(ee(n))));return e(n)/e(r)*100},Bo=function(n,e){Fe(n,"width",e+"px")},Eo=function(n,e){Fe(n,"width",e+"%")},Io=function(n,e){Fe(n,"height",e+"px")},Po=function(n,e,t,r){var o,u,i,c,a,l=parseInt(n,10);return tn(n,"%")&&"table"!==Gn(e)?(u=l,i=t,c=r,a=ot(o=e).map((function(n){var e=i(n);return Math.floor(u/100*e)})).getOr(u),c(o,a),a):l},ko=function(n){var e,t=Ve(e=n,"height").getOrThunk((function(){return To(e)+"px"}));return t?Po(t,n,Xr,Io):Xr(n)},Mo=function(n){return Ve(n,"width").fold((function(){return d.from(Me(n,"width"))}),(function(n){return d.some(n)}))},No=function(n,e){return n/e.pixelWidth()*100},jo=function(n,e){return Mo(n).fold((function(){var t=ro(n);return No(t,e)}),(function(t){return function(n,e,t){var r=Do.exec(e);if(null!==r)return parseFloat(r[1]);var o=Ro(n);return No(o,t)}(n,t,e)}))},_o=function(n,e){return Mo(n).fold((function(){return Ro(n)}),(function(t){return function(n,e,t){var r=Oo.exec(e);if(null!==r)return parseInt(r[1],10);var o=Do.exec(e);if(null===o)return Ro(n);var u=parseFloat(o[1]);return u/100*t.pixelWidth()}(n,t,e)}))},Wo=function(n){return t="rowspan",ko(e=n)/Ge(e,t);var e,t},zo=function(n,e,t){Fe(n,"width",e+t)},Fo=function(n){return Ao(n,ro)+"%"},Lo=e(Do),Ho=e(Oo),qo=function(n,e,t){return Ve(n,e).fold((function(){return t(n)+"px"}),(function(n){return n}))},Vo=function(n,e){return qo(n,"width",(function(n){return _o(n,e)}))},Uo=function(n){return qo(n,"height",Wo)},$o=function(n,e,t,r){var o,u=mt.hasColumns(n)?(o=n,B(mt.justColumns(o),(function(n){return d.from(n.element)}))):_r(n),i=B(u,(function(n){return n.map(bo.edge)}));return B(u,(function(n,o){return n.filter(c(Ke)).fold((function(){var n=Fr(i,o);return t(n)}),(function(n){return e(n,r)}))}))},Go=function(n){return n.map((function(n){return n+"px"})).getOr("")},Ko=function(n,e){return $o(n,jo,(function(n){return n.fold((function(){return e.minCellWidth()}),(function(n){return n/e.pixelWidth()*100}))}),e)},Xo=function(n,e){return $o(n,_o,(function(n){return n.getOrThunk(e.minCellWidth)}),e)},Yo=function(n,e,t,r){var o=zr(n),u=B(o,(function(n){return n.map(e.edge)}));return B(o,(function(n,e){return n.filter(c(Xe)).fold((function(){var n=Fr(u,e);return r(n)}),(function(n){return t(n)}))}))},Jo=function(n,e,t){for(var r=0,o=n;o<e;o++)r+=void 0!==t[o]?t[o]:0;return r},Qo=function(n,e){return mt.hasColumns(n)?(u=n,i=e,c=mt.justColumns(u),B(c,(function(n,e){return{element:n.element,width:i[e],colspan:n.colspan}}))):(t=n,r=e,o=mt.justCells(t),B(o,(function(n){var e=Jo(n.column,n.column+n.colspan,r);return{element:n.element,width:e,colspan:n.colspan}})));var t,r,o,u,i,c},Zo=function(n,e,t){var r=Qo(n,e);E(r,(function(n){t.setElementWidth(n.element,n.width)}))},nu=function(n,e,t,r,o){var u=mt.fromTable(n),i=o.getCellDelta(e),c=o.getWidths(u,o),a=t===u.grid.columns-1,l=r.clampTableDelta(c,t,i,o.minCellWidth(),a),f=jr(c,t,l,o,r),s=B(f,(function(n,e){return n+c[e]}));Zo(u,s,o),r.resizeTable(o.adjustTableWidth,l,a)},eu=function(n,e,t,r){var o,u,i,c,a=mt.fromTable(n),l=Yo(a,r,Wo,(function(n){return n.getOrThunk(Qe)})),f=B(l,(function(n,r){return t===r?Math.max(e+n,Qe()):n})),s=(o=a,u=f,i=mt.justCells(o),B(i,(function(n){var e=Jo(n.row,n.row+n.rowspan,u);return{element:n.element,height:e,rowspan:n.rowspan}}))),m=(c=f,B(a.all,(function(n,e){return{element:n.element,height:c[e]}})));E(m,(function(n){Io(n.element,n.height)})),E(s,(function(n){Io(n.element,n.height)}));var d=P(f,(function(n,e){return n+e}),0);Io(n,d)},tu=function(n){return B(n,e(0))},ru=function(n,e,t,r,o){return o(n.slice(0,e)).concat(r).concat(o(n.slice(t)))},ou=function(n){return function(e,t,r,o){if(n(r)){var u=Math.max(o,e[t]-Math.abs(r)),i=Math.abs(u-e[t]);return 0<=r?i:-i}return r}},uu=ou((function(n){return n<0})),iu=ou(l),cu=function(){var n=function(n,e,t,r){var o=(100+t)/100,u=Math.max(r,(n[e]+t)/o);return B(n,(function(n,t){return(t===e?u:n/o)-n}))},e=function(e,t,r,o,u,i){return i?n(e,t,o,u):(l=r,f=uu(c=e,a=t,o,u),ru(c,a,l+1,[f,0],tu));var c,a,l,f};return{resizeTable:function(n,e){return n(e)},clampTableDelta:uu,calcLeftEdgeDeltas:e,calcMiddleDeltas:function(n,t,r,o,u,i,c){return e(n,r,o,u,i,c)},calcRightEdgeDeltas:function(e,t,r,o,u,i){if(i)return n(e,r,o,u);var c=uu(e,r,o,u);return tu(e.slice(0,r)).concat([c])}}},au=function(n){var t=d.from(n.dom.documentElement).map(Dn.fromDom).getOr(n);return{parent:e(t),view:e(n),origin:e(Qr(0,0))}},lu=function(n,t){return{parent:e(t),view:e(n),origin:e(Qr(0,0))}},fu=Jt([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),su=function(n,e,t){var r=t.substring(0,t.length-n.length),o=parseFloat(r);return r===o.toString()?e(o):fu.invalid(t)},mu=H(H({},fu),{from:function(n){return tn(n,"%")?su("%",fu.percent,n):tn(n,"px")?su("px",fu.pixels,n):fu.invalid(n)}}),du=function(n,e,t){return n.fold((function(){return e}),(function(n){return o=(r=n)/t,B(e,(function(n){return mu.from(n).fold((function(){return n}),(function(n){return n*o+"px"}),(function(n){return n/100*r+"px"}))}));var r,o}),(function(n){return r=t,B(e,(function(n){return mu.from(n).fold((function(){return n}),(function(n){return n/r*100+"%"}),(function(n){return n+"%"}))}));var r}))},gu=function(n,t,r){var o,u,i,c=mu.from(r),a=W(n,(function(n){return"0px"===n}))?(o=c,u=n.length,i=o.fold((function(){return e("")}),(function(n){return e(n/u+"px")}),(function(){return e(100/u+"%")})),A(u,i)):du(c,n,t);return hu(a)},pu=function(n,r){return 0===n.length?r:P(n,(function(n,r){return mu.from(r).fold(e(0),t,t)+n}),0)},hu=function(n){if(0===n.length)return n;var t,r,o=P(n,(function(n,e){var t=mu.from(e).fold((function(){return{value:e,remainder:0}}),(function(n){return e=n,t="px",{value:(r=Math.floor(e))+t,remainder:e-r};var e,t,r}),(function(n){return{value:n+"%",remainder:0}}));return{output:[t.value].concat(n.output),remainder:n.remainder+t.remainder}}),{output:[],remainder:0}),u=o.output;return u.slice(0,u.length-1).concat([(t=u[u.length-1],r=Math.round(o.remainder),mu.from(t).fold(e(t),(function(n){return n+r+"px"}),(function(n){return n+r+"%"})))])},vu=mu.from,bu=function(n){return vu(n).fold(e("px"),e("px"),e("%"))},wu=function(n,e,t,r){var o=mt.fromTable(n),u=o.all,i=mt.justCells(o),c=mt.justColumns(o);e.each((function(e){var t,u,a,l,f=bu(e),s=ro(n),m=$o(o,Vo,Go,r),d=gu(m,s,e);mt.hasColumns(o)?(a=d,l=f,E(c,(function(n,e){var t=pu([a[e]],Je());Fe(n.element,"width",t+l)}))):(t=d,u=f,E(i,(function(n){var e=t.slice(n.column,n.colspan+n.column),r=pu(e,Je());Fe(n.element,"width",r+u)}))),Fe(n,"width",e)})),t.each((function(e){var t,r,c,a=bu(e),l=Xr(n),f=Yo(o,ho,Uo,Go),s=gu(f,l,e);t=s,r=u,c=a,E(i,(function(n){var e=t.slice(n.row,n.rowspan+n.row),r=pu(e,Qe());Fe(n.element,"height",r+c)})),E(r,(function(n,e){Fe(n.element,"height",t[e])})),Fe(n,"height",e)}))},yu=function(n){return Mo(n).exists((function(n){return Do.test(n)}))},Cu=function(n){return Mo(n).exists((function(n){return Oo.test(n)}))},Su=function(n){return Mo(n).isNone()},xu=Fo,Tu=function(n){return mt.fromTable(n).grid},Ru=function(n){var e=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");e.push(n)},unbind:function(n){e=I(e,(function(e){return e!==n}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o={};E(n,(function(n,e){o[n]=t[e]})),E(e,(function(n){n(o)}))}}},Du=function(n){return{registry:jn(n,(function(n){return{bind:n.bind,unbind:n.unbind}})),trigger:jn(n,(function(n){return n.trigger}))}},Ou=function(n){return n.slice(0).sort()},Au=function(n,e,t){if(0===e.length)throw new Error("You must specify at least one required field.");var r;return function(n,e){if(!b(e))throw new Error("The "+n+" fields must be an array. Was: "+e+".");E(e,(function(e){if(!h(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")}))}("required",e),r=Ou(e),M(r,(function(n,e){return e<r.length-1&&n===r[e+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=kn(r);W(e,(function(n){return D(o,n)}))||function(n,e){throw new Error("All required keys ("+Ou(n).join(", ")+") were not specified. Specified keys were: "+Ou(e).join(", ")+".")}(e,o),n(e,o);var u=I(e,(function(n){return!t.validate(r[n],n)}));return 0<u.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+Ou(n).join(", ")+") were not.")}(u,t.label),r}},Bu=function(n,e){var t=I(e,(function(e){return!D(n,e)}));0<t.length&&function(n){throw new Error("Unsupported keys for object: "+Ou(n).join(", "))}(t)},Eu=function(n){return Au(Bu,n,{validate:C,label:"function"})},Iu=Eu(["compare","extract","mutate","sink"]),Pu=Eu(["element","start","stop","destroy"]),ku=Eu(["forceDrop","drop","move","delayDrop"]);function Mu(){var n=d.none(),e=Du({move:Ru(["info"])});return{onEvent:function(t,r){r.extract(t).each((function(t){var o,u,i;(o=r,u=t,i=n.map((function(n){return o.compare(n,u)})),n=d.some(u),i).each((function(n){e.trigger.move(n)}))}))},reset:function(){n=d.none()},events:e.registry}}function Nu(){var e={onEvent:n,reset:n},t=Mu(),r=e;return{on:function(){r.reset(),r=t},off:function(){r.reset(),r=e},isOn:function(){return r===t},onEvent:function(n,e){r.onEvent(n,e)},events:t.events}}var ju=function(n,e,t){var r,o,u,i=!1,c=Du({start:Ru([]),stop:Ru([])}),a=Nu(),l=function(){m.stop(),a.isOn()&&(a.off(),c.trigger.stop())},f=(r=l,o=200,u=null,{cancel:function(){null!==u&&(clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&clearTimeout(u),u=setTimeout((function(){r.apply(null,n),u=null}),o)}});a.events.move.bind((function(t){e.mutate(n,t.info)}));var s=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i&&n.apply(null,e)}},m=e.sink(ku({forceDrop:l,drop:s(l),move:s((function(n){f.cancel(),a.onEvent(n,e)})),delayDrop:s(f.throttle)}),t);return{element:m.element,go:function(n){m.start(n),a.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){m.destroy()},events:c.registry}},_u=function(n){var e,t,r=Dn.fromDom(ge(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(e=u,t=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))});return{target:r,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},Wu=function(n,e,t,o,u){var i,c,a=(i=t,c=o,function(n){i(n)&&c(_u(n))});return n.dom.addEventListener(e,a,u),{unbind:r(zu,n,e,a,u)}},zu=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},Fu=l,Lu=function(n,e,t){return Wu(n,e,Fu,t,!1)},Hu=_u,qu=function(n,e){var t=Me(n,e);return void 0===t||""===t?[]:t.split(" ")},Vu=function(n){return void 0!==n.dom.classList},Uu=function(n,e){return o=e,u=qu(t=n,r="class").concat([o]),Pe(t,r,u.join(" ")),!0;var t,r,o,u},$u=function(n,e){return o=e,0<(u=I(qu(t=n,r="class"),(function(n){return n!==o}))).length?Pe(t,r,u.join(" ")):je(t,r),!1;var t,r,o,u},Gu=function(n,e){Vu(n)?n.dom.classList.add(e):Uu(n,e)},Ku=function(n){0===(Vu(n)?n.dom.classList:qu(n,"class")).length&&je(n,"class")},Xu=function(n,e){return Vu(n)&&n.dom.classList.contains(e)},Yu=function(n){var e=n.replace(/\./g,"-");return{resolve:function(n){return e+"-"+n}}},Ju=Yu("ephox-dragster").resolve,Qu=Iu({compare:function(n,e){return Qr(e.left-n.left,e.top-n.top)},extract:function(n){return d.some(Qr(n.x,n.y))},sink:function(n,e){var t=function(n){var e=H({layerClass:Ju("blocker")},n),t=Dn.fromTag("div");return Pe(t,"role","presentation"),Le(t,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Gu(t,Ju("blocker")),Gu(t,e.layerClass),{element:function(){return t},destroy:function(){Et(t)}}}(e),r=Lu(t.element(),"mousedown",n.forceDrop),o=Lu(t.element(),"mouseup",n.drop),u=Lu(t.element(),"mousemove",n.move),i=Lu(t.element(),"mouseout",n.delayDrop);return Pu({element:t.element,start:function(n){Rt(n,t.element())},stop:function(){Et(t.element())},destroy:function(){t.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,e){n.mutate(e.left,e.top)}}),Zu=function(n){return"true"===Me(n,"contenteditable")},ni=Yu("ephox-snooker").resolve,ei=function(){var n,e=Du({drag:Ru(["xDelta","yDelta","target"])}),t=d.none(),r={mutate:function(e,t){n.trigger.drag(e,t)},events:(n=Du({drag:Ru(["xDelta","yDelta"])})).registry};return r.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))})),{assign:function(n){t=d.some(n)},get:function(){return t},mutate:r.mutate,events:e.registry}},ti=ni("resizer-bar"),ri=ni("resizer-rows"),oi=ni("resizer-cols"),ui=function(n){var e=Ce(n.parent(),"."+ti);E(e,Et)},ii=function(n,e,t){var r=n.origin();E(e,(function(e){e.each((function(e){var o=t(r,e);Gu(o,ti),Rt(n.parent(),o)}))}))},ci=function(n,e,t,r){ii(n,e,(function(n,e){var o,u,i,c,a,l,f=(o=e.col,u=e.x-n.left,i=t.top-n.top,c=7,a=r,l=Dn.fromTag("div"),Le(l,{position:"absolute",left:u-c/2+"px",top:i+"px",height:a+"px",width:c+"px"}),ke(l,{"data-column":o,role:"presentation"}),l);return Gu(f,oi),f}))},ai=function(n,e,t,r){ii(n,e,(function(n,e){var o,u,i,c,a,l,f=(o=e.row,u=t.left-n.left,i=e.y-n.top,c=r,a=7,l=Dn.fromTag("div"),Le(l,{position:"absolute",left:u+"px",top:i-a/2+"px",height:a+"px",width:c+"px"}),ke(l,{"data-row":o,role:"presentation"}),l);return Gu(f,ri),f}))},li=function(n,e){ui(n);var t=mt.fromTable(e);!function(n,e,t,r){var o=no(e),u=0<t.length?ho.positions(t,e):[];ai(n,u,o,oo(e));var i=0<r.length?bo.positions(r,e):[];ci(n,i,o,Yr(e))}(n,e,zr(t),_r(t))},fi=function(n,e){var t=Ce(n.parent(),"."+ti);E(t,e)},si=function(n){fi(n,(function(n){Fe(n,"display","none")}))},mi=function(n){fi(n,(function(n){Fe(n,"display","block")}))},di=ni("resizer-bar-dragging"),gi=function(n){var e=ei(),t=function(n,e){void 0===e&&(e={});var t=void 0!==e.mode?e.mode:Qu;return ju(n,t,e)}(e,{}),o=d.none(),u=function(n,e){return d.from(Me(n,e))};e.events.drag.bind((function(n){u(n.target,"data-row").each((function(e){var t=Ye(n.target,"top");Fe(n.target,"top",t+n.yDelta+"px")})),u(n.target,"data-column").each((function(e){var t=Ye(n.target,"left");Fe(n.target,"left",t+n.xDelta+"px")}))}));var i=function(n,e){return Ye(n,e)-$e(n,"data-initial-"+e,0)};t.events.stop.bind((function(){e.get().each((function(e){o.each((function(t){u(e,"data-row").each((function(n){var r=i(e,"top");je(e,"data-initial-top"),m.trigger.adjustHeight(t,r,parseInt(n,10))})),u(e,"data-column").each((function(n){var r=i(e,"left");je(e,"data-initial-left"),m.trigger.adjustWidth(t,r,parseInt(n,10))})),li(n,t)}))}))}));var c=function(r,o){m.trigger.startAdjust(),e.assign(r),Pe(r,"data-initial-"+o,Ye(r,o)),Gu(r,di),Fe(r,"opacity","0.2"),t.go(n.parent())},a=Lu(n.parent(),"mousedown",(function(n){var e,t;e=n.target,Xu(e,ri)&&c(n.target,"top"),t=n.target,Xu(t,oi)&&c(n.target,"left")})),l=function(e){return Bn(e,n.view())},f=function(n){return Ee(n,"table",l).filter((function(n){return Ee(n,"[contenteditable]",l).exists(Zu)}))},s=Lu(n.view(),"mouseover",(function(e){f(e.target).fold((function(){he(e.target)&&ui(n)}),(function(e){o=d.some(e),li(n,e)}))})),m=Du({adjustHeight:Ru(["table","delta","row"]),adjustWidth:Ru(["table","delta","column"]),startAdjust:Ru([])});return{destroy:function(){a.unbind(),s.unbind(),t.destroy(),ui(n)},refresh:function(e){li(n,e)},on:t.on,off:t.off,hideBars:r(si,n),showBars:r(mi,n),events:m.registry}},pi=function(n,e,t){var r=ho,o=bo,u=gi(n),i=Du({beforeResize:Ru(["table","type"]),afterResize:Ru(["table","type"]),startDrag:Ru([])});return u.events.adjustHeight.bind((function(n){var e=n.table;i.trigger.beforeResize(e,"row");var t=r.delta(n.delta,e);eu(e,t,n.row,r),i.trigger.afterResize(e,"row")})),u.events.startAdjust.bind((function(n){i.trigger.startDrag()})),u.events.adjustWidth.bind((function(n){var r=n.table;i.trigger.beforeResize(r,"col");var u=o.delta(n.delta,r),c=t(r);nu(r,u,n.column,e,c),i.trigger.afterResize(r,"col")})),{on:u.on,off:u.off,hideBars:u.hideBars,showBars:u.showBars,destroy:u.destroy,events:i.registry}},hi=function(n,e){return n.fire("newrow",{node:e})},vi=function(n,e){return n.fire("newcell",{node:e})},bi=function(n,e,t,r,o){n.fire("TableSelectionChange",{cells:e,start:t,finish:r,otherCells:o})},wi=function(n){n.fire("TableSelectionClear")},yi={"border-collapse":"collapse",width:"100%"},Ci={border:"1"},Si="preservetable",xi=function(n){return n.getParam("table_sizing_mode","auto")},Ti=function(n){return n.getParam("table_responsive_width")},Ri=function(n){return n.getParam("table_default_attributes",Ci,"object")},Di=function(n){return n.getParam("table_default_styles",function(n){if(ki(n)){var e=n.getBody().offsetWidth;return H(H({},yi),{width:e+"px"})}return Mi(n)?Wn(yi,(function(n,e){return"width"!==e})):yi}(n),"object")},Oi=function(n){return n.getParam("table_tab_navigation",!0,"boolean")},Ai=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},Bi=function(n){return n.getParam("table_row_advtab",!0,"boolean")},Ei=function(n){return n.getParam("table_advtab",!0,"boolean")},Ii=function(n){return n.getParam("table_style_by_css",!1,"boolean")},Pi=function(n){return"relative"===xi(n)||!0===Ti(n)},ki=function(n){return"fixed"===xi(n)||!1===Ti(n)},Mi=function(n){return"responsive"===xi(n)},Ni=function(n){var e="section",t=n.getParam("table_header_type",e,"string");return D(["section","cells","sectionCells","auto"],t)?t:e},ji=function(n){var e=n.getParam("table_column_resizing",Si,"string");return M(["preservetable","resizetable"],(function(n){return n===e})).getOr(Si)},_i=function(n){return"preservetable"===ji(n)},Wi=function(n){var e=n.getParam("table_clone_elements");return h(e)?d.some(e.split(/[ ,]/)):Array.isArray(e)?d.some(e):d.none()},zi=function(n){return n.nodeName.toLowerCase()},Fi=function(n){return Dn.fromDom(n.getBody())},Li=function(n){return n.getBoundingClientRect().width},Hi=function(n){return n.getBoundingClientRect().height},qi=function(n){return function(e){return Bn(e,Fi(n))}},Vi=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},Ui=function(n){je(n,"data-mce-style");var e=function(n){return je(n,"data-mce-style")};E(tt(n),e),E(rt(n),e)},$i=function(n,e){var t=n.dom.getStyle(e,"width")||n.dom.getAttrib(e,"width");return d.from(t).filter(on)},Gi=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},Ki=function(n){return Dn.fromDom(n.selection.getStart())},Xi=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},Yi=function(t){var r=function(){return ro(t)},o=e(0);return{width:r,pixelWidth:r,getWidths:Xo,getCellDelta:o,singleColumnWidth:e([0]),minCellWidth:o,setElementWidth:n,adjustTableWidth:n,isRelative:!0,label:"none"}},Ji=function(n,e){var t=Xi(parseFloat(n)),r=Xi(ro(e));return{width:t.get,pixelWidth:r.get,getWidths:Ko,getCellDelta:function(n){return n/r.get()*100},singleColumnWidth:function(n,e){return[100-n]},minCellWidth:function(){return Je()/r.get()*100},setElementWidth:Eo,adjustTableWidth:function(n){var o=t.get(),u=o+n/100*o;Eo(e,u),t.set(u),r.set(ro(e))},isRelative:!0,label:"percent"}},Qi=function(n,e){var r=Xi(n),o=r.get;return{width:o,pixelWidth:o,getWidths:Xo,getCellDelta:t,singleColumnWidth:function(n,e){return[Math.max(Je(),n+e)-n]},minCellWidth:Je,setElementWidth:Bo,adjustTableWidth:function(n){var t=o()+n;Bo(e,t),r.set(t)},isRelative:!1,label:"pixel"}},Zi=function(n){return Mo(n).fold((function(){return Yi(n)}),(function(e){return function(n,e){var t=Lo().exec(e);if(null!==t)return Ji(t[1],n);var r=Ho().exec(e);if(null!==r){var o=parseInt(r[1],10);return Qi(o,n)}var u=ro(n);return Qi(u,n)}(n,e)}))},nc=Qi,ec=Ji,tc=function(n,e){if(Pi(n)){var t=$i(n,e.dom).filter(Gi).getOrThunk((function(){return xu(e)}));return ec(t,e)}return ki(n)?nc(ro(e),e):Zi(e)},rc=function(n){je(n,"width")},oc=function(n,e){var t=ro(n)+"px";wu(n,d.some(t),d.none(),e),rc(n)},uc=function(n,e){var t,r,o,u=tc(n,e);r=u,o=Fo(t=e),wu(t,d.some(o),d.none(),r),rc(t)},ic=function(n,e){var t=tc(n,e);oc(e,t)},cc=function(n){Ue(n,"width");var e=rt(n),t=0<e.length?e:tt(n);E(t,(function(n){Ue(n,"width"),rc(n)})),rc(n)},ac=function(){var n=Dn.fromTag("div");return Le(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Rt(ve(Dn.fromDom(document)),n),n},lc=function(n){var t,r,o=d.none(),u=d.none(),i=d.none(),c=function(n){return"TABLE"===n.nodeName},a=function(){return u},l=function(e){return tc(n,e)},f=function(){return _i(n)?{resizeTable:function(n,e,t){t&&n(e)},clampTableDelta:function(n,e,t,r,o){if(o){if(0<=t)return t;var u=k(n,(function(n,e){return n+e-r}),0);return Math.max(-u,t)}return uu(n,e,t,r)},calcLeftEdgeDeltas:t=function(n,e,t,r,o){var u=iu(n,0<=r?t:e,r,o);return ru(n,e,t+1,[u,-u],tu)},calcMiddleDeltas:function(n,e,r,o,u,i){return t(n,r,o,u,i)},calcRightEdgeDeltas:function(n,t,r,o,u,i){if(i)return tu(n);var c=o/n.length;return B(n,e(c))}}:cu();var t},s=function(e,o,u){var i,c,a,s,m,d,g=tn(o,"e");u!==t&&""!==r?(Fe(e,"width",r),i=f(),c=l(e),a=_i(n)||g?Tu(e).columns-1:0,nu(e,u-t,a,i,c)):Gi(r)&&(s=parseFloat(r.replace("%","")),Fe(e,"width",u*s/t+"%")),/^(\d+(\.\d+)?)px$/.test(r)&&(m=e,d=mt.fromTable(m),mt.hasColumns(d)||E(tt(m),(function(n){var e=He(n,"width");Fe(n,"width",e),je(n,"width")})))};return n.on("init",(function(){var e,t,r,c,a=(e=n).inline?lu(Fi(e),ac()):au(Dn.fromDom(e.getDoc()));i=d.some(a),c=n.getParam("object_resizing",!0),(h(c)?"table"===c:c)&&n.getParam("table_resize_bars",!0,"boolean")&&(t=f(),(r=pi(a,t,l)).on(),r.events.startDrag.bind((function(e){o=d.some(n.selection.getRng())})),r.events.beforeResize.bind((function(e){var t,r,o,u,i,c=e.table.dom;t=n,o=Li(r=c),u=Hi(c),i="bar-"+e.type,t.fire("ObjectResizeStart",{target:r,width:o,height:u,origin:i})})),r.events.afterResize.bind((function(e){var t,r,u,i,c,a=e.table,l=a.dom;Ui(a),o.each((function(e){n.selection.setRng(e),n.focus()})),t=n,u=Li(r=l),i=Hi(l),c="bar-"+e.type,t.fire("ObjectResized",{target:r,width:u,height:i,origin:c}),n.undoManager.add()})),u=d.some(r))})),n.on("ObjectResizeStart",(function(e){var o,u=e.target;c(u)&&(o=Dn.fromDom(u),E(n.dom.select(".mce-clonedresizable"),(function(e){n.dom.addClass(e,"mce-"+ji(n)+"-columns")})),!Cu(o)&&ki(n)?ic(n,o):!yu(o)&&Pi(n)&&uc(n,o),t=e.width,r=Mi(n)?"":$i(n,u).getOr(""))})),n.on("ObjectResized",(function(e){var t,o,u=e.target;c(u)&&(t=Dn.fromDom(u),""===r&&uc(n,t),o=e.origin,en(o,"corner-")&&s(t,o,e.width),Ui(t))})),n.on("SwitchMode",(function(){u.each((function(e){n.mode.isReadOnly()?e.hideBars():e.showBars()}))})),{lazyResize:a,lazyWire:function(){return i.getOr(au(Dn.fromDom(n.getBody())))},destroy:function(){u.each((function(n){n.destroy()})),i.each((function(e){var t;t=e,n.inline&&Et(t.parent())}))}}},fc=function(n,e){return{element:n,offset:e}},sc=function(n,e,t){return n.property().isText(e)&&0===n.property().getText(e).trim().length||n.property().isComment(e)?t(e).bind((function(e){return sc(n,e,t).orThunk((function(){return d.some(e)}))})):d.none()},mc=function(n,e){return n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length},dc=function(n,e){var t=sc(n,e,n.query().prevSibling).getOr(e);if(n.property().isText(t))return fc(t,mc(n,t));var r=n.property().children(t);return 0<r.length?dc(n,r[r.length-1]):fc(t,mc(n,t))},gc=dc,pc=_t(),hc=function(n,e){Mo(n).bind((function(n){return Co(n,["fixed","relative","empty"])})).each((function(t){var r=t.value/2;zo(n,r,t.unit),zo(e,r,t.unit)}))},vc=function(n,e,t){n.cells[e]=t},bc=function(n,e){return $n(e,n.section)},wc=function(n,e){var t=n.cells,r=B(t,e);return $n(r,n.section)},yc=function(n,e){return n.cells[e]},Cc=function(n,e){return yc(n,e).element},Sc=function(n){return n.cells.length},xc=function(n){var e=function(n,e){for(var t=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(e(i,o)?t:r).push(i)}return{pass:t,fail:r}}(n,(function(n){return"colgroup"===n.section}));return{rows:e.fail,cols:e.pass}},Tc=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Rc=function(n,e,t,r){t===r?je(n,e):Pe(n,e,t)},Dc=function(n,e,t){F(ye(n,e)).fold((function(){return Tt(n,t)}),(function(n){return xt(n,t)}))},Oc=function(n,e){var t=[],r=[],o=function(n){return B(n,(function(n){n.isNew&&t.push(n.element);var e=n.element;return Bt(e),E(n.cells,(function(n){n.isNew&&r.push(n.element),Rc(n.element,"colspan",n.colspan,1),Rc(n.element,"rowspan",n.rowspan,1),Rt(e,n.element)})),e}))},u=function(n){return _(n,(function(n){return B(n.cells,(function(n){return Rc(n.element,"span",n.colspan,1),n.element}))}))},i=function(e,t){var r,i,c,a=(c=Ae(r=n,i=t).getOrThunk((function(){var n=Dn.fromTag(i,ee(r).dom);return"thead"===i?Dc(r,"caption,colgroup",n):"colgroup"===i?Dc(r,"caption",n):Rt(r,n),n})),Bt(c),c),l=("colgroup"===t?u:o)(e);At(a,l)},c=function(e,t){0<e.length?i(e,t):Ae(n,t).each(Et)},a=[],l=[],f=[],s=[];return E(e,(function(n){switch(n.section){case"thead":a.push(n);break;case"tbody":l.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}})),c(s,"colgroup"),c(a,"thead"),c(l,"tbody"),c(f,"tfoot"),{newRows:t,newCells:r}},Ac=function(n,e){if(0===n.length)return 0;var t=n[0];return N(n,(function(n){return!e(t.element,n.element)})).fold((function(){return n.length}),(function(n){return n}))},Bc=function(n,e,t,r){var o,u=n[e].cells.slice(t),i=Ac(u,r),c=(o=t,B(n,(function(n){return yc(n,o)})).slice(e));return{colspan:i,rowspan:Ac(c,r)}},Ec=function(n,e){var t=B(n,(function(n){return B(n.cells,a)}));return B(n,(function(r,o){return{details:_(r.cells,(function(r,u){if(!1!==t[o][u])return[];var i=Bc(n,o,u,e);return function(n,e,r,o){for(var u=n;u<n+r;u++)for(var i=e;i<e+o;i++)t[u][i]=!0}(o,u,i.rowspan,i.colspan),[{element:r.element,rowspan:i.rowspan,colspan:i.colspan,isNew:r.isNew}]})),section:r.section}}))},Ic=function(n,e,t){var r,o=[];mt.hasColumns(n)&&(r=B(mt.justColumns(n),(function(n){return Un(n.element,t)})),o.push($n(r,"colgroup")));for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var a=mt.getAt(n,u,c).map((function(n){return Un(n.element,t)})).getOrThunk((function(){return Un(e.gap(),!0)}));i.push(a)}var l=$n(i,n.all[u].section);o.push(l)}return o},Pc=function(n,e){return B(n,(function(n){var t,r=(t=n.details,L(t,(function(n){return re(n.element).map((function(n){var e=re(n).isNone();return Un(n,e)}))})).getOrThunk((function(){return Un(e.row(),!0)})));return{element:r.element,cells:n.details,section:n.section,isNew:r.isNew}}))},kc=function(n,e){var t=Ec(n,Bn);return Pc(t,e)},Mc=function(n,e){return L(n.all,(function(n){return M(n.cells,(function(n){return Bn(e,n.element)}))}))},Nc=function(n,e,t,r,o){return function(u,i,c,a,l){var f=mt.fromTable(i);return e(f,c).map((function(e){var t=Ic(f,a,!1),r=n(t,e,Bn,o(a));return{grid:kc(r.grid,a),cursor:r.cursor}})).fold((function(){return d.none()}),(function(n){var e=Oc(i,n.grid),o=d.from(l).getOrThunk((function(){return Zi(i)}));return t(i,n.grid,o),r(i),li(u,i),d.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})}))}},jc=function(n,e){return et(e.element).bind((function(e){return Mc(n,e)}))},_c=function(n,e){var t=B(e.selection,(function(e){return et(e).bind((function(e){return Mc(n,e)}))})),r=Tc(t);return 0<r.length?d.some({cells:r,generators:e.generators,clipboard:e.clipboard}):d.none()},Wc=function(n,e){var t=B(e.selection,(function(e){return et(e).bind((function(e){return Mc(n,e)}))})),r=Tc(t);return 0<r.length?d.some(r):d.none()},zc=function(n,e,t,r){for(var o=xc(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<Sc(o[0]);c++){var a=t(Cc(o[i],c),e);!0===a&&!1===u?vc(o[i],c,Un(r(),!0)):!0===a&&(u=!1)}return n},Fc=function(n,e,t,r){var o,u,i,c=xc(n).rows;return 0<e&&e<c.length&&(o=c[e-1].cells,i=t,u=k(o,(function(n,e){return O(n,(function(n){return i(n.element,e.element)}))?n:n.concat([e])}),[]),E(u,(function(n){for(var o=d.none(),u=e;u<c.length;u++)!function(e){for(var u=0;u<Sc(c[0]);u++)!function(u){var i=c[e].cells[u];t(i.element,n.element)&&(o.isNone()&&(o=d.some(r())),o.each((function(n){vc(c[e],u,Un(n,!0))})))}(u)}(u)}))),n},Lc=function(n){return{is:function(e){return n===e},isValue:l,isError:a,getOr:e(n),getOrThunk:e(n),getOrDie:e(n),or:function(e){return Lc(n)},orThunk:function(e){return Lc(n)},fold:function(e,t){return t(n)},map:function(e){return Lc(e(n))},mapError:function(e){return Lc(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return d.some(n)}}},Hc=function(e){return{is:a,isValue:a,isError:l,getOr:t,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(e),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,t){return n(e)},map:function(n){return Hc(e)},mapError:function(n){return Hc(n(e))},each:n,bind:function(n){return Hc(e)},exists:a,forall:l,toOptional:d.none}},qc={value:Lc,error:Hc,fromOption:function(n,e){return n.fold((function(){return Hc(e)}),Lc)}},Vc=function(n,e){return{rowDelta:0,colDelta:Sc(n[0])-Sc(e[0])}},Uc=function(n,e){return{rowDelta:n.length-e.length,colDelta:0}},$c=function(n,e,t){var r="colgroup"===e.section?t.col:t.cell;return B(n,(function(){return Un(r(),!0)}))},Gc=function(n,e,t){return n.concat(A(e,(function(){var e=n[n.length-1];return bc(e,$c(e.cells,e,t))})))},Kc=function(n,e,r){return B(n,(function(n){var o=$c(A(e,t),n,r);return bc(n,n.cells.concat(o))}))},Xc=function(n,e,r){var o=e.colDelta<0?Kc:t;return(e.rowDelta<0?Gc:t)(o(n,Math.abs(e.colDelta),r),Math.abs(e.rowDelta),r)},Yc=function(n,e,t,o,u){for(var i,c,a,l,f,s=n.row,m=n.column,d=s+t.length,g=m+Sc(t[0]),p=s;p<d;p++)for(var h=m;h<g;h++){a=h,l=void 0,l=r(u,yc((i=e)[c=p],a).element),f=i[c],1<i.length&&1<Sc(f)&&(0<a&&l(Cc(f,a-1))||a<f.cells.length-1&&l(Cc(f,a+1))||0<c&&l(Cc(i[c-1],a))||c<i.length-1&&l(Cc(i[c+1],a)))&&zc(e,Cc(e[p],h),u,o.cell);var v=Cc(t[p-s],h-m),b=o.replace(v);vc(e[p],h,Un(b,!0))}return e},Jc=function(n,e,t,r,o){return function(n,e,t){if(n.row>=e.length||n.column>Sc(e[0]))return qc.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=e.slice(n.row),o=r[0].cells.slice(n.column),u=Sc(t[0]),i=t.length;return qc.value({rowDelta:r.length-i,colDelta:o.length-u})}(n,e,t).map((function(u){var i=Xc(e,u,r);return Yc(n,i,t,r,o)}))},Qc=function(n,e,t,r,o){var u,i,c,a;u=e,i=n,c=o,a=r.cell,0<i&&i<u[0].cells.length&&E(u,(function(n){var e=n.cells[i-1],t=n.cells[i];c(t.element,e.element)&&vc(n,i,Un(a(),!0))}));var l=Uc(t,e),f=Xc(t,l,r),s=Uc(e,f),m=Xc(e,s,r);return B(m,(function(e,t){var r=e.cells.slice(0,n).concat(f[t].cells).concat(e.cells.slice(n,e.cells.length));return bc(e,r)}))},Zc=function(n,e,t,r,o){Fc(e,n,o,r.cell);var u=Vc(t,e),i=Xc(t,u,r),c=Vc(e,i),a=Xc(e,c,r),l=xc(a),f=l.cols,s=l.rows;return f.concat(s.slice(0,n)).concat(i).concat(s.slice(n,s.length))},na=function(n,e,t,r,o){var u=xc(n),i=u.rows,c=u.cols,a=i.slice(0,e),l=i.slice(e),f=wc(i[t],(function(n,t){return 0<e&&e<i.length&&r(Cc(i[e-1],t),Cc(i[e],t))?yc(i[e],t):Un(o(n.element,r),!0)}));return c.concat(a).concat([f]).concat(l)},ea=function(n,e,t,r,o){return B(n,(function(n){var u,i,c,a,l,f,s,m,d,g,p,h,v,b,w=0<e&&e<Sc(n)&&r(Cc(n,e-1),Cc(n,e)),y=(i=e,c=(u=n).section,a=w,l=t,f=r,s=o,"colgroup"!==c&&a?yc(u,i):Un(s(Cc(u,l),f),!0));return d=e,g=y,p=(m=n).cells,h=p.slice(0,d),v=p.slice(d),b=h.concat([g]).concat(v),bc(m,b)}))},ta=function(n,e,t,r){return B(n,(function(n){return wc(n,(function(n){return o=n,O(e,(function(n){return t(o.element,n.element)}))?Un(r(n.element,t),!0):n;var o}))}))},ra=function(n,e,t,r){return void 0!==Cc(n[e],t)&&0<e&&r(Cc(n[e-1],t),Cc(n[e],t))},oa=function(n,e,t){return 0<e&&t(Cc(n,e-1),Cc(n,e))},ua=function(n,e,t,r){var o=_(n,(function(r,o){return ra(n,o,e,t)||oa(r,e,t)?[]:[yc(r,e)]}));return ta(n,o,t,r)},ia=function(n,e,t,r){var o=xc(n).rows,u=o[e],i=_(u.cells,(function(n,r){return ra(o,e,r,t)||oa(u,r,t)?[]:[n]}));return ta(n,i,t,r)},ca=Eu(["cell","row","replace","gap","col","colgroup"]),aa=function(n){return{element:n,colspan:$e(n,"colspan",1),rowspan:$e(n,"rowspan",1)}},la=function(n,e){void 0===e&&(e=aa),ca(n);var t=Xi(d.none()),r=function(t){return function(e){switch(Gn(e.element)){case"col":return n.col(e);default:return n.cell(e)}}(e(t))},o=function(n){var e=r(n);return t.get().isNone()&&t.set(d.some(e)),u=d.some({item:n,replacement:e}),e},u=d.none();return{getOrInit:function(n,e){return u.fold((function(){return o(n)}),(function(t){return e(n,t.item)?t.replacement:o(n)}))},cursor:t.get}},fa=function(n,e){return function(t){var r=Xi(d.none());ca(t);var o=[],u=function(u){var i={scope:n},c=t.replace(u,e,i);return o.push({item:u,sub:c}),r.get().isNone()&&r.set(d.some(c)),c};return{replaceOrInit:function(n,e){return t=n,r=e,M(o,(function(n){return r(n.item,t)})).fold((function(){return u(n)}),(function(t){return e(n,t.item)?t.sub:u(n)}));var t,r},cursor:r.get}}},sa=function(n){ca(n);var e=Xi(d.none());return{combine:function(t){return e.get().isNone()&&e.set(d.some(t)),function(){var e=n.cell({element:t,colspan:1,rowspan:1});return Ue(e,"width"),Ue(t,"width"),e}},cursor:e.get}},ma=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],da=_t(),ga=function(n){return e=n,t=da.property().name(e),D(ma,t);var e,t},pa=function(n){return e=n,t=da.property().name(e),D(["ol","ul"],t);var e,t},ha=function(n){return e=n,D(["br","img","hr","input"],da.property().name(e));var e},va=function(n){var e,t=function(n){return"br"===Gn(n)},r=function(n){return sr(n).bind((function(e){var r=ie(e).map((function(n){return!!ga(n)||!!ha(n)&&"img"!==Gn(n)})).getOr(!1);return re(e).map((function(o){return!0===r||"li"===Gn(u=o)||De(u,pa).isSome()||t(e)||ga(o)&&!Bn(n,o)?[]:[Dn.fromTag("br")];var u}))})).getOr([])},o=0===(e=_(n,(function(n){var e=ce(n);return W(e,(function(n){return t(n)||Qn(n)&&0===kt(n).trim().length}))?[]:e.concat(r(n))}))).length?[Dn.fromTag("br")]:e;Bt(n[0]),At(n[0],o)},ba=function(n){0===tt(n).length&&Et(n)},wa=function(n,e){return{grid:n,cursor:e}},ya=function(n,e,t){var r=xc(n).rows;return Ca(r,e,t).orThunk((function(){return Ca(r,0,0)}))},Ca=function(n,e,t){return d.from(n[e]).bind((function(n){return d.from(n.cells[t]).bind((function(n){return d.from(n.element)}))}))},Sa=function(n,e,t){var r=xc(n).rows;return wa(n,Ca(r,e,t))},xa=function(n){return k(n,(function(n,e){return O(n,(function(n){return n.row===e.row}))?n:n.concat([e])}),[]).sort((function(n,e){return n.row-e.row}))},Ta=function(n){return k(n,(function(n,e){return O(n,(function(n){return n.column===e.column}))?n:n.concat([e])}),[]).sort((function(n,e){return n.column-e.column}))},Ra=function(n,e,t){var r,o,u=(r=n,o=t.section,it(r,(function(){return o}))),i=mt.generate(u);return Ic(i,e,!0)},Da=function(n,e){var t=I(n,e);return 0===t.length?d.some("td"):t.length===n.length?d.some("th"):d.none()},Oa=function(n,e,t){var r=mt.generate(e),o=t.getWidths(r,t);Zo(r,o,t)},Aa=Nc((function(n,e,t,r){var o=e[0].row,u=e[0].row,i=xa(e),c=k(i,(function(n,e){return na(n,u,o,t,r.getOrInit)}),n);return Sa(c,u,e[0].column)}),Wc,n,n,la),Ba=Nc((function(n,e,t,r){var o=xa(e),u=o[o.length-1].row,i=o[o.length-1].row+o[o.length-1].rowspan,c=k(o,(function(n,e){return na(n,i,u,t,r.getOrInit)}),n);return Sa(c,i,e[0].column)}),Wc,n,n,la),Ea=Nc((function(n,e,t,r){var o=Ta(e),u=o[0].column,i=o[0].column,c=k(o,(function(n,e){return ea(n,i,u,t,r.getOrInit)}),n);return Sa(c,e[0].row,i)}),Wc,Oa,n,la),Ia=Nc((function(n,e,t,r){var o=e[e.length-1].column,u=e[e.length-1].column+e[e.length-1].colspan,i=Ta(e),c=k(i,(function(n,e){return ea(n,u,o,t,r.getOrInit)}),n);return Sa(c,e[0].row,u)}),Wc,Oa,n,la),Pa=Nc((function(n,e,t,r){var o,u,i,c,a=Ta(e),l=(o=n,u=a[0].column,i=a[a.length-1].column,c=B(o,(function(n){var e=n.cells.slice(0,u).concat(n.cells.slice(i+1));return $n(e,n.section)})),I(c,(function(n){return 0<n.cells.length}))),f=ya(l,e[0].row,e[0].column);return wa(l,f)}),Wc,Oa,ba,la),ka=Nc((function(n,e,t,r){var o,u,i,c,a,l=xa(e),f=(o=n,u=l[0].row,i=l[l.length-1].row,c=xc(o),a=c.rows,c.cols.concat(a.slice(0,u)).concat(a.slice(i+1))),s=ya(f,e[0].row,e[0].column);return wa(f,s)}),Wc,n,ba,la),Ma=Nc((function(n,e,t,r){var o=ua(n,e.column,t,r.replaceOrInit);return Sa(o,e.row,e.column)}),jc,n,n,fa("row","th")),Na=Nc((function(n,e,t,r){var o=ua(n,e.column,t,r.replaceOrInit);return Sa(o,e.row,e.column)}),jc,n,n,fa(null,"td")),ja=(Nc((function(n,e,t,r){var o=ia(n,e.row,t,r.replaceOrInit);return Sa(o,e.row,e.column)}),jc,n,n,fa("col","th")),Nc((function(n,e,t,r){var o=ia(n,e.row,t,r.replaceOrInit);return Sa(o,e.row,e.column)}),jc,n,n,fa(null,"td")),Nc((function(n,t,r,o){var u=t.cells;va(u);var i=function(n,e,t){var r=xc(n).rows;if(0===r.length)return n;for(var o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)vc(r[o],u,Un(t(),!1));return n}(n,t.bounds,e(u[0]));return wa(i,d.from(u[0]))}),(function(n,e){return e.mergable}),n,n,sa)),_a=Nc((function(n,e,t,r){var o=P(e,(function(n,e){return zc(n,e,t,r.combine(e))}),n);return wa(o,d.from(e[0]))}),(function(n,e){return e.unmergable}),Oa,n,sa),Wa=Nc((function(n,e,t,r){var o,u,i,c=(o=e.clipboard,u=e.generators,i=mt.fromTable(o),Ic(i,u,!0)),a={row:e.row,column:e.column};return Jc(a,n,c,e.generators,t).fold((function(){return wa(n,d.some(e.element))}),(function(n){var t=ya(n,e.row,e.column);return wa(n,t)}))}),(function(n,e){return et(e.element).bind((function(t){return Mc(n,t).map((function(n){return H(H({},n),{generators:e.generators,clipboard:e.clipboard})}))}))}),Oa,n,la),za=Nc((function(n,e,t,r){var o=xc(n).rows,u=e.cells[0].column,i=o[e.cells[0].row],c=Ra(e.clipboard,e.generators,i),a=Qc(u,n,c,e.generators,t),l=ya(a,e.cells[0].row,e.cells[0].column);return wa(a,l)}),_c,n,n,la),Fa=Nc((function(n,e,t,r){var o=xc(n).rows,u=e.cells[e.cells.length-1].column+e.cells[e.cells.length-1].colspan,i=o[e.cells[0].row],c=Ra(e.clipboard,e.generators,i),a=Qc(u,n,c,e.generators,t),l=ya(a,e.cells[0].row,e.cells[0].column);return wa(a,l)}),_c,n,n,la),La=Nc((function(n,e,t,r){var o=xc(n).rows,u=e.cells[0].row,i=o[u],c=Ra(e.clipboard,e.generators,i),a=Zc(u,n,c,e.generators,t),l=ya(a,e.cells[0].row,e.cells[0].column);return wa(a,l)}),_c,n,n,la),Ha=Nc((function(n,e,t,r){var o=xc(n).rows,u=e.cells[e.cells.length-1].row+e.cells[e.cells.length-1].rowspan,i=o[e.cells[0].row],c=Ra(e.clipboard,e.generators,i),a=Zc(u,n,c,e.generators,t),l=ya(a,e.cells[0].row,e.cells[0].column);return wa(a,l)}),_c,n,n,la),qa=function(n,e){var t=mt.fromTable(n);return Wc(t,e).bind((function(n){var e=n[n.length-1],r=n[0].column,o=e.column+e.colspan,u=j(B(t.all,(function(n){return I(n.cells,(function(n){return n.column>=r&&n.column<o}))})));return Da(u,(function(n){return"th"===Gn(n.element)}))})).getOr("")},Va=function(n){return zi(n.parentNode)},Ua=function(n,e){var t="thead"===Va(e),r=!O(e.cells,(function(n){return"th"!==zi(n)}));return t||r?d.some({thead:t,ths:r}):d.none()},$a=function(n,e){return"thead"===(t=Ua(0,e).fold((function(){return Va(e)}),(function(n){return"thead"})))?"header":"tfoot"===t?"footer":"body";var t},Ga=function(n,e,t){var r,o,u=n.getParent(e,"table"),i=e.parentNode,c=zi(i);t!==c&&((r=n.select(t,u)[0])||(r=n.create(t),o=u.firstChild,"thead"===t?F(ye(Dn.fromDom(u),"caption,colgroup")).fold((function(){return u.insertBefore(r,o)}),(function(e){return n.insertAfter(r,e.dom)})):u.appendChild(r)),"tbody"===t&&"thead"===c&&r.firstChild?r.insertBefore(e,r.firstChild):r.appendChild(e),i.hasChildNodes()||n.remove(i))},Ka=function(n,e,t,r){return E(e,(function(e){var o=zi(e)!==t?n.rename(e,t):e;n.setAttrib(o,"scope",r)}))},Xa=function(n,e,t){var r,o,u,i=n.dom;"header"===t?(o="auto"===(r=Ni(n))?(u=ot(Dn.fromDom(e.cells[0])).map(ut).getOr([]),L(u,(function(n){return Ua(0,n.dom)})).map((function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"})).getOr("section")):r,Ka(i,e.cells,"section"===o?"td":"th","col"),Ga(i,e,"cells"===o?"tbody":"thead")):(Ka(i,e.cells,"td",null),Ga(i,e,"footer"===t?"tfoot":"tbody"))},Ya=function(n){return function(e){var t,r=Gn(e),o="col"===r||"colgroup"===r?ot(t=e).bind((function(n){return Xt(n,Er.firstSelectedSelector)})).fold((function(){return t}),(function(n){return n[0]})):e;return Ee(o,n)}},Ja=Ya("th,td"),Qa=Ya("th,td,caption"),Za=function(n,e){return Ja(n).map((function(n){return Dr(e)})).getOr([])},nl=function(n,e){var t,r,o,u=Ja(n),i=u.bind((function(n){return ot(n)})).map(ut);return r=i,o=function(n,t){return I(t,(function(t){return O(Rr(t.dom.cells),(function(t){return"1"===Me(t,e)||Bn(t,n)}))}))},((t=u).isSome()&&r.isSome()?d.some(o(t.getOrDie(),r.getOrDie())):d.none()).getOr([])},el=function(e,t,r){var o=function(n){return"table"===Gn(Fi(n))},u=Wi(e),i=function(n,t,r,o){return function(i,c){Ui(i);var a=o(),l=Dn.fromDom(e.getDoc()),f=xr(r,l,u),s=tc(e,i);return t(i)?n(a,i,c,f,s).bind((function(n){return E(n.newRows,(function(n){hi(e,n.dom)})),E(n.newCells,(function(n){vi(e,n.dom)})),n.cursor.map((function(n){var t=gc(pc,n),r=e.dom.createRng();return r.setStart(t.element.dom,t.offset),r.setEnd(t.element.dom,t.offset),r}))})):d.none()}},c=i(ka,(function(n){return!1===o(e)||1<Tu(n).rows}),n,t),a=i(Pa,(function(n){return!1===o(e)||1<Tu(n).columns}),n,t),f=i(Aa,l,n,t),s=i(Ba,l,n,t),m=i(Ea,l,hc,t),g=i(Ia,l,hc,t),p=i(ja,l,n,t),h=i(_a,l,n,t),v=i(za,l,n,t),b=i(Fa,l,n,t),w=i(La,l,n,t),y=i(Ha,l,n,t),C=i(Wa,l,n,t),S=function(n,e){return Fn(n,"type").filter((function(n){return D(e,n)}))};return{deleteRow:c,deleteColumn:a,insertRowsBefore:f,insertRowsAfter:s,insertColumnsBefore:m,insertColumnsAfter:g,mergeCells:p,unmergeCells:h,pasteColsBefore:v,pasteColsAfter:b,pasteRowsBefore:w,pasteRowsAfter:y,pasteCells:C,setTableCellType:function(n,e){return S(e,["td","th"]).each((function(e){var t=B(Za(Ki(n),r),(function(n){return n.dom}));Ka(n.dom,t,e,null)}))},setTableRowType:function(n,e){return S(e,["header","body","footer"]).each((function(e){B(nl(Ki(n),Er.selected),(function(t){return Xa(n,t.dom,e)}))}))},makeColumnHeader:i(Ma,l,n,t),unmakeColumnHeader:i(Na,l,n,t),getTableRowType:function(n){var e=nl(Ki(n),Er.selected);if(0<e.length){var t=B(e,(function(n){return $a(0,n.dom)})),r=D(t,"header"),o=D(t,"footer");if(r||o){var u=D(t,"body");return!r||u||o?r||u||!o?"":"footer":"header"}return"body"}},getTableCellType:function(n){return Da(Za(Ki(n),r),(function(n){return"th"===Gn(n)})).getOr("")},getTableColType:qa}},tl={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},rl=function(n,e,t,r){for(var o=Dn.fromTag("tr"),u=0;u<n;u++){var i=r<e||u<t?Dn.fromTag("th"):Dn.fromTag("td");u<t&&Pe(i,"scope","row"),r<e&&Pe(i,"scope","col"),Rt(i,Dn.fromTag("br")),Rt(o,i)}return o},ol=function(n){var e=Dn.fromTag("colgroup");return A(n,(function(){return Rt(e,Dn.fromTag("col"))})),e},ul=function(n,e,t,r){return A(n,(function(n){return rl(e,t,r,n)}))},il=function(n,e){n.selection.select(e.dom,!0),n.selection.collapse(!0)},cl=function(n,e,t,o,u){var i=Di(n),c={styles:i,attributes:Ri(n),colGroups:n.getParam("table_use_colgroups",!1,"boolean")},a=function(n,e,t,r,o,u){void 0===u&&(u=tl);var i=Dn.fromTag("table"),c="cells"!==o;Le(i,u.styles),ke(i,u.attributes),u.colGroups&&Rt(i,ol(e));var a,l,f=Math.min(n,t);c&&0<t&&(a=Dn.fromTag("thead"),Rt(i,a),l=ul(t,e,"sectionCells"===o?f:0,r),At(a,l));var s=Dn.fromTag("tbody");Rt(i,s);var m=ul(c?n-f:n,e,c?0:t,r);return At(s,m),i}(t,e,u,o,Ni(n),c);Pe(a,"data-mce-id","__mce");var l,f,s,m=(l=a,f=Dn.fromTag("div"),s=Dn.fromDom(l.dom.cloneNode(!0)),Rt(f,s),f.dom.innerHTML);return n.insertContent(m),Be(Fi(n),'table[data-mce-id="__mce"]').map((function(e){var t,o,u;return ki(n)?ic(n,e):Mi(n)?cc(e):(Pi(n)||(t=i.width,h(t)&&-1!==t.indexOf("%")))&&uc(n,e),Ui(e),je(e,"data-mce-id"),o=n,E(Ce(e,"tr"),(function(n){hi(o,n.dom),E(Ce(n,"th,td"),(function(n){vi(o,n.dom)}))})),u=n,Be(e,"td,th").each(r(il,u)),e.dom})).getOr(null)},al=function(n,e,t,r,o){void 0===r&&(r={});var u=function(n){return S(n)&&0<n};if(u(e)&&u(t)){var i=r.headerRows||0,c=r.headerColumns||0;return cl(n,t,e,c,i)}return console.error(o),null},ll=function(n){return function(){return n().fold((function(){return[]}),(function(n){return B(n,(function(n){return n.dom}))}))}},fl=function(n){return function(e){var t=0<e.length?d.some(Rr(e)):d.none();n(t)}},sl=function(n,e,t,r){return{insertTable:function(e,t,r){return void 0===r&&(r={}),al(n,t,e,r,"Invalid values for insertTable - rows and columns values are required to insert a table.")},setClipboardRows:fl(e.setRows),getClipboardRows:ll(e.getRows),setClipboardCols:fl(e.setColumns),getClipboardCols:ll(e.getColumns),resizeHandler:t,selectionTargets:r}},ml=function(n,e,t){var r=$e(n,e,1);1===t||r<=1?je(n,e):Pe(n,e,Math.min(t,r))},dl=function(n,e){var t=mt.fromTable(n);return Wc(t,e).map((function(n){var e,r,o=n[n.length-1],u=n[0].column,i=o.column+o.colspan;return q(function(n,e,t){if(mt.hasColumns(n)){var r=I(mt.justColumns(n),(function(n){return n.column>=e&&n.column<t})),o=B(r,(function(n){var r=pr(n.element);return ml(r,"span",t-e),r})),u=Dn.fromTag("colgroup");return At(u,o),[u]}return[]}(t,u,i),(e=u,r=i,B(t.all,(function(n){var t=I(n.cells,(function(n){return n.column>=e&&n.column<r})),o=B(t,(function(n){var t=pr(n.element);return ml(t,"colspan",r-e),t})),u=Dn.fromTag("tr");return At(u,o),u}))))}))},gl=function(n,e,t){var r=mt.fromTable(n);return Wc(r,e).map((function(n){var e=Ic(r,t,!1),o=xc(e).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),u=kc(o,t);return B(u,(function(n){var e=gr(n.element);return E(n.cells,(function(n){var t=pr(n.element);Rc(t,"colspan",n.colspan,1),Rc(t,"rowspan",n.rowspan,1),Rt(e,t)})),e}))}))},pl=tinymce.util.Tools.resolve("tinymce.util.Tools"),hl=function(n,e,t){return function(e,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],t);if(void 0===e&&(e=u),e!==u)return""}return e}(void 0,n.select("td,th",e))},vl=function(n,e,t){t&&n.formatter.apply("align"+t,{},e)},bl=function(n,e){pl.each("left center right".split(" "),(function(t){n.formatter.remove("align"+t,{},e)}))},wl=function(n){return Ln(e=n,t="menu")&&void 0!==e[t]&&null!==e[t];var e,t},yl=function(n,e){return(e||[]).concat(B(n,(function(n){var e=n.text||n.title;return wl(n)?{text:e,items:yl(n.menu)}:{text:e,value:n.value}})))},Cl=function(n){return function(e){return en(e,"rgb")?n.toHex(e):e}},Sl=function(n,e){var t=Dn.fromDom(e);return{borderwidth:Ve(t,"border-width").getOr(""),borderstyle:Ve(t,"border-style").getOr(""),bordercolor:Ve(t,"border-color").map(Cl(n)).getOr(""),backgroundcolor:Ve(t,"background-color").map(Cl(n)).getOr("")}},xl=function(n){var e=n[0],t=n.slice(1);return E(t,(function(n){E(kn(e),(function(t){Nn(n,(function(n,r){var o=e[t];""!==o&&t===r&&o!==n&&(e[t]="")}))}))})),e},Tl=function(n){var e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},Rl=function(n,e,t,r){return M(n,(function(n){return t.formatter.matchNode(r,e+n)})).getOr("")},Dl=r(Rl,["left","center","right"],"align"),Ol=r(Rl,["top","middle","bottom"],"valign"),Al=function(n,e){var t,r,o,u,i=Di(n),c=Ri(n),a=e?(t=n.dom,{borderstyle:Fn(i,"border-style").getOr(""),bordercolor:Cl(t)(Fn(i,"border-color").getOr("")),backgroundcolor:Cl(t)(Fn(i,"background-color").getOr(""))}):{};return H(H(H(H(H(H({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),i),c),a),(u=i["border-width"],Ii(n)&&u?{border:u}:Fn(c,"border").fold((function(){return{}}),(function(n){return{border:n}})))),(r=Fn(i,"border-spacing").or(Fn(c,"cellspacing")).fold((function(){return{}}),(function(n){return{cellspacing:n}})),o=Fn(i,"border-padding").or(Fn(c,"cellpadding")).fold((function(){return{}}),(function(n){return{cellpadding:n}})),H(H({},r),o)))},Bl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],El=function(n){return Bl.concat((0<(e=yl(n.getParam("table_cell_class_list",[],"array"))).length?d.some({name:"class",type:"listbox",label:"Class",items:e}):d.none()).toArray());var e},Il=function(n){return function(e,t){var r=e.dom;return{setAttrib:function(e,o){n&&!o||r.setAttrib(t,e,o)},setStyle:function(e,o){n&&!o||r.setStyle(t,e,o)},setFormat:function(r,o){n&&!o||(""===o?e.formatter.remove(r,{value:null},t,!0):e.formatter.apply(r,{value:o},t))}}}},Pl={normal:Il(!1),ifTruthy:Il(!0)},kl=function(n){return ot(n[0]).map((function(e){var t=mt.fromTable(e),r=mt.justCells(t),o=I(r,(function(e){return O(n,(function(n){return Bn(e.element,n)}))}));return B(o,(function(n){return{element:n.element.dom,column:mt.getColumnAt(t,n.column).map((function(n){return n.element.dom}))}}))}))},Ml=function(n,e,t){var r=n.dom,o=1===e.length;1<=e.length&&kl(e).each((function(e){return E(e,(function(e){var u,i,c,a,l,f,s,m,d,g,p=e.element,h=t.celltype&&zi(p)!==t.celltype?r.rename(p,t.celltype):p,v=o?Pl.normal(n,h):Pl.ifTruthy(n,h),b=e.column.map((function(e){return o?Pl.normal(n,e):Pl.ifTruthy(n,e)})).getOr(v);i=b,c=t,(u=v).setAttrib("scope",c.scope),u.setAttrib("class",c["class"]),u.setStyle("height",Vi(c.height)),i.setStyle("width",Vi(c.width)),Ai(n)&&(l=t,(a=v).setFormat("tablecellbackgroundcolor",l.backgroundcolor),a.setFormat("tablecellbordercolor",l.bordercolor),a.setFormat("tablecellborderstyle",l.borderstyle),a.setFormat("tablecellborderwidth",Vi(l.borderwidth))),o&&(bl(n,h),f=n,s=h,pl.each("top middle bottom".split(" "),(function(n){f.formatter.remove("valign"+n,{},s)}))),t.halign&&vl(n,h,t.halign),t.valign&&(m=n,d=h,(g=t.valign)&&m.formatter.apply("valign"+g,{},d))}))}))},Nl=function(n,e,t){var r=t.getData();t.close(),n.undoManager.transact((function(){Ml(n,e,r),n.focus()}))},jl=function(n,e){var t=kl(e).map((function(e){return B(e,(function(e){return t=n,r=e.element,o=Ai(n),u=e.column,i=t.dom,c=u.getOr(r),H({width:(a=function(n,e){return i.getStyle(n,e)||i.getAttrib(n,e)})(c,"width"),height:a(r,"height"),scope:i.getAttrib(r,"scope"),celltype:zi(r),class:i.getAttrib(r,"class",""),halign:Dl(t,r),valign:Ol(t,r)},o?Sl(i,r):{});var t,r,o,u,i,c,a}))}));return xl(t.getOrDie())},_l=function(n,e){var t,o,u,i=Za(Ki(n),e);0!==i.length&&(t=jl(n,i),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:El(n)},Tl("cell")]},u={type:"panel",items:[{type:"grid",columns:2,items:El(n)}]},n.windowManager.open({title:"Cell Properties",size:"normal",body:Ai(n)?o:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:r(Nl,n,i)}))},Wl=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],zl=function(n){return Wl.concat((0<(e=yl(n.getParam("table_row_class_list",[],"array"))).length?d.some({name:"class",type:"listbox",label:"Class",items:e}):d.none()).toArray());var e},Fl=function(n,e,t,r){var o=1===e.length;E(e,(function(e){r.type!==zi(e.parentNode)&&Xa(n,e,r.type);var u,i,c,a,l=o?Pl.normal(n,e):Pl.ifTruthy(n,e);i=r,(u=l).setAttrib("scope",i.scope),u.setAttrib("class",i["class"]),u.setStyle("height",Vi(i.height)),Bi(n)&&(a=r,(c=l).setStyle("background-color",a.backgroundcolor),c.setStyle("border-color",a.bordercolor),c.setStyle("border-style",a.borderstyle)),r.align!==t.align&&(bl(n,e),vl(n,e,r.align))}))},Ll=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact((function(){Fl(n,e,t,o),n.focus()}))},Hl=function(n){var e,t,o,u,i=nl(Ki(n),Er.selected);0!==i.length&&(e=B(i,(function(e){return t=n,r=e.dom,o=Bi(n),u=t.dom,H({height:u.getStyle(r,"height")||u.getAttrib(r,"height"),scope:u.getAttrib(r,"scope"),class:u.getAttrib(r,"class",""),type:$a(0,r),align:Dl(t,r)},o?Sl(u,r):{});var t,r,o,u})),t=xl(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:zl(n)},Tl("row")]},u={type:"panel",items:[{type:"grid",columns:2,items:zl(n)}]},n.windowManager.open({title:"Row Properties",size:"normal",body:Bi(n)?o:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:r(Ll,n,B(i,(function(n){return n.dom})),t)}))},ql=tinymce.util.Tools.resolve("tinymce.Env"),Vl=function(n,e,t,r){if("TD"===e.tagName||"TH"===e.tagName)h(t)?n.setStyle(e,t,r):n.setStyle(e,t);else if(e.children)for(var o=0;o<e.children.length;o++)Vl(n,e.children[o],t,r)},Ul=function(n,e,t){var r,o=n.dom,u=t.getData();t.close(),""===u["class"]&&delete u["class"],n.undoManager.transact((function(){var t,i;e||(t=parseInt(u.cols,10)||1,i=parseInt(u.rows,10)||1,e=cl(n,t,i,0,0)),function(n,e,t){var r,o=n.dom,u={},i={};if(u["class"]=t["class"],i.height=Vi(t.height),o.getAttrib(e,"width")&&!Ii(n)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=Vi(t.width),Ii(n)?(i["border-width"]=Vi(t.border),i["border-spacing"]=Vi(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),Ii(n)&&e.children)for(var c=0;c<e.children.length;c++)Vl(o,e.children[c],{"border-width":Vi(t.border),padding:Vi(t.cellpadding)}),Ei(n)&&Vl(o,e.children[c],{"border-color":t.bordercolor});Ei(n)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(H(H({},Di(n)),i)),o.setAttribs(e,H(H({},Ri(n)),u))}(n,e,u),(r=o.select("caption",e)[0])&&!u.caption&&o.remove(r),!r&&u.caption&&((r=o.create("caption")).innerHTML=ql.ie?"\xa0":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),""===u.align?bl(n,e):vl(n,e,u.align),n.focus(),n.addVisual()}))},$l=function(n,e){var t,o,u,i,c,a,l,f,s=n.dom,m=Al(n,Ei(n));!1===e?(t=s.getParent(n.selection.getStart(),"table"))?(u=t,i=Ei(o=n),f=o.dom,m=H({width:f.getStyle(u,"width")||f.getAttrib(u,"width"),height:f.getStyle(u,"height")||f.getAttrib(u,"height"),cellspacing:f.getStyle(u,"border-spacing")||f.getAttrib(u,"cellspacing"),cellpadding:f.getAttrib(u,"cellpadding")||hl(o.dom,u,"padding"),border:(c=f,a=u,l=Ve(Dn.fromDom(a),"border-width"),Ii(o)&&l.isSome()?l.getOr(""):c.getAttrib(a,"border")||hl(o.dom,a,"border-width")||hl(o.dom,a,"border")),caption:!!f.select("caption",u)[0],class:f.getAttrib(u,"class",""),align:Dl(o,u)},i?Sl(f,u):{})):Ei(n)&&(m.borderstyle="",m.bordercolor="",m.backgroundcolor=""):(m.cols="1",m.rows="1",Ei(n)&&(m.borderstyle="",m.bordercolor="",m.backgroundcolor=""));var d=yl(n.getParam("table_class_list",[],"array"));0<d.length&&m["class"]&&(m["class"]=m["class"].replace(/\s*mce\-item\-table\s*/g,""));var g,p,h,v,b={type:"grid",columns:2,items:(g=d,p=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],h=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<g.length?[{type:"listbox",name:"class",label:"Class",items:g}]:[],p.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(h).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},w=Ei(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[b]},Tl("table")]}:{type:"panel",items:[b]};n.windowManager.open({title:"Table Properties",size:"normal",body:w,onSubmit:r(Ul,n,t),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:m})},Gl=function(n){return Qa(Ki(n))},Kl=function(n){return Ja(Ki(n))},Xl=function(e,t,o,u,i){var a=qi(e),l=function(n){return ot(n,a)},f=function(n){return Kl(e).each((function(t){l(t).each((function(r){var i=Pr(u,r,t);n(r,i).each((function(n){e.selection.setRng(n),e.focus(),o.clear(r),Ui(r)}))}))}))},s=function(){return Kl(e).map((function(t){return l(t).bind((function(r){var o=Pr(u,r,t),i=xr(n,Dn.fromDom(e.getDoc()),d.none());return gl(r,o,i)}))}))},m=function(){return Kl(e).map((function(n){return l(n).bind((function(e){var t=Pr(u,e,n);return dl(e,t)}))}))},g=function(n,t){return t().each((function(t){var r=B(t,pr);Kl(e).each((function(t){return l(t).each((function(t){var i,c,a=Tr(Dn.fromDom(e.getDoc())),l=(i=r,c=a,{selection:Dr(u),clipboard:i,generators:c});n(t,l).each((function(n){e.selection.setRng(n),e.focus(),o.clear(t)}))}))}))}))};Nn({mceTableSplitCells:function(){return f(t.unmergeCells)},mceTableMergeCells:function(){return f(t.mergeCells)},mceTableInsertRowBefore:function(){return f(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return f(t.insertRowsAfter)},mceTableInsertColBefore:function(){return f(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return f(t.insertColumnsAfter)},mceTableDeleteCol:function(){return f(t.deleteColumn)},mceTableDeleteRow:function(){return f(t.deleteRow)},mceTableCutCol:function(n){return m().each((function(n){i.setColumns(n),f(t.deleteColumn)}))},mceTableCutRow:function(n){return s().each((function(n){i.setRows(n),f(t.deleteRow)}))},mceTableCopyCol:function(n){return m().each((function(n){return i.setColumns(n)}))},mceTableCopyRow:function(n){return s().each((function(n){return i.setRows(n)}))},mceTablePasteColBefore:function(n){return g(t.pasteColsBefore,i.getColumns)},mceTablePasteColAfter:function(n){return g(t.pasteColsAfter,i.getColumns)},mceTablePasteRowBefore:function(n){return g(t.pasteRowsBefore,i.getRows)},mceTablePasteRowAfter:function(n){return g(t.pasteRowsAfter,i.getRows)},mceTableDelete:function(){return Gl(e).each((function(n){ot(n,a).filter(c(a)).each((function(n){var t,r=Dn.fromText("");xt(n,r),Et(n),e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):((t=e.dom.createRng()).setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged())}))}))},mceTableSizingMode:function(n,t){return r=t,Gl(e).each((function(n){Mi(e)||ki(e)||Pi(e)||ot(n,a).each((function(n){"relative"!==r||yu(n)?"fixed"!==r||Cu(n)?"responsive"!==r||Su(n)||cc(n):ic(e,n):uc(e,n),Ui(n)}))}));var r}},(function(n,t){return e.addCommand(t,n)})),Nn({mceTableCellType:function(n,r){return t.setTableCellType(e,r)},mceTableRowType:function(n,r){return t.setTableRowType(e,r)}},(function(n,t){return e.addCommand(t,n)})),e.addCommand("mceTableColType",(function(n,e){return Fn(e,"type").each((function(n){return f("th"===n?t.makeColumnHeader:t.unmakeColumnHeader)}))})),Nn({mceTableProps:r($l,e,!1),mceTableRowProps:r(Hl,e),mceTableCellProps:r(_l,e,u)},(function(n,t){return e.addCommand(t,(function(){return n()}))})),e.addCommand("mceInsertTable",(function(n,t){v(t)&&0<kn(t).length?al(e,t.rows,t.columns,t.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):$l(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(n,t){var r;!v(t)||0!==(r=Za(Ki(e),u)).length&&Nn(t,(function(n,t){var o="tablecell"+t.toLowerCase().replace("-","");e.formatter.has(o)&&h(n)&&E(r,(function(t){Pl.normal(e,t.dom).setFormat(o,n)}))}))}))},Yl=function(n,e,t){var r=qi(n);Nn({mceTableRowType:function(){return e.getTableRowType(n)},mceTableCellType:function(){return e.getTableCellType(n)},mceTableColType:function(){return Ja(Ki(n)).bind((function(n){return ot(n,r).map((function(r){var o=Pr(t,r,n);return e.getTableColType(r,o)}))})).getOr("")}},(function(e,t){return n.addQueryValueHandler(t,e)}))},Jl=function(){var n=Xi(d.none()),e=Xi(d.none()),t=function(n){n.set(d.none())};return{getRows:n.get,setRows:function(r){n.set(r),t(e)},clearRows:function(){return t(n)},getColumns:e.get,setColumns:function(r){e.set(r),t(n)},clearColumns:function(){return t(e)}}},Ql={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},Zl=function(n){n.formatter.register(Ql)},nf=Jt([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),ef=H(H({},nf),{none:function(n){return void 0===n&&(n=void 0),nf.none(n)}}),tf=function(n,e){return ot(n,e).bind((function(e){var t=tt(e);return N(t,(function(e){return Bn(n,e)})).map((function(n){return{index:n,all:t}}))}))},rf=function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}},of=Jt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),uf={before:of.before,on:of.on,after:of.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(t,t,t)}},cf=Jt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),af={domRange:cf.domRange,relative:cf.relative,exact:cf.exact,exactFromRange:function(n){return cf.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e,t=n.match({domRange:function(n){return Dn.fromDom(n.startContainer)},relative:function(n,e){return uf.getStart(n)},exact:function(n,e,t,r){return n}});return e=t,Dn.fromDom(te(e).dom.defaultView)},range:rf},lf=function(n,e){return n.selectNodeContents(e.dom)},ff=function(n,e,t){var r,o,u=n.document.createRange();return r=u,e.fold((function(n){r.setStartBefore(n.dom)}),(function(n,e){r.setStart(n.dom,e)}),(function(n){r.setStartAfter(n.dom)})),o=u,t.fold((function(n){o.setEndBefore(n.dom)}),(function(n,e){o.setEnd(n.dom,e)}),(function(n){o.setEndAfter(n.dom)})),u},sf=function(n,e,t,r,o){var u=n.document.createRange();return u.setStart(e.dom,t),u.setEnd(r.dom,o),u},mf=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},df=Jt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),gf=function(n,e,t){return e(Dn.fromDom(t.startContainer),t.startOffset,Dn.fromDom(t.endContainer),t.endOffset)},pf=function(n,t){var r,o,u,i=(r=n,t.match({domRange:function(n){return{ltr:e(n),rtl:d.none}},relative:function(n,e){return{ltr:U((function(){return ff(r,n,e)})),rtl:U((function(){return d.some(ff(r,e,n))}))}},exact:function(n,e,t,o){return{ltr:U((function(){return sf(r,n,e,t,o)})),rtl:U((function(){return d.some(sf(r,t,o,n,e))}))}}}));return(u=(o=i).ltr()).collapsed?o.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return df.rtl(Dn.fromDom(n.endContainer),n.endOffset,Dn.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return gf(0,df.ltr,u)})):gf(0,df.ltr,u)},hf=function(n,e){return pf(n,e).match({ltr:function(e,t,r,o){var u=n.document.createRange();return u.setStart(e.dom,t),u.setEnd(r.dom,o),u},rtl:function(e,t,r,o){var u=n.document.createRange();return u.setStart(r.dom,o),u.setEnd(e.dom,t),u}})},vf=(df.ltr,df.rtl,function(n,e,t){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}),bf=function(n,e,t,r,o){var u=function(t){var r=n.dom.createRange();return r.setStart(e.dom,t),r.collapse(!0),r},i=kt(e).length,c=function(n,e,t,r,o){if(0===o)return 0;if(e===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(e-c.left);if(t<=c.bottom){if(t<c.top||u<a)return i-1;u=a}}return 0}((function(n){return u(n).getBoundingClientRect()}),t,r,o.right,i);return u(c)},wf=function(n,e,t,r){return Qn(e)?function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getClientRects();return L(u,(function(n){return vf(n,t,r)?d.some(n):d.none()})).map((function(o){return bf(n,e,t,r,o)}))}(n,e,t,r):(u=e,i=t,c=r,a=(o=n).dom.createRange(),l=ce(u),L(l,(function(n){return a.selectNode(n.dom),vf(a.getBoundingClientRect(),i,c)?wf(o,n,i,c):d.none()})));var o,u,i,c,a,l},yf=function(n,e){return e-n.left<n.right-e},Cf=function(n,e,t){var r=n.dom.createRange();return r.selectNode(e.dom),r.collapse(t),r},Sf=function(n,e,t){var r=n.dom.createRange();r.selectNode(e.dom);var o=r.getBoundingClientRect(),u=yf(o,t);return(!0===u?fr:sr)(e).map((function(e){return Cf(n,e,u)}))},xf=function(n,e,t){var r=e.dom.getBoundingClientRect(),o=yf(r,t);return d.some(Cf(n,e,o))},Tf=function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect();return function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return wf(n,e,i,c)}(n,e,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))},Rf=document.caretPositionFromPoint?function(n,e,t){return d.from(n.dom.caretPositionFromPoint(e,t)).bind((function(e){if(null===e.offsetNode)return d.none();var t=n.dom.createRange();return t.setStart(e.offsetNode,e.offset),t.collapse(),d.some(t)}))}:document.caretRangeFromPoint?function(n,e,t){return d.from(n.dom.caretRangeFromPoint(e,t))}:function(n,e,t){return Dn.fromPoint(n,e,t).bind((function(r){var o=function(){return t=n,u=e,(0===ce(o=r).length?xf:Sf)(t,o,u);var t,o,u};return 0===ce(r).length?o():Tf(n,r,e,t).orThunk(o)}))},Df=function(n,e){var t=Gn(n);return"input"===t?uf.after(n):D(["br","img"],t)?0===e?uf.before(n):uf.after(n):uf.on(n,e)},Of=function(n,e){var t=n.fold(uf.before,Df,uf.after),r=e.fold(uf.before,Df,uf.after);return af.relative(t,r)},Af=function(n,e,t,r){var o=Df(n,e),u=Df(t,r);return af.relative(o,u)},Bf=function(n,e,t,r){var o,u,i,c,a,l=(u=e,i=t,c=r,(a=ee(o=n).dom.createRange()).setStart(o.dom,u),a.setEnd(i.dom,c),a),f=Bn(n,t)&&e===r;return l.collapsed&&!f},Ef=function(n){return d.from(n.getSelection())},If=function(n,e){Ef(n).each((function(n){n.removeAllRanges(),n.addRange(e)}))},Pf=function(n,e,t,r,o){var u=sf(n,e,t,r,o);If(n,u)},kf=function(n,e){return pf(n,e).match({ltr:function(e,t,r,o){Pf(n,e,t,r,o)},rtl:function(e,t,r,o){Ef(n).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(e.dom,t,r.dom,o);else if(u.extend)try{c=e,a=t,l=r,f=o,(i=u).collapse(c.dom,a),i.extend(l.dom,f)}catch(s){Pf(n,r,o,e,t)}else Pf(n,r,o,e,t);var i,c,a,l,f}))}})},Mf=function(n,e,t,r,o){var u=Af(e,t,r,o);kf(n,u)},Nf=function(n,e,t){var r=Of(e,t);kf(n,r)},jf=function(n){var e=af.getWin(n).dom,t=function(n,t,r,o){return sf(e,n,t,r,o)},r=n.match({domRange:function(n){var e=Dn.fromDom(n.startContainer),t=Dn.fromDom(n.endContainer);return Af(e,n.startOffset,t,n.endOffset)},relative:Of,exact:Af});return pf(e,r).match({ltr:t,rtl:t})},_f=function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return d.some(rf(Dn.fromDom(e.startContainer),e.startOffset,Dn.fromDom(t.endContainer),t.endOffset))}return d.none()},Wf=function(n){if(null===n.anchorNode||null===n.focusNode)return _f(n);var e=Dn.fromDom(n.anchorNode),t=Dn.fromDom(n.focusNode);return Bf(e,n.anchorOffset,t,n.focusOffset)?d.some(rf(e,n.anchorOffset,t,n.focusOffset)):_f(n)},zf=function(n,e){var t,r,o=(t=e,r=n.document.createRange(),lf(r,t),r);If(n,o)},Ff=function(n){return Ef(n).filter((function(n){return 0<n.rangeCount})).bind(Wf).map((function(n){return af.exact(n.start,n.soffset,n.finish,n.foffset)}))},Lf=function(n,e){var t,r,o,u=hf(n,e);return r=(t=u).getClientRects(),0<(o=0<r.length?r[0]:t.getBoundingClientRect()).width||0<o.height?d.some(o).map(mf):d.none()},Hf=function(n,e,t){return r=n,o=e,u=t,i=Dn.fromDom(r.document),Rf(i,o,u).map((function(n){return rf(Dn.fromDom(n.startContainer),n.startOffset,Dn.fromDom(n.endContainer),n.endOffset)}));var r,o,u,i},qf=tinymce.util.Tools.resolve("tinymce.util.VK"),Vf=function(n,e,t,r){return Gf(n,e,tf(o=t,u).fold((function(){return ef.none(o)}),(function(n){return n.index+1<n.all.length?ef.middle(o,n.all[n.index+1]):ef.last(o)})),r);var o,u},Uf=function(n,e,t,r){return Gf(n,e,tf(o=t,u).fold((function(){return ef.none()}),(function(n){return 0<=n.index-1?ef.middle(o,n.all[n.index-1]):ef.first(o)})),r);var o,u},$f=function(n,e){var t=af.exact(e,0,e,0);return jf(t)},Gf=function(n,e,t,r){return t.fold(d.none,d.none,(function(n,e){return fr(e).map((function(n){return $f(0,n)}))}),(function(t){return ot(t,e).bind((function(e){var o,u=Ir(t);return n.undoManager.transact((function(){r.insertRowsAfter(e,u)})),o=Ce(e,"tr"),F(o).bind((function(n){return Be(n,"td,th").map((function(n){return $f(0,n)}))}))}))}))},Kf=["table","li","dl"],Xf=function(n,e,t){var r,o,u,i;n.keyCode===qf.TAB&&(r=Fi(e),o=function(n){var e=Gn(n);return Bn(n,r)||D(Kf,e)},(u=e.selection.getRng()).collapsed&&(i=Dn.fromDom(u.startContainer),et(i,o).each((function(r){n.preventDefault(),(n.shiftKey?Uf:Vf)(e,o,r,t).each((function(n){e.selection.setRng(n)}))}))))},Yf=function(n,e){return{selection:n,kill:e}},Jf=function(n,e,t,r){return{start:uf.on(n,e),finish:uf.on(t,r)}},Qf=function(n,e){var t=hf(n,e);return rf(Dn.fromDom(t.startContainer),t.startOffset,Dn.fromDom(t.endContainer),t.endOffset)},Zf=Jf,ns=function(n,e,t,r,o){return Bn(t,r)?d.none():Ut(t,r,e).bind((function(e){var r=e.boxes.getOr([]);return 0<r.length?(o(n,r,e.start,e.finish),d.some(Yf(d.some(Zf(t,0,t,cr(t))),!0))):d.none()}))},es=function(n,e){return{item:n,mode:e}},ts=function(n,e,t,r){return void 0===r&&(r=rs),n.property().parent(e).map((function(n){return es(n,r)}))},rs=function(n,e,t,r){return void 0===r&&(r=os),t.sibling(n,e).map((function(n){return es(n,r)}))},os=function(n,e,t,r){void 0===r&&(r=os);var o=n.property().children(e);return t.first(o).map((function(n){return es(n,r)}))},us=[{current:ts,next:rs,fallback:d.none()},{current:rs,next:os,fallback:d.some(ts)},{current:os,next:os,fallback:d.some(rs)}],is=function(n,e,t,r,o){return void 0===o&&(o=us),M(o,(function(n){return n.current===t})).bind((function(t){return t.current(n,e,r,t.next).orThunk((function(){return t.fallback.bind((function(t){return is(n,e,t,r)}))}))}))},cs=function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?d.some(n[n.length-1]):d.none()}}},as=function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?d.some(n[0]):d.none()}}},ls=function(n,e,t,r,o,u){return is(n,e,r,o).bind((function(e){return u(e.item)?d.none():t(e.item)?d.some(e.item):ls(n,e.item,t,e.mode,o,u)}))},fs=function(n){return function(e){return 0===n.property().children(e).length}},ss=function(n,e,t,r){return ls(n,e,t,rs,cs(),r)},ms=function(n,e,t,r){return ls(n,e,t,rs,as(),r)},ds=_t(),gs=function(n,e){return ss(t=ds,n,fs(t),e);var t},ps=function(n,e){return ms(t=ds,n,fs(t),e);var t},hs=Jt([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),vs=function(n){return Ee(n,"tr")},bs=H(H({},hs),{verify:function(n,e,t,r,o,u,i){return Ee(r,"td,th",i).bind((function(t){return Ee(e,"td,th",i).map((function(e){return Bn(t,e)?Bn(r,t)&&cr(t)===o?u(e):hs.none("in same cell"):qt(vs,[t,e]).fold((function(){return o=e,i=t,c=(r=n).getRect(o),(a=r.getRect(i)).right>c.left&&a.left<c.right?hs.success():u(e);var r,o,i,c,a}),(function(n){return u(e)}))}))})).getOr(hs.none("default"))},cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}}),ws=function(n,e){return N(n,r(Bn,e))},ys=function(n){return"br"===Gn(n)},Cs=function(n,e,t){return e(n,t).bind((function(n){return Qn(n)&&0===kt(n).trim().length?Cs(n,e,t):d.some(n)}))},Ss=function(n,e,t,r){return ae(o=e,u=t).filter(ys).orThunk((function(){return ae(o,u-1).filter(ys)})).bind((function(e){return r.traverse(e).fold((function(){return Cs(e,r.gather,n).map(r.relative)}),(function(n){return re(e=n).bind((function(n){var t=ce(n);return ws(t,e).map((function(r){return{parent:n,children:t,element:e,index:r}}))})).map((function(n){return uf.on(n.parent,n.index)}));var e}))}));var o,u},xs=function(n,e,t,r){var o,u,i;return(ys(e)?(o=n,u=e,(i=r).traverse(u).orThunk((function(){return Cs(u,i.gather,o)})).map(i.relative)):Ss(n,e,t,r)).map((function(n){return{start:n,finish:n}}))},Ts=function(n,e){return{left:n.left,top:n.top+e,right:n.right,bottom:n.bottom+e}},Rs=function(n,e){return{left:n.left,top:n.top-e,right:n.right,bottom:n.bottom-e}},Ds=function(n,e,t){return{left:n.left+e,top:n.top+t,right:n.right+e,bottom:n.bottom+t}},Os=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},As=function(n,e){return d.some(n.getRect(e))},Bs=function(n,e,t){return Jn(e)?As(n,e).map(Os):Qn(e)?(r=n,o=e,(0<=(u=t)&&u<cr(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):d.none()).map(Os)):d.none();var r,o,u},Es=function(n,e){return Jn(e)?As(n,e).map(Os):Qn(e)?n.getRangedRect(e,0,e,cr(e)).map(Os):d.none()},Is=Jt([{none:[]},{retry:["caret"]}]),Ps=function(n,e,t){return Se((function(n,e){return e(n)}),De,e,ga,r).fold(a,(function(e){return Es(n,e).exists((function(n){return r=n,(e=t).left<r.left||Math.abs(r.right-e.left)<1||e.left>r.right;var e,r}))}));var r},ks={point:function(n){return n.bottom},adjuster:function(n,e,t,r,o){var u=Ts(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Is.retry(u):t.top===o.bottom?Is.retry(Ts(o,1)):Ps(n,e,o)?Is.retry(Ds(u,5,0)):Is.none()},move:Ts,gather:ps},Ms=function(n,e,t,r,o){return 0===o?d.some(r):(a=n,l=r.left,f=e.point(r),a.elementFromPoint(l,f).filter((function(n){return"table"===Gn(n)})).isSome()?(i=r,c=o-1,Ms(n,u=e,t,u.move(i,5),c)):n.situsFromPoint(r.left,e.point(r)).bind((function(u){return u.start.fold(d.none,(function(u){return Es(n,u).bind((function(i){return e.adjuster(n,u,i,t,r).fold(d.none,(function(r){return Ms(n,e,t,r,o-1)}))})).orThunk((function(){return d.some(r)}))}),d.none)})));var u,i,c,a,l,f},Ns=function(n,e,t){var r,o,u,i=n.move(t,5),c=Ms(e,n,t,i,100).getOr(i);return o=c,u=e,((r=n).point(o)>u.getInnerHeight()?d.some(r.point(o)-u.getInnerHeight()):r.point(o)<0?d.some(-r.point(o)):d.none()).fold((function(){return e.situsFromPoint(c.left,n.point(c))}),(function(t){return e.scrollBy(0,t),e.situsFromPoint(c.left,n.point(c)-t)}))},js={tryUp:r(Ns,{point:function(n){return n.top},adjuster:function(n,e,t,r,o){var u=Rs(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Is.retry(u):t.bottom===o.top?Is.retry(Rs(o,1)):Ps(n,e,o)?Is.retry(Ds(u,5,0)):Is.none()},move:Rs,gather:gs}),tryDown:r(Ns,ks),ieTryUp:function(n,e){return n.situsFromPoint(e.left,e.top-5)},ieTryDown:function(n,e){return n.situsFromPoint(e.left,e.bottom+5)},getJumpSize:e(5)},_s=function(n,e,t){return n.getSelection().bind((function(r){return xs(e,r.finish,r.foffset,t).fold((function(){return d.some(fc(r.finish,r.foffset))}),(function(o){var u,i=n.fromSitus(o),c=bs.verify(n,r.finish,r.foffset,i.finish,i.foffset,t.failure,e);return u=c,bs.cata(u,(function(n){return d.none()}),(function(){return d.none()}),(function(n){return d.some(fc(n,0))}),(function(n){return d.some(fc(n,cr(n)))}))}))}))},Ws=function(n,e,t,r,o,u){return 0===u?d.none():Ls(n,e,t,r,o).bind((function(i){var c=n.fromSitus(i),a=bs.verify(n,t,r,c.finish,c.foffset,o.failure,e);return bs.cata(a,(function(){return d.none()}),(function(){return d.some(i)}),(function(i){return Bn(t,i)&&0===r?zs(n,t,r,Rs,o):Ws(n,e,i,0,o,u-1)}),(function(i){return Bn(t,i)&&r===cr(i)?zs(n,t,r,Ts,o):Ws(n,e,i,cr(i),o,u-1)}))}))},zs=function(n,e,t,r,o){return Bs(n,e,t).bind((function(e){return Fs(n,o,r(e,js.getJumpSize()))}))},Fs=function(n,e,t){var r=Tn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?e.otherRetry(n,t):r.isIE()?e.ieRetry(n,t):d.none()},Ls=function(n,e,t,r,o){return Bs(n,t,r).bind((function(e){return Fs(n,o,e)}))},Hs=function(n,e){return De(n,(function(n){return re(n).exists((function(n){return Bn(n,e)}))}),t).isSome();var t},qs=function(n,e,t,r,o){return Ee(r,"td,th",e).bind((function(r){return Ee(r,"table",e).bind((function(u){return Hs(o,u)?_s(i=n,c=e,a=t).bind((function(n){return Ws(i,c,n.element,n.offset,a,20).map(i.fromSitus)})).bind((function(n){return Ee(n.finish,"td,th",e).map((function(e){return{start:r,finish:e,range:n}}))})):d.none();var i,c,a}))}))},Vs=function(n,e,t,r,o,u){return Tn().browser.isIE()?d.none():u(r,e).orThunk((function(){return qs(n,e,t,r,o).map((function(n){var e=n.range;return Yf(d.some(Zf(e.start,e.soffset,e.finish,e.foffset)),!0)}))}))},Us=function(n,e){return Ee(n,"tr",e).bind((function(n){return Ee(n,"table",e).bind((function(t){var r=Ce(t,"tr");return Bn(n,r[0])?ss(ds,t,(function(n){return sr(n).isSome()}),e).map((function(n){var e=cr(n);return Yf(d.some(Zf(n,e,n,e)),!0)})):d.none()}))}))},$s=function(n,e){return Ee(n,"tr",e).bind((function(n){return Ee(n,"table",e).bind((function(t){var r=Ce(t,"tr");return Bn(n,r[r.length-1])?ms(ds,t,(function(n){return fr(n).isSome()}),e).map((function(n){return Yf(d.some(Zf(n,0,n,0)),!0)})):d.none()}))}))},Gs=function(n,e,t,r,o,u,i){return qs(n,t,r,o,u).bind((function(n){return ns(e,t,n.start,n.finish,i)}))},Ks=function(n,e){return Ee(n,"td,th",e)};function Xs(n,e,t,r){var o,u=(o=Xi(d.none()),{clear:function(){return o.set(d.none())},set:function(n){return o.set(d.some(n))},isSet:function(){return o.get().isSome()},on:function(n){return o.get().each(n)}}),i=u.clear;return{clearstate:i,mousedown:function(n){r.clear(e),Ks(n.target,t).each(u.set)},mouseover:function(o){u.on((function(u){r.clearBeforeUpdate(e),Ks(o.target,t).each((function(o){Ut(u,o,t).each((function(t){var i=t.boxes.getOr([]);(1<i.length||1===i.length&&!Bn(u,o))&&(r.selectRange(e,i,t.start,t.finish),n.selectContents(o))}))}))}))},mouseup:function(n){i()}}}var Ys={traverse:ie,gather:ps,relative:uf.before,otherRetry:js.tryDown,ieRetry:js.ieTryDown,failure:bs.failedDown},Js={traverse:ue,gather:gs,relative:uf.before,otherRetry:js.tryUp,ieRetry:js.ieTryUp,failure:bs.failedUp},Qs=function(n){return function(e){return e===n}},Zs=Qs(38),nm=Qs(40),em=function(n){return 37<=n&&n<=40},tm={isBackward:Qs(37),isForward:Qs(39)},rm={isBackward:Qs(39),isForward:Qs(37)},om=function(n){return{elementFromPoint:function(e,t){return Dn.fromPoint(Dn.fromDom(n.document),e,t)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(e,t,r,o){var u=af.exact(e,t,r,o);return Lf(n,u)},getSelection:function(){return Ff(n).map((function(e){return Qf(n,e)}))},fromSitus:function(e){var t=af.relative(e.start,e.finish);return Qf(n,t)},situsFromPoint:function(e,t){return Hf(n,e,t).map((function(n){return Jf(n.start,n.soffset,n.finish,n.foffset)}))},clearSelection:function(){Ef(n).each((function(n){return n.removeAllRanges()}))},collapseSelection:function(e){void 0===e&&(e=!1),Ff(n).each((function(t){return t.fold((function(n){return n.collapse(e)}),(function(t,r){var o=e?t:r;Nf(n,o,o)}),(function(t,r,o,u){var i=e?t:o,c=e?r:u;Mf(n,i,c,i,c)}))}))},setSelection:function(e){Mf(n,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:function(e,t){Nf(n,e,t)},selectContents:function(e){zf(n,e)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var e,t,r,o;return(e=Dn.fromDom(n.document),t=void 0!==e?e.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop,Qr(r,o)).top},scrollBy:function(e,t){var r,o,u,i;r=e,o=t,u=Dn.fromDom(n.document),(i=(void 0!==u?u.dom:document).defaultView)&&i.scrollBy(r,o)}}},um=function(n,e){return{rows:n,cols:e}},im=function(n,e,t,r){var o=Xs(om(n),e,t,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},cm=function(n,e,t,o){var u=om(n),i=function(){return o.clear(e),d.none()};return{keydown:function(n,c,a,l,f,s){var m=n.raw,g=m.which,p=!0===m.shiftKey;return $t(e,o.selectedSelector).fold((function(){return nm(g)&&p?r(Gs,u,e,t,Ys,l,c,o.selectRange):Zs(g)&&p?r(Gs,u,e,t,Js,l,c,o.selectRange):nm(g)?r(Vs,u,t,Ys,l,c,$s):Zs(g)?r(Vs,u,t,Js,l,c,Us):d.none}),(function(n){var t=function(t){return function(){return L(t,(function(t){return r=t.rows,u=t.cols,i=e,Kt(n,r,u,(c=o).firstSelectedSelector,c.lastSelectedSelector).map((function(n){return c.clearBeforeUpdate(i),c.selectRange(i,n.boxes,n.start,n.finish),n.boxes}));var r,u,i,c})).fold((function(){return Gt(e,o.firstSelectedSelector,o.lastSelectedSelector).map((function(n){var t=nm(g)||s.isForward(g)?uf.after:uf.before;return u.setRelativeSelection(uf.on(n.first,0),t(n.table)),o.clear(e),Yf(d.none(),!0)}))}),(function(n){return d.some(Yf(d.none(),!0))}))}};return nm(g)&&p?t([um(1,0)]):Zs(g)&&p?t([um(-1,0)]):s.isBackward(g)&&p?t([um(0,-1),um(-1,0)]):s.isForward(g)&&p?t([um(0,1),um(1,0)]):em(g)&&0==p?i:d.none}))()},keyup:function(n,r,u,i,c){return $t(e,o.selectedSelector).fold((function(){var a,l,f,s,m,g,p,h=n.raw,v=h.which;return 0!=(!0===h.shiftKey)&&em(v)?(a=e,l=t,f=r,s=u,m=i,g=c,p=o.selectRange,Bn(f,m)&&s===g?d.none():Ee(f,"td,th",l).bind((function(n){return Ee(m,"td,th",l).bind((function(e){return ns(a,l,n,e,p)}))}))):d.none()}),d.none)}}},am=function(n,e,t,r){var o=om(n);return function(n,u){r.clearBeforeUpdate(e),Ut(n,u,t).each((function(n){var t=n.boxes.getOr([]);r.selectRange(e,t,n.start,n.finish),o.selectContents(u),o.collapseSelection()}))}},lm=function(n,e){E(e,(function(e){var t,r;r=e,Vu(t=n)?t.dom.classList.remove(r):$u(t,r),Ku(t)}))},fm={byClass:function(n){var e,t,r=(e=n.selected,function(n){Gu(n,e)}),o=(t=[n.selected,n.lastSelected,n.firstSelected],function(n){lm(n,t)}),u=function(e){var t=Ce(e,n.selectedSelector);E(t,o)};return{clearBeforeUpdate:u,clear:u,selectRange:function(e,t,o,i){u(e),E(t,r),Gu(o,n.firstSelected),Gu(i,n.lastSelected)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},byAttr:function(n,e,t){var r=function(e){je(e,n.selected),je(e,n.firstSelected),je(e,n.lastSelected)},o=function(e){Pe(e,n.selected,"1")},u=function(n){i(n),t()},i=function(e){var t=Ce(e,n.selectedSelector);E(t,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(t,r,i,c){u(t),E(r,o),Pe(i,n.firstSelected,"1"),Pe(c,n.lastSelected,"1"),e(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}},sm=function(n,e,t){var r=mt.fromTable(n);return Wc(r,e).map((function(n){var e,o,u,i,c,a,l,f,s,m=Ic(r,t,!1);return{upOrLeftCells:(e=n,o=t,u=m.slice(0,e[e.length-1].row+1),i=kc(u,o),_(i,(function(n){var t=n.cells.slice(0,e[e.length-1].column+1);return B(t,(function(n){return n.element}))}))),downOrRightCells:(a=n,l=t,f=(c=m).slice(a[0].row+a[0].rowspan-1,c.length),s=kc(f,l),_(s,(function(n){var e=n.cells.slice(a[0].column+a[0].colspan-1,n.cells.length);return B(e,(function(n){return n.element}))})))}}))},mm=function(n){return!1===Xu(Dn.fromDom(n.target),"ephox-snooker-resizer-bar")};function dm(e,t,r){var o=fm.byAttr(Er,(function(t,o,u){r.targets().each((function(r){ot(o).each((function(i){var c=Wi(e),a=xr(n,Dn.fromDom(e.getDoc()),c),l=sm(i,r,a);bi(e,t,o,u,l)}))}))}),(function(){return wi(e)}));return e.on("init",(function(r){var u=e.getWin(),i=Fi(e),c=qi(e),a=im(u,i,c,o),l=cm(u,i,c,o),f=am(u,i,c,o);e.on("TableSelectorChange",(function(n){return f(n.start,n.finish)}));var s,m,d=function(n,t){!0===n.raw.shiftKey&&(t.kill&&n.kill(),t.selection.each((function(n){var t=af.relative(n.start,n.finish),r=hf(u,t);e.selection.setRng(r)})))},g=function(n){return 0===n.button},p=(s=Xi(Dn.fromDom(i)),m=Xi(0),{touchEnd:function(n){var e,t,r=Dn.fromDom(n.target);"td"!==Gn(r)&&"th"!==Gn(r)||(e=s.get(),t=m.get(),Bn(e,r)&&n.timeStamp-t<300&&(n.preventDefault(),f(r,r))),s.set(r),m.set(n.timeStamp)}});e.on("dragstart",(function(n){a.clearstate()})),e.on("mousedown",(function(n){g(n)&&mm(n)&&a.mousedown(Hu(n))})),e.on("mouseover",(function(n){var e;(void 0===(e=n).buttons||ql.browser.isEdge()&&0===e.buttons||0!=(1&e.buttons))&&mm(n)&&a.mouseover(Hu(n))})),e.on("mouseup",(function(n){g(n)&&mm(n)&&a.mouseup(Hu(n))})),e.on("touchend",p.touchEnd),e.on("keyup",(function(n){var t,r,o,u=Hu(n);u.raw.shiftKey&&em(u.raw.which)&&(t=e.selection.getRng(),r=Dn.fromDom(t.startContainer),o=Dn.fromDom(t.endContainer),l.keyup(u,r,t.startOffset,o,t.endOffset).each((function(n){d(u,n)})))})),e.on("keydown",(function(n){var r=Hu(n);t().each((function(n){return n.hideBars()}));var o=e.selection.getRng(),u=Dn.fromDom(o.startContainer),i=Dn.fromDom(o.endContainer),c=Lr(tm,rm)(Dn.fromDom(e.selection.getStart()));l.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(n){d(r,n)})),t().each((function(n){return n.showBars()}))})),e.on("NodeChange",(function(){var t=e.selection,r=Dn.fromDom(t.getStart()),u=Dn.fromDom(t.getEnd());qt(ot,[r,u]).fold((function(){return o.clear(i)}),n)}))})),{clear:o.clear}}var gm=function(n,e){var t=Xi(d.none()),r=Xi([]),o=function(){return Qa(Ki(n)).bind((function(n){var t=ot(n);return t.map((function(t){return"caption"===Gn(n)?Ir(n):Pr(e,t,n)}))}))},u=function(){t.set(U(o)()),E(r.get(),(function(n){return n()}))},i=function(n,e){var o=function(){return t.get().fold((function(){n.setDisabled(!0)}),(function(t){n.setDisabled(e(t))}))};return o(),r.set(r.get().concat([o])),function(){r.set(I(r.get(),(function(n){return n!==o})))}};return n.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(n){return i(n,(function(n){return!1}))},onSetupCellOrRow:function(n){return i(n,(function(n){return"caption"===Gn(n.element)}))},onSetupPasteable:function(n){return function(e){return i(e,(function(e){return"caption"===Gn(e.element)||n().isNone()}))}},onSetupMergeable:function(n){return i(n,(function(n){return n.mergable.isNone()}))},onSetupUnmergeable:function(n){return i(n,(function(n){return n.unmergable.isNone()}))},resetTargets:u,targets:function(){return t.get()}}},pm=function(n,e,t){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(e){return function(){return n.execCommand(e)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})},hm=function(n){var e=n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<e.length&&n.ui.registry.addContextToolbar("table",{predicate:function(e){return n.dom.is(e,"table")&&n.getBody().contains(e)},items:e,scope:"node",position:"node"})},vm=function(n,e,t){var r=function(e){return function(){return n.execCommand(e)}},o=function(e){var t=e.numRows,r=e.numColumns;n.undoManager.transact((function(){cl(n,r,t,0,0)})),n.addVisual()},u={text:"Table properties",onSetup:e.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:r("mceTableDelete")};n.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:e.onSetupPasteable(t.getRows)}),n.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:e.onSetupPasteable(t.getColumns)}),n.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:e.onSetupCellOrRow}),n.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:e.onSetupMergeable}),n.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}),!1===n.getParam("table_grid",!0,"boolean")?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",u),n.ui.registry.addMenuItem("deletetable",i),n.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),n.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),n.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),n.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold((function(){return""}),(function(n){return"caption"===Gn(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})};function bm(n){var e=rr((function(){return Fi(n)}),(function(){return Qa(Ki(n))}),Er.selectedSelector),t=gm(n,e),r=lc(n),o=dm(n,r.lazyResize,t),u=el(n,r.lazyWire,e),i=Jl();return Xl(n,u,o,e,i),Yl(n,u,e),kr(n,e,u,o),vm(n,t,i),pm(n,t,i),hm(n),n.on("PreInit",(function(){n.serializer.addTempAttr(Er.firstSelected),n.serializer.addTempAttr(Er.lastSelected),Zl(n)})),Oi(n)&&n.on("keydown",(function(e){Xf(e,n,u)})),n.on("remove",(function(){r.destroy()})),sl(n,i,r,t)}or.add("table",bm)}();