!function(){"use strict";var t,e,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=0,u=function(t,e,n){var r,o,u=t.editorUpload.blobCache,c=u.create((r="mceu",o=(new Date).getTime(),r+"_"+Math.floor(1e9*Math.random())+ ++i+String(o)),n,e);u.add(c),t.insertContent(t.dom.createHTML("img",{src:c.blobUri()}))},c=tinymce.util.Tools.resolve("tinymce.util.Promise"),a=tinymce.util.Tools.resolve("tinymce.Env"),l=tinymce.util.Tools.resolve("tinymce.util.Delay"),s=function(t){t.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var e;e=t,new c((function(t){var n=document.createElement("input");n.type="file",n.accept="image/*",n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.opacity="0.001",document.body.appendChild(n),n.addEventListener("change",(function(e){t(Array.prototype.slice.call(e.target.files))}));var r=function(o){var i=function(){t([]),n.parentNode.removeChild(n)};a.os.isAndroid()&&"remove"!==o.type?l.setEditorTimeout(e,i,0):i(),e.off("focusin remove",r)};e.on("focusin remove",r),n.click()})).then((function(e){var n,r;0<e.length&&(n=e[0],r=n,new c((function(t){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(r)})).then((function(e){u(t,e,n)})))}))}}),t.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){var e,n,r,o,i,u;r=n=2,(e=t).plugins.table?e.plugins.table.insertTable(n,r):(i=n,u=r,(o=e).undoManager.transact((function(){o.insertContent(function(t,e){var n,r,o='<table data-mce-id="mce" style="width: 100%">';for(o+="<tbody>",r=0;r<e;r++){for(o+="<tr>",n=0;n<t;n++)o+="<td><br></td>";o+="</tr>"}return o+="</tbody>",o+"</table>"}(i,u));var t=o.dom.select("*[data-mce-id]")[0];t.removeAttribute("data-mce-id");var e=o.dom.select("td,th",t);o.selection.setCursorLocation(e[0],0)})))}})},f=function(t){return function(){return t}},d=f(!1),m=f(!0),g=function(){return v},v=(t=function(t){return t.isNone()},{fold:function(t,e){return t()},is:d,isSome:d,isNone:m,getOr:n=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:f(null),getOrUndefined:f(void 0),or:n,orThunk:e,map:g,each:function(){},bind:g,exists:d,forall:m,filter:g,equals:t,equals_:t,toArray:function(){return[]},toString:f("none()")}),h=function(t){var e=f(t),n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:m,isNone:d,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return h(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?o:v},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(d,(function(e){return n(t,e)}))}};return o},p={some:h,none:g,from:function(t){return null===t||void 0===t?v:h(t)}},b=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},y=function(t){return function(e){return typeof e===t}},k=b("string"),w=b("object"),T=b("array"),N=y("boolean"),q=(r=void 0,function(t){return r===t}),E=y("function");function M(t,e,n,r,o){return t(n,r)?p.some(n):E(o)&&o(n)?p.none():e(n,r,o)}var S,C=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:t}},O={fromHtml:function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return C(n.childNodes[0])},fromTag:function(t,e){var n=(e||document).createElement(t);return C(n)},fromText:function(t,e){var n=(e||document).createTextNode(t);return C(n)},fromDom:C,fromPoint:function(t,e,n){return p.from(t.dom.elementFromPoint(e,n)).map(C)}},x=function(t,e){var n=t.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},A=("undefined"!=typeof window||Function("return this;")(),function(t,e,n){for(var r=t.dom,o=E(n)?n:d;r.parentNode;){r=r.parentNode;var i=O.fromDom(r);if(e(i))return p.some(i);if(o(i))break}return p.none()}),D=function(t,e,n){return A(t,(function(t){return x(t,e)}),n)},_=(S=k,function(t,e,n){return function(t,e){if(!e(t))throw new Error("Default value doesn't match requested type.")}(n,S),function(t,e){if(T(t)||w(t))throw new Error("expected a string but found: "+t);return q(t)?e:N(t)?!1===t?"":e:t}(t.getParam(e,n),n)}),L=function(t){var e=_(t,"quickbars_insert_toolbar","quickimage quicktable");0<e.trim().length&&t.ui.registry.addContextToolbar("quickblock",{predicate:function(e){var n=O.fromDom(e),r=t.schema.getTextBlockElements(),o=function(e){return e.dom===t.getBody()};return M(x,D,n,"table",o).fold((function(){return M((function(t,e){return e(t)}),A,n,(function(e){return e.dom.nodeName.toLowerCase()in r&&t.dom.isEmpty(e.dom)}),o).isSome()}),(function(){return!1}))},items:e,position:"line",scope:"editor"})},P=function(t){var e=function(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)},n=_(t,"quickbars_image_toolbar","alignleft aligncenter alignright");0<n.trim().length&&t.ui.registry.addContextToolbar("imageselection",{predicate:e,items:n,position:"node"});var r=_(t,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote");0<r.trim().length&&t.ui.registry.addContextToolbar("textselection",{predicate:function(n){return!e(n)&&!t.selection.isCollapsed()&&(r=n,"false"!==t.dom.getContentEditableParent(r));var r},items:r,position:"selection",scope:"editor"})};o.add("quickbars",(function(t){s(t),L(t),P(t)}))}();