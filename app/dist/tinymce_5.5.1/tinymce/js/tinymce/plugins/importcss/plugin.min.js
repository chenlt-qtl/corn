!function(){"use strict";var t,e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.EditorManager"),o=tinymce.util.Tools.resolve("tinymce.Env"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=function(t){return t.getParam("importcss_selector_converter")},s=(t="array",function(e){return n=typeof(r=e),(null===r?"null":"object"==n&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":n)===t;var r,n}),a=Array.prototype.push,u=function(t,e){return function(t){for(var e=[],r=0,n=t.length;r<n;++r){if(!s(t[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+t);a.apply(e,t[r])}return e}(function(t,e){for(var r=t.length,n=new Array(r),o=0;o<r;o++){var i=t[o];n[o]=e(i,o)}return n}(t,e))},l=function(t){return"string"==typeof t?function(e){return-1!==e.indexOf(t)}:t instanceof RegExp?function(e){return t.test(e)}:t},f=function(t,e,r){var c=[],s={};function a(e,s){var u,l,f,m=e.href;if(l=m,f=o.cacheSuffix,"string"==typeof l&&(l=l.replace("?"+f,"").replace("&"+f,"")),(m=l)&&r(m,s)&&!function(t,e){var r,o=!1!==(r=t.getParam("skin"))&&(r||"oxide");if(o){var i=t.getParam("skin_url"),c=i?t.documentBaseURI.toAbsolute(i):n.baseURL+"/skins/ui/"+o,s=n.baseURL+"/skins/content/";return e===c+"/content"+(t.inline?".inline":"")+".min.css"||-1!==e.indexOf(s)}return!1}(t,m)){i.each(e.imports,(function(t){a(t,!0)}));try{u=e.cssRules||e.rules}catch(p){}i.each(u,(function(t){t.styleSheet?a(t.styleSheet,!0):t.selectorText&&i.each(t.selectorText.split(","),(function(t){c.push(i.trim(t))}))}))}}i.each(t.contentCSS,(function(t){s[t]=!0})),r=r||function(t,e){return e||s[t]};try{i.each(e.styleSheets,(function(t){a(t)}))}catch(u){}return c},m=function(t,e){var r,n=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(e);if(n){var o=n[1],c=n[2].substr(1).split(".").join(" "),s=i.makeMap("a,img");return n[1]?(r={title:e},t.schema.getTextBlockElements()[o]?r.block=o:t.schema.getBlockElements()[o]||s[o.toLowerCase()]?r.selector=o:r.inline=o):n[2]&&(r={inline:"span",title:e.substr(1),classes:c}),!1!==t.getParam("importcss_merge_classes")?r.classes=c:r.attributes={class:c},r}},p=function(t,e){return null===e||!1!==t.getParam("importcss_exclusive")},g=function(t){t.on("init",(function(e){var n,o,s,a,g=(n=[],o=[],s={},{addItemToGroup:function(t,e){s[t]?s[t].push(e):(o.push(t),s[t]=[e])},addItem:function(t){n.push(t)},toFormats:function(){return u(o,(function(t){var e=s[t];return 0===e.length?[]:[{title:t,items:e}]})).concat(n)}}),y={},v=l(t.getParam("importcss_selector_filter")),h=(a=t.getParam("importcss_groups"),i.map(a,(function(t){return i.extend({},t,{original:t,selectors:{},filter:l(t.filter),item:{text:t.title,menu:[]}})}))),d=function(e,n){if(d=e,x=y,!(p(t,_=n)?d in x:d in _.selectors)){g=e,h=y,p(t,v=n)?h[g]=!0:v.selectors[g]=!0;var o=(u=(a=t).plugins.importcss,l=e,((f=n)&&f.selector_converter?f.selector_converter:c(a)?c(a):function(){return m(a,l)}).call(u,l,f));if(o){var s=o.name||r.DOM.uniqueId();return t.formatter.register(s,o),i.extend({},{title:o.title,format:s})}}var a,u,l,f,g,v,h,d,_,x;return null};i.each(f(t,t.getDoc(),l(t.getParam("importcss_file_filter"))),(function(t){var e,r,n,o;-1===t.indexOf(".mce-")&&(v&&!v(t)||(n=h,o=t,0<(e=i.grep(n,(function(t){return!t.filter||t.filter(o)}))).length?i.each(e,(function(e){var r=d(t,e);r&&g.addItemToGroup(e.title,r)})):(r=d(t,null))&&g.addItem(r)))}));var _=g.toFormats();t.fire("addStyleModifications",{items:_,replace:!t.getParam("importcss_append")})}))};e.add("importcss",(function(t){return g(t),e=t,{convertSelectorToFormat:function(t){return m(e,t)}};var e}))}();