!function(){"use strict";var n,e,t,r=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},o=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(n){return{isFullscreen:function(){return null!==n.get()}}},i=function(){},l=function(n){return function(){return n}},c=l(!1),f=l(!0),a=function(){return s},s=(n=function(n){return n.isNone()},{fold:function(n,e){return n()},is:c,isSome:c,isNone:f,getOr:t=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:l(null),getOrUndefined:l(void 0),or:t,orThunk:e,map:a,each:i,bind:a,exists:c,forall:f,filter:a,equals:n,equals_:n,toArray:function(){return[]},toString:l("none()")}),m=function(n){var e=l(n),t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:f,isNone:c,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return m(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?o:s},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(c,(function(e){return t(n,e)}))}};return o},d={some:m,none:a,from:function(n){return null===n||void 0===n?s:m(n)}},h=function(){return n=function(n){return n.unbind()},e=r(d.none()),t=function(){return e.get().each(n)},{clear:function(){t(),e.set(d.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(d.some(n))}};var n,e,t},v=function(n){return function(e){return r=typeof(t=e),(null===t?"null":"object"==r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r)===n;var t,r}},g=function(n){return function(e){return typeof e===n}},p=v("string"),y=v("array"),w=g("boolean"),b=function(n){return!(null===(e=n)||void 0===e);var e},S=g("function"),E=g("number"),F=Array.prototype.push,T=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},x=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},D=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},k=function(n,e){return function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!y(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);F.apply(e,n[t])}return e}(T(n,e))},C=Object.keys,O=function(n){return void 0!==n.style&&S(n.style.getPropertyValue)},A=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},N={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return A(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return A(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return A(t)},fromDom:A,fromPoint:function(n,e,t){return d.from(n.dom.elementFromPoint(e,t)).map(A)}},M=("undefined"!=typeof window||Function("return this;")(),function(n){return function(e){return e.dom.nodeType===n}}),P=M(1),L=M(3),q=M(9),H=M(11),R=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},V=function(n){return N.fromDom(n.dom.ownerDocument)},W=function(n){var e;return e=n,d.from(e.dom.parentNode).map(N.fromDom).map(B).map((function(e){return D(e,(function(e){return t=e,n.dom!==t.dom;var t}))})).getOr([])},B=function(n){return T(n.dom.childNodes,N.fromDom)},j=S(Element.prototype.attachShadow)&&S(Node.prototype.getRootNode),z=l(j),I=j?function(n){return N.fromDom(n.dom.getRootNode())}:function(n){return q(n)?n:V(n)},U=function(n){var e=I(n);return H(e)?d.some(e):d.none()},_=function(n){return N.fromDom(n.dom.host)},K=function(n){if(z()&&b(n.target)){var e=N.fromDom(n.target);if(P(e)&&X(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0===(r=t).length?d.none():d.some(r[0])}}var r;return d.from(n.target)},X=function(n){return b(n.dom.shadowRoot)},Y=function(n){var e=L(n)?n.dom.parentNode:n.dom;if(void 0===e||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return U(N.fromDom(e)).fold((function(){return o.body.contains(e)}),(t=Y,r=_,function(n){return t(r(n))}))},G=function(n,e,t){!function(n,e,t){if(!(p(t)||w(t)||E(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}(n.dom,e,t)},J=function(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t},Q=function(n,e){n.dom.removeAttribute(e)},Z=function(n,e){var t=n.dom;!function(n,e){for(var t=C(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}(e,(function(n,e){!function(n,e,t){if(!p(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);O(n)&&n.style.setProperty(e,t)}(t,e,n)}))},$=function(n,e){return O(n)?n.style.getPropertyValue(e):""},nn=function(n){var e,t,r=N.fromDom(K(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(e=u,t=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))});return{target:r,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},en=function(n,e,t,r,o){var u,i,l=(u=t,i=r,function(n){u(n)&&i(nn(n))});return n.dom.addEventListener(e,l,o),{unbind:function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}(tn,n,e,l,o)}},tn=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},rn=f,on=function(n,e,t){return en(n,e,rn,t,!1)},un=function(n,e){return{left:n,top:e,translate:function(t,r){return un(n+t,e+r)}}},ln=un,cn=function(n){var e=void 0===n?window:n;return d.from(e.visualViewport)},fn=function(n,e,t,r){return{x:n,y:e,width:t,height:r,right:n+t,bottom:e+r}},an=function(n){var e,t,r,o,u=void 0===n?window:n,i=u.document,l=(e=N.fromDom(i),t=void 0!==e?e.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop,ln(r,o));return cn(u).fold((function(){var n=u.document.documentElement,e=n.clientWidth,t=n.clientHeight;return fn(l.left,l.top,e,t)}),(function(n){return fn(Math.max(n.pageLeft,l.left),Math.max(n.pageTop,l.top),n.width,n.height)}))},sn=function(n,e,t){return cn(t).map((function(t){var r=function(n){return e(nn(n))};return t.addEventListener(n,r),{unbind:function(){return t.removeEventListener(n,r)}}})).getOrThunk((function(){return{unbind:i}}))},mn=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),dn=tinymce.util.Tools.resolve("tinymce.Env"),hn=tinymce.util.Tools.resolve("tinymce.util.Delay"),vn=function(n,e){n.fire("FullscreenStateChanged",{state:e})},gn=function(n){return n.getParam("fullscreen_native",!1,"boolean")},pn=function(n){var e=N.fromDom(n.getElement());return U(e).map(_).getOrThunk((function(){return function(n){var e=n.dom.body;if(null===e||void 0===e)throw new Error("Body is not available yet");return N.fromDom(e)}(V(e))}))},yn=function(n){return n.dom===(void 0!==(e=V(n).dom).fullscreenElement?e.fullscreenElement:void 0!==e.msFullscreenElement?e.msFullscreenElement:void 0!==e.webkitFullscreenElement?e.webkitFullscreenElement:null);var e},wn=function(n,e,t){return D(function(n,e){for(var t=S(e)?e:c,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=N.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}(n,t),e)},bn=function(n){return e=n,o=void 0===t?document:t.dom,1!==(r=o).nodeType&&9!==r.nodeType&&11!==r.nodeType||0===r.childElementCount?[]:T(o.querySelectorAll(e),N.fromDom);var e,t,r,o},Sn=function(n,e){return t=function(n){return R(n,e)},D(W(n),t);var t},En="data-ephox-mobile-fullscreen-style",Fn="position:absolute!important;",Tn="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",xn=dn.os.isAndroid(),Dn=function(n){var e,t,r,o,u=(t="background-color",r=(e=n).dom,""!==(o=window.getComputedStyle(r).getPropertyValue(t))||Y(e)?o:$(r,t));return void 0!==u&&""!==u?"background-color:"+u+"!important":"background-color:rgb(255,255,255)!important;"},kn=function(n,e,t){var r,o,u=function(e){return function(t){var r=J(t,"style"),o=void 0===r?"no-styles":r.trim();o!==e&&(G(t,En,o),Z(t,n.parseStyle(e)))}},i=(r="*",wn(e,(function(n){return R(n,r)}),o)),l=k(i,(function(n){return Sn(n,"*:not(.tox-silver-sink)")})),c=Dn(t);x(l,u("display:none!important;")),x(i,u(Fn+Tn+c)),u((!0===xn?"":Fn)+Tn+c)(e)},Cn=mn.DOM,On=cn().fold((function(){return{bind:i,unbind:i}}),(function(n){var e,t=(e=r(d.none()),{clear:function(){return e.set(d.none())},set:function(n){return e.set(d.some(n))},isSet:function(){return e.get().isSome()},on:function(n){return e.get().each(n)}}),o=h(),u=h(),i=hn.throttle((function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame((function(){t.on((function(e){return Z(e,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})}))}))}),50);return{bind:function(n){t.set(n),i(),o.set(sn("resize",i)),u.set(sn("scroll",i))},unbind:function(){t.on((function(){o.clear(),u.clear()})),t.clear()}}})),An=function(n,e){var t,r,o,u,i,l,c,f=document.body,a=document.documentElement,s=n.getContainer(),m=N.fromDom(s),h=pn(n),v=e.get(),g=N.fromDom(n.getBody()),p=dn.deviceType.isTouch(),y=s.style,w=n.iframeElement.style,b=function(){var t,r;p&&(t=n.dom,r=bn("["+En+"]"),x(r,(function(n){var e=J(n,En);"no-styles"!==e?Z(n,t.parseStyle(e)):Q(n,"style"),Q(n,En)}))),Cn.removeClass(f,"tox-fullscreen"),Cn.removeClass(a,"tox-fullscreen"),Cn.removeClass(s,"tox-fullscreen"),On.unbind(),d.from(e.get()).each((function(n){return n.fullscreenChangeHandler.unbind()}))};v?(v.fullscreenChangeHandler.unbind(),gn(n)&&yn(h)&&(u=V(h),(i=u.dom).exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.webkitCancelFullScreen&&i.webkitCancelFullScreen()),w.width=v.iframeWidth,w.height=v.iframeHeight,y.width=v.containerWidth,y.height=v.containerHeight,y.top=v.containerTop,y.left=v.containerLeft,o=v.scrollPos,window.scrollTo(o.x,o.y),e.set(null),vn(n,!1),b(),n.off("remove",b)):(t=on(V(h),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",(function(t){gn(n)&&(yn(h)||null===e.get()||An(n,e))})),r={scrollPos:{x:(c=an(window)).x,y:c.y},containerWidth:y.width,containerHeight:y.height,containerTop:y.top,containerLeft:y.left,iframeWidth:w.width,iframeHeight:w.height,fullscreenChangeHandler:t},p&&kn(n.dom,m,g),w.width=w.height="100%",y.width=y.height="",Cn.addClass(f,"tox-fullscreen"),Cn.addClass(a,"tox-fullscreen"),Cn.addClass(s,"tox-fullscreen"),On.bind(m),n.on("remove",b),e.set(r),gn(n)&&((l=h.dom).requestFullscreen?l.requestFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():l.webkitRequestFullScreen&&l.webkitRequestFullScreen()),vn(n,!0))},Nn=function(n,e){return function(t){t.setActive(null!==e.get());var r=function(n){return t.setActive(n.state)};return n.on("FullscreenStateChanged",r),function(){return n.off("FullscreenStateChanged",r)}}};o.add("fullscreen",(function(n){var e,t,o,i,l=r(null);return n.inline||(t=l,(e=n).addCommand("mceFullScreen",(function(){An(e,t)})),i=l,(o=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return o.execCommand("mceFullScreen")},onSetup:Nn(o,i)}),o.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return o.execCommand("mceFullScreen")},onSetup:Nn(o,i)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),u(l)}))}();