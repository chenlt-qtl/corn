!function(){"use strict";var t=function(){},n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},e=function(t){return function(){return t}},o=function(t){return t};function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var i=function(t){return function(n){return!t(n)}},u=function(t){return function(){throw new Error(t)}},a=e(!1),c=e(!0),s=tinymce.util.Tools.resolve("tinymce.ThemeManager"),l=function(){return(l=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function f(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function d(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var m,g,p,h,v,b,y=function(){return x},x=(m=function(t){return t.isNone()},{fold:function(t,n){return t()},is:a,isSome:a,isNone:c,getOr:p=function(t){return t},getOrThunk:g=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:p,orThunk:g,map:y,each:t,bind:y,exists:a,forall:c,filter:y,equals:m,equals_:m,toArray:function(){return[]},toString:e("none()")}),w=function(t){var n=e(t),o=function(){return i},r=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:o,orThunk:o,map:function(n){return w(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?i:x},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(a,(function(n){return e(t,n)}))}};return i},S={some:w,none:y,from:function(t){return null===t||void 0===t?x:w(t)}},k=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"==o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}},C=function(t){return function(n){return typeof n===t}},O=k("string"),_=k("object"),T=k("array"),E=C("boolean"),B=(h=void 0,function(t){return h===t}),D=function(t){return!(null===(n=t)||void 0===n);var n},A=C("function"),M=C("number"),F=function(t,n){if(T(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},I=Array.prototype.slice,R=Array.prototype.indexOf,V=Array.prototype.push,P=function(t,n){return R.call(t,n)},H=function(t,n){return-1<P(t,n)},z=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},N=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},L=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=I.call(t,o,o+n);e.push(r)}return e},j=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},U=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},W=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},G=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},X=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,(function(t){e=n(e,t)})),e},Y=function(t,n,e){return U(t,(function(t){e=n(e,t)})),e},q=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return S.some(i);if(e(i,o))break}return S.none()}(t,n,a)},K=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return S.some(e);return S.none()},J=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!T(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);V.apply(n,t[e])}return n},$=function(t,n){return J(j(t,n))},Q=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Z=function(t){var n=I.call(t,0);return n.reverse(),n},tt=function(t,n){return G(t,(function(t){return!H(n,t)}))},nt=function(t,n){var e=I.call(t,0);return e.sort(n),e},et=function(t){return 0===t.length?S.none():S.some(t[0])},ot=function(t){return 0===t.length?S.none():S.some(t[t.length-1])},rt=A(Array.from)?Array.from:function(t){return I.call(t)},it=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return S.none()},ut=function(t){return{is:function(n){return t===n},isValue:c,isError:a,getOr:e(t),getOrThunk:e(t),getOrDie:e(t),or:function(n){return ut(t)},orThunk:function(n){return ut(t)},fold:function(n,e){return e(t)},map:function(n){return ut(n(t))},mapError:function(n){return ut(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return S.some(t)}}},at=function(n){return{is:a,isValue:a,isError:c,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return u(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(t){return at(n)},mapError:function(t){return at(t(n))},each:t,bind:function(t){return at(n)},exists:a,forall:c,toOptional:S.none}},ct={value:ut,error:at,fromOption:function(t,n){return t.fold((function(){return at(n)}),ut)}};(b=v=v||{})[b.Error=0]="Error",b[b.Value=1]="Value";var st,lt,ft=function(t,n,e){return t.stype===v.Error?n(t.serror):e(t.svalue)},dt=function(t){return{stype:v.Value,svalue:t}},mt=function(t){return{stype:v.Error,serror:t}},gt=function(t){return t.fold(mt,dt)},pt=function(t){return ft(t,ct.error,ct.value)},ht=dt,vt=function(t){var n=[],e=[];return U(t,(function(t){ft(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},bt=mt,yt=function(t,n){return t.stype===v.Value?n(t.svalue):t},xt=function(t,n){return t.stype===v.Error?n(t.serror):t},wt=function(t,n){return t.stype===v.Value?{stype:v.Value,svalue:n(t.svalue)}:t},St=function(t,n){return t.stype===v.Error?{stype:v.Error,serror:n(t.serror)}:t},kt=Object.keys,Ct=Object.hasOwnProperty,Ot=function(t,n){for(var e=kt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},_t=function(t,n){return Tt(t,(function(t,e){return{k:e,v:n(t,e)}}))},Tt=function(t,n){var e={};return Ot(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},Et=function(n,e){var o,r,i,u,a={};return o=e,u=a,r=function(t,n){u[n]=t},i=t,Ot(n,(function(t,n){(o(t,n)?r:i)(t,n)})),a},Bt=function(t,n){var e=[];return Ot(t,(function(t,o){e.push(n(t,o))})),e},Dt=function(t,n){for(var e=kt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return S.some(u)}return S.none()},At=function(t){return Bt(t,(function(t){return t}))},Mt=function(t,n){return Ft(t,n)?S.from(t[n]):S.none()},Ft=function(t,n){return Ct.call(t,n)},It=function(t,n){return Ft(t,n)&&void 0!==t[n]&&null!==t[n]},Rt=function(t){if(!T(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return U(t,(function(o,r){var i=kt(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!T(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){var e=arguments.length;if(e!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+e);for(var o=new Array(e),i=0;i<o.length;i++)o[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[r].apply(null,o)},match:function(t){var e=kt(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!Q(n,(function(t){return H(e,t)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,o)},log:function(t){console.log(t,{constructors:n,constructor:u,params:o})}}}})),e},Vt=Object.prototype.hasOwnProperty,Pt=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)Vt.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Ht=Pt((function(t,n){return _(t)&&_(n)?Ht(t,n):n})),zt=Pt((function(t,n){return n})),Nt=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Lt=Rt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),jt=function(t){return Lt.defaultedThunk(e(t))},Ut=Lt.strict,Wt=Lt.asOption,Gt=Lt.defaultedThunk,Xt=(Lt.asDefaultedOptionThunk,Lt.mergeWithThunk),Yt=(Rt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),qt=function(t,n){return e=n,o={},Ot(t,(function(t,n){H(e,n)||(o[n]=t)})),o;var e,o},Kt=Yt,Jt=function(t){return n={},U(t,(function(t){n[t.key]=t.value})),n;var n},$t=function(t,n){var e,o,r,i,u,a=(e=[],o=[],U(t,(function(t){t.fold((function(t){e.push(t)}),(function(t){o.push(t)}))})),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,ct.error(J(u))):(i=n,0===(r=a.values).length?ct.value(i):ct.value(Ht(i,zt.apply(void 0,r))))},Qt=function(t){return n(bt,J)(t)},Zt=function(t,n){var e,o,r=vt(t);return 0<r.errors.length?Qt(r.errors):(e=r.values,o=n,0<e.length?ht(Ht(o,zt.apply(void 0,e))):ht(o))},tn=function(t){var n=vt(t);return 0<n.errors.length?Qt(n.errors):ht(n.values)},nn=function(t){return _(t)&&100<kt(t).length?" removed due to size":JSON.stringify(t,null,2)},en=function(t,n){return bt([{path:t,getErrorInfo:n}])},on=Rt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),rn=function(t,n,e){return Mt(n,e).fold((function(){return o=e,r=n,en(t,(function(){return'Could not find valid *strict* value for "'+o+'" in '+nn(r)}));var o,r}),ht)},un=function(t,n,e){var r=Mt(t,n).fold((function(){return e(t)}),o);return ht(r)},an=function(t,n,o,r){return o.fold((function(o,i,u,a){var c=function(n){var e=a.extract(t.concat([o]),r,n);return wt(e,(function(t){return Yt(i,r(t))}))},s=function(n){return n.fold((function(){var t=Yt(i,r(S.none()));return ht(t)}),(function(n){var e=a.extract(t.concat([o]),r,n);return wt(e,(function(t){return Yt(i,r(S.some(t)))}))}))};return u.fold((function(){return yt(rn(t,n,o),c)}),(function(t){return yt(un(n,o,t),c)}),(function(){return yt(ht(Mt(n,o)),s)}),(function(t){return yt((r=t,i=Mt(e=n,o).map((function(t){return!0===t?r(e):t})),ht(i)),s);var e,r,i}),(function(t){var r=t(n),i=wt(un(n,o,e({})),(function(t){return Ht(r,t)}));return yt(i,c)}))}),(function(t,e){var o=e(n);return ht(Yt(t,r(o)))}))},cn=function(t){return{extract:function(n,e,o){return xt(t(o,e),(function(t){return e=t,en(n,(function(){return e}));var e}))},toString:function(){return"val"}}},sn=function(t){var n=ln(t),o=X(t,(function(t,n){return n.fold((function(n){return Ht(t,Kt(n,!0))}),e(t))}),{});return{extract:function(t,e,r){var i,u=E(r)?[]:kt(Et(r,(function(t){return void 0!==t&&null!==t}))),a=G(u,(function(t){return!It(o,t)}));return 0===a.length?n.extract(t,e,r):(i=a,en(t,(function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"})))},toString:n.toString}},ln=function(t){return{extract:function(n,e,o){return r=n,i=o,u=e,a=j(t,(function(t){return an(r,i,t,u)})),Zt(a,{});var r,i,u,a},toString:function(){return"obj{\n"+j(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},fn=function(t){return{extract:function(n,e,o){var r=j(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}));return tn(r)},toString:function(){return"array("+t.toString()+")"}}},dn=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o);if(a.stype===v.Value)return a;r.push(a)}return tn(r)},toString:function(){return"oneOf("+j(t,(function(t){return t.toString()})).join(", ")+")"}}},mn=function(t,n){return{extract:function(e,r,i){var u,a,c=kt(i),s=(u=e,a=c,fn(cn(t)).extract(u,o,a));return yt(s,(function(t){var o=j(t,(function(t){return on.field(t,t,Ut(),n)}));return ln(o).extract(e,r,i)}))},toString:function(){return"setOf("+n.toString()+")"}}},gn=e(cn(ht)),pn=n(fn,ln),hn=on.state,vn=on.field,bn=function(t,n,e,o,r){return Mt(o,r).fold((function(){return n=o,e=r,en(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+nn(n)}));var n,e}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))},yn=function(t,n){return{extract:function(e,o,r){return Mt(r,t).fold((function(){return n=t,en(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}));var n}),(function(t){return bn(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+kt(n)}}},xn=cn(ht),wn=function(t){return pn(t)},Sn=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}},kn=function(t){return cn((function(n){return t(n).fold(bt,ht)}))},Cn=function(t,n){return mn((function(n){return gt(t(n))}),n)},On=function(t,n,e){return pt((r=t,i=o,u=e,a=n.extract([r],i,u),St(a,(function(t){return{input:u,errors:t}}))));var r,i,u,a},_n=function(t){return t.fold((function(t){throw new Error(En(t))}),o)},Tn=function(t,n,e){return _n(On(t,n,e))},En=function(t){return"Errors: \n"+(n=t.errors,e=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,j(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})).join("\n")+"\n\nInput object: ")+nn(t.input);var n,e},Bn=yn,Dn=function(t,n){return yn(t,_t(n,ln))},An=e(xn),Mn=function(t,n){return cn((function(e){var o=typeof e;return t(e)?ht(e):bt("Expected type: "+n+" but got: "+o)}))},Fn=Mn(M,"number"),In=Mn(O,"string"),Rn=Mn(E,"boolean"),Vn=Mn(A,"function"),Pn=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return Pn(t[n])}));case"Map":return n(t.keys(),Pn)&&n(t.values(),Pn);case"Set":return n(t.keys(),Pn);default:return!1}},Hn=cn((function(t){return Pn(t)?ht(t):bt("Expected value to be acceptable for sending via postMessage")})),zn=function(t){return kn((function(n){return H(t,n)?ct.value(n):ct.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Nn=function(t){return vn(t,t,Ut(),gn())},Ln=function(t,n){return vn(t,t,Ut(),n)},jn=function(t){return Ln(t,In)},Un=function(t,n){return vn(t,t,Ut(),zn(n))},Wn=function(t){return Ln(t,Vn)},Gn=function(t,n){return vn(t,t,Ut(),ln(n))},Xn=function(t,n){return vn(t,t,Ut(),pn(n))},Yn=function(t,n){return vn(t,t,Ut(),fn(n))},qn=function(t){return vn(t,t,Wt(),gn())},Kn=function(t,n){return vn(t,t,Wt(),n)},Jn=function(t){return Kn(t,Fn)},$n=function(t){return Kn(t,In)},Qn=function(t){return Kn(t,Vn)},Zn=function(t,n){return Kn(t,ln(n))},te=function(t,n){return vn(t,t,jt(n),gn())},ne=function(t,n,e){return vn(t,t,jt(n),e)},ee=function(t,n){return ne(t,n,Fn)},oe=function(t,n){return ne(t,n,In)},re=function(t,n,e){return ne(t,n,zn(e))},ie=function(t,n){return ne(t,n,Rn)},ue=function(t,n){return ne(t,n,Vn)},ae=function(t,n,e){return ne(t,n,ln(e))},ce=function(t,n){return hn(t,n)},se=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},le=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:t}},fe={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return le(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return le(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return le(e)},fromDom:le,fromPoint:function(t,n,e){return S.from(t.dom.elementFromPoint(n,e)).map(le)}},de=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return ge(o(1),o(2))},me=function(){return ge(0,0)},ge=function(t,n){return{major:t,minor:n}},pe={nu:ge,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?me():de(t,e)},unknown:me},he=function(t,n){var e=String(n).toLowerCase();return q(t,(function(t){return t.search(e)}))},ve=function(t,n){return he(t,n).map((function(t){var e=pe.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},be=function(t,n){return he(t,n).map((function(t){var e=pe.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},ye=function(t,n){return-1!==t.indexOf(n)},xe=(st=/^\s+|\s+$/g,function(t){return t.replace(st,"")}),we=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Se=function(t){return function(n){return ye(n,t)}},ke=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ye(t,"edge/")&&ye(t,"chrome")&&ye(t,"safari")&&ye(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,we],search:function(t){return ye(t,"chrome")&&!ye(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ye(t,"msie")||ye(t,"trident")}},{name:"Opera",versionRegexes:[we,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Se("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Se("firefox")},{name:"Safari",versionRegexes:[we,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ye(t,"safari")||ye(t,"mobile/"))&&ye(t,"applewebkit")}}],Ce=[{name:"Windows",search:Se("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ye(t,"iphone")||ye(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Se("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Se("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Se("linux"),versionRegexes:[]},{name:"Solaris",search:Se("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Se("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Se("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Oe={browsers:e(ke),oses:e(Ce)},_e="Firefox",Te=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(_e),isSafari:o("Safari")}},Ee={unknown:function(){return Te({current:void 0,version:pe.unknown()})},nu:Te,edge:e("Edge"),chrome:e("Chrome"),ie:e("IE"),opera:e("Opera"),firefox:e(_e),safari:e("Safari")},Be="Windows",De="Android",Ae="Solaris",Me="FreeBSD",Fe="ChromeOS",Ie=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Be),isiOS:o("iOS"),isAndroid:o(De),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(Ae),isFreeBSD:o(Me),isChromeOS:o(Fe)}},Re={unknown:function(){return Ie({current:void 0,version:pe.unknown()})},nu:Ie,windows:e(Be),ios:e("iOS"),android:e(De),linux:e("Linux"),osx:e("OSX"),solaris:e(Ae),freebsd:e(Me),chromeos:e(Fe)},Ve=function(t,n){var o,r,i,u,a,c,s,l,f,d,m,g,p=Oe.browsers(),h=Oe.oses(),v=ve(p,t).fold(Ee.unknown,Ee.nu),b=be(h,t).fold(Re.unknown,Re.nu);return{browser:v,os:b,deviceType:(r=v,i=t,u=n,a=(o=b).isiOS()&&!0===/ipad/i.test(i),c=o.isiOS()&&!a,s=o.isiOS()||o.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=r.isSafari()&&o.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:e(a),isiPhone:e(c),isTablet:e(f),isPhone:e(d),isTouch:e(l),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:e(m),isDesktop:e(g)})}},Pe=function(t){return window.matchMedia(t).matches},He=Nt((function(){return Ve(navigator.userAgent,Pe)})),ze=function(){return He()},Ne=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Le=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},je=function(t,n){return t.dom===n.dom},Ue=function(t,n){return e=t.dom,o=n.dom,r=e,i=o,u=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(i)&u);var e,o,r,i,u},We=function(t,n){return ze().browser.isIE()?Ue(t,n):(e=n,o=t.dom,r=e.dom,o!==r&&o.contains(r));var e,o,r},Ge=function(t){return A(t)?t:a},Xe=function(t,n,e){for(var o=t.dom,r=Ge(e);o.parentNode;){o=o.parentNode;var i=fe.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return S.none()},Ye=function(t,n,e){var o=n(t),r=Ge(e);return o.orThunk((function(){return r(t)?S.none():Xe(t,n,r)}))},qe=function(t,n){return je(t.element,n.event.target)},Ke=function(n){if(!It(n,"can")&&!It(n,"abort")&&!It(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Tn("Extracting event.handler",sn([te("can",c),te("abort",a),te("run",t)]),n)},Je=function(t){var n,e,o,r,i=(e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return Y(n,(function(n,o){return n&&e(o).apply(void 0,t)}),!0)}),u=(o=n=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Y(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)});return Ke({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];U(t,(function(t){t.run.apply(void 0,n)}))}})},$e=e,Qe=$e("touchstart"),Ze=$e("touchmove"),to=$e("touchend"),no=$e("touchcancel"),eo=$e("mousedown"),oo=$e("mousemove"),ro=$e("mouseout"),io=$e("mouseup"),uo=$e("mouseover"),ao=$e("focusin"),co=$e("focusout"),so=$e("keydown"),lo=$e("keyup"),fo=$e("input"),mo=$e("change"),go=$e("click"),po=$e("transitionend"),ho=$e("selectstart"),vo=function(t){return e("alloy."+t)},bo={tap:vo("tap")},yo=vo("focus"),xo=vo("blur.post"),wo=vo("paste.post"),So=vo("receive"),ko=vo("execute"),Co=vo("focus.item"),Oo=bo.tap,_o=vo("longpress"),To=vo("sandbox.close"),Eo=vo("typeahead.cancel"),Bo=vo("system.init"),Do=vo("system.touchmove"),Ao=vo("system.touchend"),Mo=vo("system.scroll"),Fo=vo("system.resize"),Io=vo("system.attached"),Ro=vo("system.detached"),Vo=vo("system.dismissRequested"),Po=vo("system.repositionRequested"),Ho=vo("focusmanager.shifted"),zo=vo("slotcontainer.visibility"),No=vo("change.tab"),Lo=vo("dismiss.tab"),jo=vo("highlight"),Uo=vo("dehighlight"),Wo=function(t,n){qo(t,t.element,n,{})},Go=function(t,n,e){qo(t,t.element,n,e)},Xo=function(t){Wo(t,ko())},Yo=function(t,n,e){qo(t,n,e,{})},qo=function(t,n,e,o){var r=l({target:n},o);t.getSystem().triggerEvent(e,n,r)},Ko=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Jo=Jt,$o=function(t,n){return{key:t,value:Ke({abort:n})}},Qo=function(t){return{key:t,value:Ke({run:function(t,n){n.event.prevent()}})}},Zo=function(t,n){return{key:t,value:Ke({run:n})}},tr=function(t,n,e){return{key:t,value:Ke({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},nr=function(t){return function(n){return{key:t,value:Ke({run:function(t,e){qe(t,e)&&n(t,e)}})}}},er=function(t,n,e){var o,r,i=n.partUids[e];return r=i,Zo(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){Ko(t,t.element,o,n)}))}))},or=function(t,n){return Zo(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold((function(){return Ye(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),a).getOr(t)}),(function(t){return t}));n(t,r,e)}))},rr=function(t){return Zo(t,(function(t,n){n.cut()}))},ir=function(t,n){return nr(t)(n)},ur=nr(Io()),ar=nr(Ro()),cr=nr(Bo()),sr=(lt=ko(),function(t){return Zo(lt,t)}),lr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),fr=function(t){return function(n){return n.dom.nodeType===t}},dr=fr(1),mr=fr(3),gr=fr(9),pr=fr(11),hr=function(t){return fe.fromDom(t.dom.ownerDocument)},vr=function(t){return gr(t)?t:hr(t)},br=function(t){return fe.fromDom(vr(t).dom.documentElement)},yr=function(t){return fe.fromDom(vr(t).dom.defaultView)},xr=function(t){return S.from(t.dom.parentNode).map(fe.fromDom)},wr=xr,Sr=function(t){return S.from(t.dom.offsetParent).map(fe.fromDom)},kr=function(t){return j(t.dom.childNodes,fe.fromDom)},Cr=function(t,n){var e=t.dom.childNodes;return S.from(e[n]).map(fe.fromDom)},Or=function(t,n){xr(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},_r=function(t,n){var e;(e=t,S.from(e.dom.nextSibling).map(fe.fromDom)).fold((function(){xr(t).each((function(t){Er(t,n)}))}),(function(t){Or(t,n)}))},Tr=function(t,n){Cr(t,0).fold((function(){Er(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Er=function(t,n){t.dom.appendChild(n.dom)},Br=function(t,n){U(n,(function(n){Er(t,n)}))},Dr=function(t){t.dom.textContent="",U(kr(t),(function(t){Ar(t)}))},Ar=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Mr=function(t){var n,e=kr(t);0<e.length&&(n=t,U(e,(function(t){Or(n,t)}))),Ar(t)},Fr=function(t){return t.dom.innerHTML},Ir=function(t,n){var e,o,r=hr(t).dom,i=fe.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,kr(fe.fromDom(o)));Br(i,u),Dr(t),Er(t,i)},Rr=function(t,n,e){if(!(O(e)||E(e)||M(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Vr=function(t,n,e){Rr(t.dom,n,e)},Pr=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},Hr=function(t,n){return S.from(Pr(t,n))},zr=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Nr=function(t,n){t.dom.removeAttribute(n)},Lr=function(t){return n=t,e=!1,fe.fromDom(n.dom.cloneNode(e));var n,e},jr=function(t){var n,e,o,r=Lr(t);return n=r,e=fe.fromTag("div"),o=fe.fromDom(n.dom.cloneNode(!0)),Er(e,o),Fr(e)},Ur=Jo([{key:yo(),value:Ke({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target;return o=u,!(je(e=i,t.element)&&!je(e,o))||(console.warn(yo()+" did not get interpreted by the desired target. \nOriginator: "+jr(i)+"\nTarget: "+jr(u)+"\nCheck the "+yo()+" event handlers"),!1)}})}]),Wr=Object.freeze({__proto__:null,events:Ur}),Gr=0,Xr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Gr+String(n)},Yr=e("alloy-id-"),qr=e("data-alloy-id"),Kr=Yr(),Jr=qr(),$r=function(t,n){Object.defineProperty(t.dom,Jr,{value:n,writable:!0})},Qr=function(t){var n=dr(t)?t.dom[Jr]:null;return S.from(n)},Zr=Xr,ti=o,ni=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+jr(t().element)+" is not in context.":""))}};return{debugInfo:e("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:a}},ei=ni(),oi=function(t){return j(t,(function(t){return o=n="/*",r=(e=t).length-n.length,""===o||e.length>=o.length&&e.substr(r,r+o.length)===o?t.substring(0,t.length-"/*".length):t;var n,e,o,r}))},ri=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:oi(i)}},t},ii=Xr("alloy-premade"),ui=function(t){return Kt(ii,t)},ai=function(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,d([n.getApis(),n],e))},e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:oi(i.slice(1))}},n;var n,e,o,r,i},ci={init:function(){return si({readState:function(){return"No State required"}})}},si=function(t){return t},li=function(t,n){var e={};return Ot(t,(function(t,o){Ot(t,(function(t,r){var i=Mt(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},fi=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},di=function(t,n){return{cHandler:r.apply(void 0,[t.handler].concat(n)),purpose:t.purpose}},mi=function(t){return t.cHandler},gi=function(t,n){return{name:t,handler:n}},pi=function(t,n,e){var o,r,i=l(l({},e),(o=t,r={},U(n,(function(t){r[t.name()]=t.handlers(o)})),r));return li(i,gi)},hi=function(t){var n,o=A(n=t)?{can:e(!0),abort:e(!1),run:n}:n;return function(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var i=[t,n].concat(e);o.abort.apply(void 0,i)?n.stop():o.can.apply(void 0,i)&&o.run.apply(void 0,i)}},vi=function(t,n,e){var o,r,i=n[e];return i?function(t,n,o,r){try{var i=nt(o,(function(e,o){var i=e[n],u=o[n],a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0}));return ct.value(i)}catch(e){return ct.error([e])}}("Event: "+e,"name",t,i).map((function(t){var n=j(t,(function(t){return t.handler}));return Je(n)})):(o=e,r=t,ct.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(j(r,(function(t){return t.name})),null,2)]))},bi=function(t,n){var e=Bt(t,(function(t,e){return(1===t.length?ct.value(t[0].handler):vi(t,n,e)).map((function(o){var r=hi(o),i=1<t.length?G(n[e],(function(n){return z(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return Kt(e,{handler:r,purpose:i})}))}));return $t(e,{})},yi="alloy.base.behaviour",xi=function(t){var n,o;return On("custom.definition",ln([vn("dom","dom",Ut(),ln([Nn("tag"),te("styles",{}),te("classes",[]),te("attributes",{}),qn("value"),qn("innerHtml")])),Nn("components"),Nn("uid"),te("events",{}),te("apis",{}),vn("eventOrder","eventOrder",((n={})[ko()]=["disabling",yi,"toggling","typeaheadevents"],n[yo()]=[yi,"focusing","keying"],n[Bo()]=[yi,"disabling","toggling","representing"],n[fo()]=[yi,"representing","streaming","invalidating"],n[Ro()]=[yi,"representing","item-events","tooltipping"],n[eo()]=["focusing",yi,"item-type-events"],n[Qe()]=["focusing",yi,"item-type-events"],n[uo()]=["item-type-events","tooltipping"],n[So()]=["receiving","reflecting","tooltipping"],o=n,Lt.mergeWithThunk(e(o))),An()),qn("domModification")]),t)},wi=function(t,n){var e=Pr(t,n);return void 0===e||""===e?[]:e.split(" ")},Si=function(t){return void 0!==t.dom.classList},ki=function(t,n){return r=n,i=wi(e=t,o="class").concat([r]),Vr(e,o,i.join(" ")),!0;var e,o,r,i},Ci=function(t,n){return r=n,0<(i=G(wi(e=t,o="class"),(function(t){return t!==r}))).length?Vr(e,o,i.join(" ")):Nr(e,o),!1;var e,o,r,i},Oi=function(t,n){Si(t)?t.dom.classList.add(n):ki(t,n)},_i=function(t){0===(Si(t)?t.dom.classList:wi(t,"class")).length&&Nr(t,"class")},Ti=function(t,n){Si(t)?t.dom.classList.remove(n):Ci(t,n),_i(t)},Ei=function(t,n){return Si(t)&&t.dom.classList.contains(n)},Bi=function(t,n){U(n,(function(n){Oi(t,n)}))},Di=function(t,n){U(n,(function(n){Ti(t,n)}))},Ai=function(t){return void 0!==t.style&&A(t.style.getPropertyValue)},Mi=function(t){return pr(t)},Fi=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),Ii=e(Fi),Ri=Fi?function(t){return fe.fromDom(t.dom.getRootNode())}:vr,Vi=function(t){return Mi(t)?t:fe.fromDom(vr(t).dom.body)},Pi=function(t){return fe.fromDom(t.dom.host)},Hi=function(t){return D(t.dom.shadowRoot)},zi=function(t){var n=mr(t)?t.dom.parentNode:t.dom;if(void 0===n||null===n||null===n.ownerDocument)return!1;var e,o,r,i,u=n.ownerDocument;return r=fe.fromDom(n),i=Ri(r),(Mi(i)?S.some(i):S.none()).fold((function(){return u.body.contains(n)}),(e=zi,o=Pi,function(t){return e(o(t))}))},Ni=function(){return Li(fe.fromDom(document))},Li=function(t){var n=t.dom.body;if(null===n||void 0===n)throw new Error("Body is not available yet");return fe.fromDom(n)},ji=function(t,n,e){if(!O(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Ai(t)&&t.style.setProperty(n,e)},Ui=function(t,n){Ai(t)&&t.style.removeProperty(n)},Wi=function(t,n,e){var o=t.dom;ji(o,n,e)},Gi=function(t,n){var e=t.dom;Ot(n,(function(t,n){ji(e,n,t)}))},Xi=function(t,n){var e=t.dom;Ot(n,(function(t,n){t.fold((function(){Ui(e,n)}),(function(t){ji(e,n,t)}))}))},Yi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||zi(t)?o:qi(e,n)},qi=function(t,n){return Ai(t)?t.style.getPropertyValue(n):""},Ki=function(t,n){var e=t.dom,o=qi(e,n);return S.from(o).filter((function(t){return 0<t.length}))},Ji=function(t,n,e){var o=fe.fromTag(t);return Wi(o,n,e),Ki(o,n).isSome()},$i=function(t,n){var e=t.dom;Ui(e,n),Hr(t,"style").map(xe).is("")&&Nr(t,"style")},Qi=function(t){return t.dom.offsetWidth},Zi=function(t){return t.dom.value},tu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},nu=function(t){var n,e,o,r=fe.fromTag(t.tag);n=r,e=t.attributes,o=n.dom,Ot(e,(function(t,n){Rr(o,n,t)})),Bi(r,t.classes),Gi(r,t.styles),t.innerHtml.each((function(t){return Ir(r,t)}));var i=t.domChildren;return Br(r,i),t.value.each((function(t){tu(r,t)})),t.uid,$r(r,t.uid),r},eu=function(t,n){return e=t,r=j(o=n,(function(t){return Zn(t.name(),[Nn("config"),te("state",ci)])})),i=On("component.behaviours",ln(r),e.behaviours).fold((function(t){throw new Error(En(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),(function(t){return t})),{list:o,data:_t(i,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))};var e,o,r,i},ou=function(t){var n,e,o=(n=Mt(t,"behaviours").getOr({}),e=G(kt(n),(function(t){return void 0!==n[t]})),j(e,(function(t){return n[t].me})));return eu(t,o)},ru=function(t,n,e){var o,r,i,u=l(l({},(o=t).dom),{uid:o.uid,domChildren:j(o.components,(function(t){return t.element}))}),a=t.domModification.fold((function(){return fi({})}),fi),c={"alloy.base.modification":a},s=0<n.length?function(t,n,e,o){var r=l({},n);U(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=li(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return X(t,(function(t,n){return l(l({},n.modification),t)}),{})},a=X(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return fi({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,l(l({},r=u),{attributes:l(l({},r.attributes),i.attributes),styles:l(l({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},iu=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return o=e,r=t.eventOrder,i=pi(o,n,u),bi(i,r).getOrDie()},uu=function(t){var n,e,o,r,i,u,a,c,s,d,m,g,p,h=ti(t),v=h.events,b=f(h,["events"]),y=(n=Mt(b,"components").getOr([]),j(n,lu)),x=l(l({},b),{events:l(l({},Wr),v),components:y});return ct.value((o=function(){return p},r=se(ei),i=_n(xi(e=x)),u=ou(e),a=u.list,c=u.data,s=ru(i,a,c),d=nu(s),m=iu(i,a,c),g=se(i.components),p={getSystem:r.get,config:function(t){var n=c;return(A(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return A(c[t.name()])},spec:e,readState:function(t){return c[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return i.apis},connect:function(t){r.set(t)},disconnect:function(){r.set(ni(o))},element:d,syncComponents:function(){var t=kr(d),n=$(t,(function(t){return r.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));g.set(n)},components:g.get,events:m}))},au=function(t){var n=fe.fromText(t);return cu({element:n})},cu=function(n){var o=Tn("external.component",sn([Nn("element"),qn("uid")]),n),r=se(ni());o.uid.each((function(t){$r(o.element,t)}));var i={getSystem:r.get,config:S.none,hasConfigured:a,connect:function(t){r.set(t)},disconnect:function(){r.set(ni((function(){return i})))},getApis:function(){return{}},element:o.element,spec:n,readState:e("No state"),syncComponents:t,components:e([]),events:{}};return ui(i)},su=Zr,lu=function(t){return Mt(t,ii).fold((function(){var n=t.hasOwnProperty("uid")?t:l({uid:su("")},t);return uu(n).getOrDie()}),(function(t){return t}))},fu=ui;function du(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Yi(e,t);return parseFloat(r)||0}return o},o=function(t,n){return Y(n,(function(n,e){var o=Yi(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!M(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Ai(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}}var mu=du("height",(function(t){var n=t.dom;return zi(t)?n.getBoundingClientRect().height:n.offsetHeight})),gu=function(t){return mu.get(t)},pu=function(t){return mu.getOuter(t)},hu=function(t,n){return{left:t,top:n,translate:function(e,o){return hu(t+e,n+o)}}},vu=hu,bu=function(t,n){return void 0!==t?t:void 0!==n?n:0},yu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return vu(e.offsetLeft,e.offsetTop);var i=bu(null==o?void 0:o.pageYOffset,r.scrollTop),u=bu(null==o?void 0:o.pageXOffset,r.scrollLeft),a=bu(r.clientTop,e.clientTop),c=bu(r.clientLeft,e.clientLeft);return xu(t).translate(u-c,i-a)},xu=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?vu(o.offsetLeft,o.offsetTop):zi(t)?(n=e.getBoundingClientRect(),vu(n.left,n.top)):vu(0,0)},wu=du("width",(function(t){return t.dom.offsetWidth})),Su=function(t){return wu.get(t)},ku=function(t){return wu.getOuter(t)},Cu=function(t){var e=fe.fromDom(function(t){if(Ii()&&D(t.target)){var n=fe.fromDom(t.target);if(dr(n)&&Hi(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return et(e)}}return S.from(t.target)}(t).getOr(t.target)),o=function(){return t.stopPropagation()},r=function(){return t.preventDefault()},i=n(r,o);return{target:e,x:t.clientX,y:t.clientY,stop:o,prevent:r,kill:i,raw:t}},Ou=function(t,n,e,o,i){var u,a,c=(u=e,a=o,function(t){u(t)&&a(Cu(t))});return t.dom.addEventListener(n,c,i),{unbind:r(_u,t,n,c,i)}},_u=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Tu=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return vu(e,o)},Eu=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},Bu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Du=function(t){var n,e,o=void 0===t?window:t,r=o.document,i=Tu(fe.fromDom(r));return e=void 0===(n=o)?window:n,S.from(e.visualViewport).fold((function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight;return Bu(i.left,i.top,n,e)}),(function(t){return Bu(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)}))},Au=function(t,n){return t.view(n).fold(e([]),(function(n){var e=t.owner(n),o=Au(t,e);return[n].concat(o)}))},Mu=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?S.none():S.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(fe.fromDom)},owner:hr}),Fu=function(t){var n,e,o,i,u=fe.fromDom(document),a=Tu(u);return(n=t,o=(e=Mu).owner(n),i=Au(e,o),S.some(i)).fold(r(yu,t),(function(n){var e=xu(t),o=X(n,(function(t,n){var e=xu(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return vu(o.left+e.left+a.left,o.top+e.top+a.top)}))},Iu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Ru=function(t){var n=yu(t),e=ku(t),o=pu(t);return Iu(n.left,n.top,e,o)},Vu=function(t){var n=Fu(t),e=ku(t),o=pu(t);return Iu(n.left,n.top,e,o)},Pu=function(){return Du(window)};function Hu(t,n,e,o,r){return t(e,o)?S.some(e):A(r)&&r(e)?S.none():n(e,o,r)}var zu,Nu,Lu=function(t,n,e){for(var o=t.dom,r=A(e)?e:a;o.parentNode;){o=o.parentNode;var i=fe.fromDom(o);if(n(i))return S.some(i);if(r(i))break}return S.none()},ju=function(t,n,e){return Hu((function(t,n){return n(t)}),Lu,t,n,e)},Uu=function(t,n,e){return ju(t,n,e).isSome()},Wu=function(t,n,e){return Lu(t,(function(t){return Ne(t,n)}),e)},Gu=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Le(r)?S.none():S.from(r.querySelector(e)).map(fe.fromDom);var e,o,r},Xu=function(t,n,e){return Hu(Ne,Wu,t,n,e)},Yu=function(){var t=Xr("aria-owns");return{id:t,link:function(n){Vr(n,"aria-owns",t)},unlink:function(t){Nr(t,"aria-owns")}}},qu=function(t,n){return ju(n,(function(t){if(!dr(t))return!1;var n=Pr(t,"id");return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Pr(t,"id"),e=Ri(t);return Gu(e,'[aria-owns="'+n+'"]')})).exists((function(n){return Ku(t,n)}))},Ku=function(t,n){return Uu(n,(function(n){return je(n,t.element)}),a)||qu(t,n)},Ju="unknown";(Nu=zu=zu||{})[Nu.STOP=0]="STOP",Nu[Nu.NORMAL=1]="NORMAL",Nu[Nu.LOGGING=2]="LOGGING";var $u,Qu,Zu=se({}),ta=["alloy/data/Fields","alloy/debugging/Debugging"],na=function(t,n,e){var o,r,i,u;switch(Mt(Zu.get(),t).orThunk((function(){var n=kt(Zu.get());return it(n,(function(n){return-1<t.indexOf(n)?S.some(Zu.get()[n]):S.none()}))})).getOr(zu.NORMAL)){case zu.NORMAL:return e(ea());case zu.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();H(["mousemove","mouseover","mouseout",Bo()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:j(i,(function(t){return H(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+jr(t.target)+")":t.outcome}))})}}),c=e(a);return a.write(),c;case zu.STOP:return!0}},ea=e({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),oa=e([Nn("menu"),Nn("selectedMenu")]),ra=e([Nn("item"),Nn("selectedItem")]),ia=(e(ln(ra().concat(oa()))),e(ln(ra()))),ua=Gn("initSize",[Nn("numColumns"),Nn("numRows")]),aa=function(){return Gn("markers",[Nn("backgroundMenu")].concat(oa()).concat(ra()))},ca=function(t){return Gn("markers",j(t,Nn))},sa=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");q(n,(function(t){return 0<t.indexOf("alloy")&&!z(ta,(function(n){return-1<t.indexOf(n)}))})).getOr(Ju)}}(),vn(n,n,e,kn((function(t){return ct.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},la=function(n){return sa(0,n,jt(t))},fa=function(t){return sa(0,t,jt(S.none))},da=function(t){return sa(0,t,Ut())},ma=function(t){return sa(0,t,Ut())},ga=function(t,n){return ce(t,e(n))},pa=function(t){return ce(t,o)},ha=e(ua),va=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},ba=Rt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ya=ba.southeast,xa=ba.southwest,wa=ba.northeast,Sa=ba.northwest,ka=ba.south,Ca=ba.north,Oa=ba.east,_a=ba.west,Ta=function(t,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],(function(e){return Mt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},Ea=function(t){return t.x},Ba=function(t,n){return t.x+t.width/2-n.width/2},Da=function(t,n){return t.x+t.width-n.width},Aa=function(t,n){return t.y-n.height},Ma=function(t){return t.y+t.height},Fa=function(t,n){return t.y+t.height/2-n.height/2},Ia=function(t,n,e){return va(Ea(t),Ma(t),e.southeast(),ya(),Ta(t,{left:1,top:3}),"layout-se")},Ra=function(t,n,e){return va(Da(t,n),Ma(t),e.southwest(),xa(),Ta(t,{right:0,top:3}),"layout-sw")},Va=function(t,n,e){return va(Ea(t),Aa(t,n),e.northeast(),wa(),Ta(t,{left:1,bottom:2}),"layout-ne")},Pa=function(t,n,e){return va(Da(t,n),Aa(t,n),e.northwest(),Sa(),Ta(t,{right:0,bottom:2}),"layout-nw")},Ha=function(t,n,e){return va(Ba(t,n),Aa(t,n),e.north(),Ca(),Ta(t,{bottom:2}),"layout-n")},za=function(t,n,e){return va(Ba(t,n),Ma(t),e.south(),ka(),Ta(t,{top:3}),"layout-s")},Na=function(t,n,e){return va((o=t).x+o.width,Fa(t,n),e.east(),Oa(),Ta(t,{left:0}),"layout-e");var o},La=function(t,n,e){return va((o=n,t.x-o.width),Fa(t,n),e.west(),_a(),Ta(t,{right:1}),"layout-w");var o},ja=function(){return[Ia,Ra,Va,Pa,za,Ha,Na,La]},Ua=function(){return[Ra,Ia,Pa,Va,za,Ha,Na,La]},Wa=function(){return[Va,Pa,Ia,Ra,Ha,za]},Ga=function(){return[Pa,Va,Ra,Ia,Ha,za]},Xa=function(){return[Ia,Ra,Va,Pa,za,Ha]},Ya=function(){return[Ra,Ia,Pa,Va,za,Ha]},qa=Object.freeze({__proto__:null,events:function(t){return Jo([Zo(So(),(function(n,e){var o,r,i=t.channels,u=kt(i),a=e,c=(o=u,(r=a).universal?o:G(o,(function(t){return H(r.channels,t)})));U(c,(function(t){var e=i[t],o=e.schema,r=Tn("channel["+t+"] data\nReceiver: "+jr(n.element),o,a.data);e.onReceive(n,r)}))}))])}}),Ka=[Ln("channels",Cn(ct.value,sn([da("onReceive"),te("schema",An())])))],Ja=function(t,n,e){return cr((function(o,r){e(o,t,n)}))},$a=function(t,n,e,o,r,i){var u=sn(t),a=Zn(n,[Kn("config",sn(t))]);return tc(u,a,n,e,o,r,i)},Qa=function(t,n,o){var r,i,u,a,c,s;return r=function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[r].concat(i);return r.config({name:e(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+o)}),(function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[r,t.config,t.state].concat(e))}))},i=o,u=n.toString(),a=u.indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:i,parameters:oi(s.slice(0,1).concat(s.slice(3)))}},r},Za=function(t){return{key:t,value:void 0}},tc=function(t,n,e,o,i,u,a){var c=function(t){return It(t,e)?t[e]():S.none()},s=_t(i,(function(t,n){return Qa(e,t,n)})),f=_t(u,ri),d=l(l(l({},f),s),{revoke:r(Za,e),config:function(n){var o=Tn(e+"-config",t,n);return{key:e,value:{config:o,me:d,configAsRaw:Nt((function(){return Tn(e+"-config",t,n)})),initialConfig:n,state:a}}},schema:function(){return n},exhibit:function(t,n){return c(t).bind((function(t){return Mt(o,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(fi({}))},name:function(){return e},handlers:function(t){return c(t).map((function(t){return Mt(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return d},nc=Jt,ec=sn([Nn("fields"),Nn("name"),te("active",{}),te("apis",{}),te("state",ci),te("extra",{})]),oc=function(t){var n=Tn("Creating behaviour: "+t.name,ec,t);return $a(n.fields,n.name,n.active,n.apis,n.extra,n.state)},rc=sn([Nn("branchKey"),Nn("branches"),Nn("name"),te("active",{}),te("apis",{}),te("state",ci),te("extra",{})]),ic=function(t){var n,e,o,r,i,u,a,c,s=Tn("Creating behaviour: "+t.name,rc,t);return n=Dn(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=Zn(e,[Kn("config",a=n)]),tc(a,c,e,o,r,i,u)},uc=e(void 0),ac=oc({fields:Ka,name:"receiving",active:qa}),cc=Object.freeze({__proto__:null,exhibit:function(t,n){return fi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),sc=function(t){return t.dom.focus()},lc=function(t){return void 0===t&&(t=fe.fromDom(document)),S.from(t.dom.activeElement).map(fe.fromDom)},fc=function(t){return lc(Ri(t)).filter((function(n){return t.dom.contains(n.dom)}))},dc=function(n,e){var o=Ri(e),r=lc(o).bind((function(t){var n,o,r=function(n){return je(t,n)};return r(e)?S.some(e):(n=r,(o=function(t){for(var e=0;e<t.childNodes.length;e++){var r=fe.fromDom(t.childNodes[e]);if(n(r))return S.some(r);var i=o(t.childNodes[e]);if(i.isSome())return i}return S.none()})(e.dom))})),i=n(e);return r.each((function(n){lc(o).filter((function(t){return je(t,n)})).fold((function(){sc(n)}),t)})),i},mc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},gc=function(t,n){var e=function(t){return t+"px"};Xi(t,{position:S.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},pc=Rt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),hc=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=n.x-e,h=n.y-o,v=r-(p+n.width),b=i-(h+n.height),y=S.some(p),x=S.some(h),w=S.some(v),k=S.some(b),C=S.none();return u=n.direction,a=function(){return mc(t,y,x,C,C)},c=function(){return mc(t,C,x,w,C)},s=function(){return mc(t,y,C,C,k)},l=function(){return mc(t,C,C,w,k)},f=function(){return mc(t,y,x,C,C)},d=function(){return mc(t,y,C,C,k)},m=function(){return mc(t,y,x,C,C)},g=function(){return mc(t,C,x,w,C)},u.fold(a,c,s,l,f,d,m,g)},vc=function(t,n){var e=r(Fu,n),o=t.fold(e,e,(function(){var t=Tu();return Fu(n).translate(-t.left,-t.top)})),i=ku(n),u=pu(n);return Iu(o.left,o.top,i,u)},bc=function(t,n,o){var r=vu(n,o);return t.fold(e(r),e(r),(function(){var t=Tu();return r.translate(-t.left,-t.top)}))},yc=(pc.none,pc.relative),xc=pc.fixed,wc=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},Sc=function(t,n,e){return Math.min(Math.max(t,n),e)},kc=Rt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Cc=function(t,n,r,i){var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,k,C,O,_,T,E,B,D,A,M,F,I,R,V,P,H,z,N=t.x,L=t.y,j=t.bubble.offset,U=j.left,W=j.top,G=(u=i,a=t.boundsRestriction,c=j,l=(s=function(t,n){var e="top"===t||"bottom"===t?c.top:c.left;return Mt(a,t).bind(o).bind((function(e){return"left"===t||"top"===t?n<=e?S.some(e):S.none():e<=n?S.some(e):S.none()})).map((function(t){return t+e})).getOr(n)})("left",u.x),f=s("top",u.y),d=s("right",u.right),m=s("bottom",u.bottom),Iu(l,f,d-l,m-f)),X=G.y,Y=G.bottom,q=G.x,K=G.right,J=L+W,$=(g=N+U,p=J,h=n,v=r,y=(b=G).x,x=b.y,w=b.width,k=b.height,O=x<=p,_=(C=y<=g)&&O,T=g+h<=y+w&&p+v<=x+k,E=Math.abs(Math.min(h,C?y+w-g:y-(g+h))),B=Math.abs(Math.min(v,O?x+k-p:x-(p+v))),D=Math.max(b.x,b.right-h),A=Math.max(b.y,b.bottom-v),{originInBounds:_,sizeInBounds:T,limitX:Sc(g,b.x,D),limitY:Sc(p,b.y,A),deltaW:E,deltaH:B}),Q=$.originInBounds,Z=$.sizeInBounds,tt=$.limitX,nt=$.limitY,et=$.deltaW,ot=$.deltaH,rt=e(nt+ot-X),it=e(Y-nt),ut=(M=t.direction,I=F=it,R=rt,M.fold(F,F,R,R,F,R,I,I)),at=e(tt+et-q),ct=e(K-tt),st={x:tt,y:nt,width:et,height:ot,maxHeight:ut,maxWidth:(V=t.direction,H=P=ct,z=at,V.fold(P,z,P,z,H,H,P,z)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:J};return Q&&Z?kc.fit(st):kc.nofit(st,et,ot)},Oc=function(t,n,e,i){$i(n,"max-height"),$i(n,"max-width");var u,a,c,s,l,f,d,m,g,p={width:ku(u=n),height:pu(u)};return a=i.preference,c=t,s=p,l=e,f=i.bounds,d=s.width,m=s.height,g=function(t,n,e,o){var r=t(c,s,l);return Cc(r,d,m,f).fold(kc.fit,(function(t,r,i){return o<i||e<r?kc.nofit(t,r,i):kc.nofit(n,e,o)}))},Y(a,(function(t,n){var e=r(g,n);return t.fold(kc.fit,e)}),kc.nofit({x:c.x,y:c.y,width:s.width,height:s.height,maxHeight:s.height,maxWidth:s.width,direction:ya(),classes:{on:[],off:[]},label:"none",candidateYforTest:c.y},-1,-1)).fold(o,o)},_c=function(t,n,e){var o,r;gc(t,(o=e.origin,r=n,o.fold((function(){return mc("absolute",S.some(r.x),S.some(r.y),S.none(),S.none())}),(function(t,n,e,o){return hc("absolute",r,t,n,e,o)}),(function(t,n,e,o){return hc("fixed",r,t,n,e,o)}))))},Tc=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=mu.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Wi(e,"max-height",r+"px")},Ec=e((function(t,n){Tc(t,n),Gi(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Bc=e((function(t,n){Tc(t,n)})),Dc=function(t,n,e){return void 0===t[n]?e:t[n]},Ac=function(n,e,o,r,i,u){var a,c=Dc(u,"maxHeightFunction",Ec()),s=Dc(u,"maxWidthFunction",t),l=n.anchorBox,f=n.origin,d={bounds:(a=f,i.fold((function(){return a.fold(Pu,Pu,Iu)}),(function(t){return a.fold(t,t,(function(){var n=t(),e=bc(a,n.x,n.y);return Iu(e.left,e.top,n.width,n.height)}))}))),origin:f,preference:r,maxHeightFunction:c,maxWidthFunction:s};Mc(l,e,o,d)},Mc=function(t,n,e,o){var r,i,u,a,c,s,l=Oc(t,n,e,o);_c(n,l,o),r=n,i=l.classes,Di(r,i.off),Bi(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},Fc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ic=function(t,n,e){var o=function(t){return Mt(e,t).getOr([])},r=function(t,n,e){var r=tt(Fc,e);return{offset:vu(t,n),classesOn:$(e,o),classesOff:$(r,o)}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},Rc=function(){return Ic(0,0,{})},Vc=function(t,n){return function(e){return"rtl"===Pc(e)?n:t}},Pc=function(t){return"rtl"===Yi(t,"direction")?"rtl":"ltr"};(Qu=$u=$u||{}).TopToBottom="toptobottom",Qu.BottomToTop="bottomtotop";var Hc="data-alloy-vertical-dir",zc=function(t){return Uu(t,(function(t){return dr(t)&&Pr(t,"data-alloy-vertical-dir")===$u.BottomToTop}))},Nc=function(){return Zn("layouts",[Nn("onLtr"),Nn("onRtl"),qn("onBottomLtr"),qn("onBottomRtl")])},Lc=function(t,n,e,o,r,i,u){var a=u.map(zc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),l=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),f=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return Vc(l,f)(t)},jc=[Nn("hotspot"),qn("bubble"),te("overrides",{}),Nc(),ga("placement",(function(t,n,e){var o=n.hotspot,r=vc(e,o.element),i=Lc(t.element,n,Xa(),Ya(),Wa(),Ga(),S.some(n.hotspot.element));return S.some({anchorBox:r,bubble:n.bubble.getOr(Rc()),overrides:n.overrides,layouts:i,placer:S.none()})}))],Uc=[Nn("x"),Nn("y"),te("height",0),te("width",0),te("bubble",Rc()),te("overrides",{}),Nc(),ga("placement",(function(t,n,e){var o=bc(e,n.x,n.y),r=Iu(o.left,o.top,n.width,n.height),i=Lc(t.element,n,ja(),Ua(),ja(),Ua(),S.none());return S.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:S.none()})}))],Wc=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Gc=Rt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Xc=(Gc.before,Gc.on,Gc.after,function(t){return t.fold(o,o,o)}),Yc=Rt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),qc={domRange:Yc.domRange,relative:Yc.relative,exact:Yc.exact,exactFromRange:function(t){return Yc.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return fe.fromDom(t.startContainer)},relative:function(t,n){return Xc(t)},exact:function(t,n,e,o){return t}});return yr(n)},range:Wc},Kc=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),r=i,e.fold((function(t){r.setEndBefore(t.dom)}),(function(t,n){r.setEnd(t.dom,n)}),(function(t){r.setEndAfter(t.dom)})),i},Jc=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},$c=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Qc=Rt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Zc=function(t,n,e){return n(fe.fromDom(e.startContainer),e.startOffset,fe.fromDom(e.endContainer),e.endOffset)},ts=function(t,n){var o,r,i,u=(o=t,n.match({domRange:function(t){return{ltr:e(t),rtl:S.none}},relative:function(t,n){return{ltr:Nt((function(){return Kc(o,t,n)})),rtl:Nt((function(){return S.some(Kc(o,n,t))}))}},exact:function(t,n,e,r){return{ltr:Nt((function(){return Jc(o,t,n,e,r)})),rtl:Nt((function(){return S.some(Jc(o,e,r,t,n))}))}}}));return(i=(r=u).ltr()).collapsed?r.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Qc.rtl(fe.fromDom(t.endContainer),t.endOffset,fe.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Zc(0,Qc.ltr,i)})):Zc(0,Qc.ltr,i)};Qc.ltr,Qc.rtl;var ns,es,os,rs,is,us=(ns=mr,es="text",{get:function(t){if(!ns(t))throw new Error("Can only get "+es+" value of a "+es+" node");return os(t).getOr("")},getOption:os=function(t){return ns(t)?S.from(t.dom.nodeValue):S.none()},set:function(t,n){if(!ns(t))throw new Error("Can only set raw "+es+" value of a "+es+" node");t.dom.nodeValue=n}}),as=function(t){return us.getOption(t)},cs=["img","br"],ss=function(t){return as(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")})).isSome()||H(cs,lr(t))},ls=function(t,n){var e=function(t){for(var o=kr(t),r=o.length-1;0<=r;r--){var i=o[r];if(n(i))return S.some(i);var u=e(i);if(u.isSome())return u}return S.none()};return e(t)},fs=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Le(r)?[]:j(r.querySelectorAll(e),fe.fromDom);var e,o,r},ds=function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=hr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=je(t,e)&&n===o;return s.collapsed&&!l},ms=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return S.some(Wc(fe.fromDom(n.startContainer),n.startOffset,fe.fromDom(e.endContainer),e.endOffset))}return S.none()},gs=function(t){if(null===t.anchorNode||null===t.focusNode)return ms(t);var n=fe.fromDom(t.anchorNode),e=fe.fromDom(t.focusNode);return ds(n,t.anchorOffset,e,t.focusOffset)?S.some(Wc(n,t.anchorOffset,e,t.focusOffset)):ms(t)},ps=function(t){return n=t,S.from(n.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(gs);var n},hs=function(t,n){var e,o,r,i,u=ts(e=t,n).match({ltr:function(t,n,o,r){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(o.dom,r),i},rtl:function(t,n,o,r){var i=e.document.createRange();return i.setStart(o.dom,r),i.setEnd(t.dom,n),i}});return r=(o=u).getClientRects(),0<(i=0<r.length?r[0]:o.getBoundingClientRect()).width||0<i.height?S.some(i).map($c):S.none()},vs=function(t,n){return{element:t,offset:n}},bs=function(t,n){var e=kr(t);if(0===e.length)return vs(t,n);if(n<e.length)return vs(e[n],0);var o,r=e[e.length-1],i=mr(r)?(o=r,us.get(o).length):kr(r).length;return vs(r,i)},ys=Rt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),xs=function(t){return t.fold(o,(function(t,n,e){return t.translate(-n,-e)}))},ws=function(t){return t.fold(o,o)},Ss=function(t){return Y(t,(function(t,n){return t.translate(n.left,n.top)}),vu(0,0))},ks=function(t){var n=j(t,ws);return Ss(n)},Cs=ys.screen,Os=ys.absolute,_s=function(t,n,e){var o,r,i=hr(t.element),u=Tu(i),a=(o=t,r=yr(e.root).dom,S.from(r.frameElement).map(fe.fromDom).filter((function(t){var n=hr(t),e=hr(o.element);return je(n,e)})).map(yu).getOr(u));return Os(a,u.left,u.top)},Ts=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=Cs(vu(r,i));return S.some({point:c,width:u,height:a})},Es=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return ks(c)},u=function(){return ks(c)},a=function(){return t=j(c,xs),Ss(t);var t},o.fold(i,u,a)),l={x:s.left,y:s.top,width:t.width,height:t.height},f=(e.showAbove?Wa:Xa)(),d=(e.showAbove?Ga:Ya)(),m=Lc(r,e,f,d,f,d,S.none());return{anchorBox:l,bubble:e.bubble.getOr(Rc()),overrides:e.overrides,layouts:m,placer:S.none()}}))},Bs=function(t,n){return mr(t)?{element:t,offset:n}:bs(t,n)},Ds=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return ps(t)}}))().map((function(t){var n=Bs(t.start,t.soffset),e=Bs(t.finish,t.foffset);return qc.range(n.element,n.offset,e.element,e.offset)}))},As=[qn("getSelection"),Nn("root"),qn("bubble"),Nc(),te("overrides",{}),te("showAbove",!1),ga("placement",(function(t,n,e){var o=yr(n.root).dom,r=_s(t,0,n),i=Ds(o,n).bind((function(t){return hs(o,qc.exactFromRange(t)).orThunk((function(){var n=fe.fromText("\ufeff");return Or(t.start,n),hs(o,qc.exact(n,0,n,1)).map((function(t){return Ar(n),t}))})).bind((function(t){return Ts(t.left,t.top,t.width,t.height)}))})),u=Ds(o,n).bind((function(t){return dr(t.start)?S.some(t.start):wr(t.start)})).getOr(t.element);return Es(i,r,n,e,u)}))],Ms=[Nn("node"),Nn("root"),qn("bubble"),Nc(),te("overrides",{}),te("showAbove",!1),ga("placement",(function(t,n,e){var o=_s(t,0,n);return n.node.bind((function(r){var i=r.dom.getBoundingClientRect(),u=Ts(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Es(u,o,n,e,a)}))}))],Fs=function(t){return t.x+t.width},Is=function(t,n){return t.x-n.width},Rs=function(t,n){return t.y-n.height+t.height},Vs=function(t){return t.y},Ps=function(t,n,e){return va(Fs(t),Vs(t),e.southeast(),ya(),Ta(t,{left:0,top:2}),"link-layout-se")},Hs=function(t,n,e){return va(Is(t,n),Vs(t),e.southwest(),xa(),Ta(t,{right:1,top:2}),"link-layout-sw")},zs=function(t,n,e){return va(Fs(t),Rs(t,n),e.northeast(),wa(),Ta(t,{left:0,bottom:3}),"link-layout-ne")},Ns=function(t,n,e){return va(Is(t,n),Rs(t,n),e.northwest(),Sa(),Ta(t,{right:1,bottom:3}),"link-layout-nw")},Ls=function(){return[Ps,Hs,zs,Ns]},js=function(){return[Hs,Ps,Ns,zs]},Us=[Nn("item"),Nc(),te("overrides",{}),ga("placement",(function(t,n,e){var o=vc(e,n.item.element),r=Lc(t.element,n,Ls(),js(),Ls(),js(),S.none());return S.some({anchorBox:o,bubble:Rc(),overrides:n.overrides,layouts:r,placer:S.none()})}))],Ws=Dn("anchor",{selection:As,node:Ms,hotspot:jc,submenu:Us,makeshift:Uc}),Gs=function(t,n,e,o,r){var i={anchorBox:e.anchorBox,origin:n};Ac(i,r.element,e.bubble,e.layouts,o,e.overrides)},Xs=function(t,n,e,o,r,i){var u=i.map(Ru);return Ys(t,n,e,o,r,u)},Ys=function(t,n,o,r,i,u){var a=Tn("positioning anchor.info",Ws,r);dc((function(){Wi(i.element,"position","fixed");var o=Ki(i.element,"visibility");Wi(i.element,"visibility","hidden");var r,c,s,l,f=n.useFixed()?(l=document.documentElement,xc(0,0,l.clientWidth,l.clientHeight)):(c=yu((r=t).element),s=r.element.dom.getBoundingClientRect(),yc(c.left,c.top,s.width,s.height)),d=a.placement,m=u.map(e).or(n.getBounds);d(t,a,f).each((function(n){n.placer.getOr(Gs)(t,f,n,m,i)})),o.fold((function(){$i(i.element,"visibility")}),(function(t){Wi(i.element,"visibility",t)})),Ki(i.element,"left").isNone()&&Ki(i.element,"top").isNone()&&Ki(i.element,"right").isNone()&&Ki(i.element,"bottom").isNone()&&Ki(i.element,"position").is("fixed")&&$i(i.element,"position")}),i.element)},qs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Xs(t,n,e,o,r,S.none())},positionWithin:Xs,positionWithinBounds:Ys,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),Ks=[te("useFixed",a),qn("getBounds")],Js=oc({fields:Ks,name:"positioning",active:cc,apis:qs}),$s=function(t){Wo(t,Ro());var n=t.components();U(n,$s)},Qs=function(t){var n=t.components();U(n,Qs),Wo(t,Io())},Zs=function(t,n){Er(t.element,n.element)},tl=function(t,n){var e,o=t.components();U((e=t).components(),(function(t){return Ar(t.element)})),Dr(e.element),e.syncComponents();var r=tt(o,n);U(r,(function(n){$s(n),t.getSystem().removeFromWorld(n)})),U(n,(function(n){n.getSystem().isConnected()?Zs(t,n):(t.getSystem().addToWorld(n),Zs(t,n),zi(t.element)&&Qs(n)),t.syncComponents()}))},nl=function(t,n){el(t,n,Er)},el=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),zi(t.element)&&Qs(n),t.syncComponents()},ol=function(t){$s(t),Ar(t.element),t.getSystem().removeFromWorld(t)},rl=function(t){var n=xr(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));ol(t),n.each((function(t){t.syncComponents()}))},il=function(t){var n=t.components();U(n,ol),Dr(t.element),t.syncComponents()},ul=function(t,n){al(t,n,Er)},al=function(t,n,e){e(t,n.element);var o=kr(n.element);U(o,(function(t){n.getByDom(t).each(Qs)}))},cl=function(t){var n=kr(t.element);U(n,(function(n){t.getByDom(n).each($s)})),Ar(t.element)},sl=function(t,n,e,o){e.get().each((function(n){il(t)}));var r=n.getAttachPoint(t);nl(r,t);var i=t.getSystem().build(o);return nl(t,i),e.set(i),i},ll=function(t,n,e,o){var r=sl(t,n,e,o);return n.onOpen(t,r),r},fl=function(t,n,e){e.get().each((function(o){il(t),rl(t),n.onClose(t,o),e.clear()}))},dl=function(t,n,e){return e.isOpen()},ml=function(t,n,e){var o,r,i,u,a=n.getAttachPoint(t);Wi(t.element,"position",Js.getMode(a)),o=t,r="visibility",i=n.cloakVisibilityAttr,u="hidden",Ki(o.element,r).fold((function(){Nr(o.element,i)}),(function(t){Vr(o.element,i,t)})),Wi(o.element,r,u)},gl=function(t,n,e){var o,r,i,u;o=t.element,z(["top","left","right","bottom"],(function(t){return Ki(o,t).isSome()}))||$i(t.element,"position"),r=t,i="visibility",u=n.cloakVisibilityAttr,Hr(r.element,u).fold((function(){return $i(r.element,i)}),(function(t){return Wi(r.element,i,t)}))},pl=Object.freeze({__proto__:null,cloak:ml,decloak:gl,open:ll,openWhileCloaked:function(t,n,e,o,r){ml(t,n),ll(t,n,e,o),r(),gl(t,n)},close:fl,isOpen:dl,isPartOf:function(t,n,e,o){return dl(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return sl(t,n,e,o)}))}}),hl=Object.freeze({__proto__:null,events:function(t,n){return Jo([Zo(To(),(function(e,o){fl(e,t,n)}))])}}),vl=[la("onOpen"),la("onClose"),Nn("isPartOf"),Nn("getAttachPoint"),te("cloakVisibilityAttr","data-precloak-visibility")],bl=oc({fields:vl,name:"sandboxing",active:hl,apis:pl,state:Object.freeze({__proto__:null,init:function(){var t=se(S.none()),n=e("not-implemented");return si({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(S.none())},set:function(n){t.set(S.some(n))},get:function(){return t.get()}})}})}),yl=e("dismiss.popups"),xl=e("reposition.popups"),wl=e("mouse.released"),Sl=sn([te("isExtraPart",a),Zn("fireEventInstead",[te("event",Vo())])]),kl=function(t){var n=Tn("Dismissal",Sl,t),e={};return e[yl()]={schema:sn([Nn("target")]),onReceive:function(t,e){bl.isOpen(t)&&(bl.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return bl.close(t)}),(function(n){return Wo(t,n.event)})))}},e},Cl=sn([Zn("fireEventInstead",[te("event",Po())]),Wn("doReposition")]),Ol=function(t){var n=Tn("Reposition",Cl,t),e={};return e[xl()]={onReceive:function(t){bl.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(n){return Wo(t,n.event)}))}},e},_l=function(t,n,e){n.store.manager.onLoad(t,n,e)},Tl=function(t,n,e){n.store.manager.onUnload(t,n,e)},El=Object.freeze({__proto__:null,onLoad:_l,onUnload:Tl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Bl=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[ur((function(e,o){_l(e,t,n)})),ar((function(e,o){Tl(e,t,n)}))]:[Ja(t,n,_l)];return Jo(e)}}),Dl=function(){var t=se(null);return si({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Al=function(){var t=se({}),n=se({});return si({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Mt(t.get(),e).orThunk((function(){return Mt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};U(e,(function(t){i[t.value]=t,Mt(t,"meta").each((function(n){Mt(n,"text").each((function(n){u[n]=t}))}))})),t.set(l(l({},o),i)),n.set(l(l({},r),u))},clear:function(){t.set({}),n.set({})}})},Ml=Object.freeze({__proto__:null,memory:Dl,dataset:Al,manual:function(){return si({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),Fl=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Il=[qn("initialValue"),Nn("getFallbackEntry"),Nn("getDataKey"),Nn("setValue"),ga("manager",{setValue:Fl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){Fl(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:Al})],Rl=[Nn("getValue"),te("setValue",t),qn("initialValue"),ga("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:t,state:ci.init})],Vl=[qn("initialValue"),ga("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Dl})],Pl=[ne("store",{mode:"memory"},Dn("mode",{memory:Vl,manual:Rl,dataset:Il})),la("onSetValue"),te("resetOnDom",!1)],Hl=oc({fields:Pl,name:"representing",active:Bl,apis:El,extra:{setValueFrom:function(t,n){var e=Hl.getValue(n);Hl.setValue(t,e)}},state:Ml}),zl=function(t,n){return ae(t,{},j(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,vn(e,e,Wt(),cn((function(t){return bt("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([ce("dump",o)]))},Nl=function(t){return t.dump},Ll=function(t,n){return l(l({},t.dump),nc(n))},jl=zl,Ul=Ll,Wl="placeholder",Gl=Rt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Xl=function(t){return Ft(t,"uiType")},Yl=function(t,n,o,r){return Xl(o)&&o.uiType===Wl?(u=o,a=r,(i=t).exists((function(t){return t!==u.owner}))?Gl.single(!0,e(u)):Mt(a,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+kt(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(t){return t.replace()}))):Gl.single(!1,e(o));var i,u,a},ql=function(t,n,e,r){return Yl(t,0,e,r).fold((function(o,i){var u=Xl(e)?i(n,e.config,e.validated):i(n),a=Mt(u,"components").getOr([]),c=$(a,(function(e){return ql(t,n,e,r)}));return[l(l({},u),{components:c})]}),(function(t,r){if(Xl(e)){var i=r(n,e.config,e.validated);return e.validated.preprocess.getOr(o)(i)}return r(n)}))},Kl=function(t,n,o,r){var i,u,a,c=_t(r,(function(t,n){return r=t,i=!1,{name:e(o=n),required:function(){return r.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+o);return i=!0,r}};var o,r,i})),s=(i=t,u=n,a=c,$(o,(function(t){return ql(i,u,t,a)})));return Ot(c,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),s},Jl=Gl.single,$l=Gl.multiple,Ql=e(Wl),Zl=Rt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),tf=te("factory",{sketch:o}),nf=te("schema",[]),ef=Nn("name"),of=vn("pname","pname",Gt((function(t){return"<alloy."+Xr(t.name)+">"})),An()),rf=ce("schema",(function(){return[qn("preprocess")]})),uf=te("defaults",e({})),af=te("overrides",e({})),cf=ln([tf,nf,ef,of,uf,af]),sf=ln([tf,nf,ef,uf,af]),lf=ln([tf,nf,ef,of,uf,af]),ff=ln([tf,rf,ef,Nn("unit"),of,uf,af]),df=function(t){return t.fold(S.some,S.none,S.some,S.some)},mf=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},gf=function(t,n){return function(e){var o=Tn("Converting part type",n,e);return t(o)}},pf=gf(Zl.required,cf),hf=gf(Zl.external,sf),vf=gf(Zl.optional,lf),bf=gf(Zl.group,ff),yf=e("entirety"),xf=Object.freeze({__proto__:null,required:pf,external:hf,optional:vf,group:bf,asNamedPart:df,name:mf,asCommon:function(t){return t.fold(o,o,o,o)},original:yf}),wf=function(t,n,e,o){return Ht(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Sf=function(t,n){var e={};return U(n,(function(n){df(n).each((function(n){var o=kf(t,n.pname);e[n.name]=function(e){var r=Tn("Part: "+n.name+" in "+t,ln(n.schema),e);return l(l({},o),{config:e,validated:r})}}))})),e},kf=function(t,n){return{uiType:Ql(),owner:t,name:n}},Cf=function(t,n,e){return{uiType:Ql(),owner:t,name:n,config:e,validated:{}}},Of=function(t){return $(t,(function(t){return t.fold(S.none,S.some,S.none,S.none).map((function(t){return Gn(t.name,t.schema.concat([pa(yf())]))})).toArray()}))},_f=function(t){return j(t,mf)},Tf=function(t,n,o){return r=n,i={},u={},U(o,(function(t){t.fold((function(t){i[t.pname]=Jl(!0,(function(n,e,o){return t.factory.sketch(wf(n,t,e,o))}))}),(function(t){var n=r.parts[t.name];u[t.name]=e(t.factory.sketch(wf(r,t,n[yf()]),n))}),(function(t){i[t.pname]=Jl(!1,(function(n,e,o){return t.factory.sketch(wf(n,t,e,o))}))}),(function(t){i[t.pname]=$l(!0,(function(n,e,o){var r=n[t.name];return j(r,(function(e){return t.factory.sketch(Ht(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:e(i),externals:e(u)};var r,i,u},Ef=function(t,n,e){return Kl(S.some(t),n,n.components,e)},Bf=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Df=function(t,n,e){return Bf(t,n,e).getOrDie("Could not find part: "+e)},Af=function(t,n,o){var r={},i=n.partUids,u=t.getSystem();return U(o,(function(t){r[t]=e(u.getByUid(i[t]))})),r},Mf=function(t,n){var o=t.getSystem();return _t(n.partUids,(function(t,n){return e(o.getByUid(t))}))},Ff=function(t){return kt(t.partUids)},If=function(t,n,o){var r={},i=n.partUids,u=t.getSystem();return U(o,(function(t){r[t]=e(u.getByUid(i[t]).getOrDie())})),r},Rf=function(t,n){var e=_f(n);return Jt(j(e,(function(n){return{key:n,value:t+"-"+n}})))},Vf=function(t){return vn("partUids","partUids",Xt((function(n){return Rf(n.uid,t)})),An())},Pf=Object.freeze({__proto__:null,generate:Sf,generateOne:Cf,schemas:Of,names:_f,substitutes:Tf,components:Ef,defaultUids:Rf,defaultUidsSchema:Vf,getAllParts:Mf,getAllPartNames:Ff,getPart:Bf,getPartOrDie:Df,getParts:Af,getPartsOrDie:If}),Hf=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[Gn("parts",i)]:[]).concat([Nn("uid"),te("dom",{}),te("components",[]),pa("originalSpec"),te("debug.sketcher",{})]).concat(u));return Tn(t+" [SpecSchema]",sn(a.concat(n)),e)},zf=function(t,n,e,o,r){var i=Nf(r),u=Of(e),a=Vf(e),c=Hf(t,n,i,u,[a]),s=Tf(0,c,e);return o(c,Ef(t,c,s.internals()),i,s.externals())},Nf=function(t){return Ft(t,"uid")?t:l(l({},t),{uid:Zr("uid")})},Lf=sn([Nn("name"),Nn("factory"),Nn("configFields"),te("apis",{}),te("extraApis",{})]),jf=sn([Nn("name"),Nn("factory"),Nn("configFields"),Nn("partFields"),te("apis",{}),te("extraApis",{})]),Uf=function(t){var n=Tn("Sketcher for "+t.name,Lf,t),e=_t(n.apis,ai),o=_t(n.extraApis,ri);return l(l({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=Nf(t),r(Hf(e,o,i,[],[]),i);var e,o,r,i}},e),o)},Wf=function(t){var n=Tn("Sketcher for "+t.name,jf,t),e=Sf(n.name,n.partFields),o=_t(n.apis,ai),r=_t(n.extraApis,ri);return l(l({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return zf(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Gf=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Xf=function(t){return"input"===lr(t)&&"radio"!==Pr(t,"type")||"textarea"===lr(t)},Yf=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),qf=[Nn("find")],Kf=oc({fields:qf,name:"composing",apis:Yf}),Jf=function(t,n,e,o){var r=fs(t.element,"."+n.highlightClass);U(r,(function(e){z(o,(function(t){return t.element===e}))||(Ti(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Wo(e,Uo())})))}))},$f=function(t,n,e,o){Jf(t,n,0,[o]),Qf(t,n,e,o)||(Oi(o.element,n.highlightClass),n.onHighlight(t,o),Wo(o,jo()))},Qf=function(t,n,e,o){return Ei(o.element,n.highlightClass)},Zf=function(t,n,e,o){var r=fs(t.element,"."+n.itemClass);return S.from(r[o]).fold((function(){return ct.error("No element found with index "+o)}),t.getSystem().getByDom)},td=function(t,n,e){return Gu(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},nd=function(t,n,e){var o=fs(t.element,"."+n.itemClass);return(0<o.length?S.some(o[o.length-1]):S.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},ed=function(t,n,e,o){var r=fs(t.element,"."+n.itemClass);return K(r,(function(t){return Ei(t,n.highlightClass)})).bind((function(n){var e=wc(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},od=function(t,n,e){var o=fs(t.element,"."+n.itemClass);return Gf(j(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},rd=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return Jf(t,n,0,[])},dehighlight:function(t,n,e,o){Qf(t,n,e,o)&&(Ti(o.element,n.highlightClass),n.onDehighlight(t,o),Wo(o,Uo()))},highlight:$f,highlightFirst:function(t,n,e){td(t,n).each((function(o){$f(t,n,e,o)}))},highlightLast:function(t,n,e){nd(t,n).each((function(o){$f(t,n,e,o)}))},highlightAt:function(t,n,e,o){Zf(t,n,e,o).fold((function(t){throw new Error(t)}),(function(o){$f(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=od(t,n);q(r,o).each((function(o){$f(t,n,e,o)}))},isHighlighted:Qf,getHighlighted:function(t,n,e){return Gu(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:td,getLast:nd,getPrevious:function(t,n,e){return ed(t,n,0,-1)},getNext:function(t,n,e){return ed(t,n,0,1)},getCandidates:od}),id=[Nn("highlightClass"),Nn("itemClass"),la("onHighlight"),la("onDehighlight")],ud=oc({fields:id,name:"highlighting",apis:rd}),ad=[8],cd=[9],sd=[13],ld=[27],fd=[32],dd=[37],md=[38],gd=[39],pd=[40],hd=function(t,n,e){var o=Z(t.slice(0,n)),r=Z(t.slice(n+1));return q(o.concat(r),e)},vd=function(t,n,e){var o=Z(t.slice(0,n));return q(o,e)},bd=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return q(r.concat(o),e)},yd=function(t,n,e){var o=t.slice(n+1);return q(o,e)},xd=function(t){return function(n){var e=n.raw;return H(t,e.which)}},wd=function(t){return function(n){return Q(t,(function(t){return t(n)}))}},Sd=function(t){return!0===t.raw.shiftKey},kd=function(t){return!0===t.raw.ctrlKey},Cd=i(Sd),Od=function(t,n){return{matches:t,classification:n}},_d=function(t,n,e){n.exists((function(t){return e.exists((function(n){return je(n,t)}))}))||Go(t,Ho(),{prevFocus:n,newFocus:e})},Td=function(){var t=function(t){return fc(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);_d(n,o,r)}}},Ed=function(){var n=function(t){return ud.getHighlighted(t).map((function(t){return t.element}))};return{get:n,set:function(e,o){var r=n(e);e.getSystem().getByDom(o).fold(t,(function(t){ud.highlight(e,t)}));var i=n(e);_d(e,r,i)}}};(is=rs=rs||{}).OnFocusMode="onFocus",is.OnEnterOrSpaceMode="onEnterOrSpace",is.OnApiMode="onApi";var Bd,Dd=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u,a=e(t,n,o,r);return i=a,u=n.event,q(i,(function(t){return t.matches(u)})).map((function(t){return t.classification})).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([te("focusManager",Td()),ne("focusInside","onFocus",kn((function(t){return H(["onFocus","onEnterOrSpace","onApi"],t)?ct.value(t):ct.error("Invalid value for focusInside")}))),ga("handler",u),ga("state",n),ga("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==rs.OnFocusMode?S.none():r(t).map((function(e){return Zo(yo(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Zo(so(),(function(o,u){i(o,u,e,t,n).fold((function(){var e,i,a;e=o,i=u,a=xd(fd.concat(sd))(i.event),t.focusInside===rs.OnEnterOrSpaceMode&&a&&qe(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(t){u.stop()}))})),Zo(lo(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return Jo(u.toArray().concat(a))}};return u},Ad=function(t){var n=[qn("onEscape"),qn("onEnter"),te("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),te("firstTabstop",0),te("useTabstopAt",c),qn("visibilitySelector")].concat([t]),o=function(t,n){var e=t.visibilitySelector.bind((function(t){return Xu(n,t)})).getOr(n);return 0<gu(e)},i=function(t,n,e){var r,i,u;r=n,i=fs(t.element,r.selector),u=G(i,(function(t){return o(r,t)})),S.from(u[r.firstTabstop]).each((function(e){n.focusManager.set(t,e)}))},u=function(t,n,e,r,i){return i(n,e,(function(t){return o(n=r,e=t)&&n.useTabstopAt(e);var n,e})).fold((function(){return r.cyclic?S.some(!0):S.none()}),(function(n){return r.focusManager.set(t,n),S.some(!0)}))},a=function(t,n,e,o){var i,a,c=fs(t.element,e.selector);return i=t,(a=e).focusManager.get(i).bind((function(t){return Xu(t,a.selector)})).bind((function(n){return K(c,r(je,n)).bind((function(n){return u(t,c,n,e,o)}))}))},s=e([Od(wd([Sd,xd(cd)]),(function(t,n,e){var o=e.cyclic?hd:vd;return a(t,0,e,o)})),Od(xd(cd),(function(t,n,e){var o=e.cyclic?bd:yd;return a(t,0,e,o)})),Od(xd(ld),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Od(wd([Cd,xd(sd)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),l=e([]);return Dd(n,ci.init,s,l,(function(){return S.some(i)}))},Md=Ad(ce("cyclic",a)),Fd=Ad(ce("cyclic",c)),Id=function(t,n,e){return Xf(e)&&xd(fd)(n.event)?S.none():(Yo(t,e,ko()),S.some(!0))},Rd=function(t,n){return S.some(!0)},Vd=[te("execute",Id),te("useSpace",!1),te("useEnter",!0),te("useControlEnter",!1),te("useDown",!1)],Pd=function(t,n,e){return e.execute(t,n,t.element)},Hd=Dd(Vd,ci.init,(function(t,n,e,o){var r=e.useSpace&&!Xf(t.element)?fd:[],i=e.useEnter?sd:[],u=e.useDown?pd:[],a=r.concat(i).concat(u);return[Od(xd(a),Pd)].concat(e.useControlEnter?[Od(wd([kd,xd(sd)]),Pd)]:[])}),(function(t,n,e,o){return e.useSpace&&!Xf(t.element)?[Od(xd(fd),Rd)]:[]}),(function(){return S.none()})),zd=function(){var t=se(S.none());return si({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(S.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},Nd=Object.freeze({__proto__:null,flatgrid:zd,init:function(t){return t.state(t)}}),Ld=function(t){return function(n,e,o,r){var i=t(n.element);return Gd(i,n,e,o,r)}},jd=function(t,n){var e=Vc(t,n);return Ld(e)},Ud=function(t,n){var e=Vc(n,t);return Ld(e)},Wd=function(t){return function(n,e,o,r){return Gd(t,n,e,o,r)}},Gd=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},Xd=Wd,Yd=Wd,qd=Wd,Kd=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n},Jd=function(t,n,e){var o,r=fs(t,e),i=G(r,Kd);return K(o=i,(function(t){return je(t,n)})).map((function(t){return{index:t,candidates:o}}))},$d=function(t,n){return K(t,(function(t){return je(n,t)}))},Qd=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return 0<=o&&o<t.length?S.some(t[o]):S.none()}))},Zd=function(t,n,e,o,r){return Qd(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=wc(i,r,0,u-1);return S.some({row:n,column:a})}))},tm=function(t,n,e,o,r){return Qd(t,n,o,(function(n,i){var u=wc(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Sc(i,0,a-1);return S.some({row:u,column:c})}))},nm=[Nn("selector"),te("execute",Id),fa("onEscape"),te("captureTab",!1),ha()],em=function(t,n,e){Gu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},om=function(t){return function(n,e,o,r){return Jd(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},rm=function(t,n,e){return e.captureTab?S.some(!0):S.none()},im=om((function(t,n,e,o){return Zd(t,n,e,o,-1)})),um=om((function(t,n,e,o){return Zd(t,n,e,o,1)})),am=om((function(t,n,e,o){return tm(t,n,e,o,-1)})),cm=om((function(t,n,e,o){return tm(t,n,e,o,1)})),sm=e([Od(xd(dd),jd(im,um)),Od(xd(gd),Ud(im,um)),Od(xd(md),Xd(am)),Od(xd(pd),Yd(cm)),Od(wd([Sd,xd(cd)]),rm),Od(wd([Cd,xd(cd)]),rm),Od(xd(ld),(function(t,n,e){return e.onEscape(t,n)})),Od(xd(fd.concat(sd)),(function(t,n,e,o){return r=t,(i=e).focusManager.get(r).bind((function(t){return Xu(t,i.selector)})).bind((function(o){return e.execute(t,n,o)}));var r,i}))]),lm=e([Od(xd(fd),Rd)]),fm=Dd(nm,zd,sm,lm,(function(){return S.some(em)})),dm=function(t,n,e,o){var r=function(t,n,e){var i,u=wc(n,o,0,e.length-1);return u===t?S.none():(i=e[u],"button"===lr(i)&&"disabled"===Pr(i,"disabled")?r(t,u,e):S.from(e[u]))};return Jd(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},mm=[Nn("selector"),te("getInitial",S.none),te("execute",Id),fa("onEscape"),te("executeOnMove",!1),te("allowVertical",!0)],gm=function(t,n,e){return o=t,(r=e).focusManager.get(o).bind((function(t){return Xu(t,r.selector)})).bind((function(o){return e.execute(t,n,o)}));var o,r},pm=function(t,n,e){n.getInitial(t).orThunk((function(){return Gu(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},hm=function(t,n,e){return dm(t,e.selector,n,-1)},vm=function(t,n,e){return dm(t,e.selector,n,1)},bm=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?gm(n,e,o):S.some(!0)}))}},ym=function(t,n,e){return e.onEscape(t,n)},xm=e([Od(xd(fd),Rd)]),wm=Dd(mm,ci.init,(function(t,n,e,o){var r=dd.concat(e.allowVertical?md:[]),i=gd.concat(e.allowVertical?pd:[]);return[Od(xd(r),bm(jd(hm,vm))),Od(xd(i),bm(Ud(hm,vm))),Od(xd(sd),gm),Od(xd(fd),gm),Od(xd(ld),ym)]}),xm,(function(){return S.some(pm)})),Sm=function(t,n,e){return S.from(t[n]).bind((function(t){return S.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},km=function(t,n,e,o){var r=t[n].length,i=wc(e,o,0,r-1);return Sm(t,n,i)},Cm=function(t,n,e,o){var r=wc(e,o,0,t.length-1),i=t[r].length,u=Sc(n,0,i-1);return Sm(t,r,u)},Om=function(t,n,e,o){var r=t[n].length,i=Sc(e+o,0,r-1);return Sm(t,n,i)},_m=function(t,n,e,o){var r=Sc(e+o,0,t.length-1),i=t[r].length,u=Sc(n,0,i-1);return Sm(t,r,u)},Tm=[Gn("selectors",[Nn("row"),Nn("cell")]),te("cycles",!0),te("previousSelector",S.none),te("execute",Id)],Em=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return Gu(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Bm=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Xu(o,r.selectors.row).bind((function(t){var n=fs(t,r.selectors.cell);return $d(n,o).bind((function(n){var o=fs(e,r.selectors.row);return $d(o,t).bind((function(t){var e,u=(e=r,j(o,(function(t){return fs(t,e.selectors.cell)})));return i(u,t,n).map((function(t){return t.cell}))}))}))}))}},Dm=Bm((function(t,n,e){return km(t,n,e,-1)}),(function(t,n,e){return Om(t,n,e,-1)})),Am=Bm((function(t,n,e){return km(t,n,e,1)}),(function(t,n,e){return Om(t,n,e,1)})),Mm=Bm((function(t,n,e){return Cm(t,e,n,-1)}),(function(t,n,e){return _m(t,e,n,-1)})),Fm=Bm((function(t,n,e){return Cm(t,e,n,1)}),(function(t,n,e){return _m(t,e,n,1)})),Im=e([Od(xd(dd),jd(Dm,Am)),Od(xd(gd),Ud(Dm,Am)),Od(xd(md),Xd(Mm)),Od(xd(pd),Yd(Fm)),Od(xd(fd.concat(sd)),(function(t,n,e){return fc(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Rm=e([Od(xd(fd),Rd)]),Vm=Dd(Tm,ci.init,Im,Rm,(function(){return S.some(Em)})),Pm=[Nn("selector"),te("execute",Id),te("moveOnTab",!1)],Hm=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},zm=function(t,n,e){Gu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Nm=function(t,n,e){return dm(t,e.selector,n,-1)},Lm=function(t,n,e){return dm(t,e.selector,n,1)},jm=e([Od(xd(md),qd(Nm)),Od(xd(pd),qd(Lm)),Od(wd([Sd,xd(cd)]),(function(t,n,e,o){return e.moveOnTab?qd(Nm)(t,n,e,o):S.none()})),Od(wd([Cd,xd(cd)]),(function(t,n,e,o){return e.moveOnTab?qd(Lm)(t,n,e,o):S.none()})),Od(xd(sd),Hm),Od(xd(fd),Hm)]),Um=e([Od(xd(fd),Rd)]),Wm=Dd(Pm,ci.init,jm,Um,(function(){return S.some(zm)})),Gm=[fa("onSpace"),fa("onEnter"),fa("onShiftEnter"),fa("onLeft"),fa("onRight"),fa("onTab"),fa("onShiftTab"),fa("onUp"),fa("onDown"),fa("onEscape"),te("stopSpaceKeyup",!1),qn("focusIn")],Xm=Dd(Gm,ci.init,(function(t,n,e){return[Od(xd(fd),e.onSpace),Od(wd([Cd,xd(sd)]),e.onEnter),Od(wd([Sd,xd(sd)]),e.onShiftEnter),Od(wd([Sd,xd(cd)]),e.onShiftTab),Od(wd([Cd,xd(cd)]),e.onTab),Od(xd(md),e.onUp),Od(xd(pd),e.onDown),Od(xd(dd),e.onLeft),Od(xd(gd),e.onRight),Od(xd(fd),e.onSpace),Od(xd(ld),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Od(xd(fd),Rd)]:[]}),(function(t){return t.focusIn})),Ym=Md.schema(),qm=Fd.schema(),Km=wm.schema(),Jm=fm.schema(),$m=Vm.schema(),Qm=Hd.schema(),Zm=Wm.schema(),tg=Xm.schema(),ng=ic({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Ym,cyclic:qm,flow:Km,flatgrid:Jm,matrix:$m,execution:Qm,menu:Zm,special:tg}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){It(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Nd}),eg=function(t,n,e,o){var r=t.getSystem().build(o);el(t,r,e)},og=function(t,n,e,o){var r=rg(t);q(r,(function(t){return je(o.element,t.element)})).each(rl)},rg=function(t,n){return t.components()},ig=function(t,n,e,o,r){var i=rg(t);return S.from(i[o]).map((function(n){return og(t,0,0,n),r.each((function(n){eg(t,0,(function(t,n){var e,r;r=n,Cr(e=t,o).fold((function(){Er(e,r)}),(function(t){Or(t,r)}))}),n)})),n}))},ug=oc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){eg(t,0,Er,o)},prepend:function(t,n,e,o){eg(t,0,Tr,o)},remove:og,replaceAt:ig,replaceBy:function(t,n,e,o,r){var i=rg(t);return K(i,o).bind((function(n){return ig(t,0,0,n,r)}))},set:function(t,n,e,o){dc((function(){var n=j(o,t.getSystem().build);tl(t,n)}),t.element)},contents:rg})}),ag=function(t,n){var o,r;return{key:t,value:{config:{},me:(o=t,r=Jo(n),oc({fields:[Nn("enabled")],name:o,active:{events:e(r)}})),configAsRaw:e({}),initialConfig:{},state:ci}}},cg=function(t,n){n.ignore||(sc(t.element),n.onFocus(t))},sg=Object.freeze({__proto__:null,focus:cg,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=Ri(n).dom,n.dom===e.activeElement;var n,e}}),lg=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return fi(e)},events:function(t){return Jo([Zo(yo(),(function(n,e){cg(n,t),e.stop()}))].concat(t.stopMousedown?[Zo(eo(),(function(t,n){n.event.prevent()}))]:[]))}}),fg=[la("onFocus"),te("stopMousedown",!1),te("ignore",!1)],dg=oc({fields:fg,name:"focusing",active:lg,apis:sg}),mg=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},gg=function(t,n,e){n.toggleClass.each((function(n){(e.get()?Oi:Ti)(t.element,n)}))},pg=function(t,n,e){bg(t,n,e,!e.get())},hg=function(t,n,e){e.set(!0),gg(t,n,e),mg(t,n,e)},vg=function(t,n,e){e.set(!1),gg(t,n,e),mg(t,n,e)},bg=function(t,n,e,o){(o?hg:vg)(t,n,e)},yg=function(t,n,e){bg(t,n,e,n.selected)},xg=Object.freeze({__proto__:null,onLoad:yg,toggle:pg,isOn:function(t,n,e){return e.get()},on:hg,off:vg,set:bg}),wg=Object.freeze({__proto__:null,exhibit:function(){return fi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=pg,sr((function(t){r(t,e,o)}))),u=Ja(t,n,yg);return Jo(J([t.toggleOnExecute?[i]:[],[u]]))}}),Sg=function(t,n,e){Vr(t.element,"aria-expanded",e)},kg=[te("selected",!1),qn("toggleClass"),te("toggleOnExecute",!0),ne("aria",{mode:"none"},Dn("mode",{pressed:[te("syncWithExpanded",!1),ga("update",(function(t,n,e){Vr(t.element,"aria-pressed",e),n.syncWithExpanded&&Sg(t,n,e)}))],checked:[ga("update",(function(t,n,e){Vr(t.element,"aria-checked",e)}))],expanded:[ga("update",Sg)],selected:[ga("update",(function(t,n,e){Vr(t.element,"aria-selected",e)}))],none:[ga("update",t)]}))],Cg=oc({fields:kg,name:"toggling",active:wg,apis:xg,state:(Bd=!1,{init:function(){var t=se(Bd);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Bd)},readState:function(){return t.get()}}}})}),Og=function(){var t=function(t,n){n.stop(),Xo(t)};return[Zo(go(),t),Zo(Oo(),t),rr(Qe()),rr(eo())]},_g=function(t){return Jo(J([t.map((function(t){return sr((function(n,e){t(n),e.stop()}))})).toArray(),Og()]))},Tg="alloy.item-hover",Eg="alloy.item-focus",Bg=function(t){(fc(t.element).isNone()||dg.isFocused(t))&&(dg.isFocused(t)||dg.focus(t),Go(t,Tg,{item:t}))},Dg=function(t){Go(t,Eg,{item:t})},Ag=e(Tg),Mg=e(Eg),Fg=[Nn("data"),Nn("components"),Nn("dom"),te("hasSubmenu",!1),qn("toggling"),jl("itemBehaviours",[Cg,dg,ng,Hl]),te("ignoreFocus",!1),te("domModification",{}),ga("builder",(function(t){return{dom:t.dom,domModification:l(l({},t.domModification),{attributes:l(l(l({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ul(t.itemBehaviours,[t.toggling.fold(Cg.revoke,(function(t){return Cg.config(l({aria:{mode:"checked"}},t))})),dg.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Dg(t)}}),ng.config({mode:"execution"}),Hl.config({store:{mode:"memory",initialValue:t.data}}),ag("item-type-events",d(Og(),[Zo(uo(),Bg),Zo(Co(),dg.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),te("eventOrder",{})],Ig=[Nn("dom"),Nn("components"),ga("builder",(function(t){return{dom:t.dom,components:t.components,events:Jo([(n=Co(),Zo(n,(function(t,n){n.stop()})))])};var n}))],Rg=function(){return"item-widget"},Vg=e([pf({name:"widget",overrides:function(t){return{behaviours:nc([Hl.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),Pg=[Nn("uid"),Nn("data"),Nn("components"),Nn("dom"),te("autofocus",!1),te("ignoreFocus",!1),jl("widgetBehaviours",[Hl,dg,ng]),te("domModification",{}),Vf(Vg()),ga("builder",(function(t){var n=Tf(Rg(),t,Vg()),e=Ef(Rg(),t,n.internals()),o=function(n){return Bf(n,t,"widget").map((function(t){return ng.focusIn(t),t}))},r=function(n,e){return Xf(e.event.target)||t.autofocus&&e.setSource(n.element),S.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Jo([sr((function(t,n){o(t).each((function(t){n.stop()}))})),Zo(uo(),Bg),Zo(Co(),(function(n,e){t.autofocus?o(n):dg.focus(n)}))]),behaviours:Ul(t.widgetBehaviours,[Hl.config({store:{mode:"memory",initialValue:t.data}}),dg.config({ignore:t.ignoreFocus,onFocus:function(t){Dg(t)}}),ng.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:uc(),onLeft:r,onRight:r,onEscape:function(n,e){return dg.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),S.none()):(dg.focus(n),S.some(!0))}})])}}))],Hg=Dn("type",{widget:Pg,item:Fg,separator:Ig}),zg=e([bf({factory:{sketch:function(t){var n=Tn("menu.spec item",Hg,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:l(l({},n),{uid:Zr("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Ng=e([Nn("value"),Nn("items"),Nn("dom"),Nn("components"),te("eventOrder",{}),zl("menuBehaviours",[ud,Hl,Kf,ng]),ne("movement",{mode:"menu",moveOnTab:!0},Dn("mode",{grid:[ha(),ga("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[ga("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Nn("rowSelector")],menu:[te("moveOnTab",!0),ga("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Ln("markers",ia()),te("fakeFocus",!1),te("focusManager",Td()),la("onHighlight")]),Lg=e("alloy.menu-focus"),jg=Wf({name:"Menu",configFields:Ng(),partFields:zg(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Ll(t.menuBehaviours,[ud.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Hl.config({store:{mode:"memory",initialValue:t.value}}),Kf.config({find:S.some}),ng.config(t.movement.config(t,t.movement))]),events:Jo([Zo(Mg(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){ud.highlight(t,e),n.stop(),Go(t,Lg(),{menu:t,item:e})}))})),Zo(Ag(),(function(t,n){var e=n.event.item;ud.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Ug=function(t,n,e,o){return Mt(e,o).bind((function(o){return Mt(t,o).bind((function(o){var r=Ug(t,n,e,o);return S.some([o].concat(r))}))})).getOr([])},Wg=function(t,n){var e={};Ot(t,(function(t,n){U(t,(function(t){e[t]=n}))}));var o=n,r=Tt(n,(function(t,n){return{k:t,v:n}})),i=_t(r,(function(t,n){return[n].concat(Ug(e,o,r,n))}));return _t(e,(function(t){return Mt(i,t).getOr([t])}))},Gg=function(t){return"prepared"===t.type?S.some(t.menu):S.none()},Xg={init:function(){var t=se({}),n=se({}),e=se({}),o=se(S.none()),r=se({}),i=function(n,e,o){return u(n).bind((function(r){return i=n,Dt(t.get(),(function(t,n){return t===i})).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}));var i}))},u=function(t){return a(t).bind(Gg)},a=function(t){return Mt(n.get(),t)},c=function(n){return Mt(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(l(l({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(S.some(i)),t.set(a),n.set(u),r.set(c);var s=Wg(c,a);e.set(s)},expand:function(n){return Mt(t.get(),n).map((function(t){var o=Mt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Mt(e.get(),t)},collapse:function(t){return Mt(e.get(),t).bind((function(t){return 1<t.length?S.some(t.slice(1)):S.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return tt(kt(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(S.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=G(c(t).toArray(),(function(t){return u(t).isSome()}));return Mt(e.get(),t).bind((function(t){var e=Z(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return S.none();n.push(o.getOrDie())}return S.some(n)}($(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return o.get().is(t)?[]:[S.none()]}),(function(t){return[S.some(t)]}))})))}))}}},extractPreparedMenu:Gg},Yg=e("collapse-item"),qg=Uf({name:"TieredMenu",configFields:[ma("onExecute"),ma("onEscape"),da("onOpenMenu"),da("onOpenSubmenu"),la("onRepositionMenu"),la("onCollapseMenu"),te("highlightImmediately",!0),Gn("data",[Nn("primary"),Nn("menus"),Nn("expansions")]),te("fakeFocus",!1),la("onHighlight"),la("onHover"),aa(),Nn("dom"),te("navigateOnHover",!0),te("stayInDom",!1),zl("tmenuBehaviours",[ng,ud,Kf,ug]),te("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o,r=se(S.none()),i=Xg.init(),u=function(n){var e,o,r,u=(e=n,o=t.data.primary,r=t.data.menus,_t(r,(function(n,r){var i=function(){return jg.sketch(l(l({},n),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?Ed:Td)()}))};return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),a=c();return i.setContents(t.data.primary,u,t.data.expansions,a),i.getPrimary()},a=function(t){return Hl.getValue(t).value},c=function(n){return _t(t.data.menus,(function(t,n){return $(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},s=function(t,n){ud.highlight(t,n),ud.getHighlighted(n).orThunk((function(){return ud.getFirst(n)})).each((function(n){Yo(t,n.element,Co())}))},f=function(t,n){return Gf(j(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?S.some(t.menu):S.none()}))})))},d=function(n,e,o){var r=f(e,e.otherMenus(o));U(r,(function(e){Di(e.element,[t.markers.backgroundMenu]),t.stayInDom||ug.remove(n,e)}))},m=function(n,e){var o,i=(o=n,r.get().getOrThunk((function(){var n={},e=fs(o.element,"."+t.markers.item),i=G(e,(function(t){return"true"===Pr(t,"aria-haspopup")}));return U(i,(function(t){o.getSystem().getByDom(t).each((function(t){var e=a(t);n[e]=t}))})),r.set(S.some(n)),n})));Ot(i,(function(t,n){var o=H(e,n);Vr(t.element,"aria-expanded",o)}))},g=function(n,e,o){return S.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return S.none();var i=r.menu,u=f(e,o.slice(1));return U(u,(function(n){Oi(n.element,t.markers.backgroundMenu)})),zi(i.element)||ug.append(n,fu(i)),Di(i.element,[t.markers.backgroundMenu]),s(n,i),d(n,e,o),S.some(i)}))}))};(o=e=e||{})[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";var p=function(n,o,r){void 0===r&&(r=e.HighlightSubmenu);var u=a(o);return i.expand(u).bind((function(u){return m(n,u),S.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,o),o}(n,a,c);return zi(s.element)||ug.append(n,fu(s)),t.onOpenSubmenu(n,o,s,Z(u)),r===e.HighlightSubmenu?(ud.highlightFirst(s),g(n,i,u)):(ud.dehighlightAll(s),S.some(o))}))}))}))},h=function(n,e){var o=a(e);return i.collapse(o).bind((function(o){return m(n,o),g(n,i,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},v=function(n){return function(e,o){return Xu(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map((function(){return!0}))}))}))}},b=Jo([Zo(Lg(),(function(t,n){var e=n.event.item;i.lookupItem(a(e)).each((function(){var e=n.event.menu;ud.highlight(t,e);var o=a(n.event.item);i.refresh(o).each((function(n){return d(t,i,n)}))}))})),sr((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===a(o).indexOf("collapse-item")&&h(n,o),p(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),(function(){}))}))})),ur((function(n,e){u(n).each((function(e){ug.append(n,fu(e)),t.onOpenMenu(n,e),t.highlightImmediately&&s(n,e)}))}))].concat(t.navigateOnHover?[Zo(Ag(),(function(n,o){var r,u,c=o.event.item;r=n,u=a(c),i.refresh(u).bind((function(t){return m(r,t),g(r,i,t)})),p(n,c,e.HighlightParent),t.onHover(n,c)}))]:[])),y=function(t){return ud.getHighlighted(t).bind(ud.getHighlighted)},x={collapseMenu:function(t){y(t).each((function(n){h(t,n)}))},highlightPrimary:function(t){i.getPrimary().each((function(n){s(t,n)}))},repositionMenus:function(n){i.getPrimary().bind((function(t){return y(n).bind((function(t){var n=a(t),e=At(i.getMenus()),o=Gf(j(e,Xg.extractPreparedMenu));return i.getTriggeringPath(n,(function(t){return n=t,it(o,(function(t){if(!t.getSystem().isConnected())return S.none();var e=ud.getCandidates(t);return q(e,(function(t){return a(t)===n}))}));var n}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){var e;e=n,S.from(e.components()[0]).filter((function(t){return"menu"===Pr(t.element,"role")})).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Ll(t.tmenuBehaviours,[ng.config({mode:"special",onRight:v((function(t,n){return Xf(n.element)?S.none():p(t,n,e.HighlightSubmenu)})),onLeft:v((function(t,n){return Xf(n.element)?S.none():h(t,n)})),onEscape:v((function(n,e){return h(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){i.getPrimary().each((function(n){Yo(t,n.element,Co())}))}}),ud.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Kf.config({find:function(t){return ud.getHighlighted(t)}}),ug.config({})]),eventOrder:t.eventOrder,apis:x,events:b}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Kt(t,n),expansions:{}}},collapseItem:function(t){return{value:Xr(Yg()),meta:{text:t}}}}}),Kg=Uf({name:"InlineView",configFields:[Nn("lazySink"),la("onShow"),la("onHide"),Qn("onEscape"),zl("inlineBehaviours",[bl,Hl,ac]),Zn("fireDismissalEventInstead",[te("event",Vo())]),Zn("fireRepositionEventInstead",[te("event",Po())]),te("getRelated",S.none),te("isExtraPart",a),te("eventOrder",S.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map(Ru)}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();bl.openWhileCloaked(n,o,(function(){return Js.positionWithinBounds(i,e,n,r())})),Hl.setValue(n,S.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i,u,a,c,s,f,d,m,g=(i=t,u=n,a=e,s=r,f=function(){return i.lazySink(u)},d="horizontal"===(c=o).type?{layouts:{onLtr:Xa,onRtl:Ya}}:{},m=function(t){return 2===t.length?d:{}},qg.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return bl.close(u),i.onEscape.map((function(t){return t(u)})),S.some(!0)},onExecute:function(){return S.some(!0)},onOpenMenu:function(t,n){Js.positionWithinBounds(f().getOrDie(),a,n,s())},onOpenSubmenu:function(t,n,e,o){var r=f().getOrDie();Js.position(r,l({anchor:"submenu",item:n},m(o)),e)},onRepositionMenu:function(t,n,e){var o=f().getOrDie();Js.positionWithinBounds(o,a,n,s()),U(e,(function(t){var n=m(t.triggeringPath);Js.position(o,l({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}}));bl.open(n,g),Hl.setValue(n,S.some({mode:"menu",menu:g}))},i=function(n){bl.isOpen(n)&&Hl.getValue(n).each((function(e){switch(e.mode){case"menu":bl.getState(n).each((function(t){qg.repositionMenus(t)}));break;case"position":var o=t.lazySink(n).getOrDie();Js.positionWithinBounds(o,e.anchor,n,e.getBounds())}}))},u={setContent:function(t,n){bl.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,S.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,(function(){return S.none()}))},showMenuWithinBounds:r,hide:function(t){bl.isOpen(t)&&(Hl.setValue(t,S.none()),bl.close(t))},getContent:function(t){return bl.getState(t)},reposition:i,isOpen:bl.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Ll(t.inlineBehaviours,[bl.config({isPartOf:function(n,e,o){return Ku(e,o)||(r=n,i=o,t.getRelated(r).exists((function(t){return Ku(t,i)})));var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),Hl.config({store:{mode:"memory",initialValue:S.none()}}),ac.config({channels:l(l({},kl(l({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Ol(l(l({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Jg=function(t){return t.x},$g=function(t,n){return t.x+t.width/2-n.width/2},Qg=function(t,n){return t.x+t.width-n.width},Zg=function(t){return t.y},tp=function(t,n){return t.y+t.height-n.height},np=function(t,n,e){return va(Qg(t,n),tp(t,n),e.innerSoutheast(),Sa(),Ta(t,{right:0,bottom:3}),"layout-inner-se")},ep=function(t,n,e){return va(Jg(t),tp(t,n),e.innerSouthwest(),wa(),Ta(t,{left:1,bottom:3}),"layout-inner-sw")},op=function(t,n,e){return va(Qg(t,n),Zg(t),e.innerNortheast(),xa(),Ta(t,{right:0,top:2}),"layout-inner-ne")},rp=function(t,n,e){return va(Jg(t),Zg(t),e.innerNorthwest(),ya(),Ta(t,{left:1,top:2}),"layout-inner-nw")},ip=function(t,n,e){return va($g(t,n),Zg(t),e.innerNorth(),ka(),Ta(t,{top:2}),"layout-inner-n")},up=function(t,n,e){return va($g(t,n),tp(t,n),e.innerSouth(),Ca(),Ta(t,{bottom:3}),"layout-inner-s")},ap=tinymce.util.Tools.resolve("tinymce.util.Delay"),cp=Uf({name:"Button",factory:function(t){var n=_g(t.action),e=t.dom.tag,o=function(n){return Mt(t.dom,"attributes").bind((function(t){return Mt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Ul(t.buttonBehaviours,[dg.config({}),ng.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return l({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[te("uid",void 0),Nn("dom"),te("components",[]),jl("buttonBehaviours",[dg,ng]),qn("action"),qn("role"),te("eventOrder",{})]}),sp=function(t){var n=void 0!==t.uid&&It(t,"uid")?t.uid:Zr("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return l(l({},t),{uid:n})}}},lp=function(t){return S.from(t()["temporary-placeholder"]).getOr("!not found!")},fp=function(t,n){return S.from(n()[t.toLowerCase()]).getOrThunk((function(){return lp(n)}))},dp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},mp=Uf({name:"Notification",factory:function(t){var n,e,o=sp({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:nc([ug.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=sp({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:nc([ug.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each((function(t){ug.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])}))},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=o.get(t),ug.set(e,[au(n)]))}},c=J([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return S.from(dp[t])})).toArray()]),s=sp(cp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:fp("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,it(n,(function(t){return S.from(e()[t.toLowerCase()])})).getOrThunk((function(){return lp(e)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:nc([ug.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:nc([dg.config({}),ag("notification-events",[Zo(ao(),(function(t){s.getOpt(t).each(dg.focus)}))])]),components:l.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[qn("level"),Nn("progress"),Nn("icon"),Nn("onAction"),Nn("text"),Nn("iconProvider"),Nn("translationProvider"),ie("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function gp(t,n,e){var o=n.backstage;return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),u=function(){r(),Kg.hide(c)},a=lu(mp.sketch({text:t.text,level:H(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:S.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=lu(Kg.sketch(l({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),0<t.timeout&&ap.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){Kg.showAt(c,{anchor:"makeshift",x:t,y:n},fu(a))},moveRel:function(t,e){var o,r;"banner"!==e?(o=function(t){switch(t){case"bc-bc":return up;case"tc-tc":return ip;case"tc-bc":return Ha;case"bc-tc":default:return za}}(e),r={anchor:"node",root:Ni(),node:S.some(fe.fromDom(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}},Kg.showAt(c,r,fu(a))):Kg.showAt(c,n.backstage.shared.anchors.banner(),fu(a))},text:function(t){mp.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){mp.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){var n;U(t,(function(t){return t.moveTo(0,0)})),0<(n=t).length&&(et(n).each((function(t){return t.moveRel(null,"banner")})),U(n,(function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},getArgs:function(t){return t.settings}}}var pp,hp,vp=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},bp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),yp=function(t,n,e,o,r){var i=bp(t,(function(n){return o=n,(e=t).isBlock(o)||H(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o);var e,o}));return S.from(i.backwards(n,e,o,r))},xp=function(t,n){return wp(fe.fromDom(t.selection.getNode())).getOrThunk((function(){var e=fe.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Er(e,fe.fromDom(n.extractContents())),n.insertNode(e.dom),xr(e).each((function(t){return t.dom.normalize()})),ls(e,ss).map((function(n){var e;t.selection.setCursorLocation(n.dom,"img"===lr(e=n)?1:as(e).fold((function(){return kr(e).length}),(function(t){return t.length})))})),e}))},wp=function(t){return Xu(t,"[data-mce-autocompleter]")},Sp=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},kp=function(t){return""!==t&&-1!==" \xa0\f\n\r\t\v".indexOf(t)},Cp=function(t,n){return t.substring(n.length)},Op=function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return S.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return yp(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(kp(r))return S.none();if(r===e)break}return S.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return S.none();var i=Sp(r);return 0!==i.lastIndexOf(e)||Cp(i,e).length<o?S.none():S.some({text:Cp(i,e),range:r,triggerChar:e})}))},_p=function(t,n,e,o){return void 0===o&&(o=0),wp(fe.fromDom(n.startContainer)).fold((function(){return Op(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Sp(o);return S.some({range:o,text:Cp(r,e),triggerChar:e})}))},Tp=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Go(t,so(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(ud.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Xo),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(ud.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&wp(fe.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},Ep=tinymce.util.Tools.resolve("tinymce.util.Promise"),Bp=function(t,n){return{container:t,offset:n}},Dp=function(t){if(3===t.nodeType)return Bp(t,t.data.length);var n=t.childNodes;return 0<n.length?Dp(n[n.length-1]):Bp(t,n.length)},Ap=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?Ap(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?Dp(e[e.length-1]):Bp(t,n)},Mp=function(t){return function(n){var e,o,r=Ap(n.startContainer,n.startOffset);return!yp(e=t,(o=r).container,o.offset,(function(t,n){return 0===n?-1:n}),e.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!kp(n)})).isSome()}},Fp=function(t,n){var e,o,r=n(),i=t.selection.getRng();return e=t.dom,o=i,it(r.triggerChars,(function(t){return _p(e,o,t)})).bind((function(e){return Ip(t,n,e)}))},Ip=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=G(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return Mp(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return S.none();var a=Ep.all(j(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction}}))})));return S.some({lookupData:a,context:e})},Rp=ln([jn("type"),$n("text")]),Vp=ln([te("type","autocompleteitem"),te("active",!1),te("disabled",!1),te("meta",{}),jn("value"),$n("text"),$n("icon")]),Pp=ln([jn("type"),jn("ch"),ee("minChars",1),te("columns",1),ee("maxResults",10),Qn("matches"),Wn("fetch"),Wn("onAction")]),Hp=[ie("disabled",!1),$n("tooltip"),$n("icon"),$n("text"),ue("onSetup",(function(){return t}))],zp=ln([jn("type"),Wn("onAction")].concat(Hp)),Np=function(t){return On("toolbarbutton",zp,t)},Lp=[ie("active",!1)].concat(Hp),jp=ln(Lp.concat([jn("type"),Wn("onAction")])),Up=function(t){return On("ToggleButton",jp,t)},Wp=[ue("predicate",(function(){return!1})),re("scope","node",["node","editor"]),re("position","selection",["node","selection","line"])],Gp=Hp.concat([te("type","contextformbutton"),te("primary",!1),Wn("onAction"),ce("original",o)]),Xp=Lp.concat([te("type","contextformbutton"),te("primary",!1),Wn("onAction"),ce("original",o)]),Yp=Hp.concat([te("type","contextformbutton")]),qp=Lp.concat([te("type","contextformtogglebutton")]),Kp=Dn("type",{contextformbutton:Gp,contextformtogglebutton:Xp}),Jp=ln([te("type","contextform"),ue("initValue",(function(){return""})),$n("label"),Yn("commands",Kp),Kn("launch",Dn("type",{contextformbutton:Yp,contextformtogglebutton:qp}))].concat(Wp)),$p=ln([te("type","contexttoolbar"),jn("items")].concat(Wp)),Qp=function(t){var n,e,o=t.ui.registry.getAll().popups,r=_t(o,(function(t){return On("Autocompleter",Pp,t).fold((function(t){throw new Error(En(t))}),(function(t){return t}))})),i=(n=Bt(r,(function(t){return t.ch})),e={},U(n,(function(t){e[t]={}})),kt(e)),u=At(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return G(u,(function(n){return n.ch===t}))}}};(hp=pp=pp||{})[hp.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",hp[hp.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var Zp,th,nh=pp,eh="tox-menu-nav__js",oh="tox-collection__item",rh="tox-swatch",ih={normal:eh,color:rh},uh="tox-collection__item--enabled",ah="tox-collection__item-label",ch="tox-collection__item-caret",sh="tox-collection__item--active",lh=function(t){return Mt(ih,t).getOr(eh)},fh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},dh=function(t){var n=fh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:lh(t)}},mh=[jg.parts.items({})],gh=function(t,n,e){var o=fh(e);return{dom:{tag:"div",classes:J([[o.tieredMenu]])},markers:dh(e)}},ph=function(t,n){return function(e){var o=L(e,n);return j(o,(function(n){return{dom:t,components:n}}))}},hh=function(t,n){var e=[],o=[];return U(t,(function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],Ft(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),0<o.length&&e.push(o),j(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},vh=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[jg.parts.items({preprocess:function(e){return"auto"!==t&&1<t?ph({tag:"div",classes:["tox-collection__group"]},t)(e):hh(e,(function(t,e){return"separator"===n[e].type}))}})]}},bh=function(t){return z(t,(function(t){return"icon"in t&&void 0!==t.icon}))},yh=function(t){return console.error(En(t)),console.log(t),S.none()},xh=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[jg.parts.items({preprocess:function(t){return hh(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},wh=function(t,n,e,r,i){var u,a,c,s,l,f;return"color"===i?{value:t,dom:(u=r,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[jg.parts.items({preprocess:"auto"!==u?ph({tag:"div",classes:["tox-swatches__row"]},u):o})]}]}).dom,components:c.components,items:e}:"normal"===i&&"auto"===r?{value:t,dom:(c=vh(r,e)).dom,components:c.components,items:e}:"normal"===i&&1===r?{value:t,dom:(c=vh(1,e)).dom,components:c.components,items:e}:"normal"===i?{value:t,dom:(c=vh(r,e)).dom,components:c.components,items:e}:"listpreview"!==i||"auto"===r?{value:t,dom:(s=n,l=r,f=fh(i),{tag:"div",classes:J([[f.menu,"tox-menu-"+l+"-column"],s?[f.hasIcons]:[]])}),components:mh,items:e}:{value:t,dom:(a=r,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[jg.parts.items({preprocess:ph({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:c.components,items:e}},Sh=[ie("disabled",!1),$n("text"),$n("shortcut"),vn("value","value",Gt((function(){return Xr("menuitem-value")})),An()),te("meta",{})],kh=ln([jn("type"),ie("active",!1),$n("icon")].concat(Sh)),Ch=ln([jn("type"),Un("fancytype",["inserttable","colorswatch"]),ue("onAction",t)]),Oh=ln([jn("type"),ue("onSetup",(function(){return t})),ue("onAction",t),$n("icon")].concat(Sh)),_h=ln([jn("type"),Wn("getSubmenuItems"),ue("onSetup",(function(){return t})),$n("icon")].concat(Sh)),Th=ln([jn("type"),$n("icon"),ie("active",!1),ue("onSetup",(function(){return t})),Wn("onAction")].concat(Sh)),Eh=function(t,n,e){var o=fs(t.element,"."+e);if(0<o.length){var r=K(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return S.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return S.none()},Bh=function(t,n){return nc([ag(t,n)])},Dh=function(t){return Bh(Xr("unnamed-events"),t)},Ah=[Nn("lazySink"),Nn("tooltipDom"),te("exclusive",!0),te("tooltipComponents",[]),te("delay",300),re("mode","normal",["normal","follow-highlight"]),te("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:e([za,Ha,Ia,Va,Ra,Pa]),onRtl:e([za,Ha,Ia,Va,Ra,Pa])}}})),la("onHide"),la("onShow")],Mh=Object.freeze({__proto__:null,init:function(){var t=se(S.none()),n=se(S.none()),o=function(){t.get().each((function(t){clearTimeout(t)}))},r=e("not-implemented");return si({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(S.some(t))},clearTooltip:function(){n.set(S.none())},clearTimer:o,resetTimer:function(n,e){o(),t.set(S.some(setTimeout((function(){n()}),e)))},readState:r})}}),Fh=Xr("tooltip.exclusive"),Ih=Xr("tooltip.show"),Rh=Xr("tooltip.hide"),Vh=function(t,n,e){t.getSystem().broadcastOn([Fh],{})},Ph=Object.freeze({__proto__:null,hideAllExclusive:Vh,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&ug.set(t,o)}))}}),Hh=oc({fields:Ah,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){rl(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return Jo(J([[Zo(Ih,(function(e){n.resetTimer((function(){var o,r,i;o=e,n.isShowing()||(Vh(o),r=t.lazySink(o).getOrDie(),i=o.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Jo("normal"===t.mode?[Zo(uo(),(function(t){Wo(o,Ih)})),Zo(ro(),(function(t){Wo(o,Rh)}))]:[]),behaviours:nc([ug.config({})])}),n.setTooltip(i),nl(r,i),t.onShow(o,i),Js.position(r,t.anchor(o),i))}),t.delay)})),Zo(Rh,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Zo(So(),(function(t,n){n.universal||H(n.channels,Fh)&&e(t)})),ar((function(t){e(t)}))],"normal"===t.mode?[Zo(ao(),(function(t){Wo(t,Ih)})),Zo(xo(),(function(t){Wo(t,Rh)})),Zo(uo(),(function(t){Wo(t,Ih)})),Zo(ro(),(function(t){Wo(t,Rh)}))]:[Zo(jo(),(function(t,n){Wo(t,Ih)})),Zo(Uo(),(function(t){Wo(t,Rh)}))]]))}}),state:Mh,apis:Ph}),zh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Nh=tinymce.util.Tools.resolve("tinymce.util.I18n"),Lh=["input","button","textarea","select"],jh=function(t,n,e){(n.disabled()?qh:Kh)(t,n)},Uh=function(t,n){return!0===n.useNative&&H(Lh,lr(t.element))},Wh=function(t){Vr(t.element,"disabled","disabled")},Gh=function(t){Nr(t.element,"disabled")},Xh=function(t){Vr(t.element,"aria-disabled","true")},Yh=function(t){Vr(t.element,"aria-disabled","false")},qh=function(t,n,e){n.disableClass.each((function(n){Oi(t.element,n)})),(Uh(t,n)?Wh:Xh)(t),n.onDisabled(t)},Kh=function(t,n,e){n.disableClass.each((function(n){Ti(t.element,n)})),(Uh(t,n)?Gh:Yh)(t),n.onEnabled(t)},Jh=function(t,n){return Uh(t,n)?zr(t.element,"disabled"):"true"===Pr(t.element,"aria-disabled")},$h=Object.freeze({__proto__:null,enable:Kh,disable:qh,isDisabled:Jh,onLoad:jh,set:function(t,n,e,o){(o?qh:Kh)(t,n)}}),Qh=Object.freeze({__proto__:null,exhibit:function(t,n){return fi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Jo([$o(ko(),(function(n,e){return Jh(n,t)})),Ja(t,n,jh)])}}),Zh=[ue("disabled",a),te("useNative",!0),qn("disableClass"),la("onDisabled"),la("onEnabled")],tv=oc({fields:Zh,name:"disabling",active:Qh,apis:$h}),nv=tinymce.util.Tools.resolve("tinymce.EditorManager"),ev=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},ov=function(t){return t.getParam("width",zh.DOM.getStyle(t.getElement(),"width"))},rv=function(t){return S.from(t.getParam("min_width")).filter(M)},iv=function(t){return S.from(t.getParam("min_height")).filter(M)},uv=function(t){return S.from(t.getParam("max_width")).filter(M)},av=function(t){return S.from(t.getParam("max_height")).filter(M)},cv=function(t){return!1!==t.getParam("menubar",!0,"boolean")},sv=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=O(n),r=T(n)&&0<n.length;return!fv(t)&&(r||o||e)},lv=function(t){var n=N(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=G(n,(function(t){return"string"==typeof t}));return 0<e.length?S.some(e):S.none()},fv=function(t){return lv(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),(function(){return!0}))};(th=Zp=Zp||{})["default"]="wrap",th.floating="floating",th.sliding="sliding",th.scrolling="scrolling";var dv,mv,gv=function(t){return t.getParam("toolbar_mode","","string")};(mv=dv=dv||{}).auto="auto",mv.top="top",mv.bottom="bottom";var pv,hv,vv,bv=function(t){return t.getParam("toolbar_location",dv.auto,"string")},yv=function(t){return bv(t)===dv.bottom},xv=function(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?Gu(Ni(),n):S.none()},wv=function(t){return t.inline&&xv(t).isSome()},Sv=function(t){return t.inline&&!cv(t)&&!sv(t)&&!fv(t)},kv=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!wv(t)&&!Sv(t)},Cv="silver.readonly",Ov=ln([Ln("readonly",Rn)]),_v=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([yl()],{target:e}),t.uiMothership.broadcastOn([yl()],{target:e})),t.mothership.broadcastOn([Cv],{readonly:n}),t.uiMothership.broadcastOn([Cv],{readonly:n})},Tv=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&_v(n,!0)})),t.on("SwitchMode",(function(){return _v(n,t.mode.isReadOnly())})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},Ev=function(){var t;return ac.config({channels:((t={})[Cv]={schema:Ov,onReceive:function(t,n){tv.set(t,n.readonly)}},t)})},Bv=function(t){return tv.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Dv=function(t){return tv.config({disabled:t})},Av=function(t){return tv.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Mv=function(t){return tv.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Fv=function(t,n){var e=t.getApi(n);return function(t){t(e)}},Iv=function(t,n){return ur((function(e){Fv(t,e)((function(e){var o=t.onSetup(e);null!==o&&void 0!==o&&n.set(o)}))}))},Rv=function(t,n){return ar((function(e){return Fv(t,e)(n.get())}))},Vv=((pv={})[ko()]=["disabling","alloy.base.behaviour","toggling","item-events"],pv),Pv=function(t){return $(t,(function(t){return t.toArray()}))},Hv=function(n,e,o,r){var i,u,a=se(t);return{type:"item",dom:e.dom,components:Pv(e.optComponents),data:n.data,eventOrder:Vv,hasSubmenu:n.triggersSubmenu,itemBehaviours:nc([ag("item-events",[(i=n,u=o,sr((function(t,n){Fv(i,t)(i.onAction),i.triggersSubmenu||u!==nh.CLOSE_ON_EXECUTE||(Wo(t,To()),n.stop())}))),Iv(n,a),Rv(n,a)]),Bv((function(){return n.disabled||r.isReadOnly()})),Ev(),ug.config({})].concat(n.itemBehaviours))}},zv=function(t){return{value:t.value,meta:l({text:t.text.getOr("")},t.meta)}},Nv=tinymce.util.Tools.resolve("tinymce.Env"),Lv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},jv=function(t){return{dom:{tag:"div",classes:[ah]},components:[au(Nh.translate(t))]}},Uv=function(t,n){return{dom:{tag:"div",classes:[ah]},components:[{dom:{tag:t.tag,styles:t.styles},components:[au(Nh.translate(n))]}]}},Wv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=Nv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=j(o,(function(t){var n=t.toLowerCase().trim();return Ft(e,n)?e[n]:t})),Nv.mac?r.join(""):r.join("+"))}};var n,e,o,r},Gv=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:fp("checkmark",t)}}},Xv=function(t,n,e,o,r){var i=e?n.or(S.some("")).map(Lv):S.none(),u=t.checkMark,a=t.ariaLabel.map((function(t){return{attributes:{title:Nh.translate(t)}}})).getOr({});return{dom:l({tag:"div",classes:[eh,oh].concat(r?["tox-collection__item-icon-rtl"]:[])},a),optComponents:[i,t.htmlContent.fold((function(){return t.textContent.map(o)}),(function(t){return S.some({dom:{tag:"div",classes:[ah],innerHtml:t}})})),t.shortcutContent.map(Wv),u,t.caret]}},Yv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],qv=["list-bull-circle","list-bull-default","list-bull-square"],Kv=function(t,n,e,o){void 0===o&&(o=S.none());var i,u,a,c,s,f=Nh.isRtl()&&t.iconContent.exists((function(t){return H(qv,t)})),m=t.iconContent.map((function(t){return Nh.isRtl()&&H(Yv,t)?t+"-rtl":t})).map((function(t){return e=t,r=n.icons,i=o,S.from(r()[e.toLowerCase()]).or(i).getOrThunk((function(){return lp(r)}));var e,r,i})),g=S.from(t.meta).fold((function(){return jv}),(function(t){return Ft(t,"style")?r(Uv,t.style):jv}));return"color"===t.presets?(i=t.ariaLabel,u=t.value,a=n,{dom:(c=m.getOr(""),s={tag:"div",attributes:i.map((function(t){return{title:a.translate(t)}})).getOr({}),classes:["tox-swatch"]},l(l({},s),"custom"===u?{tag:"button",classes:d(s.classes,["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:d(s.classes,["tox-swatch--remove"]),innerHtml:c}:{attributes:l(l({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):Xv(t,m,e,g,f)},Jv=function(t,n){var e,o=Nh.translate(t),r=(e=o,zh.DOM.encode(e));if(0<n.length){var i=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return r.replace(i,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return r},$v=Sf(Rg(),Vg()),Qv=function(t){return{value:t}},Zv=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,tb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,nb=function(t){return Zv.test(t)||tb.test(t)},eb=function(t){var n={value:t.value.replace(Zv,(function(t,n,e,o){return n+n+e+e+o+o}))},e=tb.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},ob=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},rb=function(t){var n=ob(t.red)+ob(t.green)+ob(t.blue);return Qv(n)},ib=Math.min,ub=Math.max,ab=Math.round,cb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,sb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,lb=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},fb=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},db=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=ub(0,ib(i,1)),u=ub(0,ib(u,1));if(0===i)return n=e=o=ab(255*u),lb(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=ab(255*(n+l)),e=ab(255*(e+l)),o=ab(255*(o+l)),lb(n,e,o,1)},mb=function(t){var n=eb(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return lb(e,o,r,1)},gb=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return lb(r,i,u,a)},pb=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},hb=lb(255,0,0,1),vb=function(t,n){return t.fire("ResizeContent",n)},bb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),yb="tinymce-custom-colors",xb="choiceitem",wb=[{type:xb,text:"Light Green",value:"#BFEDD2"},{type:xb,text:"Light Yellow",value:"#FBEEB8"},{type:xb,text:"Light Red",value:"#F8CAC6"},{type:xb,text:"Light Purple",value:"#ECCAFA"},{type:xb,text:"Light Blue",value:"#C2E0F4"},{type:xb,text:"Green",value:"#2DC26B"},{type:xb,text:"Yellow",value:"#F1C40F"},{type:xb,text:"Red",value:"#E03E2D"},{type:xb,text:"Purple",value:"#B96AD9"},{type:xb,text:"Blue",value:"#3598DB"},{type:xb,text:"Dark Turquoise",value:"#169179"},{type:xb,text:"Orange",value:"#E67E23"},{type:xb,text:"Dark Red",value:"#BA372A"},{type:xb,text:"Dark Purple",value:"#843FA1"},{type:xb,text:"Dark Blue",value:"#236FA1"},{type:xb,text:"Light Gray",value:"#ECF0F1"},{type:xb,text:"Medium Gray",value:"#CED4D9"},{type:xb,text:"Gray",value:"#95A5A6"},{type:xb,text:"Dark Gray",value:"#7E8C8D"},{type:xb,text:"Navy Blue",value:"#34495E"},{type:xb,text:"Black",value:"#000000"},{type:xb,text:"White",value:"#ffffff"}],Sb=function(t){void 0===t&&(t=10);var n,e=bb.getItem(yb),o=O(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)};return{add:function(n){var e;(-1===(e=P(r,n))?S.none():S.some(e)).each(i),r.unshift(n),r.length>t&&r.pop(),bb.setItem(yb,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),kb=function(t){return!1!==t.getParam("custom_colors")},Cb=function(t){var n=t.getParam("color_map");return void 0!==n?function(t){var n=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=0;i<t.length;i+=2)n.push({text:t[i+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3];return"#"+r(i,c)+r(u,c)+r(a,c)}(t[i]),type:"choiceitem"});return n}(n):wb},Ob=function(t){Sb.add(t)},_b=function(t){t.addCommand("mceApplyTextcolor",(function(n,e){var o,r,i;r=n,i=e,(o=t).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),t.addCommand("mceRemoveTextcolor",(function(n){var e,o;o=n,(e=t).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}))},Tb=function(t){var n,e,o=Cb(t),r=(n=o.length,Math.max(5,Math.ceil(Math.sqrt(n))));return e=r,t.getParam("color_cols",e,"number")},Eb=function(t,n,e,o){"custom"===e?Ib(t)((function(e){e.each((function(e){Ob(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},Bb=function(t,n){return t.concat(j(Sb.state(),(function(t){return{type:xb,text:t,value:t}})).concat((o={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[o,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[o])));var e,o},Db=function(t,n){return function(e){e(Bb(t,n))}},Ab=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},Mb=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o,r,i;return S.from((r=e,(o=t).dom.getParents(o.selection.getStart(),(function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(i=i||n)})),i)).bind((function(t){return function(t){if("transparent"===t)return S.some(lb(0,0,0,0));var n=cb.exec(t);if(null!==n)return S.some(gb(n[1],n[2],n[3],"1"));var e=sb.exec(t);return null!==e?S.some(gb(e[1],e[2],e[3],e[4])):S.none()}(t).map((function(t){var e=rb(t).value;return ye(n.toLowerCase(),e)}))})).getOr(!1)},columns:Tb(t),fetch:Db(Cb(t),kb(t)),onAction:function(n){null!==r.get()&&Eb(t,e,r.get(),(function(){}))},onItemAction:function(o,i){Eb(t,e,i,(function(e){var o;r.set(e),o={name:n,color:e},t.fire("TextColorChange",o)}))},onSetup:function(e){null!==r.get()&&Ab(e,n,r.get());var o=function(t){t.name===n&&Ab(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},Fb=function(n,e,o,r){n.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Eb(n,o,e.value,t)}}]}})},Ib=function(t){return function(n,e){var o,r={colorpicker:e},i=(o=n,function(t){var n=t.getData();o(S.from(n.colorpicker)),t.close()});t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:i,onClose:function(){},onCancel:function(){n(S.none())}})}},Rb=function(t,n,e,o,r,i,u,a){var c=bh(n),s=Vb(n,e,o,"color"!==r?"normal":"color",i,u,a);return wh(t,c,s,o,r)},Vb=function(t,n,e,o,r,i,u){return Gf(j(t,(function(a){return"choiceitem"===a.type?On("choicemenuitem",kh,a).fold(yh,(function(c){return S.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=Kv({presets:e,textContent:n?t.text:S.none(),htmlContent:S.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:S.none(),checkMark:n?S.some(Gv(u.icons)):S.none(),caret:S.none(),value:t.value},u,a);return Ht(Hv({data:zv(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Cg.set(t,n)},isActive:function(){return Cg.isOn(t)},isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:uh,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,bh(t)))})):S.none()})))},Pb=function(t,n){var e=dh(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Hb=Xr("cell-over"),zb=Xr("cell-execute"),Nb=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(t,n,e){var o,r=function(e){return Go(e,zb,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return lu({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:nc([ag("insert-table-picker-cell",[Zo(uo(),dg.focus),Zo(ko(),r),Zo(go(),i),Zo(Oo(),i)]),Cg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),dg.config({onFocus:function(e){return Go(e,Hb,{row:t,col:n})}})])})}(r,u,t));o.push(i)}return o},Lb={inserttable:function(t){var n=Xr("size-label"),e=Nb(n,10,10),o=sp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[au("0x0")],behaviours:nc([ug.config({})])});return{type:"widget",data:{value:Xr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[$v.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:$(e,(function(t){return j(t,fu)})).concat(o.asSpec()),behaviours:nc([ag("insert-table-picker",[or(Hb,(function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Cg.set(t[i][u],i<=n&&u<=e)}(e,i,u,10,10),ug.set(o.get(t),[au(u+1+"x"+(i+1))])})),or(zb,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Wo(n,To())}))]),ng.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=Bb(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=Rb(Xr("menu-value"),e,(function(n){t.onAction({value:n})}),o,"color",nh.CLOSE_ON_EXECUTE,(function(){return!1}),n.shared.providers),i=l(l({},r),{markers:dh("color"),movement:Pb(o,"color")});return{type:"widget",data:{value:Xr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[$v.widget(jg.sketch(i))]}}},jb=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c,s,l=Kv({presets:o,textContent:S.none(),htmlContent:e?t.text.map((function(t){return Jv(t,n)})):S.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:S.none(),checkMark:S.none(),caret:S.none(),value:t.value},u.providers,a,t.icon);return Hv({data:zv(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(n){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(c=t.meta,s=u,Mt(c,"tooltipWorker").map((function(t){return[Hh.config({lazySink:s.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Bc}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){Hh.setComponents(n,[cu({element:fe.fromDom(t)})])}))}})]})).getOr([]))},l,i,u.providers)},Ub=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:l({tag:"div",classes:[oh,"tox-collection__group-heading"]},n),components:[]}},Wb=function(t,n,e,o){void 0===o&&(o=!0);var r=Kv({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:S.none(),ariaLabel:t.text,caret:S.none(),checkMark:S.none(),shortcutContent:t.shortcut},e,o);return Hv({data:zv(t),getApi:function(t){return{isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},Gb=function(n,e,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u,a,c=i?(a=o.icons,{dom:{tag:"div",classes:[ch],innerHtml:fp("chevron-down",a)}}):(u=o.icons,{dom:{tag:"div",classes:[ch],innerHtml:fp("chevron-right",u)}}),s=Kv({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:S.none(),ariaLabel:n.text,caret:S.some(c),checkMark:S.none(),shortcutContent:n.shortcut},o,r);return Hv({data:zv(n),getApi:function(t){return{isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},disabled:n.disabled,onAction:t,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,e,o)},Xb=function(t,n,e,o){void 0===o&&(o=!0);var r=Kv({iconContent:t.icon,textContent:t.text,htmlContent:S.none(),ariaLabel:t.text,checkMark:S.some(Gv(e.icons)),caret:S.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Ht(Hv({data:zv(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Cg.set(t,n)},isActive:function(){return Cg.isOn(t)},isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:uh,toggleOnExecute:!1,selected:t.active}})},Yb=function(t,n){return e=Lb,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?S.some(e[o]):S.none()).map((function(e){return e(t,n)}));var e,o};(vv=hv=hv||{})[vv.ContentFocus=0]="ContentFocus",vv[vv.UiFocus=1]="UiFocus";var qb=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?l(l({},t),{shortcut:S.none(),icon:t.text.isSome()?S.none():t.icon}):t};switch(t.type){case"menuitem":return On("menuitem",Oh,t).fold(yh,(function(t){return S.some(Wb(u(t),n,i,o))}));case"nestedmenuitem":return On("nestedmenuitem",_h,t).fold(yh,(function(t){return S.some(Gb(u(t),n,i,o,r))}));case"togglemenuitem":return On("togglemenuitem",Th,t).fold(yh,(function(t){return S.some(Xb(u(t),n,i,o))}));case"separator":return On("separatormenuitem",Rp,t).fold(yh,(function(t){return S.some(Ub(t))}));case"fancymenuitem":return On("fancymenuitem",Ch,t).fold(yh,(function(t){return Yb(u(t),e)}));default:return console.error("Unknown item in general menu",t),S.none()}},Kb=function(t,n,e,o,r,i){var u=1===o,a=!u||bh(t);return Gf(j(t,(function(t){return"separator"===t.type?On("Autocompleter.Separator",Rp,t).fold(yh,(function(t){return S.some(Ub(t))})):On("Autocompleter.Item",Vp,t).fold(yh,(function(t){return S.some(jb(t,n,u,"normal",e,r,i,a))}))})))},Jb=function(t,n,e,o,r){var i=bh(n),u=Gf(j(n,(function(t){var n=function(t){return qb(t,e,o,(n=t,r?!n.hasOwnProperty("text"):i),r);var n};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(l(l({},t),{disabled:!0})):n(t)})));return(r?xh:wh)(t,i,u,1,"normal")},$b=function(t){return qg.singleData(t.value,t)},Qb=function(t,n){var e=se(S.none()),o=se(!1),r=lu(Kg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:nc([ag("dismissAutocompleter",[Zo(Vo(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Kg.hide(r)},a=function(){var n;i()&&(n=e.get().map((function(t){return t.element})),wp(n.getOr(fe.fromDom(t.selection.getNode()))).each(Mr),u(),e.set(S.none()),o.set(!1))},c=Nt((function(){return Qp(t)})),s=function(n,e,o,i){n.matchLength=e.text.length;var u,a,c,s,l,f,d,m=it(o,(function(t){return S.from(t.columns)})).getOr(1);Kg.showAt(r,{anchor:"node",root:fe.fromDom(t.getBody()),node:S.from(n.element)},jg.sketch((u=wh("autocompleter-value",!0,i,m,"normal"),a=m,c=hv.ContentFocus,s="normal",l=(c===hv.ContentFocus?Ed:Td)(),f=Pb(a,s),d=dh(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===hv.ContentFocus,focusManager:l,menuBehaviours:Dh("auto"!==a?[]:[ur((function(t,n){Eh(t,4,d.item).each((function(n){var e=n.numColumns,o=n.numRows;ng.setGridSize(t,o,e)}))}))])}))),Kg.getContent(r).each(ud.highlightFirst)},l=function(r){var f;f=r,e.get().map((function(n){return _p(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return Ip(t,c,n,f)}))})).getOrThunk((function(){return Fp(t,c)})).fold(a,(function(r){var c,f;c=r.context,i()||(f=xp(t,c.range),e.set(S.some({triggerChar:c.triggerChar,element:f,matchLength:c.text.length})),o.set(!1)),r.lookupData.then((function(i){e.get().map((function(e){var c,f,d,m,g=r.context;e.triggerChar===g.triggerChar&&(f=g.triggerChar,m=it(d=i,(function(t){return S.from(t.columns)})).getOr(1),0<(c=$(d,(function(e){var r=e.items;return Kb(r,e.matchText,(function(n,r){var i=t.selection.getRng();_p(t.dom,i,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),l(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),m,nh.BUBBLE_TO_SANDBOX,n)}))).length?s(e,g,i,c):(10<=g.text.length-e.matchLength?a:u)())}))}))}))},f={onKeypress:vp((function(t){27!==t.which&&l()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Kg.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Kg.getContent(r)}};Tp(f,t)},Zb=c,ty=function(t,n,e){return Ou(t,n,Zb,e,!1)},ny=function(t,n,e){return Ou(t,n,Zb,e,!0)},ey=Cu,oy=function(t,n,e){return Xu(t,n,e).isSome()};function ry(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}}var iy=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?S.none():S.some(n.touches[0])},uy=function(t){var n=se(S.none()),e=se(!1),o=ry((function(n){t.triggerEvent(_o(),n),e.set(!0)}),400),r=Jt([{key:Qe(),value:function(t){return iy(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(S.some(i))})),S.none()}},{key:Ze(),value:function(t){return o.cancel(),iy(t).each((function(t){n.get().each((function(e){var o,r,i,u;o=t,r=e,i=Math.abs(o.clientX-r.x),u=Math.abs(o.clientY-r.y),(5<i||5<u)&&n.set(S.none())}))})),S.none()}},{key:to(),value:function(r){return o.cancel(),n.get().filter((function(t){return je(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(Oo(),r)}))}}]);return{fireIfReady:function(t,n){return Mt(r,n).bind((function(n){return n(t)}))}}},ay=function(){return ze().browser.isFirefox()},cy=sn([Wn("triggerEvent"),te("stopBackspace",!0)]),sy=function(t,n){var e,o,r,i,u=Tn("Getting GUI events settings",cy,n),a=uy(u),c=j(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return ty(t,n,(function(t){a.fireIfReady(t,n).each((function(n){n&&t.kill()})),u.triggerEvent(n,t)&&t.kill()}))})),s=se(S.none()),l=ty(t,"paste",(function(t){a.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),u.triggerEvent("paste",t)&&t.kill(),s.set(S.some(setTimeout((function(){u.triggerEvent(wo(),t)}),0)))})),f=ty(t,"keydown",(function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==ad[0]||H(["input","textarea"],lr(n.target))||oy(n.target,'[contenteditable="true"]')||t.prevent()})),d=(e=t,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},ay()?ny(e,"focus",o):ty(e,"focusin",o)),m=se(S.none()),g=(r=t,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(S.some(setTimeout((function(){u.triggerEvent(xo(),t)}),0)))},ay()?ny(r,"blur",i):ty(r,"focusout",i));return{unbind:function(){U(c,(function(t){t.unbind()})),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},ly=function(t,n){var e=Mt(t,"target").getOr(n);return se(e)},fy=Rt([{stopped:[]},{resume:["element"]},{complete:[]}]),dy=function(t,n,e,o,r,i){var u,a,c,s,l=t(n,o),f=(u=e,a=r,c=se(!1),s=se(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold((function(){return i.logEventNoHandlers(n,o),fy.complete()}),(function(t){var e=t.descHandler;return mi(e)(f),f.isStopped()?(i.logEventStopped(n,t.element,e.purpose),fy.stopped()):f.isCut()?(i.logEventCut(n,t.element,e.purpose),fy.complete()):xr(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),fy.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),fy.resume(o)}))}))},my=function(t,n,e,o,r,i){return dy(t,n,e,o,r,i).fold((function(){return!0}),(function(o){return my(t,n,e,o,r,i)}),(function(){return!1}))},gy=function(n,e,o){var r,i,c=(r=e,i=se(!1),{stop:function(){i.set(!0)},cut:t,isStopped:i.get,isCut:a,event:r,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return U(n,(function(t){var n=t.descHandler;mi(n)(c)})),c.isStopped()},py=function(t,n,e,o,r){var i=ly(e,o);return my(t,n,e,o,i,r)},hy=function(t,n){return{element:t,descHandler:n}},vy=function(t,n){return{id:t,descHandler:n}};function by(){var t={};return{registerId:function(n,e,o){Ot(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=di(o,n),t[r]=i}))},unregisterId:function(n){Ot(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return Mt(t,n).map((function(t){return Bt(t,(function(t,n){return vy(n,t)}))})).getOr([])},find:function(n,e,o){var r=Mt(t,e);return Ye(o,(function(t){return n=r,Qr(e=t).fold((function(){return S.none()}),(function(t){return n.bind((function(n){return Mt(n,t)})).map((function(t){return hy(e,t)}))}));var n,e}),n)}}}function yy(){var t=by(),n={},e=function(t){var n=t.element;return Qr(n).fold((function(){return n="uid-",e=t.element,o=Xr(Kr+n),$r(e,o),o;var n,e,o}),(function(t){return t}))},o=function(e){Qr(e.element).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r);It(n,i)&&function(t,e){var r=n[e];if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+jr(r.element)+"\nCannot use it for: "+jr(t.element)+"\nThe conflicting element is"+(zi(r.element)?" ":" not ")+"already in the DOM");o(t)}(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},unregister:o,getById:function(t){return Mt(n,t)}}}var xy,wy,Sy,ky,Cy=Uf({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=f(n,["attributes"]);return{uid:t.uid,dom:l({tag:"div",attributes:l({role:"presentation"},e)},o),components:t.components,behaviours:Nl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[te("components",[]),zl("containerBehaviours",[]),te("events",{}),te("domModification",{}),te("eventOrder",{})]}),Oy=function(n){var o=function(t){return xr(n.element).fold((function(){return!0}),(function(n){return je(t,n)}))},r=yy(),i=function(t,n){return r.find(o,t,n)},u=sy(n.element,{triggerEvent:function(t,n){return na(t,n.target,(function(e){return r=e,py(i,t,o=n,o.target,r);var o,r}))}}),a={debugInfo:e("real"),triggerEvent:function(t,n,e){na(t,n,(function(o){return py(i,t,e,n,o)}))},triggerFocus:function(n,e){Qr(n).fold((function(){sc(n)}),(function(o){na(yo(),n,(function(o){var r,u,a,c,s,l;return r=i,u=yo(),s=o,l=ly(a={originator:e,kill:t,prevent:t,target:n},c=n),dy(r,u,a,c,l,s),!1}))}))},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:lu,addToGui:function(t){f(t)},removeFromGui:function(t){d(t)},addToWorld:function(t){s(t)},removeFromWorld:function(t){l(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:c},s=function(t){t.connect(a),mr(t.element)||(r.register(t),U(t.components(),s),a.triggerEvent(Bo(),t.element,{target:t.element}))},l=function(t){mr(t.element)||(U(t.components(),l),r.unregister(t)),t.disconnect()},f=function(t){nl(n,t)},d=function(t){rl(t)},m=function(t){var n=r.filter(So());U(n,(function(n){var e=n.descHandler;mi(e)(t)}))},g=function(t){m({universal:!0,data:t})},p=function(t,n){m({universal:!1,channels:t,data:n})},h=function(t,n){var e=r.filter(t);return gy(e,n)},v=function(t){return r.getById(t).fold((function(){return ct.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),ct.value)},b=function(t){var n=Qr(t).getOr("not found");return v(n)};return s(n),{root:n,element:n.element,destroy:function(){u.unbind(),Ar(n.element)},add:f,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:l,broadcast:g,broadcastOn:p,broadcastEvent:h}},_y=e([te("prefix","form-field"),zl("fieldBehaviours",[Kf,Hl])]),Ty=e([vf({schema:[Nn("dom")],name:"label"}),vf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Nn("text")],name:"aria-descriptor"}),pf({factory:{sketch:function(t){var n=qt(t,["factory"]);return t.factory.sketch(n)}},schema:[Nn("factory")],name:"field"})]),Ey=Wf({name:"FormField",configFields:_y(),partFields:Ty(),factory:function(t,n,e,o){var r=Ll(t.fieldBehaviours,[Kf.config({find:function(n){return Bf(n,t,"field")}}),Hl.config({store:{mode:"manual",getValue:function(t){return Kf.getCurrent(t).bind(Hl.getValue)},setValue:function(t,n){Kf.getCurrent(t).each((function(t){Hl.setValue(t,n)}))}}})]),i=Jo([ur((function(n,e){var o=Af(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Xr(t.prefix);o.label().each((function(t){Vr(t.element,"for",e),Vr(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Xr(t.prefix);Vr(e.element,"id",o),Vr(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return Bf(n,t,"field")},getLabel:function(n){return Bf(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),By=Object.freeze({__proto__:null,exhibit:function(t,n){return fi({attributes:Jt([{key:n.tabAttr,value:"true"}])})}}),Dy=[te("tabAttr","data-alloy-tabstop")],Ay=oc({fields:Dy,name:"tabstopping",active:By}),My=function(t,n,e,o){var r=Fy(t,n,e,o);return Ey.sketch(r)},Fy=function(t,n,e,o){return{dom:Iy(e),components:t.toArray().concat([n]),fieldBehaviours:nc(o)}},Iy=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Ry=function(t,n){return Ey.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Vy=Xr("form-component-change"),Py=Xr("form-close"),Hy=Xr("form-cancel"),zy=Xr("form-action"),Ny=Xr("form-submit"),Ly=Xr("form-block"),jy=Xr("form-unblock"),Uy=Xr("form-tabchange"),Wy=Xr("form-resize"),Gy=function(t,n){var e,r,i,u=t.label.map((function(t){return Ry(t,n)})),a=function(t){return function(n,e){Xu(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Pr(o,"data-collection-item-value"))}))}},c=function(e,o){var r=j(o,(function(e){var o,r=Nh.translate(e.text),i=1===t.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",u='<div class="tox-collection__item-icon">'+e.icon+"</div>",a={_:" "," - ":" ","-":" "},c=r.replace(/\_| \- |\-/g,(function(t){return a[t]}));return'<div class="tox-collection__item'+(n.isReadOnly()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+('"'===(o=e.value)?"&quot;":o)+'" title="'+c+'" aria-label="'+c+'">'+u+i+"</div>"})),i="auto"!==t.columns&&1<t.columns?L(r,t.columns):[r],u=j(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Ir(e.element,u.join(""))},s=a((function(e,o,r,i){o.stop(),n.isReadOnly()||Go(e,zy,{name:t.name,value:i})})),l=[Zo(uo(),a((function(t,n,e){sc(e)}))),Zo(go(),s),Zo(Oo(),s),Zo(ao(),a((function(t,n,e){Gu(t.element,"."+sh).each((function(t){Ti(t,sh)})),Oi(e,sh)}))),Zo(co(),a((function(t){Gu(t.element,"."+sh).each((function(t){Ti(t,sh)}))}))),sr(a((function(n,e,o,r){Go(n,zy,{name:t.name,value:r})})))],f=function(t,n){return j(fs(t.element,".tox-collection__item"),n)},d=Ey.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:o},behaviours:nc([tv.config({disabled:n.isReadOnly,onDisabled:function(t){f(t,(function(t){Oi(t,"tox-collection__item--state-disabled"),Vr(t,"aria-disabled",!0)}))},onEnabled:function(t){f(t,(function(t){Ti(t,"tox-collection__item--state-disabled"),Nr(t,"aria-disabled")}))}}),Ev(),ug.config({}),Hl.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){c(n,e),"auto"===t.columns&&Eh(n,5,"tox-collection__item").each((function(t){var e=t.numRows,o=t.numColumns;ng.setGridSize(n,e,o)})),Wo(n,Wy)}}),Ay.config({}),ng.config((r=t.columns,i="normal",1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===i?".tox-swatches__row":".tox-collection__group",cell:"color"===i?"."+rh:"."+oh}})),ag("collection-events",l)]),eventOrder:((e={})[ko()]=["disabling","alloy.base.behaviour","collection-events"],e)});return My(u,d,["tox-form__group--collection"],[])},Xy=e([qn("data"),te("inputAttributes",{}),te("inputStyles",{}),te("tag","input"),te("inputClasses",[]),la("onSetValue"),te("styles",{}),te("eventOrder",{}),zl("inputBehaviours",[Hl,dg]),te("selectOnFocus",!0)]),Yy=function(n){return nc([dg.config({onFocus:n.selectOnFocus?function(t){var n=t.element,e=Zi(n);n.dom.setSelectionRange(0,e.length)}:t})])},qy=function(t){return{tag:t.tag,attributes:l({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},Ky=Uf({name:"Input",configFields:Xy(),factory:function(t,n){return{uid:t.uid,dom:qy(t),components:[],behaviours:l(l({},Yy(e=t)),Ll(e.inputBehaviours,[Hl.config({store:l(l({mode:"manual"},e.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Zi(t.element)},setValue:function(t,n){Zi(t.element)!==n&&tu(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),Jy={},$y={exports:Jy};xy=void 0,wy=Jy,Sy=$y,ky=void 0,function(t){"object"==typeof wy&&void 0!==Sy?Sy.exports=t():"function"==typeof xy&&xy.amd?xy([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c="function"==typeof ky&&ky;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[u]={exports:{}};n[u][0].call(l.exports,(function(t){return r(n[u][1][t]||t)}),l,l.exports,t,n,e,o)}return e[u].exports}for(var i="function"==typeof ky&&ky,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var t=c(m);f=!0;for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run();d=-1,n=l.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new p(t,n)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){function e(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(t,this)}function r(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn((function(){var e,o=1===t._state?n.onFulfilled:n.onRejected;if(null!==o){try{e=o(t._value)}catch(f){return void u(n.promise,f)}i(n.promise,e)}else(1===t._state?i:u)(n.promise,t._value)}))):t._deferreds.push(n)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof o)return t._state=3,t._value=n,void a(t);if("function"==typeof e)return void s((r=e,c=n,function(){r.apply(c,arguments)}),t)}t._state=1,t._value=n,a(t)}catch(i){u(t,i)}var r,c}function u(t,n){t._state=2,t._value=n,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function c(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function s(t,n){var o=!1;try{t((function(t){o||(o=!0,i(n,t))}),(function(t){o||(o=!0,u(n,t))}))}catch(e){if(o)return;o=!0,u(n,e)}}var l,f;l=this,f=setTimeout,o.prototype["catch"]=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var o=new this.constructor(e);return r(this,new c(t,n,o)),o},o.all=function(t){var n=Array.prototype.slice.call(t);return new o((function(t,o){if(0===n.length)return t([]);for(var r=n.length,i=0;i<n.length;i++)!function i(u,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(t){i(u,t)}),o)}n[u]=a,0==--r&&t(n)}catch(e){o(e)}}(i,n[i])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(n){n(t)}))},o.reject=function(t){return new o((function(n,e){e(t)}))},o.race=function(t){return new o((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},o._immediateFn="function"==typeof t?function(n){t(n)}:function(t){f(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=o:l.Promise||(l.Promise=o)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var Qy,Zy,tx=$y.exports.boltExport,nx=function(t){var n=S.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){U(t,u)},u=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=S.some(t),i(e),e=[])})),{get:o,map:function(t){return nx((function(n){o((function(e){n(t(e))}))}))},isReady:r}},ex={nu:nx,pure:function(t){return nx((function(n){n(t)}))}},ox=function(t){setTimeout((function(){throw t}),0)},rx=function(t){var n=function(n){t().then(n,ox)};return{map:function(n){return rx((function(){return t().then(n)}))},bind:function(n){return rx((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return rx((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return ex.nu(n)},toCached:function(){var n=null;return rx((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},ix=function(t){return rx((function(){return new tx(t)}))},ux=function(t){return rx((function(){return tx.resolve(t)}))},ax=["input","textarea"],cx=function(t){var n=lr(t);return H(ax,n)},sx=function(t,n){var e=n.getRoot(t).getOr(t.element);Ti(e,n.invalidClass),n.notify.each((function(n){cx(t.element)&&Vr(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Ir(t,n.validHtml)})),n.onValid(t)}))},lx=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);Oi(r,n.invalidClass),n.notify.each((function(n){cx(t.element)&&Vr(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Ir(t,o)})),n.onInvalid(t,o)}))},fx=function(t,n,e){return n.validator.fold((function(){return ux(ct.value(!0))}),(function(n){return n.validate(t)}))},dx=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),fx(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return lx(t,n,0,e),ct.error(e)}),(function(e){return sx(t,n),ct.value(e)})):ct.error("No longer in system")}))},mx=Object.freeze({__proto__:null,markValid:sx,markInvalid:lx,query:fx,run:dx,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return Ei(e,n.invalidClass)}}),gx=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map((function(e){return Jo([Zo(e.onEvent,(function(t){dx(t,n).get(o)}))].concat(e.validateOnLoad?[ur((function(e){dx(e,n).get(t)}))]:[]))})).getOr({})}}),px=[Nn("invalidClass"),te("getRoot",S.none),Zn("notify",[te("aria","alert"),te("getContainer",S.none),te("validHtml",""),la("onValid"),la("onInvalid"),la("onValidate")]),Zn("validator",[Nn("validate"),te("onEvent","input"),te("validateOnLoad",!0)])],hx=oc({fields:px,name:"invalidating",active:gx,apis:mx,extra:{validation:function(t){return function(n){var e=Hl.getValue(n);return ux(t(e))}}}}),vx=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),bx=[Ln("others",Cn(ct.value,An()))],yx=oc({fields:bx,name:"coupling",apis:vx,state:Object.freeze({__proto__:null,init:function(){var t={},n=e({});return si({readState:n,getOrCreate:function(n,e,o){var r=kt(e.others);if(r)return Mt(t,o).getOrThunk((function(){var r=Mt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),xx=e("sink"),wx=e(vf({name:xx(),overrides:e({dom:{tag:"div"},behaviours:nc([Js.config({useFixed:c})]),events:Jo([rr(so()),rr(eo()),rr(go())])})}));(Zy=Qy=Qy||{})[Zy.HighlightFirst=0]="HighlightFirst",Zy[Zy.HighlightNone=1]="HighlightNone";var Sx=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}}))},kx=function(t,n,e,o,r,i,u){var a,c,s,f,d,m,g,p,h,v,b=Sx(t,e);return(c=b,f=o,d=r,m=u,g=n,p=s=e,h=(0,(a=t).fetch)(p).map(g),v=Tx(s,a),h.map((function(t){return t.bind((function(t){return S.from(qg.sketch(l(l({},d.menu()),{uid:Zr(""),data:t,highlightImmediately:m===Qy.HighlightFirst,onOpenMenu:function(t,n){var e=v().getOrDie();Js.position(e,c,n),bl.decloak(f)},onOpenSubmenu:function(t,n,e){var o=v().getOrDie();Js.position(o,{anchor:"submenu",item:n},e),bl.decloak(f)},onRepositionMenu:function(t,n,e){var o=v().getOrDie();Js.position(o,c,n),U(e,(function(t){Js.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return dg.focus(s),bl.close(f),S.some(!0)}})))}))}))).map((function(t){return t.fold((function(){bl.isOpen(o)&&bl.close(o)}),(function(t){bl.cloak(o),bl.open(o,t),i(o)})),o}))},Cx=function(t,n,e,o,r,i,u){return bl.close(o),ux(o)},Ox=function(t,n,e,o,r,i){var u=yx.getCoupled(e,"sandbox");return(bl.isOpen(u)?Cx:kx)(t,n,e,u,o,r,i)},_x=function(t,n,e){var o,r,i=Kf.getCurrent(n).getOr(n),u=Su(t.element);e?Wi(i.element,"min-width",u+"px"):(o=i.element,r=u,wu.set(o,r))},Tx=function(t,n){return t.getSystem().getByUid(n.uid+"-"+xx()).map((function(t){return function(){return ct.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return ct.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},Ex=function(t){bl.getState(t).each((function(t){qg.repositionMenus(t)}))},Bx=function(t,n,e){var o=Yu(),r=Tx(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Ul(t.sandboxBehaviours,[Hl.config({store:{mode:"memory",initialValue:n}}),bl.config({onOpen:function(r,i){var u=Sx(t,n);o.link(n.element),t.matchWidth&&_x(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Ku(e,o)||Ku(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Kf.config({find:function(t){return bl.getState(t).bind((function(t){return Kf.getCurrent(t)}))}}),ac.config({channels:l(l({},kl({isExtraPart:a})),Ol({doReposition:Ex}))})])}},Dx=function(t){var n=yx.getCoupled(t,"sandbox");Ex(n)},Ax=function(){return[te("sandboxClasses",[]),jl("sandboxBehaviours",[Kf,ac,bl,Hl])]},Mx=e([Nn("dom"),Nn("fetch"),la("onOpen"),fa("onExecute"),te("getHotspot",S.some),te("getAnchorOverrides",e({})),Nc(),zl("dropdownBehaviours",[Cg,yx,ng,dg]),Nn("toggleClass"),te("eventOrder",{}),qn("lazySink"),te("matchWidth",!1),te("useMinWidth",!1),qn("role")].concat(Ax())),Fx=e([hf({schema:[aa()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),wx()]),Ix=Wf({name:"Dropdown",configFields:Mx(),partFields:Fx(),factory:function(n,e,o,r){var i,u,a=function(t){bl.getState(t).each((function(t){qg.highlightPrimary(t)}))},c={expand:function(e){Cg.isOn(e)||Ox(n,(function(t){return t}),e,r,t,Qy.HighlightNone).get(t)},open:function(e){Cg.isOn(e)||Ox(n,(function(t){return t}),e,r,t,Qy.HighlightFirst).get(t)},isOpen:Cg.isOn,close:function(e){Cg.isOn(e)&&Ox(n,(function(t){return t}),e,r,t,Qy.HighlightFirst).get(t)},repositionMenus:function(t){Cg.isOn(t)&&Dx(t)}},s=function(t,n){return Xo(t),S.some(!0)};return{uid:n.uid,dom:n.dom,components:e,behaviours:Ll(n.dropdownBehaviours,[Cg.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),yx.config({others:{sandbox:function(t){return Bx(n,t,{onOpen:function(){Cg.on(t)},onClose:function(){Cg.off(t)}})}}}),ng.config({mode:"special",onSpace:s,onEnter:s,onDown:function(t,n){var e;return Ix.isOpen(t)?(e=yx.getCoupled(t,"sandbox"),a(e)):Ix.open(t),S.some(!0)},onEscape:function(t,n){return Ix.isOpen(t)?(Ix.close(t),S.some(!0)):S.none()}}),dg.config({})]),events:_g(S.some((function(e){Ox(n,(function(t){return t}),e,r,a,Qy.HighlightFirst).get(t)}))),eventOrder:l(l({},n.eventOrder),((i={})[ko()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:c,domModification:{attributes:l(l({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===n.dom.tag?{type:(u="type",Mt(n.dom,"attributes").bind((function(t){return Mt(t,u)})).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Rx=oc({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Jo([$o(ho(),c)])},exhibit:function(){return fi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Vx=Xr("color-input-change"),Px=Xr("color-swatch-change"),Hx=Xr("color-picker-cancel"),zx=function(t,n,e){var o,r,i=Ey.parts.field({factory:Ky,inputClasses:["tox-textfield"],onSetValue:function(t){return hx.run(t).get((function(){}))},inputBehaviours:nc([tv.config({disabled:n.providers.isReadOnly}),Ev(),Ay.config({}),hx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return xr(t.element)},notify:{onValid:function(t){var n=Hl.getValue(t);Go(t,Vx,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Hl.getValue(t);if(0===n.length)return ux(ct.value(!0));var e=fe.fromTag("span");Wi(e,"background-color",n);var o=Ki(e,"background-color").fold((function(){return ct.error("blah")}),(function(t){return ct.value(n)}));return ux(o)}}})]),selectOnFocus:!1}),u=t.label.map((function(t){return Ry(t,n.providers)})),a=function(t,n){Go(t,Px,{value:n})},c=sp((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Ra,Ia,za]},onLtr:function(){return[Ia,Ra,za]}},components:[],fetch:Db(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){c.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Wo(t,Hx)}),(function(n){a(t,n),Ob(n)}))}),"#ffffff"):a(t,"remove"===n?"":n)}))}},r=n,Ix.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:nc([Dv(r.providers.isReadOnly),Ev(),Rx.config({}),Ay.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:r.getSink,fetch:function(t){return ix((function(t){return o.fetch(t)})).map((function(n){return S.from($b(Ht(Rb(Xr("menu-value"),n,(function(n){o.onItemAction(t,n)}),o.columns,o.presets,nh.CLOSE_ON_EXECUTE,(function(){return!1}),r.providers),{movement:Pb(o.columns,o.presets)})))}))},parts:{menu:gh(0,0,o.presets)}})));return Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,c.asSpec()]}]),fieldBehaviours:nc([ag("form-field-events",[Zo(Vx,(function(n,e){c.getOpt(n).each((function(t){Wi(t.element,"background-color",e.event.color)})),Go(n,Vy,{name:t.name})})),Zo(Px,(function(t,n){Ey.getField(t).each((function(e){Hl.setValue(e,n.event.value),Kf.getCurrent(t).each(dg.focus)}))})),Zo(Hx,(function(t,n){Ey.getField(t).each((function(n){Kf.getCurrent(t).each(dg.focus)}))}))])])})},Nx=function(t,n,e){return{hue:t,saturation:n,value:e}},Lx=Xr("rgb-hex-update"),jx=Xr("slider-update"),Ux=Xr("palette-update"),Wx=vf({schema:[Nn("dom")],name:"label"}),Gx=function(t){return vf({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Jo([tr(Qe(),(function(n,e,o){return t(n,o)}),[n]),tr(eo(),(function(n,e,o){return t(n,o)}),[n]),tr(oo(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},Xx=Gx("top-left"),Yx=Gx("top"),qx=Gx("top-right"),Kx=Gx("right"),Jx=Gx("bottom-right"),$x=Gx("bottom"),Qx=Gx("bottom-left"),Zx=[Wx,Gx("left"),Kx,Yx,$x,Xx,qx,Qx,Jx,pf({name:"thumb",defaults:e({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Jo([er(Qe(),t,"spectrum"),er(Ze(),t,"spectrum"),er(to(),t,"spectrum"),er(eo(),t,"spectrum"),er(oo(),t,"spectrum"),er(io(),t,"spectrum")])}}}),pf({schema:[ce("mouseIsDown",(function(){return se(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:nc([ng.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),dg.config({})]),events:Jo([Zo(Qe(),e),Zo(Ze(),e),Zo(eo(),e),Zo(oo(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}})],tw=e("slider.change.value"),nw=function(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?void 0!==n.clientX?S.some(n).map((function(t){return vu(t.clientX,t.clientY)})):S.none():void 0!==n.touches&&1===n.touches.length?S.some(n.touches[0]).map((function(t){return vu(t.clientX,t.clientY)})):S.none()},ew=function(t){return t.model.minX},ow=function(t){return t.model.minY},rw=function(t){return t.model.minX-1},iw=function(t){return t.model.minY-1},uw=function(t){return t.model.maxX},aw=function(t){return t.model.maxY},cw=function(t){return t.model.maxX+1},sw=function(t){return t.model.maxY+1},lw=function(t,n,e){return n(t)-e(t)},fw=function(t){return lw(t,uw,ew)},dw=function(t){return lw(t,aw,ow)},mw=function(t){return fw(t)/2},gw=function(t){return dw(t)/2},pw=function(t){return t.stepSize},hw=function(t){return t.snapToGrid},vw=function(t){return t.snapStart},bw=function(t){return t.rounded},yw=function(t,n){return void 0!==t[n+"-edge"]},xw=function(t){return yw(t,"left")},ww=function(t){return yw(t,"right")},Sw=function(t){return yw(t,"top")},kw=function(t){return yw(t,"bottom")},Cw=function(t){return t.model.value.get()},Ow=function(t){return{x:t}},_w=function(t){return{y:t}},Tw=function(t,n){return{x:t,y:n}},Ew=function(t,n){Go(t,tw(),{value:n})},Bw=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},Dw=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},Aw=function(t,n,e){return Math.max(n,Math.min(e,t))},Mw=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=Aw(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold((function(){var t=h-v,n=Math.round(t/y)*y;return Aw(v+n,v-1,b+1)}),(function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)}))):c?Math.round(C):C},Fw=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},Iw="left",Rw=function(t){return t.element.dom.getBoundingClientRect()},Vw=function(t,n){return t[n]},Pw=function(t){var n=Rw(t);return Vw(n,Iw)},Hw=function(t){var n=Rw(t);return Vw(n,"right")},zw=function(t){var n=Rw(t);return Vw(n,"top")},Nw=function(t){var n=Rw(t);return Vw(n,"bottom")},Lw=function(t){var n=Rw(t);return Vw(n,"width")},jw=function(t){var n=Rw(t);return Vw(n,"height")},Uw=function(t,n,e){return(t+n)/2-e},Ww=function(t,n){var e=Rw(t),o=Rw(n),r=Vw(e,Iw),i=Vw(e,"right"),u=Vw(o,Iw);return Uw(r,i,u)},Gw=function(t,n){var e=Rw(t),o=Rw(n),r=Vw(e,"top"),i=Vw(e,"bottom"),u=Vw(o,"top");return Uw(r,i,u)},Xw=function(t,n){Go(t,tw(),{value:n})},Yw=function(t){return{x:t}},qw=function(t,n,e){var o={min:ew(n),max:uw(n),range:fw(n),value:e,step:pw(n),snap:hw(n),snapStart:vw(n),rounded:bw(n),hasMinEdge:xw(n),hasMaxEdge:ww(n),minBound:Pw(t),maxBound:Hw(t),screenRange:Lw(t)};return Mw(o)},Kw=function(t){return function(n,e){return o=n,i=(0<t?Dw:Bw)(Cw(r=e).x,ew(r),uw(r),pw(r)),Xw(o,Yw(i)),S.some(i).map((function(){return!0}));var o,r,i}},Jw=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=Lw(u=n),d=s.bind((function(t){return S.some(Ww(t,u))})).getOr(0),m=l.bind((function(t){return S.some(Ww(t,u))})).getOr(f),g={min:ew(a),max:uw(a),range:fw(a),value:c,hasMinEdge:xw(a),hasMaxEdge:ww(a),minBound:Pw(u),minOffset:0,maxBound:Hw(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Fw(g));return Pw(n)-Pw(t)+p},$w=Kw(-1),Qw=Kw(1),Zw=S.none,tS=S.none,nS={"top-left":S.none(),top:S.none(),"top-right":S.none(),right:S.some((function(t,n){Ew(t,Ow(cw(n)))})),"bottom-right":S.none(),bottom:S.none(),"bottom-left":S.none(),left:S.some((function(t,n){Ew(t,Ow(rw(n)))}))},eS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=qw(t,n,e),r=Yw(o);return Xw(t,r),o},setToMin:function(t,n){var e=ew(n);Xw(t,Yw(e))},setToMax:function(t,n){var e=uw(n);Xw(t,Yw(e))},findValueOfOffset:qw,getValueFromEvent:function(t){return nw(t).map((function(t){return t.left}))},findPositionOfValue:Jw,setPositionFromValue:function(t,n,e,o){var r=Cw(e),i=Jw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Su(n.element)/2;Wi(n.element,"left",i-u+"px")},onLeft:$w,onRight:Qw,onUp:Zw,onDown:tS,edgeActions:nS}),oS=function(t,n){Go(t,tw(),{value:n})},rS=function(t){return{y:t}},iS=function(t,n,e){var o={min:ow(n),max:aw(n),range:dw(n),value:e,step:pw(n),snap:hw(n),snapStart:vw(n),rounded:bw(n),hasMinEdge:Sw(n),hasMaxEdge:kw(n),minBound:zw(t),maxBound:Nw(t),screenRange:jw(t)};return Mw(o)},uS=function(t){return function(n,e){return o=n,i=(0<t?Dw:Bw)(Cw(r=e).y,ow(r),aw(r),pw(r)),oS(o,rS(i)),S.some(i).map((function(){return!0}));var o,r,i}},aS=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=jw(u=n),d=s.bind((function(t){return S.some(Gw(t,u))})).getOr(0),m=l.bind((function(t){return S.some(Gw(t,u))})).getOr(f),g={min:ow(a),max:aw(a),range:dw(a),value:c,hasMinEdge:Sw(a),hasMaxEdge:kw(a),minBound:zw(u),minOffset:0,maxBound:Nw(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Fw(g));return zw(n)-zw(t)+p},cS=S.none,sS=S.none,lS=uS(-1),fS=uS(1),dS={"top-left":S.none(),top:S.some((function(t,n){Ew(t,_w(iw(n)))})),"top-right":S.none(),right:S.none(),"bottom-right":S.none(),bottom:S.some((function(t,n){Ew(t,_w(sw(n)))})),"bottom-left":S.none(),left:S.none()},mS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=iS(t,n,e),r=rS(o);return oS(t,r),o},setToMin:function(t,n){var e=ow(n);oS(t,rS(e))},setToMax:function(t,n){var e=aw(n);oS(t,rS(e))},findValueOfOffset:iS,getValueFromEvent:function(t){return nw(t).map((function(t){return t.top}))},findPositionOfValue:aS,setPositionFromValue:function(t,n,e,o){var r=Cw(e),i=aS(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=gu(n.element)/2;Wi(n.element,"top",i-u+"px")},onLeft:cS,onRight:sS,onUp:lS,onDown:fS,edgeActions:dS}),gS=function(t,n){Go(t,tw(),{value:n})},pS=function(t,n){return{x:t,y:n}},hS=function(t,n){return function(e,o){return i=e,u=o,a=0<t?Dw:Bw,c=(r=n)?Cw(u).x:a(Cw(u).x,ew(u),uw(u),pw(u)),s=r?a(Cw(u).y,ow(u),aw(u),pw(u)):Cw(u).y,gS(i,pS(c,s)),S.some(c).map((function(){return!0}));var r,i,u,a,c,s}},vS=nw,bS=hS(-1,!1),yS=hS(1,!1),xS=hS(-1,!0),wS=hS(1,!0),SS={"top-left":S.some((function(t,n){Ew(t,Tw(rw(n),iw(n)))})),top:S.some((function(t,n){Ew(t,Tw(mw(n),iw(n)))})),"top-right":S.some((function(t,n){Ew(t,Tw(cw(n),iw(n)))})),right:S.some((function(t,n){Ew(t,Tw(cw(n),gw(n)))})),"bottom-right":S.some((function(t,n){Ew(t,Tw(cw(n),sw(n)))})),bottom:S.some((function(t,n){Ew(t,Tw(mw(n),sw(n)))})),"bottom-left":S.some((function(t,n){Ew(t,Tw(rw(n),sw(n)))})),left:S.some((function(t,n){Ew(t,Tw(rw(n),gw(n)))}))},kS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=qw(t,n,e.left),r=iS(t,n,e.top),i=pS(o,r);return gS(t,i),i},setToMin:function(t,n){var e=ew(n),o=ow(n);gS(t,pS(e,o))},setToMax:function(t,n){var e=uw(n),o=aw(n);gS(t,pS(e,o))},getValueFromEvent:vS,setPositionFromValue:function(t,n,e,o){var r=Cw(e),i=Jw(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=aS(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Su(n.element)/2,c=gu(n.element)/2;Wi(n.element,"left",i-a+"px"),Wi(n.element,"top",u-c+"px")},onLeft:bS,onRight:yS,onUp:xS,onDown:wS,edgeActions:SS}),CS=Wf({name:"Slider",configFields:[te("stepSize",1),te("onChange",t),te("onChoose",t),te("onInit",t),te("onDragStart",t),te("onDragEnd",t),te("snapToGrid",!1),te("rounded",!0),qn("snapStart"),Ln("model",Dn("mode",{x:[te("minX",0),te("maxX",100),ce("value",(function(t){return se(t.mode.minX)})),Nn("getInitialValue"),ga("manager",eS)],y:[te("minY",0),te("maxY",100),ce("value",(function(t){return se(t.mode.minY)})),Nn("getInitialValue"),ga("manager",mS)],xy:[te("minX",0),te("maxX",100),te("minY",0),te("maxY",100),ce("value",(function(t){return se({x:t.mode.minX,y:t.mode.minY})})),Nn("getInitialValue"),ga("manager",kS)]})),zl("sliderBehaviours",[ng,Hl]),ce("mouseIsDown",(function(){return se(!1)}))],partFields:Zx,factory:function(t,n,e,o){var r,i=function(n){return Df(n,t,"thumb")},u=function(n){return Df(n,t,"spectrum")},a=function(n){return Bf(n,t,"left-edge")},s=function(n){return Bf(n,t,"right-edge")},l=function(n){return Bf(n,t,"top-edge")},f=function(n){return Bf(n,t,"bottom-edge")},d=t.model,m=d.manager,g=function(n,e){m.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:s,getTopEdge:l,getBottomEdge:f,getSpectrum:u})},p=function(n,e){d.value.set(e);var o=i(n);return g(n,o),t.onChange(n,o,e),S.some(!0)},h=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&Bf(n,t,"thumb").each((function(e){var o=d.value.get();t.onChoose(n,e,o)}))},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Ll(t.sliderBehaviours,[ng.config({mode:"special",focusIn:function(n){return Bf(n,t,"spectrum").map(ng.focusIn).map(c)}}),Hl.config({store:{mode:"manual",getValue:function(t){return d.value.get()}}}),ac.config({channels:((r={})[wl()]={onReceive:h},r)})]),events:Jo([Zo(tw(),(function(t,n){p(t,n.event.value)})),ur((function(n,e){var o=d.getInitialValue();d.value.set(o);var r=i(n);g(n,r);var a=u(n);t.onInit(n,r,a,d.value.get())})),Zo(Qe(),v),Zo(to(),b),Zo(eo(),v),Zo(io(),b)]),apis:{resetToMin:function(n){m.setToMin(n,t)},resetToMax:function(n){m.setToMax(n,t)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),OS=[zl("formBehaviours",[Hl])],_S=function(t){return"<alloy.field."+t+">"},TS=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Ll(t.formBehaviours,[Hl.config({store:{mode:"manual",getValue:function(n){var e=Mf(n,t);return _t(e,(function(t,n){return t().bind((function(t){var e,o,r=Kf.getCurrent(t);return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+jr(t.element)),e.fold((function(){return ct.error(o)}),ct.value)})).map(Hl.getValue)}))},setValue:function(n,e){Ot(e,(function(e,o){Bf(n,t,o).each((function(t){Kf.getCurrent(t).each((function(t){Hl.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Bf(n,t,e).bind(Kf.getCurrent)}}}},ES={getField:ai((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),Cf("form",_S(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=j(r,(function(t){return pf({name:t,pname:_S(t)})}));return zf("form",OS,i,TS,o)}},BS=Xr("valid-input"),DS=Xr("invalid-input"),AS=Xr("validating-input"),MS="colorcustom.rgb.",FS=function(n,e,o,r){var i=function(o,r,i,u,a){var c,s,f=n(MS+"range"),d=[Ey.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Ey.parts.field({data:a,factory:Ky,inputAttributes:l({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:nc([(c=r,s=o,hx.config({invalidClass:e("invalid"),notify:{onValidate:function(t){Go(t,AS,{type:c})},onValid:function(t){Go(t,BS,{type:c,value:Hl.getValue(t)})},onInvalid:function(t){Go(t,DS,{type:c,value:Hl.getValue(t)})}},validator:{validate:function(t){var e=Hl.getValue(t),o=s(e)?ct.value(!0):ct.error(n("aria.input.invalid"));return ux(o)},validateOnLoad:!1}})),Ay.config({})]),onSetValue:function(n){hx.isInvalid(n)&&hx.run(n).get(t)}})],m="hex"!==r?[Ey.parts["aria-descriptor"]({text:f})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;Hl.setValue(t,{red:e,green:o,blue:r})},a=sp({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){Wi(t.element,"background-color","#"+n.value)}))};return Uf({factory:function(){var t={red:se(S.some(255)),green:se(S.some(255)),blue:se(S.some(255)),hex:se(S.some("ffffff"))},s=function(n){return t[n].get()},l=function(n,e){t[n].set(e)},f=function(t){var n=t.red,e=t.green,o=t.blue;l("red",S.some(n)),l("green",S.some(e)),l("blue",S.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?l(e.type,S.none()):r(t)},m=function(t,n,e){var o=parseInt(e,10);l(n,S.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return lb(t,n,e,1)}))}))})).each((function(n){var e,o,r=(e=t,o=rb(n),ES.getField(e,"hex").each((function(t){dg.isFocused(t)||Hl.setValue(e,{hex:o.value})})),o);c(t,r)}))},g=function(t,n){var e=n.event;"hex"===e.type?function(t,n){o(t);var e=Qv(n);l("hex",S.some(n));var r=mb(e);u(t,r),f(r),Go(t,Lx,{hex:e}),c(t,e)}(t,e.value):m(t,e.type,e.value)},p=function(t){return{label:n(MS+t+".label"),description:n(MS+t+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex");return Ht(ES.sketch((function(t){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[t.field("red",Ey.sketch(i(fb,"red",h.label,h.description,255))),t.field("green",Ey.sketch(i(fb,"green",v.label,v.description,255))),t.field("blue",Ey.sketch(i(fb,"blue",b.label,b.description,255))),t.field("hex",Ey.sketch(i(nb,"hex",y.label,y.description,"ffffff"))),a.asSpec()],formBehaviours:nc([hx.config({invalidClass:e("form-invalid")}),ag("rgb-form-events",[Zo(BS,g),Zo(DS,d),Zo(AS,d)])])}})),{apis:{updateHex:function(t,n){var e,o;Hl.setValue(t,{hex:n.value}),e=t,o=mb(n),u(e,o),f(o),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},IS=function(t,n){var o=CS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=CS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))};return Uf({factory:function(t){var u=e({x:0,y:0}),a=nc([Kf.config({find:S.some}),dg.config({})]);return CS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[o,r],onChange:function(t,n,e){Go(t,Ux,{value:e})},onInit:function(t,n,e,o){i(e.element.dom,pb(hb))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element.dom,i(r,pb(o))}},extraApis:{}})},RS=function(n,o){return Uf({name:"ColourPicker",configFields:[Nn("dom"),te("onValidHex",t),te("onInvalidHex",t)],factory:function(t){var r,i,u,a,c,s=FS(n,o,t.onValidHex,t.onInvalidHex),l=IS(0,o),f={paletteRgba:se(hb)},d=sp(l.sketch({})),m=sp(s.sketch({})),g=function(t,n){d.getOpt(t).each((function(t){var e=mb(n);f.paletteRgba.set(e),l.setRgba(t,e)}))},p=function(t,n){m.getOpt(t).each((function(t){s.updateHex(t,n)}))},h=function(t,n,e){U(e,(function(e){e(t,n)}))};return{uid:t.uid,dom:t.dom,components:[d.asSpec(),(u=o,a=CS.parts.spectrum({dom:{tag:"div",classes:[u("hue-slider-spectrum")],attributes:{role:"presentation"}}}),c=CS.parts.thumb({dom:{tag:"div",classes:[u("hue-slider-thumb")],attributes:{role:"presentation"}}}),CS.sketch({dom:{tag:"div",classes:[u("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:e({y:0})},components:[a,c],sliderBehaviours:nc([dg.config({})]),onChange:function(t,n,e){Go(t,jx,{value:e})}})),m.asSpec()],behaviours:nc([ag("colour-picker-events",[Zo(Ux,(i=[p],function(t,n){var e,o,r,u,a,c,s,l,d,m=n.event.value,g=f.paletteRgba.get(),p=(u=r=0,a=(e=g).red/255,c=e.green/255,s=e.blue/255,l=Math.min(a,Math.min(c,s)),d=Math.max(a,Math.max(c,s)),l===d?Nx(0,0,100*(u=l)):(r=60*((r=a===l?3:s===l?1:5)-(a===l?c-s:s===l?a-c:s-a)/(d-l)),o=(d-l)/d,u=d,Nx(Math.round(r),Math.round(100*o),Math.round(100*u)))),v=Nx(p.hue,m.x,100-m.y),b=db(v),y=rb(b);h(t,y,i)})),Zo(jx,(r=[g,p],function(t,n){var e,o,i,u=n.event.value,a=(e=u.y,o=Nx((100-e)/100*360,100,100),i=db(o),rb(i));h(t,a,r)}))]),Kf.config({find:function(t){return m.getOpt(t)}}),ng.config({mode:"acyclic"})])}}})},VS=function(){return Kf.config({find:S.some})},PS=function(t){return Kf.config({find:t.getOpt})},HS=function(t){return Kf.config({find:function(n){return Cr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},zS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},NS=function(t){return zS[t]},LS=tinymce.util.Tools.resolve("tinymce.Resource"),jS=ln([te("preprocess",o),te("postprocess",o)]),US=function(t,n,e){return Hl.config(Ht({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},WS=function(t,n,e){return US(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},GS=function(t,n){var e=Tn("RepresentingConfigs.memento processors",jS,n);return Hl.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Hl.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);Hl.setValue(i,r)}}})},XS=US,YS=function(t){return WS(t,Fr,Ir)},qS=function(t){return Hl.config({store:{mode:"memory",initialValue:t}})},KS=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){U(t,(function(t){t(n,e)}))}},r=function(t,n){var e;tv.isDisabled(t)||(e=n.event.raw,u(t,e.dataTransfer.files))},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(n,e){var o,r;Hl.setValue(n,(o=e,r=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),G(rt(o),(function(t){return r.test(t.name)})))),Go(n,Vy,{name:t.name})},a=sp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:nc([ag("input-file-events",[rr(go()),rr(Oo())])])}),c=t.label.map((function(t){return Ry(t,n)})),s=Ey.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:nc([qS([]),VS(),tv.config({}),Cg.config({toggleClass:"dragenter",toggleOnExecute:!1}),ag("dropzone-events",[Zo("dragenter",o([e,Cg.toggle])),Zo("dragleave",o([e,Cg.toggle])),Zo("dragover",e),Zo("drop",o([e,r])),Zo(mo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},cp.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:nc([Ay.config({}),Dv(n.isReadOnly),Ev()])})]}]}}}});return My(c,s,["tox-form__group--stretched"],[])},JS=Xr("alloy-fake-before-tabstop"),$S=Xr("alloy-fake-after-tabstop"),QS=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:nc([dg.config({ignore:!0}),Ay.config({})])}},ZS=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[QS([JS]),t,QS([$S])],behaviours:nc([HS(1)])}},tk=function(t,n){Go(t,so(),{raw:{which:9,shiftKey:n}})},nk=function(t,n){var e=n.element;Ei(e,JS)?tk(t,!0):Ei(e,$S)&&tk(t,!1)},ek=function(t){return oy(t,["."+JS,"."+$S].join(","),a)},ok=!(ze().browser.isIE()||ze().browser.isEdge()),rk=function(t,n){var e,o,r=ok&&t.sandboxed,i=l(l({},t.label.map((function(t){return{title:t}})).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=se(""),{getValue:function(t){return o.get()},setValue:function(t,n){var r;e?Vr(t.element,"srcdoc",n):(Vr(t.element,"src","javascript:''"),(r=t.element.dom.contentWindow.document).open(),r.write(n),r.close()),o.set(n)}}),a=t.label.map((function(t){return Ry(t,n)})),c=Ey.parts.field({factory:{sketch:function(t){return ZS({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:nc([Ay.config({}),dg.config({}),XS(S.none(),u.getValue,u.setValue)])})}}});return My(a,c,["tox-form__group--stretched"],[])};function ik(t,n){return ck(document.createElement("canvas"),t,n)}function uk(t){var n=ik(t.width,t.height);return ak(n).drawImage(t,0,0),n}function ak(t){return t.getContext("2d")}function ck(t,n,e){return t.width=n,t.height=e,t}function sk(t){return t.naturalWidth||t.width}function lk(t){return t.naturalHeight||t.height}var fk,dk,mk,gk,pk=window.Promise?window.Promise:(fk=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Sk(t,hk(bk,this),hk(yk,this))},dk=window,mk=fk.immediateFn||"function"==typeof dk.setImmediate&&dk.setImmediate||function(t){setTimeout(t,1)},gk=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},fk.prototype["catch"]=function(t){return this.then(null,t)},fk.prototype.then=function(t,n){var e=this;return new fk((function(o,r){vk.call(e,new wk(t,n,o,r))}))},fk.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=Array.prototype.slice.call(1===t.length&&gk(t[0])?t[0]:t);return new fk((function(t,n){if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}e[i]=u,0==--o&&t(e)}catch(p){n(p)}}(r,e[r])}))},fk.resolve=function(t){return t&&"object"==typeof t&&t.constructor===fk?t:new fk((function(n){n(t)}))},fk.reject=function(t){return new fk((function(n,e){e(t)}))},fk.race=function(t){return new fk((function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)}))},fk);function hk(t,n){return function(){return t.apply(n,arguments)}}function vk(t){var n=this;null!==this._state?mk((function(){var e,o=n._state?t.onFulfilled:t.onRejected;if(null!==o){try{e=o(n._value)}catch(g){return void t.reject(g)}t.resolve(e)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function bk(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void Sk(hk(n,t),hk(bk,this),hk(yk,this))}this._state=!0,this._value=t,xk.call(this)}catch(g){yk.call(this,g)}}function yk(t){this._state=!1,this._value=t,xk.call(this)}function xk(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];vk.call(this,e)}this._deferreds=[]}function wk(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function Sk(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(h){if(o)return;o=!0,e(h)}}function kk(t){return new pk((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return S.none();for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return S.some(new Blob(c,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))}function Ck(t,n,e){return n=n||"image/png",A(HTMLCanvasElement.prototype.toBlob)?new pk((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):kk(t.toDataURL(n,e))}function Ok(t){return n=t,new pk((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)};function u(){i(),t(r)}function a(){i(),e("Unable to load data of type "+n.type+": "+o)}r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&u()})).then((function(t){var n;n=t,URL.revokeObjectURL(n.src);var e=ik(sk(t),lk(t));return ak(e).drawImage(t,0,0),e}));var n}function _k(t,n,o){var r=n.type;function i(n,e){return t.then((function(t){return r=e,o=(o=n)||"image/png",t.toDataURL(o,r);var o,r}))}return{getType:e(r),toBlob:function(){return pk.resolve(n)},toDataURL:e(o),toBase64:function(){return o.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return Ck(t,n,e)}))},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(uk)}}}function Tk(t){return n=t,new pk((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})).then((function(n){return _k(Ok(t),t,n)}));var n}function Ek(t,n){return Ck(t,n).then((function(n){return _k(pk.resolve(t),n,t.toDataURL())}))}var Bk=Tk;function Dk(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o}function Ak(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var Mk=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function Fk(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r}function Ik(t,n){return t.toCanvas().then((function(e){return o=e,r=t.getType(),i=n,u=ak(o),a=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(u.getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),Ek(o,r);var o,r,i,u,a}))}function Rk(t,n){return t.toCanvas().then((function(e){return o=e,r=t.getType(),i=n,u=ak(o),a=u.getImageData(0,0,o.width,o.height),c=u.getImageData(0,0,o.width,o.height),c=function(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}(a,c,i),u.putImageData(c,0,0),Ek(o,r);var o,r,i,u,a,c}))}function Vk(t){return function(n,e){return Ik(n,t(Ak(),e))}}var Pk,Hk,zk,Nk,Lk=(Pk=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return Ik(t,Pk)}),jk=Vk((function(t,n){return Fk(t,[1,0,0,0,n=Dk(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),Uk=Vk((function(t,n){var e;return n=Dk(n,-1,1),Fk(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?Mk[n]:Mk[Math.floor(n)]*(1-e)+Mk[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Wk=(Hk=[0,-1,0,-1,5,-1,0,-1,0],function(t){return Rk(t,Hk)}),Gk=(zk=function(t,n){return 255*Math.pow(t/255,1-n)},Nk=function(t,n,e){for(var o=ak(t),r=new Array(256),i=0;i<r.length;i++)r[i]=zk(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),Ek(t,n)},function(t,n){return t.toCanvas().then((function(e){return Nk(e,t.getType(),n)}))});function Xk(t,n,e){var o=sk(t),r=lk(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c,s,l,f=(c=t,s=i,l=u,new pk((function(t){var n=sk(c),e=lk(c),o=Math.floor(n*s),r=Math.floor(e*l),i=ik(o,r);ak(i).drawImage(c,0,0,n,e,0,0,o,r),t(i)})));return a?f.then((function(t){return Xk(t,n,e)})):f}function Yk(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=ik(t.width,t.height),r=ak(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||ck(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),Ek(o,n)}(e,t.getType(),n)}))}function qk(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=ik(t.width,t.height),r=ak(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),Ek(o,n)}(e,t.getType(),n)}))}function Kk(t,n,e,o,r){return t.toCanvas().then((function(i){return u=i,a=t.getType(),c=n,s=e,ak(l=ik(o,r)).drawImage(u,-c,-s),Ek(l,a);var u,a,c,s,l}))}var Jk,$k=function(t){return Lk(t)},Qk=function(t){return Wk(t)},Zk=function(t,n){return Gk(t,n)},tC=function(t,n,e,o){return Ik(t,(r=Ak(),i=e,u=o,Fk(r,[Dk(n,0,2),0,0,0,0,0,i=Dk(i,0,2),0,0,0,0,0,u=Dk(u,0,2),0,0,0,0,0,1,0,0,0,0,0,1])));var r,i,u},nC=function(t,n){return jk(t,n)},eC=function(t,n){return Uk(t,n)},oC=qk,rC=Kk,iC=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then((function(t){return Xk(t,r,i).then((function(t){return Ek(t,o.getType())}))}));var o,r,i},uC=Yk,aC=function(t,n){return l({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},cC=function(t,n){return aC(fp(t,n),{})},sC=function(t,n){return aC(fp(t,n),{behaviours:nc([ug.config({})])})},lC=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:nc([ug.config({})])}},fC=Xr("toolbar.button.execute"),dC=((Jk={})[ko()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Jk),mC=Xr("update-menu-text"),gC=Xr("update-menu-icon"),pC=function(n,e,o){var i=se(t),u=n.text.map((function(t){return sp(lC(t,e,o.providers))})),a=n.icon.map((function(t){return sp(sC(t,o.providers.icons))})),c=function(t,n){var e=Hl.getValue(t);return dg.focus(e),Go(e,"keydown",{raw:n.event.raw}),Ix.close(e),S.some(!0)},s=n.role.fold((function(){return{}}),(function(t){return{role:t}})),f=n.tooltip.fold((function(){return{}}),(function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}}));return sp(Ix.sketch(l(l(l({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[e,e+"--select"].concat(j(n.classes,(function(t){return e+"--"+t}))),attributes:l({},f)},components:Pv([a.map((function(t){return t.asSpec()})),u.map((function(t){return t.asSpec()})),S.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:fp("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:nc(d(n.dropdownBehaviours,[Dv((function(){return n.disabled||o.providers.isReadOnly()})),Ev(),Rx.config({}),ug.config({}),ag("dropdown-events",[Iv(n,i),Rv(n,i)]),ag("menubutton-update-display-text",[Zo(mC,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){ug.set(t,[au(o.providers.translate(n.event.text))])}))})),Zo(gC,(function(t,n){a.bind((function(n){return n.getOpt(t)})).each((function(t){ug.set(t,[sC(n.event.icon,o.providers.icons)])}))}))])])),eventOrder:Ht(dC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:nc([ng.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:gh(0,n.columns,n.presets)},fetch:function(t){return ix(r(n.fetch,t))}}))).asSpec()},hC=function(t){return"separator"===t.type},vC={type:"separator"},bC=function(t,n){var e=Y(t,(function(t,e){return O(e)?""===e?t:"|"===e?0<t.length&&!hC(t[t.length-1])?t.concat([vC]):t:Ft(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return 0<e.length&&hC(e[e.length-1])&&e.pop(),e},yC=function(t,n){return Ft(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=xC(r,o),{item:e,menus:Ht(i.menus,Kt(e.value,i.items)),expansions:Ht(i.expansions,Kt(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i},xC=function(t,n){var e=bC(O(t)?t.split(" "):t,n);return X(e,(function(t,e){var o=function(t){if(hC(t))return t;var n=Mt(t,"value").getOrThunk((function(){return Xr("generated-menu-item")}));return Ht({value:n},t)}(e),r=yC(o,n);return{menus:Ht(t.menus,r.menus),items:[r.item].concat(t.items),expansions:Ht(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},wC=function(t,n,e,o){var r=Xr("primary-menu"),i=xC(t,e.shared.providers.menuItems());if(0===i.items.length)return S.none();var u=Jb(r,i.items,n,e,o),a=_t(i.menus,(function(t,o){return Jb(o,t,n,e,!1)})),c=Ht(a,Kt(r,u));return S.from(qg.tieredData(r,c,i.expansions))},SC=function(t){return{isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)},setActive:function(n){var e=t.element;n?(Oi(e,"tox-tbtn--enabled"),Vr(e,"aria-pressed",!0)):(Ti(e,"tox-tbtn--enabled"),Nr(e,"aria-pressed"))},isActive:function(){return Ei(t.element,"tox-tbtn--enabled")}}},kC=function(t,n,e,o){return pC({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(wC(t,nh.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:SC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ay.config({})]},n,e.shared)},CC=function(t,n,e){return function(o){o(j(t,(function(t){var o,r,i=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return l(l({type:t.type,active:!1},i),{onAction:function(t){var o=!t.isActive();t.setActive(o),r.storage.set(o),e.shared.getSink().each((function(t){n().getOpt(t).each((function(t){sc(t.element),Go(t,zy,{name:r.name,value:r.storage.get()})}))}))},onSetup:(o=r=t,function(t){t.setActive(o.storage.get())})})})))}},OC=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=l({buttonBehaviours:nc([Dv((function(){return t.disabled||i.isReadOnly()})),Ev(),Ay.config({}),ag("button press",[Qo("click"),Qo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Ht(a,{dom:o});return Ht(c,{components:r})},_C=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return cC(t,e.icons)})),u=Pv([i]);return OC(t,n,o,r,u,e)},TC=function(t,n,e,o){void 0===o&&(o=[]);var r=_C(t,S.some(n),e,o);return cp.sketch(r)},EC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return cC(t,e.icons)})):S.none(),a=u.isSome()?Pv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=d(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),f=l(l({tag:"button",classes:s},c),{attributes:{title:i}});return OC(t,n,o,f,a,e)},BC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=EC(t,S.some(n),e,o,r);return cp.sketch(i)},DC=function(t,n){return function(e){"custom"===n?Go(e,zy,{name:t,value:{}}):"submit"===n?Wo(e,Ny):"cancel"===n?Wo(e,Hy):console.error("Unknown button type: ",n)}},AC=function(n,e,o){if("menu"===e){var r=n,i=l(l({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:CC(r.items,(function(){return u}),o)}),u=sp(kC(i,"tox-tbtn",o,S.none()));return u.asSpec()}if("custom"===(s=e)||"cancel"===s||"submit"===s){var a=DC(n.name,e),c=l(l({},n),{borderless:!1});return BC(c,a,o.shared.providers,[])}var s;console.error("Unknown footer button type: ",e)},MC=function(t,n){var e,o,r=DC(t.name,"custom");return e=S.none(),o=Ey.parts.field(l({factory:cp},EC(t,S.some(r),n,[qS(""),VS()]))),My(e,o,[],[])},FC=e([te("field1Name","field1"),te("field2Name","field2"),da("onLockedChange"),ca(["lockClass"]),te("locked",!1),jl("coupledFieldBehaviours",[Kf,Hl])]),IC=function(t,n){return pf({factory:Ey,name:t,overrides:function(t){return{fieldBehaviours:nc([ag("coupled-input-behaviour",[Zo(fo(),(function(e){Bf(e,t,n).bind(Kf.getCurrent).each((function(n){Bf(e,t,"lock").each((function(o){Cg.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},RC=e([IC("field1","field2"),IC("field2","field1"),pf({factory:cp,schema:[Nn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:nc([Cg.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),VC=Wf({name:"FormCoupledInputs",configFields:FC(),partFields:RC(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Ul(t.coupledFieldBehaviours,[Kf.config({find:S.some}),Hl.config({store:{mode:"manual",getValue:function(n){var e=If(n,t,["field1","field2"]),o={};return o[t.field1Name]=Hl.getValue(e.field1()),o[t.field2Name]=Hl.getValue(e.field2()),o},setValue:function(n,e){var o=If(n,t,["field1","field2"]);It(e,t.field1Name)&&Hl.setValue(o.field1(),e[t.field1Name]),It(e,t.field2Name)&&Hl.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Bf(n,t,"field1")},getField2:function(n){return Bf(n,t,"field2")},getLock:function(n){return Bf(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),PC=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return ct.error(t);var e=parseFloat(n[1]),o=n[2];return ct.value({value:e,unit:o})},HC=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?S.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?S.some(t.value):S.some(t.value/e[t.unit]*e[n]):S.none()},zC=function(t){return S.none()},NC=function(t,n){var e,o,r,i=PC(t).toOptional(),u=PC(n).toOptional();return o=u,r=function(t,n){return HC(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return HC(t,o).map((function(t){return{value:t*e,unit:o}}))};var e,o})).getOr(zC)},((e=i).isSome()&&o.isSome()?S.some(r(e.getOrDie(),o.getOrDie())):S.none()).getOr(zC)},LC=function(t,n){var e=zC,o=Xr("ratio-event"),r=VC.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:fp("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:fp("unlock",n.icons)}}],buttonBehaviours:nc([tv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Ev(),Ay.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return Ey.parts.field({factory:Ky,inputClasses:["tox-textfield"],inputBehaviours:nc([tv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Ev(),Ay.config({}),ag("size-input-events",[Zo(ao(),(function(t,n){Go(t,o,{isField1:e})})),Zo(mo(),(function(n,e){Go(n,Vy,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=VC.parts.field1(i([Ey.parts.label(a("Width")),u(!0)])),s=VC.parts.field2(i([Ey.parts.label(a("Height")),u(!1)]));return VC.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){PC(Hl.getValue(t)).each((function(t){e(t).each((function(t){var e,o,r,i;Hl.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))}))}))},coupledFieldBehaviours:nc([tv.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){VC.getField1(t).bind(Ey.getField).each(tv.disable),VC.getField2(t).bind(Ey.getField).each(tv.disable),VC.getLock(t).each(tv.disable)},onEnabled:function(t){VC.getField1(t).bind(Ey.getField).each(tv.enable),VC.getField2(t).bind(Ey.getField).each(tv.enable),VC.getLock(t).each(tv.enable)}}),Ev(),ag("size-input-events2",[Zo(o,(function(t,n){var o=n.event.isField1,r=o?VC.getField1(t):VC.getField2(t),i=o?VC.getField2(t):VC.getField1(t),u=r.map(Hl.getValue).getOr(""),a=i.map(Hl.getValue).getOr("");e=NC(u,a)}))])])})},jC={undo:e(Xr("undo")),redo:e(Xr("redo")),zoom:e(Xr("zoom")),back:e(Xr("back")),apply:e(Xr("apply")),swap:e(Xr("swap")),transform:e(Xr("transform")),tempTransform:e(Xr("temp-transform")),transformApply:e(Xr("transform-apply"))},UC=e("save-state"),WC=e("disable"),GC=e("enable"),XC={formActionEvent:zy,saveState:UC,disable:WC,enable:GC},YC=function(n,o){var r=function(t,n,e,r){return sp(BC({name:t,text:t,disabled:e,primary:r,icon:S.none(),borderless:!1},n,o))},i=function(t,n,e,r){return sp(TC({name:t,icon:S.some(t),tooltip:S.some(n),disabled:r,primary:!1,borderless:!1},e,o))},u=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(tv)&&tv.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(tv)&&tv.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=t,l=function(t,n,e){Go(t,n,e)},f=function(t){return Wo(t,XC.disable())},d=function(t){return Wo(t,XC.enable())},m=function(t,n){f(t),l(t,jC.transform(),{transform:n}),d(t)},g=function(t){return function(){Z.getOpt(t).each((function(t){ug.set(t,[$])}))}},p=function(t,n){f(t),l(t,jC.transformApply(),{transform:n,swap:g(t)}),d(t)},h=function(){return r("Back",(function(t){return l(t,jC.back(),{swap:g(t)})}),!1,!1)},v=function(){return sp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:nc([tv.config({})])})},b=function(){return r("Apply",(function(t){return l(t,jC.apply(),{swap:g(t)})}),!0,!0)},y=[h(),v(),r("Apply",(function(t){p(t,(function(t){var e=n.getRect();return rC(t,e.x,e.y,e.w,e.h)})),n.hideCrop()}),!1,!0)],x=Cy.sketch({dom:c,components:y.map((function(t){return t.asSpec()})),containerBehaviours:nc([ag("image-tools-crop-buttons-events",[Zo(XC.disable(),(function(t,n){u(y,t)})),Zo(XC.enable(),(function(t,n){a(y,t)}))])])}),w=sp(LC({name:"size",label:S.none(),constrain:!0,disabled:!1},o)),k=[h(),v(),w,v(),r("Apply",(function(t){w.getOpt(t).each((function(n){var e,o,r=Hl.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return iC(t,e,o)});p(t,a)}))}),!1,!0)],C=Cy.sketch({dom:c,components:k.map((function(t){return t.asSpec()})),containerBehaviours:nc([ag("image-tools-resize-buttons-events",[Zo(XC.disable(),(function(t,n){u(k,t)})),Zo(XC.enable(),(function(t,n){a(k,t)}))])])}),O=function(t,n){return function(e){return t(e,n)}},_=O(oC,"h"),T=O(oC,"v"),E=O(uC,-90),B=O(uC,90),D=function(t,n){var e,o;o=n,f(e=t),l(e,jC.tempTransform(),{transform:o}),d(e)},A=[h(),v(),i("flip-horizontally","Flip horizontally",(function(t){D(t,_)}),!1),i("flip-vertically","Flip vertically",(function(t){D(t,T)}),!1),i("rotate-left","Rotate counterclockwise",(function(t){D(t,E)}),!1),i("rotate-right","Rotate clockwise",(function(t){D(t,B)}),!1),v(),b()],M=Cy.sketch({dom:c,components:A.map((function(t){return t.asSpec()})),containerBehaviours:nc([ag("image-tools-fliprotate-buttons-events",[Zo(XC.disable(),(function(t,n){u(A,t)})),Zo(XC.enable(),(function(t,n){a(A,t)}))])])}),F=function(t,n,r,i,u){var a=CS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:o.translate(t)}}),c=CS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=CS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return sp(CS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:e({x:i})},components:[a,c,s],sliderBehaviours:nc([dg.config({})]),onChoose:n}))},I=function(t,n,e,o,r){return[h(),(i=n,F(t,(function(t,n,e){var o=O(i,e.x/100);m(t,o)}),e,o,r)),b()];var i},R=function(t,n,e,o,r){var i=I(t,n,e,o,r);return Cy.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:nc([ag("image-tools-filter-panel-buttons-events",[Zo(XC.disable(),(function(t,n){u(i,t)})),Zo(XC.enable(),(function(t,n){a(i,t)}))])])})},V=[h(),v(),b()],P=Cy.sketch({dom:c,components:V.map((function(t){return t.asSpec()}))}),H=R("Brightness",nC,-100,0,100),z=R("Contrast",eC,-100,0,100),N=R("Gamma",Zk,-100,0,100),L=function(t){return F(t,(function(t,n,e){var o=j.getOpt(t),r=W.getOpt(t),i=U.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r,i,u,a=Hl.getValue(n).x/100,c=Hl.getValue(o).x/100,s=Hl.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return tC(t,r,i,u)});m(t,l)}))}))}))}),0,100,200)},j=L("R"),U=L("G"),W=L("B"),G=[h(),j,U,W,b()],X=Cy.sketch({dom:c,components:G.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){l(o,jC.swap(),{transform:n,swap:function(){Z.getOpt(o).each((function(n){ug.set(n,[t]),e(n)}))}})}},q=S.some(Qk),K=S.some($k),J=[i("crop","Crop",Y(x,S.none(),(function(t){n.showCrop()})),!1),i("resize","Resize",Y(C,S.none(),(function(t){w.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Hl.setValue(t,{width:o,height:r})}))})),!1),i("orientation","Orientation",Y(M,S.none(),s),!1),i("brightness","Brightness",Y(H,S.none(),s),!1),i("sharpen","Sharpen",Y(P,q,s),!1),i("contrast","Contrast",Y(z,S.none(),s),!1),i("color-levels","Color levels",Y(X,S.none(),s),!1),i("gamma","Gamma",Y(N,S.none(),s),!1),i("invert","Invert",Y(P,K,s),!1)],$=Cy.sketch({dom:c,components:J.map((function(t){return t.asSpec()}))}),Q=Cy.sketch({dom:{tag:"div"},components:[$],containerBehaviours:nc([ug.config({})])}),Z=sp(Q);return{memContainer:Z,getApplyButton:function(t){return Z.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},qC=tinymce.util.Tools.resolve("tinymce.geom.Rect"),KC=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),JC=tinymce.util.Tools.resolve("tinymce.util.Observable"),$C=tinymce.util.Tools.resolve("tinymce.util.Tools"),QC=tinymce.util.Tools.resolve("tinymce.util.VK");function ZC(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function tO(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(ZC(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){ZC(t),KC(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)};this.destroy=function(){KC(a).off()},KC(a).on("mousedown touchstart",(function(t){var l,f,d,m,g,p,h,v,b,y,x=(l=u,f=Math.max,d=l.documentElement,m=l.body,g=f(d.scrollWidth,m.scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v});ZC(t),t.preventDefault(),o=t.button;var w=a;r=t.screenX,i=t.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,e=KC("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),KC(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)}))}var nO=0,eO=function(t,n,e,o,r){var i,u="tox-",a="tox-crid-"+nO++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},f=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}};function d(n,o,r,i){var u,a=o.x,c=o.y,s=o.w,l=o.h;a+=r*n.deltaX,c+=i*n.deltaY,(s+=r*n.deltaW)<20&&(s=20),(l+=i*n.deltaH)<20&&(l=20),u=t=qC.clamp({x:a,y:c,w:s,h:l},e,"move"===n.name),u=f(e,u),h.fire("updateRect",{rect:u}),p(u)}function m(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),KC("#"+a+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}$C.each(c,(function(n){KC("#"+a+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function g(n){m(t=n)}function p(t){g(l(e,t))}KC('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),$C.each(s,(function(t){KC("#"+a,o).append('<div id="'+a+"-"+t+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),$C.each(c,(function(t){KC("#"+a,o).append('<div id="'+a+"-"+t.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=$C.map(c,(function(n){var e;return new tO(a,{document:o.ownerDocument,handle:a+"-"+n.name,start:function(){e=t},drag:function(t){d(n,e,t.deltaX,t.deltaY)}})})),m(t),KC(o).on("focusin focusout",(function(t){KC(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),KC(o).on("keydown",(function(n){var e;function o(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),d(e,o,r,i)}switch($C.each(c,(function(t){if(n.target.id===a+"-"+t.name)return e=t,!1})),n.keyCode){case QC.LEFT:o(n,0,t,-10,0);break;case QC.RIGHT:o(n,0,t,10,0);break;case QC.UP:o(n,0,t,0,-10);break;case QC.DOWN:o(n,0,t,0,10);break;case QC.ENTER:case QC.SPACEBAR:n.preventDefault(),r()}}));var h=$C.extend({toggleVisibility:function(t){var n=$C.map(c,(function(t){return"#"+a+"-"+t.name})).concat($C.map(s,(function(t){return"#"+a+"-"+t}))).join(",");t?KC(n,o).show():KC(n,o).hide()},setClampRect:function(n){e=n,m(t)},setRect:g,getInnerRect:function(){return f(e,t)},setInnerRect:p,setViewPortRect:function(e){n=e,m(t)},destroy:function(){$C.each(i,(function(t){t.destroy()})),i=[]}},JC);return h},oO=function(t){var n=sp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=se(1),o=se(S.none()),r=se({x:0,y:0,w:1,h:1}),i=se({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=Su(t.element),c=gu(t.element),s=i.dom.naturalWidth*u,l=i.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Gi(i,m),n.getOpt(t).each((function(t){Gi(t.element,m)})),o.get().each((function(t){var n=r.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=fe.fromTag("img");return Vr(a,"src",n),o=a.dom,new Ep((function(t){var n=function(){o.removeEventListener("load",n),t(o)};o.complete?t(o):o.addEventListener("load",n)})).then((function(){return s.getOpt(t).map((function(t){var n=cu({element:a});ug.replaceAt(t,1,S.some(n));var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight};i.set(c);var l,f,d=qC.inflate(c,-20,-20);return r.set(d),o.w===c.w&&o.h===c.h||(l=t,f=a,s.getOpt(l).each((function(t){var n=Su(t.element),o=gu(t.element),r=f.dom.naturalWidth,i=f.dom.naturalHeight,u=Math.min(n/r,o/i);1<=u?e.set(1):e.set(u)}))),u(t,a),a}))}))},c=Cy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:nc([ag("image-panel-crop-events",[ur((function(t){s.getOpt(t).each((function(t){var n=t.element.dom,i=eO({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,(function(){}));i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(S.some(i))}))}))])])}],containerBehaviours:nc([ug.config({}),ag("image-panel-events",[ur((function(n){a(n,t)}))])])}),s=sp(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=0<n?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element;u(t,n)}))},showCrop:function(){o.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},rO=function(t,n,e,o,r){return TC({name:t,icon:S.some(n),disabled:e,tooltip:S.some(t),primary:!1,borderless:!1},o,r)},iO=function(t,n){n?tv.enable(t):tv.disable(t)};function uO(){var t=[],n=-1;function e(){return 0<n}function o(){return-1!==n&&n<t.length-1}return{data:t,add:function(e){var o=t.splice(++n);return t.push(e),{state:e,removed:o}},undo:function(){if(e())return t[--n]},redo:function(){if(o())return t[++n]},canUndo:e,canRedo:o}}var aO,cO,sO,lO=function(t){var n=se(t),e=se(S.none()),o=uO();o.add(t);var r=function(t){n.set(t)},i=function(t){return{blob:t,url:URL.createObjectURL(t)}},u=function(t){URL.revokeObjectURL(t.url)},a=function(){e.get().each(u),e.set(S.none())},c=function(t){var n=i(t);r(n);var e,a=o.add(n).removed;return e=a,$C.each(e,u),n.url};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().fold((function(){return n.get()}),(function(t){return t}))},updateTempState:function(t){var n=i(t);return a(),e.set(S.some(n)),n.url},addTempState:function(t){var n=i(t);return e.set(S.some(n)),n.url},applyTempState:function(t){return e.get().fold((function(){}),(function(n){c(n.blob),t()}))},destroyTempState:a,undo:function(){var t=o.undo();return r(t),t.url},redo:function(){var t=o.redo();return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},fO=function(n,e){var o,r,i,u=lO(n.currentState),a=function(t){var n=u.getHistoryStates();h.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Go(t,XC.formActionEvent,{name:XC.saveState(),value:n.undoEnabled})},c=function(t){return t.toBlob()},s=function(t){Go(t,XC.formActionEvent,{name:XC.disable(),value:{}})},l=function(t){v.getApplyButton(t).each((function(t){tv.enable(t)})),Go(t,XC.formActionEvent,{name:XC.enable(),value:{}})},f=function(t,n){return s(t),p.updateSrc(t,n)},d=function(t,n,e,o,r){return s(t),Bk(n).then(e).then(c).then(o).then((function(n){return f(t,n).then((function(n){return a(t),r(),l(t),n}))}))["catch"]((function(n){return console.log(n),l(t),n}))},m=function(t,n,e){var o=u.getBlobState().blob;d(t,o,n,(function(t){return u.updateTempState(t)}),e)},g=function(t){var n=u.getBlobState().url;return u.destroyTempState(),a(t),n},p=oO(n.currentState.url),h=(r=sp(rO("Undo","undo",!0,(function(t){Go(t,jC.undo(),{direction:1})}),o=e)),i=sp(rO("Redo","redo",!0,(function(t){Go(t,jC.redo(),{direction:1})}),o)),{container:Cy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[r.asSpec(),i.asSpec(),rO("Zoom in","zoom-in",!1,(function(t){Go(t,jC.zoom(),{direction:1})}),o),rO("Zoom out","zoom-out",!1,(function(t){Go(t,jC.zoom(),{direction:-1})}),o)]}),updateButtonUndoStates:function(t,n,e){r.getOpt(t).each((function(t){iO(t,n)})),i.getOpt(t).each((function(t){iO(t,e)}))}}),v=YC(p,e);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[v.memContainer.asSpec(),p.memContainer.asSpec(),h.container],behaviours:nc([Hl.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),ag("image-tools-events",[Zo(jC.undo(),(function(t,n){var e=u.undo();f(t,e).then((function(n){l(t),a(t)}))})),Zo(jC.redo(),(function(t,n){var e=u.redo();f(t,e).then((function(n){l(t),a(t)}))})),Zo(jC.zoom(),(function(t,n){var e=n.event.direction;p.zoom(t,e)})),Zo(jC.back(),(function(t,n){var e,o;o=g(e=t),f(e,o).then((function(t){l(e)})),(0,n.event.swap)(),p.hideCrop()})),Zo(jC.apply(),(function(t,n){u.applyTempState((function(){g(t),(0,n.event.swap)()}))})),Zo(jC.transform(),(function(n,e){return m(n,e.event.transform,t)})),Zo(jC.tempTransform(),(function(n,e){return o=n,r=e.event.transform,i=u.getTempState().blob,void d(o,i,r,(function(t){return u.addTempState(t)}),t);var o,r,i})),Zo(jC.transformApply(),(function(t,n){return e=t,o=n.event.transform,r=n.event.swap,i=u.getBlobState().blob,void d(e,i,o,(function(t){var n=u.addBlobState(t);return g(e),n}),r);var e,o,r,i})),Zo(jC.swap(),(function(t,n){var e;e=t,h.updateButtonUndoStates(e,!1,!1);var o=n.event.transform,r=n.event.swap;o.fold((function(){r()}),(function(n){m(t,n,r)}))}))]),VS()])}},dO=function(t){return!Ft(t,"items")},mO="data-value",gO=function(t,n,e,o){return j(e,(function(e){return dO(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Hl.setValue(t,e.value),Go(t,Vy,{name:n}),dg.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return gO(t,n,e.items,o)}}}))},pO=function(t,n){return it(t,(function(t){return dO(t)?(e=t.value===n,o=t,e?S.some(o):S.none()):pO(t.items,n);var e,o}))},hO=Uf({name:"HtmlSelect",configFields:[Nn("options"),zl("selectBehaviours",[dg,Hl]),te("selectClasses",[]),te("selectAttributes",{}),qn("data")],factory:function(t,n){var e=j(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return Kt("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Ll(t.selectBehaviours,[dg.config({}),Hl.config({store:l({mode:"manual",getValue:function(t){return Zi(t.element)},setValue:function(n,e){q(t.options,(function(t){return t.value===e})).isSome()&&tu(n.element,e)}},o)})])}}}),vO=function(t,n){var o=t.label.map((function(t){return Ry(t,n)})),r=[tv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Ev(),ng.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Wo(t,Ny),S.some(!0)}}),ag("textfield-change",[Zo(fo(),(function(n,e){Go(n,Vy,{name:t.name})})),Zo(wo(),(function(n,e){Go(n,Vy,{name:t.name})}))]),Ay.config({})],i=t.validation.map((function(t){return hx.config({getRoot:function(t){return xr(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Hl.getValue(n),o=t.validator(e);return ux(!0===o?ct.value(e):ct.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(e({}),(function(t){return{placeholder:n.translate(t)}})),a=t.inputMode.fold(e({}),(function(t){return{inputmode:t}})),c=l(l({},u),a),s=Ey.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:nc(J([r,i])),selectOnFocus:!1,factory:Ky}),f=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),d=[tv.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){Ey.getField(t).each(tv.disable)},onEnabled:function(t){Ey.getField(t).each(tv.enable)}}),Ev()];return My(o,s,f,d)},bO=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Jo([Zo(t.event,e),ar((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Zo(t,(function(){return n.cancel()}))]})).getOr([])))}}),yO=function(t){var n=se(null);return si({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},xO=Object.freeze({__proto__:null,throttle:yO,init:function(t){return t.stream.streams.state(t)}}),wO=[Ln("stream",Dn("mode",{throttle:[Nn("delay"),te("stopEvent",!0),ga("streams",{setup:function(t,n){var e=t.stream,o=vp(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:yO})]})),te("event","input"),qn("cancelEvent"),da("onStream")],SO=oc({fields:wO,name:"streaming",active:bO,state:xO}),kO=function(t,n,e){var o=Hl.getValue(e);Hl.setValue(n,o),OO(n)},CO=function(t,n){var e=t.element,o=Zi(e),r=e.dom;"number"!==Pr(e,"type")&&n(r,o)},OO=function(t){CO(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},_O=function(t,n,e){if(t.selectsOver){var o=Hl.getValue(n),r=t.getDisplayText(o),i=Hl.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?S.some((function(){var t,o;kO(0,n,e),t=n,o=r.length,CO(t,(function(t,n){return t.setSelectionRange(o,n.length)}))})):S.none()}return S.none()},TO=e("alloy.typeahead.itemexecute"),EO=e([qn("lazySink"),Nn("fetch"),te("minChars",5),te("responseTime",1e3),la("onOpen"),te("getHotspot",S.some),te("getAnchorOverrides",e({})),te("layouts",S.none()),te("eventOrder",{}),ae("model",{},[te("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),te("selectsOver",!0),te("populateFromBrowse",!0)]),la("onSetValue"),fa("onExecute"),la("onItemExecute"),te("inputClasses",[]),te("inputAttributes",{}),te("inputStyles",{}),te("matchWidth",!0),te("useMinWidth",!1),te("dismissOnBlur",!0),ca(["openClass"]),qn("initialData"),zl("typeaheadBehaviours",[dg,Hl,SO,ng,Cg,yx]),ce("previewing",(function(){return se(!0)}))].concat(Xy()).concat(Ax())),BO=e([hf({schema:[aa()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){_O(t.model,o,e).fold((function(){return ud.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&kO(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Go(t,TO(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&kO(t.model,n,e)}))}}}})]),DO=Wf({name:"Typeahead",configFields:EO(),partFields:BO(),factory:function(n,e,o,r){var i=function(e,o,i){n.previewing.set(!1);var u=yx.getCoupled(e,"sandbox");bl.isOpen(u)?Kf.getCurrent(u).each((function(t){ud.getHighlighted(t).fold((function(){i(t)}),(function(){Ko(u,t.element,"keydown",o)}))})):kx(n,a(e),e,u,r,(function(t){Kf.getCurrent(t).each(i)}),Qy.HighlightFirst).get(t)},u=Yy(n),a=function(t){return function(n){return n.map((function(n){var e=At(n.menus),o=$(e,(function(t){return G(t.items,(function(t){return"item"===t.type}))}));return Hl.getState(t).update(j(o,(function(t){return t.data}))),n}))}},c=[dg.config({}),Hl.config({onSetValue:n.onSetValue,store:l({mode:"dataset",getDataKey:function(t){return Zi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,e){tu(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(t){return Kt("initialValue",t)})).getOr({}))}),SO.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(e,o){var i,u=yx.getCoupled(e,"sandbox");dg.isFocused(e)&&Zi(e.element).length>=n.minChars&&(i=Kf.getCurrent(u).bind((function(t){return ud.getHighlighted(t).map(Hl.getValue)})),n.previewing.set(!0),kx(n,a(e),e,u,r,(function(t){Kf.getCurrent(u).each((function(t){i.fold((function(){n.model.selectsOver&&ud.highlightFirst(t)}),(function(n){ud.highlightBy(t,(function(t){return Hl.getValue(t).value===n.value})),ud.getHighlighted(t).orThunk((function(){return ud.highlightFirst(t),S.none()}))}))}))}),Qy.HighlightFirst).get(t))},cancelEvent:Eo()}),ng.config({mode:"special",onDown:function(t,n){return i(t,n,ud.highlightFirst),S.some(!0)},onEscape:function(t){var n=yx.getCoupled(t,"sandbox");return bl.isOpen(n)?(bl.close(n),S.some(!0)):S.none()},onUp:function(t,n){return i(t,n,ud.highlightLast),S.some(!0)},onEnter:function(t){var e=yx.getCoupled(t,"sandbox"),o=bl.isOpen(e);if(o&&!n.previewing.get())return Kf.getCurrent(e).bind((function(t){return ud.getHighlighted(t)})).map((function(n){return Go(t,TO(),{item:n}),!0}));var r=Hl.getValue(t);return Wo(t,Eo()),n.onExecute(e,t,r),o&&bl.close(e),S.some(!0)}}),Cg.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),yx.config({others:{sandbox:function(t){return Bx(n,t,{onOpen:function(){return Cg.on(t)},onClose:function(){return Cg.off(t)}})}}}),ag("typeaheadevents",[sr((function(e){var o=t;Ox(n,a(e),e,r,o,Qy.HighlightFirst).get(t)})),Zo(TO(),(function(t,e){var o=yx.getCoupled(t,"sandbox");kO(n.model,t,e.event.item),Wo(t,Eo()),n.onItemExecute(t,o,e.event.item,Hl.getValue(t)),bl.close(o),OO(t)}))].concat(n.dismissOnBlur?[Zo(xo(),(function(t){var n=yx.getCoupled(t,"sandbox");fc(n.element).isNone()&&bl.close(n)}))]:[]))];return{uid:n.uid,dom:qy(Ht(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:l(l({},u),Ll(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}}}),AO=function(t){return l(l({},t),{toCached:function(){return AO(t.toCached())},bindFuture:function(n){return AO(t.bind((function(t){return t.fold((function(t){return ux(ct.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return AO(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return AO(t.map((function(t){return t.map(n)})))},mapError:function(n){return AO(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return AO(ix((function(o){var r=!1,i=setTimeout((function(){r=!0,o(ct.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},MO=function(t){return AO(ix(t))},FO=MO,IO={type:"separator"},RO=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},VO=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}},PO=function(t,n){return o=t,e=G(n,(function(t){return t.type===o})),j(e,RO);var e,o},HO=function(t,n){var e=t.toLowerCase();return G(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return ye(n.toLowerCase(),e)||ye(t.value.toLowerCase(),e)}))},zO=function(t,n,e){var o=Hl.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i,u,a,c=HO(r,(o=e.getHistory(t),j(o,(function(t){return VO(t,t)}))));return"file"===t?(i=[c,HO(r,PO("header",n.targets)),HO(r,J([(a=n,S.from(a.anchorTop).map((function(t){return VO("<top>",t)})).toArray()),PO("anchor",n.targets),(u=n,S.from(u.anchorBottom).map((function(t){return VO("<bottom>",t)})).toArray())]))],Y(i,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(IO,n)}),[])):c}))},NO=Xr("aria-invalid"),LO=function(n,e,o){var r,i,u,a,c,s=e.shared.providers,f=function(t){var e=Hl.getValue(t);o.addToHistory(e.value,n.filetype)},d=Ey.parts.field({factory:DO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":NO,type:"url"},minChars:0,responseTime:0,fetch:function(t){var r=zO(n.filetype,t,o),i=wC(r,nh.BUBBLE_TO_SANDBOX,e,!1);return ux(i)},getHotspot:function(t){return b.getOpt(t)},onSetValue:function(n,e){n.hasConfigured(hx)&&hx.run(n).get(t)},typeaheadBehaviours:nc(J([o.getValidationHandler().map((function(t){return hx.config({getRoot:function(t){return xr(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){g.getOpt(t).each((function(t){Vr(t.element,"title",s.translate(n))}))}},validator:{validate:function(e){var o=Hl.getValue(e);return FO((function(e){t({type:n.filetype,url:o.value},(function(t){var n,o;"invalid"===t.status?(n=ct.error(t.message),e(n)):(o=ct.value(t.message),e(o))}))}))},validateOnLoad:!1}})})).toArray(),[tv.config({disabled:function(){return n.disabled||s.isReadOnly()}}),Ay.config({}),ag("urlinput-events",J(["file"===n.filetype?[Zo(fo(),(function(t){Go(t,Vy,{name:n.name})}))]:[],[Zo(mo(),(function(t){Go(t,Vy,{name:n.name}),f(t)})),Zo(wo(),(function(t){Go(t,Vy,{name:n.name}),f(t)}))]]))]])),eventOrder:((r={})[fo()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:gh(0,0,"normal")},onExecute:function(t,n,e){Go(n,Ny,{})},onItemExecute:function(t,e,o,r){f(t),Go(t,Vy,{name:n.name})}}),m=n.label.map((function(t){return Ry(t,s)})),g=sp((i="invalid",u=S.some(NO),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:fp(a,s.icons),attributes:l({title:s.translate(c),"aria-live":"polite"},u.fold((function(){return{}}),(function(t){return{id:t}})))}})),p=sp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=o.getUrlPicker(n.filetype),v=Xr("browser.url.event"),b=sp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,p.asSpec()],behaviours:nc([tv.config({disabled:function(){return n.disabled||s.isReadOnly()}})])}),y=sp(BC({name:n.name,icon:S.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(t){return Wo(t,v)}),s,[],["tox-browse-url"]));return Ey.sketch({dom:Iy([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:J([[b.asSpec()],h.map((function(){return y.asSpec()})).toArray()])}]),fieldBehaviours:nc([tv.config({disabled:function(){return n.disabled||s.isReadOnly()},onDisabled:function(t){Ey.getField(t).each(tv.disable),y.getOpt(t).each(tv.disable)},onEnabled:function(t){Ey.getField(t).each(tv.enable),y.getOpt(t).each(tv.enable)}}),Ev(),ag("url-input-events",[Zo(v,(function(t){Kf.getCurrent(t).each((function(e){var o=Hl.getValue(e),r=l({fieldname:n.name},o);h.each((function(o){o(r).get((function(o){Hl.setValue(e,o),Go(t,Vy,{name:n.name})}))}))}))}))])])})},jO=function(t){return function(n,e,o){return Mt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},UO={bar:jO((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:j(e.items,o.interpreter)};var e,o})),collection:jO((function(t,n){return Gy(t,n.shared.providers)})),alertbanner:jO((function(t,n){return e=t,o=n.shared.providers,Cy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[cp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:fp(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Go(t,zy,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o})),input:jO((function(t,n){return e=t,o=n.shared.providers,vO({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:S.none(),maximized:e.maximized},o);var e,o})),textarea:jO((function(t,n){return e=t,o=n.shared.providers,vO({name:e.name,multiline:!0,label:e.label,inputMode:S.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:S.none(),maximized:e.maximized},o);var e,o})),label:jO((function(t,n){return e=t,o=n.shared,r={dom:{tag:"label",innerHtml:o.providers.translate(e.label),classes:["tox-label"]}},i=j(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:nc([VS(),ug.config({}),YS(S.none()),ng.config({mode:"acyclic"})])};var e,o,r,i})),iframe:(aO=function(t,n){return rk(t,n.shared.providers)},function(t,n,e){var o=Ht(n,{source:"dynamic"});return jO(aO)(t,o,e)}),button:jO((function(t,n){return MC(t,n.shared.providers)})),checkbox:jO((function(t,n){return e=t,r=n.shared.providers,i=Hl.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),u=function(t){return t.element.dom.click(),S.some(!0)},a=Ey.parts.field({factory:{sketch:o},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:nc([VS(),tv.config({disabled:function(){return e.disabled||r.isReadOnly()}}),Ay.config({}),dg.config({}),i,ng.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),ag("checkbox-events",[Zo(mo(),(function(t,n){Go(t,Vy,{name:e.name})}))])])}),c=Ey.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:r.translate(e.label)},behaviours:nc([Rx.config({})])}),l=sp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:fp("checked"===t?"selected":"unselected",r.icons)}}})("checked"),s("unchecked")]}),Ey.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:nc([tv.config({disabled:function(){return e.disabled||r.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Ey.getField(t).each(tv.disable)},onEnabled:function(t){Ey.getField(t).each(tv.enable)}}),Ev()])});var e,r,i,u,a,c,s,l})),colorinput:jO((function(t,n){return zx(t,n.shared,n.colorinput)})),colorpicker:jO((function(t){var n=function(t){return"tox-"+t},e=RS(NS,n),o=sp(e.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Go(t,zy,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Go(t,zy,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:nc([Hl.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return Kf.getCurrent(n).bind((function(t){return Hl.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);Kf.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){Hl.setValue(t,{hex:S.from(e[1]).getOr("")}),ES.getField(t,"hex").each((function(t){Wo(t,fo())}))}))}}}),VS()])}})),dropzone:jO((function(t,n){return KS(t,n.shared.providers)})),grid:jO((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:j(e.items,o.interpreter)};var e,o})),listbox:jO((function(n,o){return r=n,u=(i=o).shared.providers,a=et(r.items).filter(dO),c=r.label.map((function(t){return Ry(t,u)})),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Ey.parts.field({dom:{},factory:{sketch:function(n){return pC({uid:n.uid,text:a.map((function(t){return t.text})),icon:S.none(),tooltip:r.label,role:S.none(),fetch:function(t,n){var e=gO(t,r.name,r.items,Hl.getValue(t));n(wC(e,nh.CLOSE_ON_EXECUTE,i,!1))},onSetup:e(t),getApi:e({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ay.config({}),Hl.config({store:{mode:"manual",initialValue:a.map((function(t){return t.value})).getOr(""),getValue:function(t){return Pr(t.element,mO)},setValue:function(t,n){pO(r.items,n).each((function(n){Vr(t.element,mO,n.value),Go(t,mC,{text:n.text})}))}}})]},"tox-listbox",i.shared)}}})]},Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([c.toArray(),[s]]),fieldBehaviours:nc([tv.config({disabled:e(r.disabled),onDisabled:function(t){Ey.getField(t).each(tv.disable)},onEnabled:function(t){Ey.getField(t).each(tv.enable)}})])});var r,i,u,a,c,s})),selectbox:jO((function(t,n){return e=t,o=n.shared.providers,r=j(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return Ry(t,o)})),u=Ey.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:hO,selectBehaviours:nc([tv.config({disabled:function(){return e.disabled||o.isReadOnly()}}),Ay.config({}),ag("selectbox-change",[Zo(mo(),(function(t,n){Go(t,Vy,{name:e.name})}))])])}),a=1<e.size?S.none():S.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:fp("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:J([[u],a.toArray()])},Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([i.toArray(),[c]]),fieldBehaviours:nc([tv.config({disabled:function(){return e.disabled||o.isReadOnly()},onDisabled:function(t){Ey.getField(t).each(tv.disable)},onEnabled:function(t){Ey.getField(t).each(tv.enable)}}),Ev()])});var e,o,r,i,u,a,c})),sizeinput:jO((function(t,n){return LC(t,n.shared.providers)})),urlinput:jO((function(t,n){return LO(t,n,n.urlinput)})),customeditor:jO((function(t){var n=se(S.none()),e=sp({dom:{tag:t.tag}}),o=se(S.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:nc([ag("custom-editor-events",[ur((function(r){e.getOpt(r).each((function(e){var r;r=t,(Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element.dom):LS.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(S.none()),n.set(S.some(t))}))}))}))]),Hl.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(S.some(e))}),(function(t){return t.setValue(e)}))}}}),VS()]),components:[e.asSpec()]}})),htmlpanel:jO((function(t){return"presentation"===t.presets?Cy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Cy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:nc([Ay.config({}),dg.config({})])})})),imagetools:jO((function(t,n){return fO(t,n.shared.providers)})),table:jO((function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:j(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:j(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:j(r,c)})],behaviours:nc([Ay.config({}),dg.config({})])};var e,o,r,i,u,a,c})),panel:jO((function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:j(e.items,o.shared.interpreter)};var e,o}))},WO={field:function(t,n){return n}},GO=function(t,n,e){var o=Ht(e,{shared:{interpreter:function(n){return XO(t,n,o)}}});return XO(t,n,o)},XO=function(t,n,e){return Mt(UO,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},YO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},qO=function(t,n,e){var o=Ic(-12,12,YO),r={maxHeightFunction:Bc()};return function(){return e()?{anchor:"node",root:Vi(t()),node:S.from(t()),bubble:o,layouts:{onRtl:function(){return[rp]},onLtr:function(){return[op]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[Ia]},onLtr:function(){return[Ra]}},overrides:r}}},KO=function(t,n,e){return function(){return e()?{anchor:"node",root:Vi(t()),node:S.from(t()),layouts:{onRtl:function(){return[ip]},onLtr:function(){return[ip]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[za]},onLtr:function(){return[za]}}}}},JO=function(t,n,e){var o,r,i,u=wv(t),a=function(){return fe.fromDom(t.getBody())},c=function(){return fe.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:qO(c,n,s),banner:KO(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return S.some(qc.range(fe.fromDom(t.startContainer),t.startOffset,fe.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},$O=function(t){return{colorPicker:function(t,n){Ib(r)(t,n)},hasCustomColors:function(){return kb(o)},getColors:function(){return Cb(e)},getColorCols:(n=e=o=r=t,function(){return Tb(n)})};var n,e,o,r},QO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],ZO=function(t){return Y(t,(function(t,n){if(Ft(n,"items")){var e=ZO(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Ft(n,"inline")||Ft(n,"block")||Ft(n,"selector")){var o="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return l(l({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},t_=function(t){return n=t,S.from(n.getParam("style_formats")).filter(T).map((function(n){var e,o,r,i=(e=t,o=ZO(n),r=function(t){U(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))},e.formatter?r(o.customFormats):e.on("init",(function(){r(o.customFormats)})),o.formats);return t.getParam("style_formats_merge",!1,"boolean")?QO.concat(i):i})).getOr(QO);var n},n_=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Ht(t,o)},e_=function(t,n,e,o){var r=function(n){return j(n,(function(n){var i,u,a,c,s=kt(n);if(It(n,"items")){var l=r(n.items);return Ht(Ht(n,{type:"submenu"}),{getStyleItems:function(){return l}})}return It(n,"format")?n_(n,e,o):1===s.length&&H(s,"title")?Ht(n,{type:"separator"}):(u=Xr((i=n).title),a={type:"formatter",format:u,isSelected:e(u),getStylePreview:o(u)},c=Ht(i,a),t.formatter.register(u,c),c)}))};return r(n)},o_=$C.trim,r_=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},i_=r_("true"),u_=r_("false"),a_=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},c_=function(t){return t.innerText||t.textContent},s_=function(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&f_(t);var n},l_=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},f_=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return i_(t)}return!1}(t)&&!u_(t)},d_=function(t){return l_(t)&&f_(t)},m_=function(t){var n,e,o=(n=t).id?n.id:Xr("h");return a_("header",c_(t),"#"+o,l_(e=t)?parseInt(e.nodeName.substr(1),10):0,(function(){t.id=o}))},g_=function(n){var e=n.id||n.name,o=c_(n);return a_("anchor",o||"#"+e,"#"+e,0,t)},p_=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,j(fs(fe.fromDom(e),n),(function(t){return t.dom}))},h_=function(t){return 0<o_(t.title).length},v_=function(t){var n=p_(t);return G(j(G(n,d_),m_).concat(j(G(n,s_),g_)),h_)},b_="tinymce-url-history",y_=function(t){return O(t)&&/^https?/.test(t)},x_=function(t){return _(t)&&Dt(t,(function(t){return!(T(n=t)&&n.length<=5&&Q(n,y_));var n})).isNone()},w_=function(){var t,n=bb.getItem(b_);if(null===n)return{};try{t=JSON.parse(n)}catch(g){if(g instanceof SyntaxError)return console.log("Local storage "+b_+" was not valid JSON",g),{};throw g}return x_(t)?t:(console.log("Local storage "+b_+" was not valid format",t),{})},S_=function(t){var n=w_();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},k_=function(t,n){var e,o,r;y_(t)&&(e=w_(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=G(o,(function(n){return n!==t})),e[n]=[t].concat(r).slice(0,5),function(t){if(!x_(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));bb.setItem(b_,JSON.stringify(t))}(e))},C_=function(t){return!!t},O_=function(t){return _t($C.makeMap(t,/[, ]/),C_)},__=function(t){return S.from(t.getParam("file_picker_callback")).filter(A)},T_=function(t,n){var e,o,r,i,u=(e=t,o=S.some(e.getParam("file_picker_types")).filter(C_),r=S.some(e.getParam("file_browser_callback_types")).filter(C_),i=o.or(r).map(O_),__(e).fold((function(){return!1}),(function(t){return i.fold((function(){return!0}),(function(t){return 0<kt(t).length&&t}))})));return E(u)?u?__(t):S.none():u[n]?__(t):S.none()},E_=function(t){return S.from(t).filter(O).getOrUndefined()},B_=function(t){return S.from(void 0===(e=(n=t).getParam("file_picker_validator_handler",void 0,"function"))?n.getParam("filepicker_validator_handler",void 0,"function"):e);var n,e},D_=function(t){return{getHistory:S_,addToHistory:k_,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?S.none():S.some({targets:v_(n.getBody()),anchorTop:E_(n.getParam("anchor_top","#top")),anchorBottom:E_(n.getParam("anchor_bottom","#bottom"))});var n},getValidationHandler:function(){return B_(t)},getUrlPicker:function(n){return T_(e=t,o=n).map((function(t){return function(n){return ix((function(r){var i=l({filetype:o,fieldname:n.fieldname},S.from(n.meta).getOr({}));t.call(e,(function(t,n){if(!O(t))throw new Error("Expected value to be string");if(void 0!==n&&!_(n))throw new Error("Expected meta to be a object");r({value:t,meta:n})}),n.value,i)}))}}));var e,o}}},A_=function(t,n,e){var o,r,i=se(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=se(yv(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Nh.translate,isReadOnly:function(){return n.mode.isReadOnly()}},interpreter:function(t){return XO(WO,t,a)},anchors:JO(n,e,u.isPositionedAtTop),header:u,getSink:function(){return ct.value(t)}},urlinput:D_(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?S.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):S.none()}},o=function(t){var n=t.items;return void 0!==n&&0<n.length?$(n,o):[t.format]},r=se([]),i=se([]),u=se([]),a=se([]),c=se(!1);return t.on("PreInit",(function(u){var a=t_(t),c=e_(t,a,n,e);r.set(c),i.set($(c,o))})),t.on("addStyleModifications",(function(r){var i=e_(t,r.items,n,e);u.set(i),c.set(r.replace),a.set($(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}}(n),colorinput:$O(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},M_=e((function(t,n){var e,o,r;e=t,o=Math.floor(n),r=wu.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),Wi(e,"max-width",r+"px")})),F_="contexttoolbar-hide",I_=e([Nn("dom"),te("shell",!0),zl("toolbarBehaviours",[ug])]),R_=e([vf({name:"groups",overrides:function(){return{behaviours:nc([ug.config({})])}}})]),V_=Wf({name:"Toolbar",configFields:I_(),partFields:R_(),factory:function(t,n,e,o){var r=function(n){return t.shell?S.some(n):Bf(n,t,"groups")},i=t.shell?{behaviours:[ug.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:Ll(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){ug.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),P_=function(t,n,e){return{within:t,extra:n,withinWidth:e}},H_=function(t,n,o){var r,i=(r=function(t,n){var e=o(t);return S.some({element:t,start:n,finish:n+e,width:e})},Y(t,(function(t,n){return r(n,t.len).fold(e(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),u=G(i,(function(t){return t.finish<=n})),a=X(u,(function(t,n){return t+n.width}),0);return{within:u,extra:i.slice(u.length),withinWidth:a}},z_=function(t){return j(t,(function(t){return t.element}))},N_=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=H_(n,t,e)).extra.length?S.some(r):S.none()).getOrThunk((function(){return H_(n,t-e(o),e)})),g=m.within,p=m.extra,h=m.withinWidth;return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=z_(g.concat(l)),P_(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=z_(g).concat([a]),P_(s,z_(u),c)):(i=h,P_(z_(g),[],i))},L_=function(t,n){var e=j(n,(function(t){return fu(t)}));V_.setGroups(t,e)},j_=function(t,n,e){var o=Df(t,n,"primary"),r=yx.getCoupled(t,"overflowGroup");Wi(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=it(i,(function(t){return fc(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),L_(o,i);var a=Su(o.element),c=N_(a,n.builtGroups.get(),(function(t){return Su(t.element)}),r);0===c.extra.length?(ug.remove(o,r),e([])):(L_(o,c.within),e(c.extra)),$i(o.element,"visibility"),Qi(o.element),u.each(dg.focus)},U_=e([zl("splitToolbarBehaviours",[yx]),ce("builtGroups",(function(){return se([])}))]),W_=e([ca(["overflowToggledClass"]),Qn("getOverflowBounds"),Nn("lazySink"),ce("overflowGroups",(function(){return se([])}))].concat(U_())),G_=e([pf({factory:V_,schema:I_(),name:"primary"}),hf({schema:I_(),name:"overflow"}),hf({name:"overflow-button"}),hf({name:"overflow-group"})]),X_=e([ca(["toggledClass"]),Nn("lazySink"),Wn("fetch"),Qn("getBounds"),Zn("fireDismissalEventInstead",[te("event",Vo())]),Nc()]),Y_=e([hf({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:nc([Cg.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),hf({factory:V_,schema:I_(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:nc([ng.config({mode:"cyclic",onEscape:function(n){return Bf(n,t,"button").each(dg.focus),S.none()}})])}}})]),q_=function(t,n){var e=yx.getCoupled(t,"toolbarSandbox");bl.isOpen(e)?bl.close(e):bl.open(e,n.toolbar())},K_=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();Js.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:M_()}},n,r)},J_=function(t,n,e,o,r){V_.setGroups(n,r),K_(t,n,e,o),Cg.on(t)},$_=Wf({name:"FloatingToolbarButton",factory:function(t,n,e,o){return l(l({},cp.sketch(l(l({},o.button()),{action:function(t){q_(t,o)},buttonBehaviours:Ul({dump:o.button().buttonBehaviours},[yx.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=Yu()).id}},behaviours:nc([ng.config({mode:"special",onEscape:function(t){return bl.close(t),S.some(!0)}}),bl.config({onOpen:function(t,n){i.fetch().get((function(t){J_(o,n,i,r.layouts,t),u.link(o.element),ng.focusIn(n)}))},onClose:function(){Cg.off(o),dg.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return Ku(n,e)||Ku(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),ac.config({channels:l(l({},kl(l({isExtraPart:a},i.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Ol({doReposition:function(){bl.getState(yx.getCoupled(o,"toolbarSandbox")).each((function(t){K_(o,t,i,r.layouts)}))}}))})])};var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){bl.getState(yx.getCoupled(n,"toolbarSandbox")).each((function(r){J_(n,r,t,e.layouts,o)}))},reposition:function(n){bl.getState(yx.getCoupled(n,"toolbarSandbox")).each((function(o){K_(n,o,t,e.layouts)}))},toggle:function(t){q_(t,o)},getToolbar:function(t){return bl.getState(yx.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return bl.isOpen(yx.getCoupled(t,"toolbarSandbox"))}}})},configFields:X_(),partFields:Y_(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),Q_=e([Nn("items"),ca(["itemSelector"]),zl("tgroupBehaviours",[ng])]),Z_=e([bf({name:"items",unit:"item"})]),tT=Wf({name:"ToolbarGroup",configFields:Q_(),partFields:Z_(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Ll(t.tgroupBehaviours,[ng.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),nT=function(t){return j(t,(function(t){return fu(t)}))},eT=function(t,n,e){j_(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){$_.setGroups(t,nT(o))}))}))},oT=Wf({name:"SplitFloatingToolbar",configFields:W_(),partFields:G_(),factory:function(t,n,e,o){var r=sp($_.sketch({fetch:function(){return ix((function(n){n(nT(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Ra,Ia]},onRtl:function(){return[Ia,Ra]},onBottomLtr:function(){return[Pa,Va]},onBottomRtl:function(){return[Va,Pa]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Ll(t.splitToolbarBehaviours,[yx.config({others:{overflowGroup:function(){return tT.sketch(l(l({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(j(e,n.getSystem().build)),eT(n,r,t)},refresh:function(n){return eT(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){$_.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map($_.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){$_.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind($_.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),rT=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},iT=function(t){return t.dimension.property},uT=function(t,n){return t.dimension.getDimension(n)},aT=function(t,n){var e=rT(t,n);Di(e,[n.shrinkingClass,n.growingClass])},cT=function(t,n){Ti(t.element,n.openClass),Oi(t.element,n.closedClass),Wi(t.element,iT(n),"0px"),Qi(t.element)},sT=function(t,n){Ti(t.element,n.closedClass),Oi(t.element,n.openClass),$i(t.element,iT(n))},lT=function(t,n,e,o){e.setCollapsed(),Wi(t.element,iT(n),uT(n,t.element)),Qi(t.element),aT(t,n),cT(t,n),n.onStartShrink(t),n.onShrunk(t)},fT=function(t,n,e,o){var r=o.getOrThunk((function(){return uT(n,t.element)}));e.setCollapsed(),Wi(t.element,iT(n),r),Qi(t.element);var i=rT(t,n);Ti(i,n.growingClass),Oi(i,n.shrinkingClass),cT(t,n),n.onStartShrink(t)},dT=function(t,n,e){var o=uT(n,t.element);("0px"===o?lT:fT)(t,n,e,S.some(o))},mT=function(t,n,e){var o=rT(t,n),r=Ei(o,n.shrinkingClass),i=uT(n,t.element);sT(t,n);var u=uT(n,t.element);(r?function(){Wi(t.element,iT(n),i),Qi(t.element)}:function(){cT(t,n)})(),Ti(o,n.shrinkingClass),Oi(o,n.growingClass),sT(t,n),Wi(t.element,iT(n),u),e.setExpanded(),n.onStartGrow(t)},gT=function(t,n,e){var o=rT(t,n);return!0===Ei(o,n.growingClass)},pT=function(t,n,e){var o=rT(t,n);return!0===Ei(o,n.shrinkingClass)},hT=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&($i(t.element,iT(n)),o=uT(n,t.element),Wi(t.element,iT(n),o))},grow:function(t,n,e){e.isExpanded()||mT(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&dT(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&lT(t,n,e,S.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:gT,isShrinking:pT,isTransitioning:function(t,n,e){return!0===gT(t,n)||!0===pT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?dT:mT)(t,n,e)},disableTransitions:aT}),vT=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return fi(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Kt(n.dimension.property,"0px")})},events:function(t,n){return Jo([ir(po(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(aT(e,t),n.isExpanded()&&$i(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),bT=[Nn("closedClass"),Nn("openClass"),Nn("shrinkingClass"),Nn("growingClass"),qn("getAnimationRoot"),la("onShrunk"),la("onStartShrink"),la("onGrown"),la("onStartGrow"),te("expanded",!1),Ln("dimension",Dn("property",{width:[ga("property","width"),ga("getDimension",(function(t){return Su(t)+"px"}))],height:[ga("property","height"),ga("getDimension",(function(t){return gu(t)+"px"}))]}))],yT=oc({fields:bT,name:"sliding",active:vT,apis:hT,state:Object.freeze({__proto__:null,init:function(t){var n=se(t.expanded);return si({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:r(n.set,!1),setExpanded:r(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),xT=e([ca(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),la("onOpened"),la("onClosed")].concat(U_())),wT=e([pf({factory:V_,schema:I_(),name:"primary"}),pf({factory:V_,schema:I_(),name:"overflow",overrides:function(t){return{toolbarBehaviours:nc([yT.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Bf(n,t,"overflow-button").each((function(t){Cg.off(t),dg.focus(t)})),t.onClosed(n)},onGrown:function(n){ng.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Bf(n,t,"overflow-button").each(Cg.on)}}),ng.config({mode:"acyclic",onEscape:function(n){return Bf(n,t,"overflow-button").each(dg.focus),S.some(!0)}})])}}}),hf({name:"overflow-button",overrides:function(t){return{buttonBehaviours:nc([Cg.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),hf({name:"overflow-group"})]),ST=function(t,n){Bf(t,n,"overflow-button").bind((function(){return Bf(t,n,"overflow")})).each((function(e){kT(t,n),yT.toggleGrow(e)}))},kT=function(t,n){Bf(t,n,"overflow").each((function(e){j_(t,n,(function(t){var n=j(t,(function(t){return fu(t)}));V_.setGroups(e,n)})),Bf(t,n,"overflow-button").each((function(t){yT.hasGrown(e)&&Cg.on(t)})),yT.refresh(e)}))},CT=Wf({name:"SplitSlidingToolbar",configFields:xT(),partFields:wT(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Ll(t.splitToolbarBehaviours,[yx.config({others:{overflowGroup:function(t){return tT.sketch(l(l({},o["overflow-group"]()),{items:[cp.sketch(l(l({},o["overflow-button"]()),{action:function(n){Wo(t,r)}}))]}))}}}),ag("toolbar-toggle-events",[Zo(r,(function(n){ST(n,t)}))])]),apis:{setGroups:function(n,e){var o;o=j(e,n.getSystem().build),t.builtGroups.set(o),kT(n,t)},refresh:function(n){return kT(n,t)},toggle:function(n){return ST(n,t)},isOpen:function(n){return Bf(n,t,"overflow").map(yT.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),OT=e(Xr("toolbar-height-change")),_T=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:l({tag:"div",classes:["tox-toolbar__group"]},n),components:[tT.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:nc([Ay.config({}),dg.config({})])}},TT=function(t){return tT.sketch(_T(t))},ET=function(t,n){var e=ur((function(n){var e=j(t.initGroups,TT);V_.setGroups(n,e)}));return nc([Mv(t.providers.isReadOnly),Ev(),ng.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),ag("toolbar-events",[e])])},BT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":_T({title:S.none(),items:[]}),"overflow-button":_C({name:"more",icon:S.some("more-drawer"),disabled:!1,tooltip:S.some("More..."),primary:!1,borderless:!1},S.none(),t.providers)},splitToolbarBehaviours:ET(t,n)}},DT=function(t){var n=BT(t),e=oT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return oT.sketch(l(l({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=Vu(n),o=br(n),r=Vu(o),i=Math.max(o.dom.scrollHeight,r.height);return Iu(e.x+4,r.y,e.width-8,i)},parts:l(l({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},AT=function(t){var n=CT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=CT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=BT(t);return CT.sketch(l(l({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([OT()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([OT()],{type:"closed"})}}))},MT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return V_.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Zp.scrolling?["tox-toolbar--scrolling"]:[])},components:[V_.parts.groups({})],toolbarBehaviours:ET(t,n)})},FT=ln([jn("type"),Ln("items",dn([wn([jn("name"),Yn("items",In)]),In]))].concat(Hp)),IT=[$n("text"),$n("tooltip"),$n("icon"),Wn("fetch"),ue("onSetup",(function(){return t}))],RT=ln(d([jn("type")],IT)),VT=function(t){return On("menubutton",RT,t)},PT=ln([jn("type"),$n("tooltip"),$n("icon"),$n("text"),Qn("select"),Wn("fetch"),ue("onSetup",(function(){return t})),re("presets","normal",["normal","color","listpreview"]),te("columns",1),Wn("onAction"),Wn("onItemAction")]),HT=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=j(r,e.getSystem().build);tl(e,i)}))};return Jo([Zo(So(),(function(n,o){var r,i=o;i.universal||(r=t.channel,H(i.channels,r)&&e(n,i.data))})),ur((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),zT=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),NT=[Nn("channel"),qn("renderComponents"),qn("updateState"),qn("initialData")],LT=oc({fields:NT,name:"reflecting",active:HT,apis:zT,state:Object.freeze({__proto__:null,init:function(){var t=se(S.none());return{readState:function(){return t.get().fold((function(){return"none"}),(function(t){return t}))},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(S.none())}}}})}),jT=e([Nn("toggleClass"),Nn("fetch"),da("onExecute"),te("getHotspot",S.some),te("getAnchorOverrides",e({})),Nc(),da("onItemExecute"),qn("lazySink"),Nn("dom"),la("onOpen"),zl("splitDropdownBehaviours",[yx,ng,dg]),te("matchWidth",!1),te("useMinWidth",!1),te("eventOrder",{}),qn("role")].concat(Ax())),UT=pf({factory:cp,schema:[Nn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:nc([dg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Xo)},buttonBehaviours:nc([Cg.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),WT=pf({factory:cp,schema:[Nn("dom")],name:"button",defaults:function(){return{buttonBehaviours:nc([dg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),GT=e([UT,WT,vf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Nn("text")],name:"aria-descriptor"}),hf({schema:[aa()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),wx()]),XT=Wf({name:"SplitDropdown",configFields:jT(),partFields:GT(),factory:function(n,e,o,r){var i,u=function(t){Kf.getCurrent(t).each((function(t){ud.highlightFirst(t),ng.focusIn(t)}))},a=function(e){Ox(n,(function(t){return t}),e,r,u,Qy.HighlightFirst).get(t)},c=function(t){var e=Df(t,n,"button");return Xo(e),S.some(!0)},s=l(l({},Jo([ur((function(t,e){Bf(t,n,"aria-descriptor").each((function(n){var e=Xr("aria");Vr(n.element,"id",e),Vr(t.element,"aria-describedby",e)}))}))])),_g(S.some(a))),f={repositionMenus:function(t){Cg.isOn(t)&&Dx(t)}};return{uid:n.uid,dom:n.dom,components:e,apis:f,eventOrder:l(l({},n.eventOrder),((i={})[ko()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:Ll(n.splitDropdownBehaviours,[yx.config({others:{sandbox:function(t){var e=Df(t,n,"arrow");return Bx(n,t,{onOpen:function(){Cg.on(e),Cg.on(t)},onClose:function(){Cg.off(e),Cg.off(t)}})}}}),ng.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){return a(t),S.some(!0)}}),dg.config({}),Cg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),YT=function(t){return{isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},qT=function(t){return{setActive:function(n){Cg.set(t,n)},isActive:function(){return Cg.isOn(t)},isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)}}},KT=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},JT=Xr("focus-button"),$T=["checklist","ordered-list"],QT=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],ZT=function(t,n,e,o,r,i){var u,a=function(t){return Nh.isRtl()&&H($T,t)?t+"-rtl":t},c=Nh.isRtl()&&t.exists((function(t){return H(QT,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:KT(e,i)},components:Pv([t.map((function(t){return cC(a(t),i.icons)})),n.map((function(t){return lC(t,"tox-tbtn",i)}))]),eventOrder:((u={})[eo()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:nc([Mv(i.isReadOnly),Ev(),ag("common-button-display-events",[Zo(eo(),(function(t,n){n.event.prevent(),Wo(t,JT)}))])].concat(o.map((function(e){return LT.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return Pv([t.icon.map((function(t){return cC(a(t),i.icons)})),t.text.map((function(t){return lC(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},tE=function(n,e,o){var r,i=se(t),u=ZT(n.icon,n.text,n.tooltip,S.none(),S.none(),o);return cp.sketch({dom:u.dom,components:u.components,eventOrder:dC,buttonBehaviours:nc([ag("toolbar-button-events",[(r={onAction:n.onAction,getApi:e.getApi},sr((function(t,n){Fv(r,t)((function(n){Go(t,fC,{buttonApi:n}),r.onAction(n)}))}))),Iv(e,i),Rv(e,i)]),Mv((function(){return n.disabled||o.isReadOnly()})),Ev()].concat(e.toolbarButtonBehaviours))})},nE=function(t,n,e){return tE(t,{toolbarButtonBehaviours:[].concat(0<e.length?[ag("toolbarButtonWith",e)]:[]),getApi:YT,onSetup:t.onSetup},n)},eE=function(t,n,e){return Ht(tE(t,{toolbarButtonBehaviours:[ug.config({}),Cg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[ag("toolbarToggleButtonWith",e)]:[]),getApi:qT,onSetup:t.onSetup},n))},oE=function(n,e){var o,r,i,u,a=Xr("channel-update-split-dropdown-display"),c=function(t){return{isDisabled:function(){return tv.isDisabled(t)},setDisabled:function(n){return tv.set(t,n)},setIconFill:function(n,e){Gu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Vr(t,"fill",e)}))},setIconStroke:function(n,e){Gu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Vr(t,"stroke",e)}))},setActive:function(n){Vr(t.element,"aria-pressed",n),Gu(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Cg.set(t,n)}))}))},isActive:function(){return Gu(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Cg.isOn)}))}}},s=se(t),f={getApi:c,onSetup:n.onSetup};return XT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:l({"aria-pressed":!1},KT(n.tooltip,e.providers))},onExecute:function(t){n.onAction(c(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:nc([Av(e.providers.isReadOnly),Ev(),ag("split-dropdown-events",[Zo(JT,dg.focus),Iv(f,s),Rv(f,s)]),Rx.config({})]),eventOrder:((o={})[Io()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(r=c,i=n,u=e.providers,function(t){return ix((function(t){return i.fetch(t)})).map((function(n){return S.from($b(Ht(Rb(Xr("menu-value"),n,(function(n){i.onItemAction(r(t),n)}),i.columns,i.presets,nh.CLOSE_ON_EXECUTE,i.select.getOr((function(){return!1})),u),{movement:Pb(i.columns,i.presets),menuBehaviours:Dh("auto"!==i.columns?[]:[ur((function(t,n){Eh(t,4,lh(i.presets)).each((function(n){var e=n.numRows,o=n.numColumns;ng.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:gh(0,n.columns,n.presets)},components:[XT.parts.button(ZT(n.icon,n.text,S.none(),S.some(a),S.some([Cg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),XT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:fp("chevron-down",e.providers.icons)},buttonBehaviours:nc([Av(e.providers.isReadOnly),Ev()])}),XT.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})},rE=function(t,n){return Zo(fC,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Wo(r,To())},getValue:function(){return Hl.getValue(r)}});n.onAction(u,o.event.buttonApi)}))},iE=function(t,n,e){var o,r,i,u,a,c,s,d,m,g,p,h,v={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(s=t,m=v,(g=(d=n).original).primary,p=f(g,["primary"]),h=_n(Up(l(l({},p),{type:"togglebutton",onAction:function(){}}))),eE(h,m.backstage.shared.providers,[rE(s,d)])):(o=t,i=v,(u=(r=n).original).primary,a=f(u,["primary"]),c=_n(Np(l(l({},a),{type:"button",onAction:function(){}}))),nE(c,i.backstage.shared.providers,[rE(o,r)]))},uE=function(t,n){var e,o,r,u,a=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),c=sp(Ky.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:nc([ng.config({mode:"special",onEnter:function(t){return s.findPrimary(t).map((function(t){return Xo(t),!0}))},onLeft:function(t,n){return n.cut(),S.none()},onRight:function(t,n){return n.cut(),S.none()}})])})),s=(e=c,o=t.commands,r=n,u=j(o,(function(t){return sp(iE(e,t,r))})),{asSpecs:function(){return j(u,(function(t){return t.asSpec()}))},findPrimary:function(t){return it(o,(function(n,e){return n.primary?S.from(u[e]).bind((function(n){return n.getOpt(t)})).filter(i(tv.isDisabled)):S.none()}))}});return[{title:S.none(),items:[c.asSpec()]},{title:S.none(),items:s.asSpecs()}]},aE=uE,cE=function(t,n){var e,o,r,i,u,a=Du(window),c=Ru(fe.fromDom(t.getContentAreaContainer())),s=cv(t)||sv(t)||fv(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width;if(t.inline&&!s)return Iu(f,a.y,d,a.height);var m=function(t,n,e,o){var r=fe.fromDom(t.getContainer()),i=Gu(r,".tox-editor-header").getOr(r),u=Ru(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=Ru(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom;return Iu(f,g,d,p-g)},sE=function(t,n){var e=G(n,(function(n){return n.predicate(t.dom)})),o=W(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},lE=function(t,n,e){var o=sE(t,n);if(0<o.contextForms.length)return S.some({elem:t,toolbars:[o.contextForms[0]]});var r=sE(t,e);if(0<r.contextForms.length)return S.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t;var n=function(n){return z(t,(function(t){return t.position===n}))},e=function(n){return G(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=j(e("selection"),(function(t){return l(l({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return S.some({elem:t,toolbars:i})}return S.none()},fE=function(t,n,e){return t(n)?S.none():Xe(n,(function(t){var n=sE(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=0<r.length?r:function(t){if(t.length<=1)return t;var n=function(n){return q(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return G(t,(function(t){return t.position===n}))}))}(o);return 0<i.length?S.some({elem:t,toolbars:i}):S.none()}),t)},dE=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=_n(On("ContextForm",Jp,a));(e[t]=c).launch.map((function(e){i["form:"+t]=l(l({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){On("ContextToolbar",$p,n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=kt(t);return U(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},mE=Xr("forward-slide"),gE=Xr("backward-slide"),pE=Xr("change-slide-event"),hE="tox-pop--resizing",vE=function(t,n,e){var o,r,i,u,a,c=e.dataset,s="basic"===c.type?function(){return j(c.data,(function(t){return n_(t,e.isSelectedFor,e.getPreviewFor)}))}:c.getData;return{items:(o=n,r=e,i=function(t,n,e,i){var a=o.shared.providers.translate(t.title);if("separator"===t.type)return S.some({type:"separator",text:a});if("submenu"!==t.type)return S.some(l({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(i),disabled:e,onAction:r.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))));var c=$(t.getStyleItems(),(function(t){return u(t,n,i)}));return 0===n&&c.length<=0?S.none():S.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return $(t.getStyleItems(),(function(t){return u(t,n,i)}))}})},u=function(t,n,e){var o="formatter"===t.type&&r.isInvalid(t);return 0===n?o?[]:i(t,n,!1,e).toArray():i(t,n,o,e).toArray()},{validateItems:a=function(t){var n=r.getCurrentValue(),e=r.shouldHide?0:1;return $(t,(function(t){return u(t,e,n)}))},getFetch:function(t,n){return function(e,o){var r=n(),i=a(r);o(wC(i,nh.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}},bE=function(n,e,o){var r=vE(0,e,o),i=r.items,u=r.getStyleItems;return pC({text:o.icon.isSome()?S.none():S.some(""),icon:o.icon,tooltip:S.from(o.tooltip),role:S.none(),fetch:i.getFetch(e,u),onSetup:function(e){return o.setInitialValue.each((function(t){return t(e.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(e.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(t)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};(sO=cO=cO||{})[sO.SemiColon=0]="SemiColon",sO[sO.Space=1]="Space";var yE,xE,wE,SE,kE,CE,OE=function(t,n,e,o){var r,i,u=t.getParam(n,e,"string");return{type:"basic",data:(i=u,r=o===cO.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),j(r,(function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}},_E=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],TE=function(t){var n=function(n){var e=q(_E,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));Go(n,gC,{icon:"align-"+e})},e=S.some((function(t){return function(){return n(t)}})),o=S.some(n),r={type:"basic",data:_E};return{tooltip:"Align",icon:S.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:S.none,getPreviewFor:function(t){return function(){return S.none()}},onAction:function(n){return function(){return q(_E,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},EE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],BE=function(t){var n=t.split(/\s*,\s*/);return j(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},DE=function(t){var n;return 0===t.indexOf("-apple-system")&&(n=BE(t.toLowerCase()),Q(EE,(function(t){return-1<n.indexOf(t.toLowerCase())})))},AE=function(t){var n=function(){var n=function(t){return t?BE(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:q(o,(function(t){var e=t.format;return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()})).orThunk((function(){return DE(r)?S.from({title:"System Font",format:r}):S.none()})),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}));Go(t,mC,{text:i})},o=S.some((function(t){return function(){return e(t)}})),r=S.some(e),i=OE(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",cO.SemiColon);return{tooltip:"Fonts",icon:S.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return S.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},ME={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},FE=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):t;var e,o,r},IE=function(t){var n=function(){var n=S.none(),e=a.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=FE(o,t),i=Mt(ME,r).getOr("");n=q(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&0<=i;i--)r(i);return{matchOpt:n,size:o}},o=e(S.none),r=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(t){return t.title}));Go(t,mC,{text:i})},i=S.some((function(t){return function(){return r(t)}})),u=S.some(r),a=OE(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",cO.Space);return{tooltip:"Font sizes",icon:S.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:o,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:a,shouldHide:!1,isInvalid:function(){return!1}}},RE=function(t,n,e){var o=n();return it(e,(function(n){return q(o,(function(e){return t.formatter.matchNode(n,e.format)}))})).orThunk((function(){return t.formatter.match("p")?S.some({title:"Paragraph",format:"p"}):S.none()}))},VE=function(t){var n=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(n,(function(){return!0}),t.getBody())},PE=function(t){var n=se(S.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(S.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(S.some(t))}}},HE=function(){return PE((function(t){return t.unbind()}))},zE=function(t,n){return function(e){var o=HE(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.on("init",r),o.clear}},NE=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},LE=function(t){var n=function(n,e){var o=RE(t,(function(){return r.data}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}));Go(e,mC,{text:o})},e=S.some((function(t){return function(e){return n(e.parents,t)}})),o=S.some((function(e){var o=VE(t);n(o,e)})),r=OE(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",cO.SemiColon);return{tooltip:"Blocks",icon:S.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:S.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return S.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:NE(t),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},jE=function(t,n){var e=function(n,e){var o=function(t){var n=t.items;return void 0!==n&&0<n.length?$(n,o):[{title:t.title,format:t.format}]},r=$(t_(t),o),i=RE(t,(function(){return r}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}));Go(e,mC,{text:i})},o=S.some((function(t){return function(n){return e(n.parents,t)}})),r=S.some((function(n){var o=VE(t);e(o,n)}));return{tooltip:"Formats",icon:S.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:S.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?S.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):S.none()}},onAction:NE(t),setInitialValue:r,nodeChangeHandler:o,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},UE=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],WE=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return En(t)})).getOrDie();return n(i,o,r)}},GE={button:WE(Np,(function(t,n){return e=t,o=n.backstage.shared.providers,nE(e,o,[]);var e,o})),togglebutton:WE(Up,(function(t,n){return e=t,o=n.backstage.shared.providers,eE(e,o,[]);var e,o})),menubutton:WE(VT,(function(t,n){return kC(t,"tox-tbtn",n.backstage,S.none())})),splitbutton:WE((function(t){return On("SplitButton",PT,t)}),(function(t,n){return oE(t,n.backstage.shared)})),grouptoolbarbutton:WE((function(t){return On("GroupToolbarButton",FT,t)}),(function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[Hc]=n.backstage.shared.header.isPositionedAtTop()?$u.TopToBottom:$u.BottomToTop,o);switch(gv(e)){case Zp.floating:return r=t,i=n.backstage,u=function(t){return KE(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,S.none())},a=l,c=i.shared,$_.sketch({lazySink:c.getSink,fetch:function(){return ix((function(t){t(j(u(r.items),TT))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:ZT(r.icon,r.text,r.tooltip,S.none(),S.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=l({type:"advanced"},o.styleselect),bE(e,o,jE(e,r));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,bE(e,o,IE(e));var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,bE(e,o,AE(e));var e,o},formatButton:function(t,n){return e=t,o=n.backstage,bE(e,o,LE(e));var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,bE(e,o,TE(e));var e,o}},XE={styleselect:GE.styleSelectButton,fontsizeselect:GE.fontsizeSelectButton,fontselect:GE.fontSelectButton,formatselect:GE.formatButton,align:GE.alignMenuButton},YE=function(t){var n,e,o,r=t.toolbar,i=t.buttons;return!1===r?[]:void 0===r||!0===r?(e=i,o=j(UE,(function(t){var n=G(t.items,(function(t){return Ft(e,t)||Ft(XE,t)}));return{name:t.name,items:n}})),G(o,(function(t){return 0<t.items.length}))):O(r)?(n=r.split("|"),j(n,(function(t){return{items:t.trim().split(" ")}}))):F(r,(function(t){return Ft(t,"name")&&Ft(t,"items")}))?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},qE=function(t,n,e,o,r,i){return Mt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return it(t,(function(t){return Mt(n,t+e.toLowerCase())}))}))})).fold((function(){return Mt(XE,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return S.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?(u=r,a=t,Mt(GE,(i=n).type).fold((function(){return console.error("skipping button defined by",i),S.none()}),(function(t){return S.some(t(i,u,a))}))):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),S.none());var i,u,a}))},KE=function(t,n,e,o){var r=YE(n),i=j(r,(function(r){var i=$(r.items,(function(r){return 0===r.trim().length?[]:qE(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:S.from(t.translate(r.name)),items:i}}));return G(i,(function(t){return 0<t.items.length}))},JE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},$E={maxHeightFunction:Bc(),maxWidthFunction:M_()},QE={onLtr:function(){return[Ha,za,Va,Ia,Pa,Ra,ip,up,op,np,rp,ep]},onRtl:function(){return[Ha,za,Pa,Ra,Va,Ia,ip,up,rp,ep,op,np]}},ZE={onLtr:function(){return[za,Ia,Ra,Va,Pa,Ha,ip,up,op,np,rp,ep]},onRtl:function(){return[za,Ra,Ia,Pa,Va,Ha,ip,up,rp,ep,op,np]}},tB=function(t,n,e,o){var r,i,u=ze().deviceType.isTouch,a=lu((r={sink:e,onEscape:function(){return t.focus(),S.some(!0)}},i=se([]),Kg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),Kg.getContent(t).each((function(t){$i(t.element,"visibility")})),Ti(t.element,hE),$i(t.element,"width")},inlineBehaviours:nc([ag("context-toolbar-events",[ir(po(),(function(t,n){Ti(t.element,hE),$i(t.element,"width")})),Zo(pE,(function(t,n){$i(t.element,"width");var e=Su(t.element);Kg.setContent(t,n.event.contents),Oi(t.element,hE);var o=Su(t.element);Wi(t.element,"width",e+"px"),Kg.getContent(t).each((function(e){n.event.focus.bind((function(n){return sc(n),fc(t.element)})).orThunk((function(){return ng.focusIn(e),lc()}))})),ap.setTimeout((function(){Wi(t.element,"width",o+"px")}),0)})),Zo(mE,(function(t,n){Kg.getContent(t).each((function(t){i.set(i.get().concat([{bar:t,focus:lc()}]))})),Go(t,pE,{contents:n.event.forwardContents,focus:S.none()})})),Zo(gE,(function(t,n){ot(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),Go(t,pE,{contents:fu(n.bar),focus:n.focus})}))}))]),ng.config({mode:"special",onEscape:function(t){return ot(i.get()).fold((function(){return r.onEscape()}),(function(n){return Wo(t,gE),S.some(!0)}))}})]),lazySink:function(){return ct.value(r.sink)}}))),c=function(){return cE(t,o.backstage.shared)},s=function(){if(u()&&o.backstage.isContextMenuOpen())return!0;var n,e,r,i,a,s,l=(n=g.get().filter((function(t){return zi(fe.fromDom(t))})).map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),e=t.inline?Tu().top:Vu(fe.fromDom(t.getBody())).y,{y:n.top+e,bottom:n.bottom+e}),f=c();return r=l.y,i=l.bottom,a=f.y,s=f.bottom,!(Math.max(r,a)<=Math.min(i,s))},f=function(){Kg.hide(a)},d=function(){m.get().each((function(t){var n=a.element;$i(n,"display"),s()?Wi(n,"display","none"):Js.positionWithinBounds(e,t,a,S.some(c()))}))},m=se(S.none()),g=se(S.none()),p=se(null),h=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:nc([ng.config({mode:"acyclic"}),ag("pop-dialog-wrap-events",[ur((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return ng.focusIn(n)}))})),ar((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},v=Nt((function(){return dE(n,(function(t){var n=b([t]);Go(a,mE,{forwardContents:h(n)})}))})),b=function(n){var e=t.ui.registry.getAll().buttons,r=v(),i=l(l({},e),r.formNavigators),u=gv(t)===Zp.scrolling?Zp.scrolling:Zp["default"],a=J(j(n,(function(n){return"contexttoolbar"===n.type?KE(t,{buttons:i,toolbar:n.items,allowToolbarGroups:!1},o,S.some(["form:"])):(e=n,r=o.backstage.shared.providers,aE(e,r));var e,r})));return MT({type:u,uid:Xr("context-toolbar"),initGroups:a,onEscape:S.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};t.on("contexttoolbar-show",(function(n){var e=v();Mt(e.lookupTable,n.toolbarKey).each((function(e){x([e],n.target===t?S.none():S.some(n)),Kg.getContent(a).each(ng.focusIn)}))}));var y=function(t,n){var e,r,i="node"===t?o.backstage.shared.anchors.node(n):o.backstage.shared.anchors.cursor();return Ht(i,(e=t,r=u(),"line"===e?{bubble:Ic(12,0,JE),layouts:{onLtr:function(){return[Na]},onRtl:function(){return[La]}},overrides:$E}:{bubble:Ic(0,12,JE),layouts:r?ZE:QE,overrides:$E}))},x=function(t,n){var e,r,i,l;k(),u()&&o.backstage.isContextMenuOpen()||(e=b(t),r=n.map(fe.fromDom),i=y(t[0].position,r),m.set(S.some(i)),g.set(n),l=a.element,$i(l,"display"),Kg.showWithinBounds(a,i,h(e),(function(){return S.some(c())})),s()&&Wi(l,"display","none"))},w=function(){var n,e,o,r,i,u,c;t.hasFocus()&&(n=v(),e=n,o=t,i=fe.fromDom(o.getBody()),u=function(t){return je(t,i)},c=fe.fromDom(o.selection.getNode()),(u(r=c)||We(i,r)?lE(c,e.inNodeScope,e.inEditorScope).orThunk((function(){return fE(u,c,e)})):S.none()).fold((function(){m.set(S.none()),Kg.hide(a)}),(function(t){x(t.toolbars,S.some(t.elem.dom))})))},k=function(){var t=p.get();null!==t&&(ap.clearTimeout(t),p.set(null))},C=function(t){k(),p.set(t)};t.on("init",(function(){t.on(F_,f),t.on("ScrollContent ScrollWindow longpress",d),t.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){C(ap.setEditorTimeout(t,w,0))})),t.on("focusout",(function(n){ap.setEditorTimeout(t,(function(){fc(e.element).isNone()&&fc(a.element).isNone()&&(m.set(S.none()),Kg.hide(a))}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&(m.set(S.none()),Kg.hide(a))})),t.on("NodeChange",(function(n){fc(a.element).fold((function(){C(ap.setEditorTimeout(t,w,0))}),(function(t){}))}))}))},nB=Pf,eB=xf,oB=e([te("shell",!1),Nn("makeItem"),te("setupItem",t),jl("listBehaviours",[ug])]),rB=vf({name:"items",overrides:function(){return{behaviours:nc([ug.config({})])}}}),iB=e([rB]),uB=Wf({name:e("CustomList")(),configFields:oB(),partFields:iB(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[ug.config({})],components:[]}:{behaviours:[],components:n},i=function(n){return t.shell?S.some(n):Bf(n,t,"items")};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Ll(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){i(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=ug.contents(o),i=e.length,u=i-r.length,a=0<u?N(u,(function(){return t.makeItem()})):[],c=r.slice(i);U(c,(function(t){return ug.remove(o,t)})),U(a,(function(t){return ug.append(o,t)}));var s=ug.contents(o);U(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),aB=t,cB=a,sB=e([]),lB=Object.freeze({__proto__:null,setup:aB,isDocked:cB,getBehaviours:sB}),fB=function(t){return(Ki(t,"position").is("fixed")?S.none():Sr(t)).orThunk((function(){var n=fe.fromTag("span");return xr(t).bind((function(t){Er(t,n);var e=Sr(n);return Ar(n),e}))}))},dB=function(t){return fB(t).map(yu).getOrThunk((function(){return vu(0,0)}))},mB=Rt([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),gB=function(t,n){var e=t.element;Oi(e,n.transitionClass),Ti(e,n.fadeOutClass),Oi(e,n.fadeInClass),n.onShow(t)},pB=function(t,n){var e=t.element;Oi(e,n.transitionClass),Ti(e,n.fadeInClass),Oi(e,n.fadeOutClass),n.onHide(t)},hB=function(t,n,e){return Q(t,(function(t){switch(t){case"bottom":return r=e,n.bottom<=r.bottom;case"top":return o=e,n.y>=o.y}var o,r}))},vB=function(t,n){return n.getInitialPosition().map((function(n){return Iu(n.bounds.x,n.bounds.y,Su(t),gu(t))}))},bB=function(t,n,e){e.setInitialPosition(S.some({style:function(t){var n={},e=t.dom;if(Ai(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Yi(t,"position")||"static",bounds:n}))},yB=function(t,n,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(S.none()),o.position){case"static":return S.some(mB["static"]());case"absolute":var r=fB(t).map(Ru).getOrThunk((function(){return Ru(Ni())}));return S.some(mB.absolute(mc("absolute",Mt(o.style,"left").map((function(t){return n.x-r.x})),Mt(o.style,"top").map((function(t){return n.y-r.y})),Mt(o.style,"right").map((function(t){return r.right-n.right})),Mt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return S.none()}}))},xB=function(t,n,e){var o,r,i,u=t.element;return Ki(u,"position").is("fixed")?(r=n,vB(o=u,i=e).filter((function(t){return hB(i.getModes(),t,r)})).bind((function(t){return yB(o,t,i)}))):function(t,n,e){var o=Ru(t);if(hB(e.getModes(),o,n))return S.none();bB(t,o,e);var r=Pu(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return S.some(mB.fixed(mc("fixed",S.some(i),c?S.some(u):S.none(),S.none(),c?S.none():S.some(a))))}(u,n,e)},wB=function(t,n){U(["left","right","top","bottom","position"],(function(n){return $i(t.element,n)})),n.onUndocked(t)},SB=function(t,n,e){gc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},kB=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u,a,c=(a=o,(u=i).y<a.bottom&&u.bottom>a.y);c!==e.isVisible()&&(e.setVisible(c),r&&!c?(Bi(t.element,[n.fadeOutClass]),n.onHide(t)):(c?gB:pB)(t,n))}))}))},CB=function(n,e,o){var r,i,u=n.element;o.setDocked(!1),r=o,i=n.element,vB(i,r).bind((function(t){return yB(i,t,r)})).each((function(o){o.fold((function(){return wB(n,e)}),(function(t){return SB(n,e,t)}),t)})),o.setVisible(!0),e.contextual.each((function(t){Di(u,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),OB(n,e,o)},OB=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&kB(o,r,i,u),xB(o,u,i).each((function(t){i.setDocked(!a),t.fold((function(){return wB(o,r)}),(function(t){return SB(o,r,t)}),(function(t){kB(o,r,i,u,!0),SB(o,r,t)}))})))},_B=function(t,n,e){e.isDocked()&&CB(t,n,e)},TB=Object.freeze({__proto__:null,refresh:OB,reset:_B,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),EB=Object.freeze({__proto__:null,events:function(t,n){return Jo([ir(po(),(function(e,o){t.contextual.each((function(t){Ei(e.element,t.transitionClass)&&(Di(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Zo(Mo(),(function(e,o){OB(e,t,n)})),Zo(Fo(),(function(e,o){_B(e,t,n)}))])}}),BB=[Zn("contextual",[jn("fadeInClass"),jn("fadeOutClass"),jn("transitionClass"),Wn("lazyContext"),la("onShow"),la("onShown"),la("onHide"),la("onHidden")]),ue("lazyViewport",Pu),ne("modes",["top","bottom"],fn(In)),la("onDocked"),la("onUndocked")],DB=oc({fields:BB,name:"docking",active:EB,apis:TB,state:Object.freeze({__proto__:null,init:function(t){var n=se(!1),e=se(!0),o=se(S.none()),r=se(t.modes);return si({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),AB={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},MB="tox-tinymce--toolbar-sticky-on",FB="tox-tinymce--toolbar-sticky-off",IB=function(t){var n=t.element;xr(n).each((function(e){var o,r,i="padding-"+DB.getModes(t)[0];DB.isDocked(t)?(o=Su(e),Wi(n,"width",o+"px"),Wi(e,i,pu(r=n)+(parseInt(Yi(r,"margin-top"),10)||0)+(parseInt(Yi(r,"margin-bottom"),10)||0)+"px")):($i(n,"width"),$i(e,i))}))},RB=function(t,n){n?(Ti(t,AB.fadeOutClass),Bi(t,[AB.transitionClass,AB.fadeInClass])):(Ti(t,AB.fadeInClass),Bi(t,[AB.fadeOutClass,AB.transitionClass]))},VB=function(t,n){var e=fe.fromDom(t.getContainer());n?(Oi(e,MB),Ti(e,FB)):(Oi(e,FB),Ti(e,MB))},PB=function(t,n){var e,o=se(S.none()),r=n.getSink,i=function(t){r().each((function(n){return t(n.element)}))},u=function(n){t.inline||IB(n),VB(t,DB.isDocked(n)),n.getSystem().broadcastOn([xl()],{}),r().each((function(t){return t.getSystem().broadcastOn([xl()],{})}))},a=t.inline?[]:[ac.config({channels:((e={})[OT()]={onReceive:IB},e)})];return d([dg.config({}),DB.config({contextual:l({lazyContext:function(n){var e,o,r=pu(n.element),i=t.inline?t.getContentAreaContainer():t.getContainer(),u=Ru(fe.fromDom(i)),a=u.height-r,c=u.y+(e=n,o="top",H(DB.getModes(e),o)?0:r);return S.some(Iu(u.x,c,u.width,a))},onShow:function(){i((function(t){return RB(t,!0)}))},onShown:function(t){i((function(t){return Di(t,[AB.transitionClass,AB.fadeInClass])})),o.get().each((function(n){var e,r,i;e=t.element,i=hr(r=n),lc(i).filter((function(t){return!je(r,t)})).filter((function(t){return je(t,fe.fromDom(i.dom.body))||We(e,t)})).each((function(){return sc(r)})),o.set(S.none())}))},onHide:function(t){var n,e;o.set((n=t.element,e=r,fc(n).orThunk((function(){return e().toOptional().bind((function(t){return fc(t.element)}))})))),i((function(t){return RB(t,!1)}))},onHidden:function(){i((function(t){return Di(t,[AB.transitionClass])}))}},AB),modes:[n.header.getDockingMode()],onDocked:u,onUndocked:u})],a)},HB=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(DB.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(IB)})),t.on("SkinLoaded",(function(){e().each((function(t){DB.isDocked(t)?DB.reset(t):DB.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(DB.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){DB.refresh(n);var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=n.element;Kd(y)&&(e=t,i=hr(o=y),u=i.dom.defaultView.innerHeight,a=Tu(i),c=fe.fromDom(e.elm),s=Vu(c),l=gu(c),f=s.y,d=f+l,m=yu(o),g=gu(o),p=m.top,h=p+g,v=Math.abs(p-a.top)<2,b=Math.abs(h-(a.top+u))<2,v&&f<h?Eu(a.left,f-g,i):b&&p<d&&(r=f-u+l+g,Eu(a.left,r,i)))}))})),t.on("PostRender",(function(){VB(t,!1)}))},isDocked:function(t){return t().map(DB.isDocked).getOr(!1)},getBehaviours:PB}),zB=Uf({factory:function(t,n){var e={focus:ng.focusIn,setMenus:function(t,e){var o=j(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=VT(e).mapError((function(t){return En(t)})).getOrDie();return kC(o,"tox-mbtn",n.backstage,S.some("menuitem"))}));ug.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:nc([ug.config({}),ag("menubar-events",[ur((function(n){t.onSetup(n)})),Zo(uo(),(function(t,n){Gu(t.element,".tox-mbtn--active").each((function(e){Xu(n.event.target,".tox-mbtn").each((function(n){je(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){Ix.expand(t),Ix.close(e),dg.focus(t)}))}))}))}))})),Zo(Ho(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){Ix.isOpen(e)&&(Ix.expand(t),Ix.close(e))}))}))}))]),ng.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),S.some(!0)}}),Ay.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Nn("dom"),Nn("uid"),Nn("onEscape"),Nn("backstage"),te("onSetup",t)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),NB="container",LB=[zl("slotBehaviours",[])],jB=function(t){return"<alloy.field."+t+">"},UB=function(t,n){var e,o=function(n){return Ff(t)},r=function(n,e){return function(o,r){return Bf(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Pr(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){var e;i(t)&&(e=t.element,Wi(e,"display","none"),Vr(e,"aria-hidden","true"),Go(t,zo(),{name:n,visible:!1}))})),c=function(t,n){U(n,(function(n){return e(t,n)}))},s=r((function(t,n){var e;i(t)||(e=t.element,$i(e,"display"),Nr(e,"aria-hidden"),Go(t,zo(),{name:n,visible:!0}))})),l={getSlotNames:o,getSlot:function(n,e){return Bf(n,t,e)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:Nl(t.slotBehaviours),apis:l}},WB=_t({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},ai),GB=l(l({},WB),{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),Cf(NB,jB(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=j(r,(function(t){return pf({name:t,pname:jB(t)})}));return zf(NB,LB,i,UB,o)}}),XB=ln([$n("icon"),$n("tooltip"),ue("onShow",t),ue("onHide",t),ue("onSetup",(function(){return t}))]),YB=function(t){return{element:function(){return t.element.dom}}},qB=function(n,e){var o=j(kt(e),(function(t){var n=e[t],o=_n(On("sidebar",XB,n));return{name:t,getApi:YB,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return j(o,(function(e){var r=se(t);return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Dh([Iv(e,r),Rv(e,r),Zo(zo(),(function(t,n){var e=n.event;q(o,(function(t){return t.name===e.name})).each((function(n){(e.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},KB=function(t,n){Kf.getCurrent(t).each((function(t){return ug.set(t,[(e=n,GB.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:qB(t,e),slotBehaviours:Dh([ur((function(t){return GB.hideAllSlots(t)}))])}})))]);var e}))},JB=function(t){return Kf.getCurrent(t).bind((function(t){return yT.isGrowing(t)||yT.hasGrown(t)?Kf.getCurrent(t).bind((function(t){return q(GB.getSlotNames(t),(function(n){return GB.isShowing(t,n)}))})):S.none()}))},$B=Xr("FixSizeEvent"),QB=Xr("AutoSizeEvent"),ZB=function(t){var n,e,o,r=fe.fromHtml(t),i=kr(r),u=(e=void 0!==(n=r).dom.attributes?n.dom.attributes:[],Y(e,(function(t,n){var e;return"class"===n.name?t:l(l({},t),((e={})[n.name]=n.value,e))}),{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:Fr(r)};return l({tag:lr(r),classes:a,attributes:u},c)},tD=function(t,n,e){var o=t.element;!0===n?(ug.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:ZB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:nc([ng.config({mode:"special",onTab:function(){return S.some(!0)},onShiftTab:function(){return S.some(!0)}}),dg.config({})])}]),$i(o,"display"),Nr(o,"aria-hidden")):(ug.set(t,[]),Wi(o,"display","none"),Vr(o,"aria-hidden","true"))},nD=eB.optional({factory:zB,name:"menubar",schema:[Nn("backstage")]}),eD=eB.optional({factory:{sketch:function(t){return uB.sketch({uid:t.uid,dom:t.dom,listBehaviours:nc([ng.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return MT({type:t.type,uid:Xr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),S.some(!0)}})},setupItem:function(t,n,e,o){V_.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Nn("dom"),Nn("onEscape")]}),oD=eB.optional({factory:{sketch:function(t){var n;return((n=t).type===Zp.sliding?AT:n.type===Zp.floating?DT:MT)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),S.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Nn("dom"),Nn("onEscape"),Nn("getSink")]}),rD=eB.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?PB:sB;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:nc(e(n,t.sharedBackstage))}}},name:"header",schema:[Nn("dom")]}),iD=eB.optional({name:"socket",schema:[Nn("dom")]}),uD=eB.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:nc([Ay.config({}),dg.config({}),yT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Kf.getCurrent(t).each(GB.hideAllSlots),Wo(t,QB)},onGrown:function(t){Wo(t,QB)},onStartGrow:function(t){Go(t,$B,{width:Ki(t.element,"width").getOr("")})},onStartShrink:function(t){Go(t,$B,{width:Su(t.element)+"px"})}}),ug.config({}),Kf.config({find:function(t){var n=ug.contents(t);return et(n)}})])}],behaviours:nc([HS(0),ag("sidebar-sliding-events",[Zo($B,(function(t,n){Wi(t.element,"width",n.event.width)})),Zo(QB,(function(t,n){$i(t.element,"width")}))])])}}},name:"sidebar",schema:[Nn("dom")]}),aD=eB.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:nc([ug.config({})]),components:[]}}},name:"throbber",schema:[Nn("dom")]}),cD=Wf({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return nB.getPart(n,t,"socket")},setSidebar:function(n,e){nB.getPart(n,t,"sidebar").each((function(t){return KB(t,e)}))},toggleSidebar:function(n,e){nB.getPart(n,t,"sidebar").each((function(t){return n=t,o=e,void Kf.getCurrent(n).each((function(t){Kf.getCurrent(t).each((function(n){yT.hasGrown(t)?GB.isShowing(n,o)?yT.shrink(t):(GB.hideAllSlots(n),GB.showSlot(n,o)):(GB.hideAllSlots(n),GB.showSlot(n,o),yT.grow(t))}))}));var n,o}))},whichSidebar:function(n){return nB.getPart(n,t,"sidebar").bind(JB).getOrNull()},getHeader:function(n){return nB.getPart(n,t,"header")},getToolbar:function(n){return nB.getPart(n,t,"toolbar")},setToolbar:function(n,e){nB.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){nB.getPart(n,t,"multiple-toolbar").each((function(t){uB.setItems(t,e)}))},refreshToolbar:function(n){nB.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){nB.getPart(n,t,"toolbar").each((function(t){var n,e;n=t.getApis().toggle,e=function(n){return n(t)},void 0!==n&&null!==n?S.some(e(n)):S.none()}))},isToolbarDrawerToggled:function(n){return nB.getPart(n,t,"toolbar").bind((function(t){return S.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return nB.getPart(n,t,"throbber")},focusToolbar:function(n){nB.getPart(n,t,"toolbar").orThunk((function(){return nB.getPart(n,t,"multiple-toolbar")})).each((function(t){ng.focusIn(t)}))},setMenubar:function(n,e){nB.getPart(n,t,"menubar").each((function(t){zB.setMenus(t,e)}))},focusMenubar:function(n){nB.getPart(n,t,"menubar").each((function(t){zB.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Nn("dom"),Nn("behaviours")],partFields:[rD,nD,oD,eD,iD,uD,aD],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=j(e,TT);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=j(e,(function(t){return j(t,TT)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),sD={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},lD=function(t){return"string"==typeof t?t.split(" "):t},fD=function(t,n){var e=l(l({},sD),n.menus),o=0<kt(n.menus).length,r=void 0===n.menubar||!0===n.menubar?lD("file edit view insert format tools table help"):lD(!1===n.menubar?"":n.menubar),i=G(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||sD.hasOwnProperty(t)})),u=j(i,(function(o){var r,i,u,a=e[o];return r={title:a.title,items:lD(a.items)},i=n,u=t.getParam("removed_menuitems","").split(/[ ,]/),{text:r.title,getItems:function(){return $(r.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||z(u,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]}))}}}));return G(u,(function(t){return 0<t.getItems().length&&z(t.getItems(),(function(t){return"separator"!==t.type}))}))},dD=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},mD=function(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e);var e}},gD=function(t,n){var e,o,r,i,u,a,c=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):nv.baseURL+"/skins/ui/"+o),i);c&&(u=c+"/skin.min.css",n.contentCSS.push(c+(t?"/content.inline":"/content")+".min.css")),0==(!1===n.getParam("skin"))&&u?((a=n.ui.styleSheetLoader).load(u,dD(n),mD(n,"Skin could not be loaded")),n.on("remove",(function(){return a.unload(u)}))):dD(n)()},pD=r(gD,!1),hD=r(gD,!0),vD=function(t,n,e,o){var r,i=n.outerContainer,u=e.toolbar,a=e.buttons;F(u,O)?(r=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return KE(t,r,{backstage:o},S.none())})),cD.setToolbars(i,r)):cD.setToolbar(i,KE(t,e,{backstage:o},S.none()))},bD=zh.DOM,yD=ze(),xD=yD.os.isiOS()&&yD.os.version.major<=12,wD=function(t,n){var e=t.getWin(),o=t.getDoc().documentElement,r=se(vu(e.innerWidth,e.innerHeight)),i=se(vu(o.offsetWidth,o.offsetHeight)),u=function(){var n=r.get();n.left===e.innerWidth&&n.top===e.innerHeight||(r.set(vu(e.innerWidth,e.innerHeight)),vb(t))},a=function(){var n=t.getDoc().documentElement,e=i.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(i.set(vu(n.offsetWidth,n.offsetHeight)),vb(t))},c=function(n){return e=n,t.fire("ScrollContent",e);var e};bD.bind(e,"resize",u),bD.bind(e,"scroll",c);var s=ny(fe.fromDom(t.getBody()),"load",a),l=n.uiMothership.element;t.on("hide",(function(){Wi(l,"display","none")})),t.on("show",(function(){$i(l,"display")})),t.on("NodeChange",a),t.on("remove",(function(){s.unbind(),bD.unbind(e,"resize",u),bD.unbind(e,"scroll",c)}))},SD=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=se(0),u=n.outerContainer;pD(t);var a,c,s=fe.fromDom(r.targetNode),l=Vi(Ri(s));a=s,c=n.mothership,al(a,c,_r),ul(l,n.uiMothership),t.on("PostRender",(function(){vD(t,n,e,o),i.set(t.getWin().innerWidth),cD.setMenubar(u,fD(t,e)),cD.setSidebar(u,e.sidebar),wD(t,n)}));var f,d,m,g,p=cD.getSocket(u).getOrDie("Could not find expected socket element");xD&&(Gi(p.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),d=function(){t.fire("ScrollContent")},m=20,g=null,f={cancel:function(){null!==g&&(clearTimeout(g),g=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===g&&(g=setTimeout((function(){d.apply(null,t),g=null}),m))}},ty(p.element,"scroll",f.throttle)),Tv(t,n),t.addCommand("ToggleSidebar",(function(n,e){cD.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return cD.whichSidebar(u)}));var h=gv(t);return h!==Zp.sliding&&h!==Zp.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(cD.refreshToolbar(n.outerContainer),i.set(e))})),{iframeContainer:p.element.dom,editorContainer:u.element.dom}}}),kD=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?S.some(parseInt(""+t,10)):S.none()},CD=function(t){return M(t)?t+"px":t},OD=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return n<t}));return o.or(r).getOr(t)},_D=function(t){var n,e,o,r;return(e=ev(n=t),o=iv(n),r=av(n),kD(e).map((function(t){return OD(t,o,r)}))).getOr(ev(t))},TD=function(t){var n=ov(t),e=rv(t),o=uv(t);return kD(n).map((function(t){return OD(t,e,o)}))},ED=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=zh.DOM,c=wv(t),s=kv(t),l=uv(t).or(TD(t)),f=o.shared.header,d=f.isPositionedAtTop,m=gv(t),g=m===Zp.sliding||m===Zp.floating,p=se(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold((function(){return 0}),(function(t){return 1<t.components().length?gu(t.components()[1].element):0})):0},b=function(){i.broadcastOn([xl()],{})},y=function(t){var e,o,i,a,f,m;void 0===t&&(t=!1),h()&&(c||(e=l.getOrThunk((function(){var t=kD(Yi(Ni(),"margin-left")).getOr(0);return Su(Ni())-yu(n).left+t})),Wi(r.get().element,"max-width",e+"px")),g&&cD.refreshToolbar(u),c||(o=cD.getToolbar(u),i=v(o),a=Ru(n),f=d()?Math.max(a.y-gu(r.get().element)+i,0):a.bottom,Gi(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=r.get(),t?DB.reset(m):DB.refresh(m)),b())},x=function(e){var o,i;void 0===e&&(e=!0),!c&&s&&h()&&(o=f.getDockingMode(),(i=function(e){switch(bv(t)){case dv.auto:var o=cD.getToolbar(u),r=v(o),i=gu(e.element)-r,a=Ru(n);if(a.y>i)return"top";var c=br(n),s=Math.max(c.dom.scrollHeight,gu(c));return a.bottom<s-i||Pu().bottom<a.bottom-i?"bottom":"top";case dv.bottom:return"bottom";case dv.top:default:return"top"}}(r.get()))!==o&&(function(t){var n=r.get();DB.setModes(n,[t]),f.setDockingMode(t);var e=d()?$u.TopToBottom:$u.BottomToTop;Vr(n.element,Hc,e)}(i),e&&y(!0)))};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Wi(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),$i(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Wi(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Wi(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},BD=function(t,n){var e=Ru(t);return{pos:n?e.y:e.bottom,bounds:e}},DD=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=se(null),s=fe.fromDom(r.targetNode),l=ED(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean");hD(t);var d=function(){var r,d;c.get()?l.show():(c.set(cD.getHeader(a).getOrDie()),r=xv(d=t).getOrThunk((function(){return Vi(Ri(fe.fromDom(d.getElement())))})),ul(r,i),ul(r,u),vD(t,n,e,o),cD.setMenubar(a,fD(t,e)),l.show(),function(t,n,e,o){var r=se(BD(n,e.isPositionedAtTop())),i=function(o){var i=BD(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;r.set({pos:u,bounds:a}),f&&vb(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){ap.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=HE();u.set(ny(fe.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,l,f),t.nodeChanged())};t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",(function(){(t.hasFocus()||f)&&d()})),Tv(t,n);var m={show:function(){l.show()},hide:function(){l.hide()}};return{editorContainer:a.element.dom,api:m}}}),AD=function(t,n){var e,o,r,i,u,a,c,s,f,d,m,g,p,h;r=vE(0,o=n,TE(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=vE(0,u=n,AE(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,f=l({type:"advanced"},(s=n).styleselect),d=vE(0,s,jE(c,f)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return d.items.validateItems(d.getStyleItems())}}),g=vE(0,n,LE(m=t)),m.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),h=vE(0,n,IE(p=t)),p.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})},MD=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},FD=function(t){var n,e;!function(t){$C.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:zE(t,n.name),onAction:MD(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:zE(t,e),onAction:MD(t,e)})}}(t),n=t,$C.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})})),e=t,$C.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:zE(e,t.name)})}))},ID=function(t){var n;FD(t),n=t,$C.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:MD(n,"code")})},RD=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},VD=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return RD(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return RD(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return RD(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return RD(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},PD={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},HD=(xE="[eE][+-]?[0-9]+",SE=["Infinity",(yE="[0-9]+")+"\\."+(wE=function(t){return"(?:"+t+")?"})(yE)+wE(xE),"\\."+yE+wE(xE),yE+wE(xE)].join("|"),new RegExp("^([+-]?(?:"+SE+"))(.*)$")),zD=function(t,n){return S.from(HD.exec(t)).bind((function(t){var e,o=Number(t[1]),r=t[2];return e=r,z(n,(function(t){return z(PD[t],(function(t){return e===t}))}))?S.some({value:o,unit:r}):S.none()}))},ND=function(t){return zD(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit})).getOr(t)},LD=function(t){var n=t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),e=new Map,o=PE((function(t){return t.destroy()})),r=function(){var n=ND(t.queryCommandValue("LineHeight"));S.from(e.get(n)).fold((function(){return o.clear()}),(function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)}))};return t.on("nodeChange",r),j(n,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(ND(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}}))},jD=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return LD(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(LD(e))}})},UD=function(t,n){var e,o,r,i;!function(t){$C.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:zE(t,n.name)})}));var n="alignnone",e="No alignment",o="JustifyNone",r="align-none";t.ui.registry.addButton(n,{tooltip:e,onAction:function(){return t.execCommand(o)},icon:r})}(t),ID(t),AD(t,n),VD(t),function(t){_b(t);var n=se(null),e=se(null);Mb(t,"forecolor","forecolor","Text color",n),Mb(t,"backcolor","hilitecolor","Background color",e),Fb(t,"forecolor","forecolor","Text color"),Fb(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),jD(t)},WD=function(t,n){return{anchor:"makeshift",x:t,y:n}},GD=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},XD=function(t,n){var e,o,r,i=zh.DOM.getPos(t);return e=n,o=i.x,r=i.y,WD(e.x+o,e.y+r)},YD=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(GD(t)){var n=t.touches[0];return WD(n.pageX,n.pageY)}return WD(t.pageX,t.pageY)}(n):XD(t.getContentAreaContainer(),function(t){if(GD(t)){var n=t.touches[0];return WD(n.clientX,n.clientY)}return WD(t.clientX,t.clientY)}(n)):qD(t)},qD=function(t){return{anchor:"selection",root:fe.fromDom(t.selection.getNode())}},KD=function(t){return{anchor:"node",node:S.some(fe.fromDom(t.selection.getNode())),root:fe.fromDom(t.getBody())}},JD=function(t,n,e,o,r,i){var u=e(),a=i?KD(t):YD(t,n);wC(u,nh.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),Kg.showMenuAt(r,a,{menu:{markers:dh("normal")},data:t})}))},$D={onLtr:function(){return[za,Ia,Ra,Va,Pa,Ha,ip,up,op,np,rp,ep]},onRtl:function(){return[za,Ra,Ia,Pa,Va,Ha,ip,up,rp,ep,op,np]}},QD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},ZD=function(t,n,e,o,r,i,u){var a,c,s=i?KD(t):(a=t,c=n,l({bubble:Ic(0,12,QD),layouts:$D,overrides:{maxWidthFunction:M_(),maxHeightFunction:Bc()}},YD(a,c)));wC(e,nh.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),Kg.showMenuWithinBounds(r,s,{menu:{markers:dh("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return S.some(cE(t,o.shared))})),t.fire(F_)}))},tA=function(t,n,e,o,r,i){var u,a=ze(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var u=e();ZD(t,n,u,o,r,i,!(l||c||s&&f))};!s&&!c||i?(l&&!i&&t.selection.setCursorLocation(n.target,0),d()):(u=function(){!function(t){var n=t.selection.getRng(),e=function(){ap.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),d()},function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return hs(t.getWin(),qc.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?u():(t.once("selectionchange",u),t.once("touchend",(function(){return t.off("selectionchange",u)}))))},nA=function(t){return"string"==typeof t?t.split(/[ ,]/):t},eA=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},oA=function(t){return e="contextmenu",o="link linkchecker image imagetools table spellchecker configurepermanentpen",r=(n=t).ui.registry.getAll().contextMenus,S.from(n.getParam(e)).map(nA).getOrThunk((function(){return G(nA(o),(function(t){return Ft(r,t)}))}));var n,e,o,r},rA=function(t){return O(t)?"|"===t:"separator"===t.type},iA={type:"separator"},uA=function(t){if(O(t))return t;switch(t.type){case"separator":return iA;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems();return O(n)?n:j(n,uA)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:(n=t.onAction,function(){return n()})}}var n},aA=function(t,n){if(0===n.length)return t;var e=ot(t).filter((function(t){return!rA(t)})).fold((function(){return[]}),(function(t){return[iA]}));return t.concat(e).concat(n).concat([iA])},cA=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},sA=function(t,n){return cA(t,n)?t.selection.getStart(!0):n.target},lA=function(t,n,e){var o=ze().deviceType.isTouch,r=lu(Kg.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:nc([ag("dismissContextMenu",[Zo(Vo(),(function(n,e){bl.close(n),t.focus()}))])])})),i=function(t){return Kg.hide(r)},u=function(n){var i,u;eA(t)&&n.preventDefault(),i=t,n.ctrlKey&&!eA(i)||!1===t.getParam("contextmenu")||(u=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(cA(t,n))return!0;if(e){var o=sA(t,n);return oy(fe.fromDom(o),e)}return!1}(t,n),(o()?tA:JD)(t,n,(function(){var e,o,r,i=sA(t,n),u=t.ui.registry.getAll(),a=oA(t);return e=u.contextMenus,o=i,0<(r=Y(a,(function(t,n){if(Ft(e,n)){var r=e[n].update(o);if(O(r))return aA(t,r.split(" "));if(0<r.length){var i=j(r,uA);return aA(t,i)}return t}return t.concat([n])}),[])).length&&rA(r[r.length-1])&&r.pop(),r}),e,r,u))};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)}))},fA=Rt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),dA=function(t){return function(n){return n.translate(-t.left,-t.top)}},mA=function(t){return function(n){return n.translate(t.left,t.top)}},gA=function(t){return function(n,e){return Y(t,(function(t,n){return n(t)}),vu(n,e))}},pA=function(t,n,e){return t.fold(gA([mA(e),dA(n)]),gA([dA(n)]),gA([]))},hA=function(t,n,e){return t.fold(gA([mA(e)]),gA([]),gA([mA(n)]))},vA=function(t,n,e){return t.fold(gA([]),gA([dA(e)]),gA([mA(n),dA(e)]))},bA=function(t,n,e){var o=t.fold((function(t,n){return{position:S.some("absolute"),left:S.some(t+"px"),top:S.some(n+"px")}}),(function(t,n){return{position:S.some("absolute"),left:S.some(t-e.left+"px"),top:S.some(n-e.top+"px")}}),(function(t,n){return{position:S.some("fixed"),left:S.some(t+"px"),top:S.some(n+"px")}}));return l({right:S.none(),bottom:S.none()},o)},yA=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(vA,xA),r(hA,wA),r(pA,SA))},xA=fA.offset,wA=fA.absolute,SA=fA.fixed,kA=function(t,n){var e=Pr(t,n);return B(e)?NaN:parseInt(e,10)},CA=function(t,n,e,o){return r=n,i=t.element,u=kA(i,r.leftAttr),a=kA(i,r.topAttr),(isNaN(u)||isNaN(a)?S.none():S.some(vu(u,a))).fold((function(){return e}),(function(t){return SA(t.left+o.left,t.top+o.top)}));var r,i,u,a},OA=function(t,n,e,o,r,i){var u,a,c,s=CA(t,n,e,o),l=(n.mustSnap?EA:BA)(t,n,s,r,i),f=pA(s,r,i);return u=n,a=f,c=t.element,Vr(c,u.leftAttr,a.left+"px"),Vr(c,u.topAttr,a.top+"px"),l.fold((function(){return{coord:SA(f.left,f.top),extra:S.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},_A=function(t,n){var e,o;e=n,o=t.element,Nr(o,e.leftAttr),Nr(o,e.topAttr)},TA=function(t,n,e,o){return it(t,(function(t){var r,i,u,a,c,s,l,f,d=t.sensor;return r=n,i=d,u=t.range.left,a=t.range.top,l=hA(r,c=e,s=o),f=hA(i,c,s),Math.abs(l.left-f.left)<=u&&Math.abs(l.top-f.top)<=a?S.some({output:yA(t.output,n,e,o),extra:t.extra}):S.none()}))},EA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return TA(i,e,o,r).orThunk((function(){return Y(i,(function(t,n){var i,u,a,c,s,l,f,d,m=n.sensor,g=(i=e,u=m,n.range.left,n.range.top,s=hA(i,a=o,c=r),l=hA(u,a,c),f=Math.abs(s.left-l.left),d=Math.abs(s.top-l.top),vu(f,d));return t.deltas.fold((function(){return{deltas:S.some(g),snap:S.some(n)}}),(function(e){return(g.left+g.top)/2<=(e.left+e.top)/2?{deltas:S.some(g),snap:S.some(n)}:t}))}),{deltas:S.none(),snap:S.none()}).snap.map((function(t){return{output:yA(t.output,e,o,r),extra:t.extra}}))}))},BA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return TA(i,e,o,r)},DA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f,d=n.getTarget(t.element);n.repositionTarget&&(r=hr(t.element),i=Tu(r),u=dB(d),l=i,f=u,a={coord:yA((s=o).output,s.output,l,f),extra:s.extra},c=bA(a.coord,0,u),Xi(d,c))}}),AA="data-initial-z-index",MA=function(t,n){var e;t.getSystem().addToGui(n),xr((e=n).element).filter(dr).each((function(t){Ki(t,"z-index").each((function(n){Vr(t,AA,n)})),Wi(t,"z-index",Yi(e.element,"z-index"))}))},FA=function(t){xr(t.element).filter(dr).each((function(t){Hr(t,AA).fold((function(){return $i(t,"z-index")}),(function(n){return Wi(t,"z-index",n)})),Nr(t,AA)})),t.getSystem().removeFromGui(t)},IA=function(t,n,e){return t.getSystem().build(Cy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},RA=Zn("snaps",[Nn("getSnapPoints"),la("onSensor"),Nn("leftAttr"),Nn("topAttr"),te("lazyViewport",Pu),te("mustSnap",!1)]),VA=[te("useFixed",a),Nn("blockerClass"),te("getTarget",o),te("onDrag",t),te("repositionTarget",!0),te("onDrop",t),ue("getBounds",Pu),RA],PA=function(t){return n=Ki(t,"left"),e=Ki(t,"top"),o=Ki(t,"position"),r=function(t,n,e){return("fixed"===e?SA:xA)(parseInt(t,10),parseInt(n,10))},(n.isSome()&&e.isSome()&&o.isSome()?S.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):S.none()).getOrThunk((function(){var n=yu(t);return wA(n.left,n.top)}));var n,e,o,r},HA=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return xA(t+n,e+u)}),(function(t,e){return wA(t+n,e+u)}),(function(t,e){return SA(t+n,e+u)}))),c=pA(a,o,r);return SA(c.left,c.top)}),(function(n){var u=OA(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return a=h,c=o,s=r,f=(l=u).bounds,d=hA(a,c,s),m=Sc(d.left,f.x,f.x+f.width-l.width),g=Sc(d.top,f.y,f.y+f.height-l.height),p=wA(m,g),a.fold((function(){var t=vA(p,c,s);return xA(t.left,t.top)}),(function(){return p}),(function(){var t=pA(p,c,s);return SA(t.left,t.top)}))},zA=function(t,n){return{bounds:t.getBounds(),height:pu(n.element),width:ku(n.element)}},NA=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return zA(n,t)}));i.each((function(e){var o,r,i,a,c,s,l,f,d,m,g;o=t,i=u,a=e,g=(r=n).getTarget(o.element),r.repositionTarget&&(c=hr(o.element),s=Tu(c),l=dB(g),f=PA(g),d=HA(o,r.snaps,f,s,l,a,i),m=bA(d,0,l),Xi(g,m)),r.onDrag(o,g,a)}))},LA=function(t,n,e,o){n.each(FA),e.snaps.each((function(n){_A(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},jA=function(t){return function(n,e){var o=function(t){e.setStartData(zA(n,t))};return Jo(d([Zo(Mo(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},UA=Object.freeze({__proto__:null,getData:function(t){return S.from(vu(t.x,t.y))},getDelta:function(t,n){return vu(n.left-t.left,n.top-t.top)}}),WA=function(t,n,e){return[Zo(eo(),(function(o,r){var i,u,a,c,s;0===r.event.raw.button&&(r.stop(),a={drop:i=function(){return LA(o,S.some(c),t,n)},delayDrop:(u=ry(i,200)).schedule,forceDrop:i,move:function(e){u.cancel(),NA(o,t,n,UA,e)}},c=IA(o,t.blockerClass,(s=a,Jo([Zo(eo(),s.forceDrop),Zo(io(),s.drop),Zo(oo(),(function(t,n){s.move(n.event)})),Zo(ro(),s.delayDrop)]))),e(o),MA(o,c))}))]},GA=d(VA,[ga("dragger",{handlers:jA(WA)})]),XA=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],S.some(vu(n.clientX,n.clientY))):S.none()},getDelta:function(t,n){return vu(n.left-t.left,n.top-t.top)}}),YA=function(t,n,e){var o=se(S.none());return[Zo(Qe(),(function(r,i){i.stop();var u,a=function(){LA(r,o.get(),t,n),o.set(S.none())},c={drop:a,delayDrop:function(){},forceDrop:a,move:function(e){NA(r,t,n,XA,e)}},s=IA(r,t.blockerClass,(u=c,Jo([Zo(Qe(),u.forceDrop),Zo(to(),u.drop),Zo(no(),u.drop),Zo(Ze(),(function(t,n){u.move(n.event)}))])));o.set(S.some(s)),e(r),MA(r,s)})),Zo(Ze(),(function(e,o){o.stop(),NA(e,t,n,XA,o.event)})),Zo(to(),(function(e,r){r.stop(),LA(e,o.get(),t,n),o.set(S.none())})),Zo(no(),(function(e){LA(e,o.get(),t,n),o.set(S.none())}))]},qA=d(VA,[ga("dragger",{handlers:jA(YA)})]),KA=d(VA,[ga("dragger",{handlers:jA((function(t,n,e){return d(WA(t,n,e),YA(t,n,e))}))})]),JA=ic({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:GA,touch:qA,mouseOrTouch:KA}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:S.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=S.none(),n=S.none(),o=e({});return si({readState:o,reset:function(){t=S.none(),n=S.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=S.some(r),i;var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=S.some(t)}})}}),apis:DA}),$A=function(t,n,e,o,r,i){return t.fold((function(){return JA.snap({sensor:wA(e-20,o-20),range:vu(r,i),output:wA(S.some(e),S.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return JA.snap({sensor:wA(r,i),range:vu(40,40),output:wA(S.some(e-u.width/2),S.some(o-u.height/2)),extra:{td:n}})}))},QA=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r,i,u=o.td;r=n.get(),i=u,r.exists((function(t){return je(t,i)}))||(n.set(S.some(u)),e(u))},mustSnap:!0}},ZA=function(t){return sp(cp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:nc([JA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Rx.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},tM=function(t,n){var e=se([]),o=se([]),r=se(!1),i=se(S.none()),u=se(S.none()),a=function(t){var e=Vu(t);return $A(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=Vu(t);return $A(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=QA((function(){return j(e.get(),a)}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),l=QA((function(){return j(o.get(),c)}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),f=ZA(s),d=ZA(l),m=lu(f.asSpec()),g=lu(d.asSpec()),p=function(n,e,o,r){var i=o(e);JA.snapTo(n,i),function(n,e,o,r){var i=e.dom.getBoundingClientRect();$i(n.element,"display");var u=yr(fe.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Wi(n.element,"display","none")}(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};ze().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(nl(n,m),nl(n,g),r.set(!0)),i.set(S.some(t.start)),u.set(S.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(rl(m),rl(g),r.set(!1)),i.set(S.none()),u.set(S.none())})))};(CE=kE=kE||{})[CE.None=0]="None",CE[CE.Both=1]="Both",CE[CE.Vertical=2]="Vertical";var nM,eM,oM,rM=function(t,n,e){var o,r,i,u,a,c,s=fe.fromDom(t.getContainer()),l=(o=t,r=n,i=e,u=gu(s),a=Su(s),(c={}).height=OD(u+r.top,iv(o),av(o)),i===kE.Both&&(c.width=OD(a+r.left,rv(o),uv(o))),c);Ot(l,(function(t,n){return Wi(s,n,CD(t))})),t.fire("ResizeEditor")},iM=function(t,n,e){return n.delimiter||(n.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:nc([ng.config({mode:"flow",selector:"div[role=button]"}),tv.config({disabled:e.isReadOnly}),Ev(),Ay.config({}),ug.config({}),ag("elementPathEvents",[ur((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return ng.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o];if(1===r.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);0<a.length?ug.set(o,(i=j(a||[],(function(n,o){return cp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:nc([Dv(e.isReadOnly),Ev()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},Y(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):ug.set(o,[])}))}))])]),components:[]}},uM=function(t,n){var e,o,r,i,u,a;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var e,o,r,i,u,a=[];return t.getParam("elementpath",!0,"boolean")&&a.push(iM(t,{},n)),t.hasPlugin("wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return ug.set(t,[au(o.translate(["{0} "+e,n[e]]))])},cp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:nc([Dv(o.isReadOnly),Ev(),Ay.config({}),ug.config({}),Hl.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ag("wordcount-events",[sr((function(t){var n=Hl.getValue(t),e="words"===n.mode?"characters":"words";Hl.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)})),ur((function(t){e.on("wordCountUpdate",(function(n){var e=Hl.getValue(t).mode;Hl.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)}))}))])]),eventOrder:((r={})[ko()]=["disabling","alloy.base.behaviour","wordcount-events"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=Nh.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!(e=t).hasPlugin("autoresize"),(a=!1===(r=e.getParam("resize",o))?kE.None:"both"===r?kE.Both:kE.Vertical)!==kE.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:fp("resize-handle",n.icons)},behaviours:nc([JA.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,e,o){rM(t,o,i)},blockerClass:"tox-blocker"})])})),u)}},aM=function(t){var n,e=t.inline,o=e?DD:SD,r=kv(t)?HB:lB,i=S.none(),u=ze(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=yv(t),f=Nh.isRtl()?{attributes:{dir:"rtl"}}:{},d={attributes:((n={})[Hc]=s?$u.BottomToTop:$u.TopToBottom,n)},m=function(){return i.bind(cD.getHeader)},g=lu({dom:l({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},f),behaviours:nc([Js.config({useFixed:function(){return r.isDocked(m)}})])}),p=function(){return ct.value(g)},h=sp({dom:{tag:"div",classes:["tox-anchorbar"]}}),v=function(){return i.bind((function(t){return cD.getThrobber(t)})).getOrDie("Could not find throbber element")},b=A_(g,t,(function(){return i.bind((function(t){return h.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),y=cD.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:b,onEscape:function(){t.focus()}}),x=gv(t),w=cD.parts.toolbar(l({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,providers:b.shared.providers,onEscape:function(){t.focus()},type:x,lazyToolbar:function(){return i.bind((function(t){return cD.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return m().getOrDie("Could not find header element")}},d)),k=cD.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:b.shared.providers,onEscape:function(){t.focus()},type:x}),C=cD.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),O=cD.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),_=cD.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:b}),T=t.getParam("statusbar",!0,"boolean")&&!e?S.some(uM(t,b.shared.providers)):S.none(),E={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[C,O]},B=fv(t),D=sv(t),A=cv(t),F=cD.parts.header({dom:l({tag:"div",classes:["tox-editor-header"]},d),components:J([A?[y]:[],B?[k]:D?[w]:[],wv(t)?[]:[h.asSpec()]]),sticky:kv(t),editor:t,sharedBackstage:b.shared}),I=J([s?[]:[F],e?[]:[E],s?[F]:[]]),R=J([[{dom:{tag:"div",classes:["tox-editor-container"]},components:I}],e?[]:T.toArray(),[_]]),V=Sv(t),P=l(l({role:"application"},Nh.isRtl()?{dir:"rtl"}:{}),V?{"aria-hidden":"true"}:{}),H=lu(cD.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:l({visibility:"hidden"},V?{opacity:"0",border:"0"}:{}),attributes:P},components:R,behaviours:nc([ng.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));i=S.some(H);t.shortcuts.add("alt+F9","focus menubar",(function(){cD.focusMenubar(H)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){cD.focusToolbar(H)})),t.addCommand("ToggleToolbarDrawer",(function(){cD.toggleToolbarDrawer(H)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return cD.isToolbarDrawerToggled(H)}));var z,N,L,j,W,G,X,Y,q,K,$,Q,Z,tt,nt,et,ot=Oy(H),rt=Oy(g);z=t,N=ot,L=rt,j=function(t,n){U([N,L],(function(e){e.broadcastEvent(t,n)}))},W=function(t,n){U([N,L],(function(e){e.broadcastOn([t],n)}))},G=function(t){return W(yl(),{target:t.target})},X=ty(fe.fromDom(document),"touchstart",G),Y=ty(fe.fromDom(document),"touchmove",(function(t){return j(Do(),t)})),q=ty(fe.fromDom(document),"touchend",(function(t){return j(Ao(),t)})),K=ty(fe.fromDom(document),"mousedown",G),$=ty(fe.fromDom(document),"mouseup",(function(t){0===t.raw.button&&W(wl(),{target:t.target})})),Q=function(t){return W(yl(),{target:fe.fromDom(t.target)})},Z=function(t){0===t.button&&W(wl(),{target:fe.fromDom(t.target)})},tt=function(t){return j(Mo(),ey(t))},nt=function(t){W(xl(),{}),j(Fo(),ey(t))},et=function(){return W(xl(),{})},z.on("PostRender",(function(){z.on("click",Q),z.on("tap",Q),z.on("mouseup",Z),z.on("ScrollWindow",tt),z.on("ResizeWindow",nt),z.on("ResizeEditor",et)})),z.on("remove",(function(){z.off("click",Q),z.off("tap",Q),z.off("mouseup",Z),z.off("ScrollWindow",tt),z.off("ResizeWindow",nt),z.off("ResizeEditor",et),K.unbind(),X.unbind(),Y.unbind(),q.unbind(),$.unbind()})),z.on("detach",(function(){cl(N),cl(L),N.destroy(),L.destroy()}));var it=function(){var n,e=CD(_D(t)),o=CD(TD(n=t).getOr(ov(n)));return t.inline||(Ji("div","width",o)&&Wi(H.element,"width",o),Ji("div","height",e)?Wi(H.element,"height",e):Wi(H.element,"height","200px")),e};return{mothership:ot,uiMothership:rt,backstage:b,renderUI:function(){var n,e,i,u,a,c,s,f;r.setup(t,b.shared,m),UD(t,b),lA(t,p,b),e=(n=t).ui.registry.getAll().sidebars,U(kt(e),(function(t){var o=e[t],r=function(){return S.from(n.queryCommandValue("ToggleSidebar")).is(t)};n.ui.registry.addToggleButton(t,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){n.execCommand("ToggleSidebar",!1,t),e.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})})),i=t,u=v,a=b.shared,c=se(!1),s=se(S.none()),f=function(t){t!==c.get()&&(tD(u(),t,a.providers),c.set(t))},i.on("ProgressState",(function(t){var n;s.get().each(ap.clearTimeout),M(t.time)?(n=ap.setEditorTimeout(i,(function(){return f(t.state)}),t.time),s.set(S.some(n))):(f(t.state),s.set(S.none()))})),_t(t.getParam("toolbar_groups",{},"object"),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var d,h=t.ui.registry.getAll(),y=h.buttons,w=h.menuItems,k=h.contextToolbars,C=h.sidebars,O=lv(t),_={menuItems:w,menus:(d=t.getParam("menu"))?_t(d,(function(t){return l(l({},t),{items:t.items})})):{},menubar:t.getParam("menubar"),toolbar:O.getOrThunk((function(){return t.getParam("toolbar",!0)})),allowToolbarGroups:x===Zp.floating,buttons:y,sidebar:C};tB(t,k,g,{backstage:b}),tM(t,g);var T=t.getElement(),E=it(),B={mothership:ot,uiMothership:rt,outerContainer:H},D={targetNode:T,height:E};return o.render(t,B,_,b,D)},getUi:function(){return{channels:{broadcastAll:rt.broadcast,broadcastOn:rt.broadcastOn,register:function(){}}}}}},cM=e([Nn("lazySink"),qn("dragBlockClass"),ue("getBounds",Pu),te("useTabstopAt",c),te("eventOrder",{}),zl("modalBehaviours",[ng]),fa("onExecute"),ma("onEscape")]),sM={sketch:o},lM=e([vf({name:"draghandle",overrides:function(t,n){return{behaviours:nc([JA.config({mode:"mouse",getTarget:function(t){return Wu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),pf({schema:[Nn("dom")],name:"title"}),pf({factory:sM,schema:[Nn("dom")],name:"close"}),pf({factory:sM,schema:[Nn("dom")],name:"body"}),vf({factory:sM,schema:[Nn("dom")],name:"footer"}),hf({factory:{sketch:function(t,n){return l(l({},t),{dom:n.dom,components:n.components})}},schema:[te("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),te("components",[])],name:"blocker"})]),fM=Wf({name:"ModalDialog",configFields:cM(),partFields:lM(),factory:function(t,n,e,r){var i,u=Xr("alloy.dialog.busy"),a=Xr("alloy.dialog.idle"),c=nc([ng.config({mode:"special",onTab:function(){return S.some(!0)},onShiftTab:function(){return S.some(!0)}}),dg.config({})]),s=Xr("modal-events"),f=l(l({},t.eventOrder),((i={})[Io()]=[s].concat(t.eventOrder["alloy.system.attached"]||[]),i));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){var e=t.lazySink(n).getOrDie(),o=se(S.none()),i=r.blocker(),s=e.getSystem().build(l(l({},i),{components:i.components.concat([fu(n)]),behaviours:nc([dg.config({}),ag("dialog-blocker-events",[ir(ao(),(function(){ng.focusIn(n)})),Zo(a,(function(t,e){zr(n.element,"aria-busy")&&(Nr(n.element,"aria-busy"),o.get().each((function(t){return ug.remove(n,t)})))})),Zo(u,(function(t,e){Vr(n.element,"aria-busy","true");var r=e.event.getBusySpec;o.get().each((function(t){ug.remove(n,t)}));var i=r(n,c),u=t.getSystem().build(i);o.set(S.some(u)),ug.append(n,fu(u)),u.hasConfigured(ng)&&ng.focusIn(u)}))])])}));nl(e,s),ng.focusIn(n)},hide:function(t){xr(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){rl(t)}))}))},getBody:function(n){return Df(n,t,"body")},getFooter:function(n){return Df(n,t,"footer")},setIdle:function(t){Wo(t,a)},setBusy:function(t,n){Go(t,u,{getBusySpec:n})}},eventOrder:f,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Ll(t.modalBehaviours,[ug.config({}),ng.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),ag(s,[ur((function(n){var e,r,i,u,a,c;e=n.element,r=Df(n,t,"title").element,i=Hr(e,"id").fold((function(){var t=Xr("dialog-label");return Vr(r,"id",t),t}),o),Vr(e,"aria-labelledby",i),u=n.element,a=Df(n,t,"body").element,c=S.from(Pr(u,"id")).fold((function(){var t=Xr("dialog-describe");return Vr(a,"id",t),t}),o),Vr(u,"aria-describedby",c)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),dM=ln([jn("type"),jn("name")].concat(Sh)),mM=Rn,gM=[vn("name","name",Gt((function(){return Xr("button-name")})),In),$n("icon"),re("align","end",["start","end"]),ie("primary",!1),ie("disabled",!1)],pM=d(gM,[jn("text")]),hM=d([Un("type",["submit","cancel","custom"])],pM),vM=d([Un("type",["menu"]),$n("text"),$n("tooltip"),$n("icon"),Yn("items",dM)],gM),bM=Dn("type",{submit:hM,cancel:hM,custom:hM,menu:vM}),yM=[jn("type"),jn("text"),Un("level",["info","warn","error","success"]),jn("icon"),te("url","")],xM=ln(yM),wM=[jn("type"),jn("text"),ie("disabled",!1),ie("primary",!1),vn("name","name",Gt((function(){return Xr("button-name")})),In),$n("icon"),ie("borderless",!1)],SM=ln(wM),kM=[jn("type"),jn("name"),jn("label"),ie("disabled",!1)],CM=ln(kM),OM=Rn,_M=[jn("type"),jn("name")],TM=_M.concat([$n("label")]),EM=TM.concat([te("columns","auto")]),BM=ln(EM),DM=wn([jn("value"),jn("text"),jn("icon")]),AM=ln(TM),MM=In,FM=ln(TM),IM=In,RM=_M.concat([oe("tag","textarea"),jn("scriptId"),jn("scriptUrl"),(nM=void 0,ne("settings",nM,Hn))]),VM=_M.concat([oe("tag","textarea"),Wn("init")]),PM=kn((function(t){return On("customeditor.old",sn(VM),t).orThunk((function(){return On("customeditor.new",sn(RM),t)}))})),HM=In,zM=ln(TM),NM=fn(xn),LM=function(t){return[jn("type"),Ln("columns",Fn),t]},jM=[jn("type"),jn("html"),re("presets","presentation",["presentation","document"])],UM=ln(jM),WM=TM.concat([ie("sandboxed",!0)]),GM=ln(WM),XM=In,YM=TM.concat([Ln("currentState",ln([Nn("blob"),jn("url")]))]),qM=ln(YM),KM=TM.concat([$n("inputMode"),$n("placeholder"),ie("maximized",!1),ie("disabled",!1)]),JM=ln(KM),$M=In,QM=[jn("text"),jn("value")],ZM=[jn("text"),Yn("items",(eM=function(){return tF},oM=Nt((function(){return eM()})),{extract:function(t,n,e){return oM().extract(t,n,e)},toString:function(){return oM().toString()}}))],tF=dn([ln(QM),ln(ZM)]),nF=TM.concat([Yn("items",tF),ie("disabled",!1)]),eF=ln(nF),oF=In,rF=TM.concat([Xn("items",[jn("text"),jn("value")]),ee("size",1),ie("disabled",!1)]),iF=ln(rF),uF=In,aF=TM.concat([ie("constrain",!0),ie("disabled",!1)]),cF=ln(aF),sF=ln([jn("width"),jn("height")]),lF=[jn("type"),Yn("header",In),Yn("cells",fn(In))],fF=ln(lF),dF=TM.concat([$n("placeholder"),ie("maximized",!1),ie("disabled",!1)]),mF=ln(dF),gF=In,pF=TM.concat([re("filetype","file",["image","media","file"]),te("disabled",!1)]),hF=ln(pF),vF=ln([jn("value"),te("meta",{})]),bF=function(t){return vn("items","items",Ut(),fn(kn((function(n){return On("Checking item of "+t,yF,n).fold((function(t){return ct.error(En(t))}),(function(t){return ct.value(t)}))}))))},yF=Sn((function(){return Bn("type",{alertbanner:xM,bar:ln((n=bF("bar"),[jn("type"),n])),button:SM,checkbox:CM,colorinput:AM,colorpicker:FM,dropzone:zM,grid:ln(LM(bF("grid"))),iframe:GM,input:JM,listbox:eF,selectbox:iF,sizeinput:cF,textarea:mF,urlinput:hF,customeditor:PM,htmlpanel:UM,imagetools:qM,collection:BM,label:ln((t=bF("label"),[jn("type"),jn("label"),t])),table:fF,panel:wF});var t,n})),xF=[jn("type"),te("classes",[]),Yn("items",yF)],wF=ln(xF),SF=[vn("name","name",Gt((function(){return Xr("tab-name")})),In),jn("title"),Yn("items",yF)],kF=[jn("type"),Xn("tabs",SF)],CF=ln(kF),OF=pM,_F=bM,TF=ln([jn("title"),Ln("body",Bn("type",{panel:wF,tabpanel:CF})),oe("size","normal"),Yn("buttons",_F),te("initialData",{}),ue("onAction",t),ue("onChange",t),ue("onSubmit",t),ue("onClose",t),ue("onCancel",t),te("onTabChange",t)]),EF=ln(d([Un("type",["cancel","custom"])],OF)),BF=ln([jn("title"),jn("url"),Jn("height"),Jn("width"),Kn("buttons",fn(EF)),ue("onAction",t),ue("onCancel",t),ue("onClose",t),ue("onMessage",t)]),DF=function(t){return _(t)?[t].concat($(At(t),DF)):T(t)?$(t,DF):[]},AF=function(t){return O(t.type)&&O(t.name)},MF={checkbox:OM,colorinput:MM,colorpicker:IM,dropzone:NM,input:$M,iframe:XM,sizeinput:sF,selectbox:uF,listbox:oF,size:sF,textarea:gF,urlinput:vF,customeditor:HM,collection:DM,togglemenuitem:mM},FF=function(t){var n=G(DF(t),AF),e=$(n,(function(t){return n=t,S.from(MF[n.type]).fold((function(){return[]}),(function(n){return[Ln(t.name,n)]}));var n}));return ln(e)},IF=function(t){return{internalDialog:_n(On("dialog",TF,t)),dataValidator:FF(t),initialData:t.initialData}},RF={open:function(t,n){var e=IF(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(_n(On("dialog",BF,n)))},redial:IF},VF=function(t){var n=[],e={};return Ot(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?ct.error(n):ct.value(e)},PF=Uf({name:"TabButton",configFields:[te("uid",void 0),Nn("value"),vn("dom","dom",Xt((function(){return{attributes:{role:"tab",id:Xr("aria"),"aria-selected":"false"}}})),An()),qn("action"),te("domModification",{}),zl("tabButtonBehaviours",[dg,ng,Hl]),Nn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:_g(t.action),behaviours:Ll(t.tabButtonBehaviours,[dg.config({}),ng.config({mode:"execution",useSpace:!0,useEnter:!0}),Hl.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),HF=e([Nn("tabs"),Nn("dom"),te("clickToDismiss",!1),zl("tabbarBehaviours",[ud,ng]),ca(["tabClass","selectedClass"])]),zF=bf({factory:PF,name:"tabs",unit:"tab",overrides:function(n){var e=function(t,n){ud.dehighlight(t,n),Go(t,Lo(),{tabbar:t,button:n})},o=function(t,n){ud.highlight(t,n),Go(t,No(),{tabbar:t,button:n})};return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=ud.isHighlighted(i,r);(u&&n.clickToDismiss?e:u?t:o)(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),NF=e([zF]),LF=Wf({name:"Tabbar",configFields:HF(),partFields:NF(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Ll(t.tabbarBehaviours,[ud.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Vr(n.element,"aria-selected","true")},onDehighlight:function(t,n){Vr(n.element,"aria-selected","false")}}),ng.config({mode:"flow",getInitial:function(t){return ud.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),jF=Uf({name:"Tabview",configFields:[zl("tabviewBehaviours",[ug])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Ll(t.tabviewBehaviours,[ug.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),UF=e([te("selectFirst",!0),la("onChangeTab"),la("onDismissTab"),te("tabs",[]),zl("tabSectionBehaviours",[])]),WF=pf({factory:LF,schema:[Nn("dom"),Gn("markers",[Nn("tabClass"),Nn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),GF=pf({factory:jF,name:"tabview"}),XF=e([WF,GF]),YF=Wf({name:"TabSection",configFields:UF(),partFields:XF(),factory:function(t,n,e,o){var r=function(n,e){Bf(n,t,"tabbar").each((function(t){e(t).each(Xo)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:Nl(t.tabSectionBehaviours),events:Jo(J([t.selectFirst?[ur((function(t,n){r(t,ud.getFirst)}))]:[],[Zo(No(),(function(n,e){var o,r,i=e.event.button;o=i,r=Hl.getValue(o),Bf(o,t,"tabview").each((function(n){q(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();Hr(o.element,"id").each((function(t){Vr(n.element,"aria-labelledby",t)})),ug.set(n,r),t.onChangeTab(n,o,r)}))}))})),Zo(Lo(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Bf(n,t,"tabview").map((function(t){return ug.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=ud.getCandidates(t);return q(e,(function(t){return Hl.getValue(t)===n})).filter((function(n){return!ud.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),qF=function(t,n){Wi(t,"height",n+"px"),ze().browser.isIE()?$i(t,"flex-basis"):Wi(t,"flex-basis",n+"px")},KF=function(t,n,e){Wu(t,'[role="dialog"]').each((function(t){Gu(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Wi(n,"height","0"),Wi(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=br(r=t).dom,c=Wu(r,".tox-dialog-wrap").getOr(r),s="fixed"===Yi(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=gu(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+Su(u)?Math.max(gu(u),l):l,d=parseInt(Yi(r,"margin-top"),10)||0,m=parseInt(Yi(r,"margin-bottom"),10)||0,s-(gu(r)+d+m-f)));var r,i,u,a,c,s,l,f,d,m})).each((function(t){qF(n,t)}))}))}))},JF=function(t){return Gu(t,'[role="tabpanel"]')},$F=function(t){var n;return{smartTabHeight:(n=se(S.none()),{extraEvents:[ur((function(e){var o=e.element;JF(o).each((function(r){var i;Wi(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o,i,u,a=(i=r,u=e,j(o=t,(function(t,n){ug.set(u,o[n].view());var e=i.dom.getBoundingClientRect();return ug.set(u,[]),e.height}))),c=et(nt(a,(function(t,n){return n<t?-1:t<n?1:0})));n.set(c)})),KF(o,r,n),$i(r,"visibility"),i=e,et(t).each((function(t){return YF.showTab(i,t.value)})),ap.requestAnimationFrame((function(){KF(o,r,n)}))}))})),Zo(Fo(),(function(t){var e=t.element;JF(e).each((function(t){KF(e,t,n)}))})),Zo(Wy,(function(t,e){var o=t.element;JF(o).each((function(t){var e=lc();Wi(t,"visibility","hidden");var r=Ki(t,"height").map((function(t){return parseInt(t,10)}));$i(t,"height"),$i(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return t<i}))?(n.set(S.from(i)),KF(o,t,n)):r.each((function(n){qF(t,n)})),$i(t,"visibility"),e.each(sc)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},QF="send-data-to-section",ZF="send-data-to-view",tI=Xr("update-dialog"),nI=Xr("update-title"),eI=Xr("update-body"),oI=Xr("update-footer"),rI=Xr("body-send-message"),iI=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:l(l({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:nc([HS(0),LT.config({channel:eI,updateState:function(t,n){return S.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(u=t.body,a=e,c=se({}),s=function(t){var n=Hl.getValue(t),e=VF(n).getOr({}),o=c.get(),r=Ht(o,e);c.set(r)},l=function(t){var n=c.get();Hl.setValue(t,n)},f=se(null),d=j(u.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:a.shared.providers.translate(t.title)},view:function(){return[ES.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:j(t.items,(function(t){return GO(n,t,a)})),formBehaviours:nc([ng.config({mode:"acyclic",useTabstopAt:i(ek)}),ag("TabView.form.events",[ur(l),ar(s)]),ac.config({channels:Jt([{key:QF,value:{onReceive:s}},{key:ZF,value:{onReceive:l}}])})])}}))]}}})),m=$F(d).smartTabHeight,YF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Hl.getValue(n);Go(t,Uy,{name:o,oldName:f.get()}),f.set(o)},tabs:d,components:[YF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[LF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:nc([Ay.config({})])}),YF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:nc([ag("tabpanel",m.extraEvents),ng.config({mode:"acyclic"}),Kf.config({find:function(t){return et(YF.getViewItems(t))}}),Hl.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([QF],{}),c.get()},setValue:function(t,n){c.set(n),t.getSystem().broadcastOn([ZF],{})}}})])}))];default:return[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=sp(ES.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:j(n.items,(function(n){return GO(t,n,o)}))}})))).asSpec()]}],behaviours:nc([ng.config({mode:"acyclic",useTabstopAt:i(ek)}),PS(r),GS(r,{postprocess:function(t){return VF(t).fold((function(t){return console.error(t),{}}),(function(t){return t}))}})])})]}var n,o,r,u,a,c,s,l,f,d,m},initialData:t})])}},uI=Nv.deviceType.isTouch(),aI=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},cI=function(t,n){return fM.parts.close(cp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:nc([Ay.config({})])}))},sI=function(){return fM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},lI=function(t,n){return fM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:ZB("<p>"+n.translate(t)+"</p>")}]}]})},fI=function(t){return fM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},dI=function(t,n){return[Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},mI=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return fM.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),S.some(!0)},useTabstopAt:function(t){return!ek(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:l({position:"relative"},t.extraStyles)},components:d([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:ZB('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:uI?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:nc(d([dg.config({}),ag("dialog-events",t.dialogEvents.concat([ir(ao(),(function(t,n){ng.focusIn(t)}))])),ag("scroll-lock",[ur((function(){Oi(Ni(),i)})),ar((function(){Ti(Ni(),i)}))])],t.extraBehaviours)),eventOrder:l(((n={})[ko()]=["dialog-events"],n[Io()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[Ro()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},gI=function(t){return cp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:fp("close",t.icons)}}],action:function(t){Wo(t,Hy)}})},pI=function(t,n,e){var o=function(t){return[au(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:l({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:nc([LT.config({channel:nI,renderComponents:o})])}},hI=function(){return{dom:ZB('<div class="tox-dialog__draghandle"></div>')}},vI=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=fM.parts.title(pI(e,S.none(),o)),i=fM.parts.draghandle(hI()),u=fM.parts.close(gI(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),Cy.sketch({dom:ZB('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},bI=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){fM.setBusy(t(),(function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:ZB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){fM.setIdle(t())}}},yI=function(t,n,e,o){var r;return lu(mI(l(l({},t),{lazySink:o.shared.getSink,extraBehaviours:d([LT.config({channel:tI,updateState:function(t,n){return S.some(n)},initialData:n}),qS({})],t.extraBehaviours),onEscape:function(t){Wo(t,Hy)},dialogEvents:e,eventOrder:((r={})[So()]=["reflecting","receiving"],r[Io()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],r[Ro()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],r)})))},xI=function(t){return j(t,(function(t){return"menu"===t.type?(e=j((n=t).items,(function(t){var n=se(!1);return l(l({},t),{storage:n})})),l(l({},n),{items:e})):t;var n,e}))},wI=function(t){return Y(t,(function(t,n){return"menu"!==n.type?t:Y(n.items,(function(t,n){return t[n.name]=n.storage,t}),t)}),{})},SI=function(t,n){return[or(ao(),nk),t(Py,(function(t,e){n.onClose(),e.onClose()})),t(Hy,(function(t,n,e,o){n.onCancel(t),Wo(o,Py)})),Zo(jy,(function(t,e){return n.onUnblock()})),Zo(Ly,(function(t,e){return n.onBlock(e.event)}))]},kI=function(t,n){var e=function(n,e){return Zo(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){LT.getState(t).get().each((function(e){n(e,t)}))};return d(SI(e,n),[e(zy,(function(t,n,e){n.onAction(t,{name:e.name})}))])},CI=function(t,n,e){var o=function(n,e){return Zo(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){LT.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return d(SI(o,n),[o(Ny,(function(t,n){return n.onSubmit(t)})),o(Vy,(function(t,n,e){n.onChange(t,{name:e.name})})),o(zy,(function(t,n,o,r){var i=function(){return ng.focusIn(r)},u=function(t){return zr(t,"disabled")||Hr(t,"aria-disabled").exists((function(t){return"true"===t}))},a=Ri(r.element),c=lc(a);n.onAction(t,{name:o.name,value:o.value}),lc(a).fold(i,(function(t){u(t)||c.exists((function(n){return We(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!We(n.element,t)})).each(i)}))})),o(Uy,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),ar((function(n){var e=t();Hl.setValue(n,e.getData())}))])},OI=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=W(e,(function(t){return"start"===t.align})),r=function(t,n){return Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:j(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},_I=function(t,n){return{dom:ZB('<div class="tox-dialog__footer"></div>'),components:[],behaviours:nc([LT.config({channel:oI,initialData:t,updateState:function(t,e){var o=j(e.buttons,(function(t){var e,o,r=sp((o=n,AC(e=t,e.type,o)));return{name:t.name,align:t.align,memento:r}}));return S.some({lookupByName:function(t,n){return e=t,r=n,q(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}));var e,r},footerButtons:o})},renderComponents:OI})])}},TI=_I,EI=function(t,n){return fM.parts.footer(_I(t,n))},BI=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Kf.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return ES.getField(e,n).fold((function(){var o=t.getFooter();return LT.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return S.some(t)}))}return S.none()},DI=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=Hl.getValue(o),i=_t(e,(function(t){return t.get()}));return l(l({},r),i)},setData:function(n){o((function(o){var i,u,a=r.getData(),c=l(l({},a),n),s=(i=c,u=t.getRoot(),LT.getState(u).get().map((function(t){return _n(On("data",t.dataValidator,i))})).getOr(i)),f=t.getFormWrapper();Hl.setValue(f,s),Ot(e,(function(t,n){Ft(c,n)&&t.set(c[n])}))}))},disable:function(n){BI(t,n).each(tv.disable)},enable:function(n){BI(t,n).each(tv.enable)},focus:function(n){BI(t,n).each(dg.focus)},block:function(t){if(!O(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Go(n,Ly,{message:t})}))},unblock:function(){o((function(t){Wo(t,jy)}))},showTab:function(n){o((function(e){var o=t.getBody();LT.getState(o).get().exists((function(t){return t.isTabPanel()}))&&Kf.getCurrent(o).each((function(t){YF.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([tI],o),e.getSystem().broadcastOn([nI],o.internalDialog),e.getSystem().broadcastOn([eI],o.internalDialog),e.getSystem().broadcastOn([oI],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(t){Wo(t,Py)}))}};return r},AI=function(t,n,e){var o,r,i,u=vI(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=iI(o,S.none(),r,!1),fM.parts.body(i)),c=xI(t.internalDialog.buttons),s=wI(c),l=EI({buttons:c},e),f=CI((function(){return p}),bI((function(){return g}),n),e.shared.getSink),d="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],m={header:u,body:a,footer:S.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=yI(m,t,f,e),p=DI({getRoot:function(){return g},getBody:function(){return fM.getBody(g)},getFooter:function(){return fM.getFooter(g)},getFormWrapper:function(){var t=fM.getBody(g);return Kf.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:g,instanceApi:p}},MI=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=Xr("dialog-label"),g=Xr("dialog-content"),p=sp((u={title:t.internalDialog.title,draggable:!0},a=m,c=e.shared.providers,Cy.sketch({dom:ZB('<div class="tox-dialog__header"></div>'),components:[pI(u,S.some(a),c),hI(),gI(c)],containerBehaviours:nc([JA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Xu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=sp((s={body:t.internalDialog.body},l=g,f=e,d=o,iI(s,S.some(l),f,d))),v=xI(t.internalDialog.buttons),b=wI(v),y=sp(TI({buttons:v},e)),x=CI((function(){return k}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}},e.shared.getSink),w=lu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[So()]=[LT.name(),ac.name()],i[ko()]=["execute-on-form"],i[Io()]=["reflecting","execute-on-form"],i),behaviours:nc([ng.config({mode:"cyclic",onEscape:function(t){return Wo(t,Py),S.some(!0)},useTabstopAt:function(t){return!ek(t)&&("button"!==lr(t)||"disabled"!==Pr(t,"disabled"))}}),LT.config({channel:tI,updateState:function(t,n){return S.some(n)},initialData:t}),dg.config({}),ag("execute-on-form",x.concat([ir(ao(),(function(t,n){ng.focusIn(t)}))])),qS({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),k=DI({getRoot:function(){return w},getFooter:function(){return y.get(w)},getBody:function(){return h.get(w)},getFormWrapper:function(){var t=h.get(w);return Kf.getCurrent(t).getOr(t)}},n.redial,b);return{dialog:w,instanceApi:k}},FI=tinymce.util.Tools.resolve("tinymce.util.URI"),II=["insertContent","setContent","execCommand","close","block","unblock"],RI=function(t){return _(t)&&-1!==II.indexOf(t.mceAction)},VI=function(t,n,e,o){var r,u,a,c,s=vI(t.title,o),f=(u={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ZS({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:nc([Ay.config({}),dg.config({})])})]}],behaviours:nc([ng.config({mode:"acyclic",useTabstopAt:i(ek)})])},fM.parts.body(u)),d=t.buttons.bind((function(t){return 0===t.length?S.none():S.some(EI({buttons:t},o))})),m=kI((function(){return w}),bI((function(){return x}),n)),g=l(l({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),p=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],h=new FI(t.url,{base_uri:new FI(window.location.href)}),v=h.protocol+"://"+h.host+(h.port?":"+h.port:""),b=se(S.none()),y=[ag("messages",[ur((function(){var n=ty(fe.fromDom(window),"message",(function(n){var o,r;h.isSameOrigin(new FI(n.raw.origin))&&(o=n.raw.data,RI(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!E(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,w,o):!RI(r=o)&&_(r)&&Ft(r,"mceAction")&&t.onMessage(w,o))}));b.set(S.some(n))})),ar((function(){b.get().each((function(t){return t.unbind()}))}))]),ac.config({channels:((r={})[rI]={onReceive:function(t,n){Gu(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,v)}))}},r)})],x=yI({header:s,body:f,footer:d,extraClasses:p,extraBehaviours:y,extraStyles:g},t,m,o),w=(c=function(t){a.getSystem().isConnected()&&t(a)},{block:function(t){if(!O(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");c((function(n){Go(n,Ly,{message:t})}))},unblock:function(){c((function(t){Wo(t,jy)}))},close:function(){c((function(t){Wo(t,Py)}))},sendMessage:function(t){c((function(n){n.getSystem().broadcastOn([rI],t)}))}});return{dialog:a=x,instanceApi:w}},PI=function(t){var n,e,o,r,i=t.backstage,u=t.editor,a=kv(u),c=(e=(n=t).backstage.shared,{open:function(t,o){var r=function(){fM.hide(c),o()},i=sp(AC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:S.none()},"cancel",n.backstage)),u=sI(),a=cI(r,e.providers),c=lu(mI({lazySink:function(){return e.getSink()},header:aI(u,a),body:lI(t,e.providers),footer:S.some(fI(dI([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Zo(Hy,r)],eventOrder:{}}));fM.show(c);var s=i.get(c);dg.focus(s)}}),s=(r=(o=t).backstage.shared,{open:function(t,n){var e=function(t){fM.hide(s),n(t)},i=sp(AC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:S.none()},"submit",o.backstage)),u=AC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:S.none()},"cancel",o.backstage),a=sI(),c=cI((function(){return e(!1)}),r.providers),s=lu(mI({lazySink:function(){return r.getSink()},header:aI(a,c),body:lI(t,r.providers),footer:S.some(fI(dI([],[u,i.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Zo(Hy,(function(){return e(!1)})),Zo(Ny,(function(){return e(!0)}))],eventOrder:{}}));fM.show(s);var l=i.get(s);dg.focus(l)}}),f=function(t,n){return RF.openUrl((function(t){var e=VI(t,{closeWindow:function(){fM.hide(e.dialog),n(e.instanceApi)}},u,i);return fM.show(e.dialog),e.instanceApi}),t)},m=function(t,n){return RF.open((function(t,e,o){var r=e,u=AI({dataValidator:o,initialData:r,internalDialog:t},{redial:RF.redial,closeWindow:function(){fM.hide(u.dialog),n(u.instanceApi)}},i);return fM.show(u.dialog),u.instanceApi.setData(r),u.instanceApi}),t)},g=function(t,n,e,o){return RF.open((function(t,r,c){var s,f,m,g=_n(On("data",c,r)),p=(s=se(S.none()),{clear:function(){return s.set(S.none())},set:function(t){return s.set(S.some(t))},isSet:function(){return s.get().isSome()},on:function(t){return s.get().each(t)}}),h=i.shared.header.isPositionedAtTop(),v=function(){return p.on((function(t){Kg.reposition(t),DB.refresh(t)}))},b=MI({dataValidator:c,initialData:g,internalDialog:t},{redial:RF.redial,closeWindow:function(){p.on(Kg.hide),u.off("ResizeEditor",v),p.clear(),e(b.instanceApi)}},i,o),y=lu(Kg.sketch(l(l({lazySink:i.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:nc(d([ag("window-manager-inline-events",[Zo(Vo(),(function(t,n){Wo(b.dialog,Hy)}))])],(f=u,m=h,a&&m?[]:[DB.config({contextual:{lazyContext:function(){return S.some(Ru(fe.fromDom(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return oy(e=n,".tox-alert-dialog")||oy(e,".tox-confirm-dialog");var e}})));return p.set(y),Kg.showWithin(y,n,fu(b.dialog),S.some(Ni())),a&&h||(DB.refresh(y),u.on("ResizeEditor",v)),b.instanceApi.setData(g),ng.focusIn(b.dialog),b.instanceApi}),t)};return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?g(t,i.shared.anchors.inlineDialog(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?g(t,i.shared.anchors.cursor(),e,n.ariaAttrs):m(t,e)},openUrl:function(t,n){return f(t,n)},alert:function(t,n){c.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){s.open(t,(function(t){n(t)}))}}};s.add("silver",(function(t){var n=aM(t),o=n.uiMothership,r=n.backstage,i=n.renderUI,u=n.getUi;Qb(t,r.shared);var a=PI({editor:t,backstage:r});return{renderUI:i,getWindowManagerImpl:e(a),getNotificationManagerImpl:function(){return gp(0,{backstage:r},o)},ui:u()}}))}();