!function(){"use strict";var n=function(){return(n=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function e(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}function t(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}var r=function(){},o=function(n,e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(e.apply(null,t))}},i=function(n){return function(){return n}},u=function(n){return n};function c(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}var a,f,s,l,d,m,g=function(n){return function(e){return!n(e)}},p=function(n){return function(){throw new Error(n)}},v=function(n){return n()},h=i(!1),y=i(!0),b=function(n){var e,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,e=n.apply(null,r)),e}},x=function(){return w},w=(a=function(n){return n.isNone()},{fold:function(n,e){return n()},is:h,isSome:h,isNone:y,getOr:s=function(n){return n},getOrThunk:f=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:s,orThunk:f,map:x,each:r,bind:x,exists:h,forall:y,filter:x,equals:a,equals_:a,toArray:function(){return[]},toString:i("none()")}),S=function(n){var e=i(n),t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:y,isNone:h,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return S(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?o:w},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(h,(function(e){return t(n,e)}))}};return o},O={some:S,none:x,from:function(n){return null===n||void 0===n?w:S(n)}},T=function(n){return function(e){return r=typeof(t=e),(null===t?"null":"object"==r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r)===n;var t,r}},k=function(n){return function(e){return typeof e===n}},E=T("string"),C=T("object"),M=T("array"),D=k("boolean"),_=function(n){return!(null===(e=n)||void 0===e);var e},I=k("function"),F=k("number"),R=Array.prototype.slice,V=Array.prototype.indexOf,B=Array.prototype.push,A=function(n,e){return t=n,r=e,-1<V.call(t,r);var t,r},j=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},N=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},P=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},H=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t},z=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,(function(n){t=e(t,n)})),t},L=function(n,e,t){return P(n,(function(n){t=e(t,n)})),t},G=function(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(e(i,r))return O.some(i);if(t(i,r))break}return O.none()}(n,e,h)},$=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return O.some(t);return O.none()},U=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!M(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);B.apply(e,n[t])}return e},W=function(n,e){return U(N(n,e))},X=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},q=function(n){var e=R.call(n,0);return e.reverse(),e},Y=function(n,e){return H(n,(function(n){return!A(e,n)}))},K=function(n){return[n]},J=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return O.none()},Q=function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return nn(r(1),r(2))},Z=function(){return nn(0,0)},nn=function(n,e){return{major:n,minor:e}},en={nu:nn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Z():Q(n,t)},unknown:Z},tn=function(n,e){var t=String(e).toLowerCase();return G(n,(function(n){return n.search(t)}))},rn=function(n,e){return tn(n,e).map((function(n){var t=en.detect(n.versionRegexes,e);return{current:n.name,version:t}}))},on=function(n,e){return tn(n,e).map((function(n){var t=en.detect(n.versionRegexes,e);return{current:n.name,version:t}}))},un=function(n,e){return n.replace(/\$\{([^{}]*)\}/g,(function(n,t){var r,o=e[t];return"string"==(r=typeof o)||"number"==r?o.toString():n}))},cn=function(n,e){return-1!==n.indexOf(e)},an=(l=/^\s+|\s+$/g,function(n){return n.replace(l,"")}),fn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,sn=function(n){return function(e){return cn(e,n)}},ln=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return cn(n,"edge/")&&cn(n,"chrome")&&cn(n,"safari")&&cn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,fn],search:function(n){return cn(n,"chrome")&&!cn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return cn(n,"msie")||cn(n,"trident")}},{name:"Opera",versionRegexes:[fn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:sn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:sn("firefox")},{name:"Safari",versionRegexes:[fn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(cn(n,"safari")||cn(n,"mobile/"))&&cn(n,"applewebkit")}}],dn=[{name:"Windows",search:sn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return cn(n,"iphone")||cn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:sn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:sn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:sn("linux"),versionRegexes:[]},{name:"Solaris",search:sn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:sn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:sn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],mn={browsers:i(ln),oses:i(dn)},gn="Firefox",pn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(gn),isSafari:r("Safari")}},vn={unknown:function(){return pn({current:void 0,version:en.unknown()})},nu:pn,edge:i("Edge"),chrome:i("Chrome"),ie:i("IE"),opera:i("Opera"),firefox:i(gn),safari:i("Safari")},hn="Windows",yn="Android",bn="Solaris",xn="FreeBSD",wn="ChromeOS",Sn=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(hn),isiOS:r("iOS"),isAndroid:r(yn),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(bn),isFreeBSD:r(xn),isChromeOS:r(wn)}},On={unknown:function(){return Sn({current:void 0,version:en.unknown()})},nu:Sn,windows:i(hn),ios:i("iOS"),android:i(yn),linux:i("Linux"),osx:i("OSX"),solaris:i(bn),freebsd:i(xn),chromeos:i(wn)},Tn=function(n,e){var t,r,o,u,c,a,f,s,l,d,m,g,p=mn.browsers(),v=mn.oses(),h=rn(p,n).fold(vn.unknown,vn.nu),y=on(v,n).fold(On.unknown,On.nu);return{browser:h,os:y,deviceType:(r=h,o=n,u=e,c=(t=y).isiOS()&&!0===/ipad/i.test(o),a=t.isiOS()&&!c,f=t.isiOS()||t.isAndroid(),s=f||u("(pointer:coarse)"),l=c||!a&&f&&u("(min-device-width:768px)"),d=a||f&&!l,m=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),g=!d&&!l&&!m,{isiPad:i(c),isiPhone:i(a),isTablet:i(l),isPhone:i(d),isTouch:i(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:i(m),isDesktop:i(g)})}},kn=function(n){return window.matchMedia(n).matches},En=b((function(){return Tn(navigator.userAgent,kn)})),Cn=function(){return En()},Mn=i,Dn=Mn("touchstart"),_n=Mn("touchmove"),In=Mn("touchend"),Fn=Mn("mousedown"),Rn=Mn("mousemove"),Vn=Mn("mouseup"),Bn=Mn("mouseover"),An=Mn("keydown"),jn=Mn("keyup"),Nn=Mn("input"),Pn=Mn("change"),Hn=Mn("click"),zn=Mn("transitionend"),Ln=Mn("selectstart"),Gn=function(n){return i("alloy."+n)},$n={tap:Gn("tap")},Un=Gn("focus"),Wn=Gn("blur.post"),Xn=Gn("paste.post"),qn=Gn("receive"),Yn=Gn("execute"),Kn=Gn("focus.item"),Jn=$n.tap,Qn=Gn("longpress"),Zn=Gn("system.init"),ne=Gn("system.attached"),ee=Gn("system.detached"),te=Gn("focusmanager.shifted"),re=Gn("highlight"),oe=Gn("dehighlight"),ie=function(n,e){fe(n,n.element,e,{})},ue=function(n,e,t){fe(n,n.element,e,t)},ce=function(n){ie(n,Yn())},ae=function(n,e,t){fe(n,e,t,{})},fe=function(e,t,r,o){var i=n({target:t},o);e.getSystem().triggerEvent(r,t,i)},se=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},le={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return se(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return se(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return se(t)},fromDom:se,fromPoint:function(n,e,t){return O.from(n.dom.elementFromPoint(e,t)).map(se)}},de=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},me=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},ge=function(n,e){var t=void 0===e?document:e.dom;return me(t)?[]:N(t.querySelectorAll(n),le.fromDom)},pe=function(n,e){var t=void 0===e?document:e.dom;return me(t)?O.none():O.from(t.querySelector(n)).map(le.fromDom)},ve=function(n,e){return n.dom===e.dom},he=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),ye=function(n){return function(e){return e.dom.nodeType===n}},be=ye(1),xe=ye(3),we=ye(9),Se=ye(11),Oe=function(n){return le.fromDom(n.dom.ownerDocument)},Te=function(n){return we(n)?n:Oe(n)},ke=function(n){return O.from(n.dom.parentNode).map(le.fromDom)},Ee=function(n){return N(n.dom.childNodes,le.fromDom)},Ce=function(n,e){var t=n.dom.childNodes;return O.from(t[e]).map(le.fromDom)},Me=function(n,e){ke(n).each((function(t){t.dom.insertBefore(e.dom,n.dom)}))},De=function(n,e){var t;(t=n,O.from(t.dom.nextSibling).map(le.fromDom)).fold((function(){ke(n).each((function(n){Ie(n,e)}))}),(function(n){Me(n,e)}))},_e=function(n,e){Ce(n,0).fold((function(){Ie(n,e)}),(function(t){n.dom.insertBefore(e.dom,t.dom)}))},Ie=function(n,e){n.dom.appendChild(e.dom)},Fe=function(n,e){P(e,(function(e){Ie(n,e)}))},Re=function(n){n.dom.textContent="",P(Ee(n),(function(n){Ve(n)}))},Ve=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Be=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode),Ae=i(Be),je=Be?function(n){return le.fromDom(n.dom.getRootNode())}:Te,Ne=function(n){var e=je(n);return Se(e)?O.some(e):O.none()},Pe=function(n){return le.fromDom(n.dom.host)},He=function(n){if(Ae()&&_(n.target)){var e=le.fromDom(n.target);if(be(e)&&ze(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0===(r=t).length?O.none():O.some(r[0])}}var r;return O.from(n.target)},ze=function(n){return _(n.dom.shadowRoot)},Le=function(n){var e=xe(n)?n.dom.parentNode:n.dom;if(void 0===e||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return Ne(le.fromDom(e)).fold((function(){return o.body.contains(e)}),(t=Le,r=Pe,function(n){return t(r(n))}))},Ge=function(){return $e(le.fromDom(document))},$e=function(n){var e=n.dom.body;if(null===e||void 0===e)throw new Error("Body is not available yet");return le.fromDom(e)},Ue=function(n){ie(n,ee());var e=n.components();P(e,Ue)},We=function(n){var e=n.components();P(e,We),ie(n,ne())},Xe=function(n,e){Ie(n.element,e.element)},qe=function(n,e){var t,r=n.components();P((t=n).components(),(function(n){return Ve(n.element)})),Re(t.element),t.syncComponents();var o=Y(r,e);P(o,(function(e){Ue(e),n.getSystem().removeFromWorld(e)})),P(e,(function(e){e.getSystem().isConnected()?Xe(n,e):(n.getSystem().addToWorld(e),Xe(n,e),Le(n.element)&&We(e)),n.syncComponents()}))},Ye=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),Le(n.element)&&We(e),n.syncComponents()},Ke=function(n){var e,t=ke(n.element).bind((function(e){return n.getSystem().getByDom(e).toOptional()}));Ue(e=n),Ve(e.element),e.getSystem().removeFromWorld(e),t.each((function(n){n.syncComponents()}))},Je=function(n,e,t){t(n,e.element);var r=Ee(e.element);P(r,(function(n){e.getByDom(n).each(We)}))},Qe=Object.keys,Ze=Object.hasOwnProperty,nt=function(n,e){for(var t=Qe(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},et=function(n,e){return tt(n,(function(n,t){return{k:t,v:e(n,t)}}))},tt=function(n,e){var t={};return nt(n,(function(n,r){var o=e(n,r);t[o.k]=o.v})),t},rt=function(n,e){var t,o,i,u,c={};return t=e,u=c,o=function(n,e){u[e]=n},i=r,nt(n,(function(n,e){(t(n,e)?o:i)(n,e)})),c},ot=function(n,e){var t=[];return nt(n,(function(n,r){t.push(e(n,r))})),t},it=function(n,e){return ut(n,e)?O.from(n[e]):O.none()},ut=function(n,e){return Ze.call(n,e)},ct=function(n,e){return ut(n,e)&&void 0!==n[e]&&null!==n[e]},at=function(n,e,t){if(!(E(t)||D(t)||F(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},ft=function(n,e,t){at(n.dom,e,t)},st=function(n,e){var t=n.dom;nt(e,(function(n,e){at(t,e,n)}))},lt=function(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t},dt=function(n,e){return O.from(lt(n,e))},mt=function(n,e){var t=n.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(e)},gt=function(n,e){n.dom.removeAttribute(e)},pt=function(n,e){var t=lt(n,e);return void 0===t||""===t?[]:t.split(" ")},vt=function(n){return void 0!==n.dom.classList},ht=function(n,e){return o=e,i=pt(t=n,r="class").concat([o]),ft(t,r,i.join(" ")),!0;var t,r,o,i},yt=function(n,e){return o=e,0<(i=H(pt(t=n,r="class"),(function(n){return n!==o}))).length?ft(t,r,i.join(" ")):gt(t,r),!1;var t,r,o,i},bt=function(n,e){vt(n)?n.dom.classList.add(e):ht(n,e)},xt=function(n){0===(vt(n)?n.dom.classList:pt(n,"class")).length&&gt(n,"class")},wt=function(n,e){vt(n)?n.dom.classList.remove(e):yt(n,e),xt(n)},St=function(n,e){return vt(n)&&n.dom.classList.contains(e)},Ot=function(n,e,t){wt(n,t),bt(n,e)},Tt=Object.freeze({__proto__:null,toAlpha:function(n,e,t){Ot(n.element,e.alpha,e.omega)},toOmega:function(n,e,t){Ot(n.element,e.omega,e.alpha)},isAlpha:function(n,e,t){return St(n.element,e.alpha)},isOmega:function(n,e,t){return St(n.element,e.omega)},clear:function(n,e,t){wt(n.element,e.alpha),wt(n.element,e.omega)}}),kt=function(n){return{is:function(e){return n===e},isValue:y,isError:h,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:function(e){return kt(n)},orThunk:function(e){return kt(n)},fold:function(e,t){return t(n)},map:function(e){return kt(e(n))},mapError:function(e){return kt(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return O.some(n)}}},Et=function(n){return{is:h,isValue:h,isError:y,getOr:u,getOrThunk:function(n){return n()},getOrDie:function(){return p(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(e,t){return e(n)},map:function(e){return Et(n)},mapError:function(e){return Et(e(n))},each:r,bind:function(e){return Et(n)},exists:h,forall:y,toOptional:O.none}},Ct={value:kt,error:Et,fromOption:function(n,e){return n.fold((function(){return Et(e)}),kt)}};(m=d=d||{})[m.Error=0]="Error",m[m.Value=1]="Value";var Mt,Dt,_t,It,Ft,Rt=function(n,e,t){return n.stype===d.Error?e(n.serror):t(n.svalue)},Vt=function(n){return{stype:d.Value,svalue:n}},Bt=function(n){return{stype:d.Error,serror:n}},At=function(n){return n.fold(Bt,Vt)},jt=function(n){return Rt(n,Ct.error,Ct.value)},Nt=Vt,Pt=function(n){var e=[],t=[];return P(n,(function(n){Rt(n,(function(n){return t.push(n)}),(function(n){return e.push(n)}))})),{values:e,errors:t}},Ht=Bt,zt=function(n,e){return n.stype===d.Value?e(n.svalue):n},Lt=function(n,e){return n.stype===d.Error?e(n.serror):n},Gt=function(n,e){return n.stype===d.Value?{stype:d.Value,svalue:e(n.svalue)}:n},$t=function(n,e){return n.stype===d.Error?{stype:d.Error,serror:e(n.serror)}:n},Ut=function(n){if(!M(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],t={};return P(n,(function(r,o){var i=Qe(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=r[u];if(void 0!==t[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!M(c))throw new Error("case arguments must be an array");e.push(u),t[u]=function(){var t=arguments.length;if(t!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+t);for(var r=new Array(t),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(n){var t=Qe(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));if(!X(e,(function(n){return A(t,n)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[u].apply(null,r)},log:function(n){console.log(n,{constructors:e,constructor:u,params:r})}}}})),t},Wt=Object.prototype.hasOwnProperty,Xt=function(n){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)Wt.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}},qt=Xt((function(n,e){return C(n)&&C(e)?qt(n,e):e})),Yt=Xt((function(n,e){return e})),Kt=Ut([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Jt=function(n){return Kt.defaultedThunk(i(n))},Qt=Kt.strict,Zt=Kt.asOption,nr=Kt.defaultedThunk,er=(Kt.asDefaultedOptionThunk,Kt.mergeWithThunk),tr=(Ut([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,e){var t={};return t[n]=e,t}),rr=function(n,e){return t=e,r={},nt(n,(function(n,e){A(t,e)||(r[e]=n)})),r;var t,r},or=tr,ir=function(n){return e={},P(n,(function(n){e[n.key]=n.value})),e;var e},ur=function(n,e){var t,r,o,i,u,c=(t=[],r=[],P(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){r.push(n)}))})),{errors:t,values:r});return 0<c.errors.length?(u=c.errors,Ct.error(U(u))):(i=e,0===(o=c.values).length?Ct.value(i):Ct.value(qt(i,Yt.apply(void 0,o))))},cr=function(n){return o(Ht,U)(n)},ar=function(n,e){var t,r,o=Pt(n);return 0<o.errors.length?cr(o.errors):(t=o.values,r=e,0<t.length?Nt(qt(r,Yt.apply(void 0,t))):Nt(r))},fr=function(n){var e=Pt(n);return 0<e.errors.length?cr(e.errors):Nt(e.values)},sr=function(n){return C(n)&&100<Qe(n).length?" removed due to size":JSON.stringify(n,null,2)},lr=function(n,e){return Ht([{path:n,getErrorInfo:e}])},dr=Ut([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),mr=function(n,e,t){return it(e,t).fold((function(){return r=t,o=e,lr(n,(function(){return'Could not find valid *strict* value for "'+r+'" in '+sr(o)}));var r,o}),Nt)},gr=function(n,e,t){var r=it(n,e).fold((function(){return t(n)}),u);return Nt(r)},pr=function(n,e,t,r){return t.fold((function(t,o,u,c){var a=function(e){var i=c.extract(n.concat([t]),r,e);return Gt(i,(function(n){return tr(o,r(n))}))},f=function(e){return e.fold((function(){var n=tr(o,r(O.none()));return Nt(n)}),(function(e){var i=c.extract(n.concat([t]),r,e);return Gt(i,(function(n){return tr(o,r(O.some(n)))}))}))};return u.fold((function(){return zt(mr(n,e,t),a)}),(function(n){return zt(gr(e,t,n),a)}),(function(){return zt(Nt(it(e,t)),f)}),(function(n){return zt((o=n,i=it(r=e,t).map((function(n){return!0===n?o(r):n})),Nt(i)),f);var r,o,i}),(function(n){var r=n(e),o=Gt(gr(e,t,i({})),(function(n){return qt(r,n)}));return zt(o,a)}))}),(function(n,t){var o=t(e);return Nt(tr(n,r(o)))}))},vr=function(n){return{extract:function(e,t,r){return Lt(n(r,t),(function(n){return t=n,lr(e,(function(){return t}));var t}))},toString:function(){return"val"}}},hr=function(n){var e=yr(n),t=z(n,(function(n,e){return e.fold((function(e){return qt(n,or(e,!0))}),i(n))}),{});return{extract:function(n,r,o){var i,u=D(o)?[]:Qe(rt(o,(function(n){return void 0!==n&&null!==n}))),c=H(u,(function(n){return!ct(t,n)}));return 0===c.length?e.extract(n,r,o):(i=c,lr(n,(function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"})))},toString:e.toString}},yr=function(n){return{extract:function(e,t,r){return o=e,i=r,u=t,c=N(n,(function(n){return pr(o,i,n,u)})),ar(c,{});var o,i,u,c},toString:function(){return"obj{\n"+N(n,(function(n){return n.fold((function(n,e,t,r){return n+" -> "+r.toString()}),(function(n,e){return"state("+n+")"}))})).join("\n")+"}"}}},br=function(n,e){var t=function(e,t){return r=vr(n),function(n,e,t){var o=N(t,(function(t,o){return r.extract(n.concat(["["+o+"]"]),e,t)}));return fr(o)}(e,u,t);var r};return{extract:function(n,r,o){var i=Qe(o),u=t(n,i);return zt(u,(function(t){var i=N(t,(function(n){return dr.field(n,n,Qt(),e)}));return yr(i).extract(n,r,o)}))},toString:function(){return"setOf("+e.toString()+")"}}},xr=i(vr(Nt)),wr=dr.state,Sr=dr.field,Or=function(n,e,t,r,o){return it(r,o).fold((function(){return e=r,t=o,lr(n,(function(){return'The chosen schema: "'+t+'" did not exist in branches: '+sr(e)}));var e,t}),(function(r){return r.extract(n.concat(["branch: "+o]),e,t)}))},Tr=function(n,e){return{extract:function(t,r,o){return it(o,n).fold((function(){return e=n,lr(t,(function(){return'Choice schema did not contain choice key: "'+e+'"'}));var e}),(function(n){return Or(t,r,o,e,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+Qe(e)}}},kr=vr(Nt),Er=function(n){return vr((function(e){return n(e).fold(Ht,Nt)}))},Cr=function(n,e){return br((function(e){return At(n(e))}),e)},Mr=function(n,e,t){return jt((r=n,o=u,i=t,c=e.extract([r],o,i),$t(c,(function(n){return{input:i,errors:n}}))));var r,o,i,c},Dr=function(n){return n.fold((function(n){throw new Error(Ir(n))}),u)},_r=function(n,e,t){return Dr(Mr(n,e,t))},Ir=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,N(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: ")+sr(n.input);var e,t},Fr=function(n,e){return Tr(n,et(e,yr))},Rr=i(kr),Vr=(Mt=I,Dt="function",vr((function(n){var e=typeof n;return Mt(n)?Nt(n):Ht("Expected type: "+Dt+" but got: "+e)}))),Br=function(n){return Sr(n,n,Qt(),xr())},Ar=function(n,e){return Sr(n,n,Qt(),e)},jr=function(n,e){return Sr(n,n,Qt(),yr(e))},Nr=function(n){return Sr(n,n,Zt(),xr())},Pr=function(n,e){return Sr(n,n,Zt(),e)},Hr=function(n,e){return Pr(n,yr(e))},zr=function(n,e){return Pr(n,hr(e))},Lr=function(n,e){return Sr(n,n,Jt(e),xr())},Gr=function(n,e,t){return Sr(n,n,Jt(e),t)},$r=function(n,e){return wr(n,e)},Ur=[Br("alpha"),Br("omega")],Wr=function(n){return I(n)?n:h},Xr=function(n,e,t){var r=e(n),o=Wr(t);return r.orThunk((function(){return o(n)?O.none():function(n,e,t){for(var r=n.dom,o=Wr(t);r.parentNode;){r=r.parentNode;var i=le.fromDom(r),u=e(i);if(u.isSome())return u;if(o(i))break}return O.none()}(n,e,o)}))},qr=function(n,e){return ve(n.element,e.event.target)},Yr=function(n){if(!ct(n,"can")&&!ct(n,"abort")&&!ct(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return _r("Extracting event.handler",hr([Lr("can",y),Lr("abort",h),Lr("run",r)]),n)},Kr=function(n){var e,t,r,o,i=(t=function(n){return n.can},function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return L(e,(function(e,r){return e&&t(r).apply(void 0,n)}),!0)}),u=(r=e=n,o=function(n){return n.abort},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return L(r,(function(e,t){return e||o(t).apply(void 0,n)}),!1)});return Yr({can:i,abort:u,run:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];P(n,(function(n){n.run.apply(void 0,e)}))}})},Jr=ir,Qr=function(n,e){return{key:n,value:Yr({abort:e})}},Zr=function(n,e){return{key:n,value:Yr({run:e})}},no=function(n,e,t){return{key:n,value:Yr({run:function(n,r){e.apply(void 0,[n,r].concat(t))}})}},eo=function(n){return function(e){return{key:n,value:Yr({run:function(n,t){qr(n,t)&&e(n,t)}})}}},to=function(n,e){return Zr(n,(function(t,r){t.getSystem().getByUid(e).each((function(e){var t,o,i,u;o=(t=e).element,i=n,u=r,t.getSystem().triggerEvent(i,o,u.event)}))}))},ro=function(n,e,t){var r=e.partUids[t];return to(n,r)},oo=function(n){return Zr(n,(function(n,e){e.cut()}))},io=eo(ne()),uo=eo(ee()),co=eo(Zn()),ao=(_t=Yn(),function(n){return Zr(_t,n)}),fo=function(n){return N(n,(function(n){return r=e="/*",o=(t=n).length-e.length,""===r||t.length>=r.length&&t.substr(o,o+r.length)===r?n.substring(0,n.length-"/*".length):n;var e,t,r,o}))},so=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:fo(i)}},n},lo=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},mo=function(n,e,t){return co((function(r,o){t(r,n,e)}))},go=function(n,e,t){var r,o,u,c,a,f;return r=function(r){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=[r].concat(o);return r.config({name:i(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+t)}),(function(n){var t=Array.prototype.slice.call(c,1);return e.apply(void 0,[r,n.config,n.state].concat(t))}))},o=t,u=e.toString(),c=u.indexOf(")")+1,a=u.indexOf("("),f=u.substring(a+1,c-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:o,parameters:fo(f.slice(0,1).concat(f.slice(3)))}},r},po=function(n){return{key:n,value:void 0}},vo=function(e,t,r,o,i,u,a){var f=function(n){return ct(n,r)?n[r]():O.none()},s=et(i,(function(n,e){return go(r,n,e)})),l=et(u,so),d=n(n(n({},l),s),{revoke:c(po,r),config:function(n){var t=_r(r+"-config",e,n);return{key:r,value:{config:t,me:d,configAsRaw:b((function(){return _r(r+"-config",e,n)})),initialConfig:n,state:a}}},schema:function(){return t},exhibit:function(n,e){return f(n).bind((function(n){return it(o,"exhibit").map((function(t){return t(e,n.config,n.state)}))})).getOr(lo({}))},name:function(){return r},handlers:function(n){return f(n).map((function(n){return it(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}});return d},ho={init:function(){return yo({readState:function(){return"No State required"}})}},yo=function(n){return n},bo=ir,xo=hr([Br("fields"),Br("name"),Lr("active",{}),Lr("apis",{}),Lr("state",ho),Lr("extra",{})]),wo=function(n){var e,t,r,o,i,u,c,a,f=_r("Creating behaviour: "+n.name,xo,n);return e=f.fields,t=f.name,r=f.active,o=f.apis,i=f.extra,u=f.state,c=hr(e),a=Hr(t,[zr("config",e)]),vo(c,a,t,r,o,i,u)},So=hr([Br("branchKey"),Br("branches"),Br("name"),Lr("active",{}),Lr("apis",{}),Lr("state",ho),Lr("extra",{})]),Oo=i(void 0),To=wo({fields:Ur,name:"swapping",apis:Tt}),ko=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},Eo=function(n){return n.dom.focus()},Co=function(n){return n.dom.blur()},Mo=function(n){return void 0===n&&(n=le.fromDom(document)),O.from(n.dom.activeElement).map(le.fromDom)},Do=function(n){return Mo(je(n)).filter((function(e){return n.dom.contains(e.dom)}))},_o=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Io=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Fo=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Ro=["undo","bold","italic","link","image","bullist","styleselect"],Vo="formatChanged",Bo="orientationChanged",Ao="dropupDismissed",jo=function(n){return n.dom.innerHTML},No=function(n,e){var t,r,o=Oe(n).dom,i=le.fromDom(o.createDocumentFragment()),u=(t=e,(r=(o||document).createElement("div")).innerHTML=t,Ee(le.fromDom(r)));Fe(i,u),Re(n),Ie(n,i)},Po=function(n){return e=n,t=!1,le.fromDom(e.dom.cloneNode(t));var e,t},Ho=function(n){var e,t,r,o=Po(n);return e=o,t=le.fromTag("div"),r=le.fromDom(e.dom.cloneNode(!0)),Ie(t,r),jo(t)},zo=Object.freeze({__proto__:null,events:function(n){return Jr([Zr(qn(),(function(e,t){var r,o,i=n.channels,u=Qe(i),c=t,a=(r=u,(o=c).universal?r:H(r,(function(n){return A(o.channels,n)})));P(a,(function(n){var t=i[n],r=t.schema,o=_r("channel["+n+"] data\nReceiver: "+Ho(e.element),r,c.data);t.onReceive(e,o)}))}))])}}),Lo="unknown";(Ft=It=It||{})[Ft.STOP=0]="STOP",Ft[Ft.NORMAL=1]="NORMAL",Ft[Ft.LOGGING=2]="LOGGING";var Go,$o=ko({}),Uo=["alloy/data/Fields","alloy/debugging/Debugging"],Wo=function(n,e,t){var r,o,i,u;switch(it($o.get(),n).orThunk((function(){var e=Qe($o.get());return J(e,(function(e){return-1<n.indexOf(e)?O.some($o.get()[e]):O.none()}))})).getOr(It.NORMAL)){case It.NORMAL:return t(Xo());case It.LOGGING:var c=(r=n,o=e,i=[],u=(new Date).getTime(),{logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();A(["mousemove","mouseover","mouseout",Zn()],r)||console.log(r,{event:r,time:n-u,target:o.dom,sequence:N(i,(function(n){return A(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Ho(n.target)+")":n.outcome}))})}}),a=t(c);return c.write(),a;case It.STOP:return!0}},Xo=i({logEventCut:r,logEventStopped:r,logNoParent:r,logEventNoHandlers:r,logEventResponse:r,write:r}),qo=i([Br("menu"),Br("selectedMenu")]),Yo=i([Br("item"),Br("selectedItem")]),Ko=(i(yr(Yo().concat(qo()))),i(yr(Yo()))),Jo=jr("initSize",[Br("numColumns"),Br("numRows")]),Qo=function(n,e,t){return function(){var n=new Error;if(void 0!==n.stack){var e=n.stack.split("\n");G(e,(function(n){return 0<n.indexOf("alloy")&&!j(Uo,(function(e){return-1<n.indexOf(e)}))})).getOr(Lo)}}(),Sr(e,e,t,Er((function(n){return Ct.value((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)}))})))},Zo=function(n){return Qo(0,n,Jt(r))},ni=function(n){return Qo(0,n,Jt(O.none))},ei=function(n){return Qo(0,n,Qt())},ti=function(n){return Qo(0,n,Qt())},ri=function(n,e){return $r(n,i(e))},oi=function(n){return $r(n,u)},ii=i(Jo),ui=[Ar("channels",Cr(Ct.value,hr([ei("onReceive"),Lr("schema",Rr())])))],ci=wo({fields:ui,name:"receiving",active:zo}),ai=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},fi=function(n,e,t){e.toggleClass.each((function(e){(t.get()?bt:wt)(n.element,e)}))},si=function(n,e,t){mi(n,e,t,!t.get())},li=function(n,e,t){t.set(!0),fi(n,e,t),ai(n,e,t)},di=function(n,e,t){t.set(!1),fi(n,e,t),ai(n,e,t)},mi=function(n,e,t,r){(r?li:di)(n,e,t)},gi=function(n,e,t){mi(n,e,t,e.selected)},pi=Object.freeze({__proto__:null,onLoad:gi,toggle:si,isOn:function(n,e,t){return t.get()},on:li,off:di,set:mi}),vi=Object.freeze({__proto__:null,exhibit:function(){return lo({})},events:function(n,e){var t,r,o,i=(t=n,r=e,o=si,ao((function(n){o(n,t,r)}))),u=mo(n,e,gi);return Jr(U([n.toggleOnExecute?[i]:[],[u]]))}}),hi=function(n,e,t){ft(n.element,"aria-expanded",t)},yi=[Lr("selected",!1),Nr("toggleClass"),Lr("toggleOnExecute",!0),Gr("aria",{mode:"none"},Fr("mode",{pressed:[Lr("syncWithExpanded",!1),ri("update",(function(n,e,t){ft(n.element,"aria-pressed",t),e.syncWithExpanded&&hi(n,e,t)}))],checked:[ri("update",(function(n,e,t){ft(n.element,"aria-checked",t)}))],expanded:[ri("update",hi)],selected:[ri("update",(function(n,e,t){ft(n.element,"aria-selected",t)}))],none:[ri("update",r)]}))],bi=wo({fields:yi,name:"toggling",active:vi,apis:pi,state:(Go=!1,{init:function(){var n=ko(Go);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(Go)},readState:function(){return n.get()}}}})}),xi=function(n,e){return ci.config({channels:or(Vo,{onReceive:function(t,r){r.command===n&&e(t,r.state)}})})},wi=function(n){return ci.config({channels:or(Bo,{onReceive:n})})},Si=function(n,e){return{key:n,value:{onReceive:e}}},Oi="tinymce-mobile",Ti=function(n){return Oi+"-"+n},ki=function(){var n=function(n,e){e.stop(),ce(n)};return[Zr(Hn(),n),Zr(Jn(),n),oo(Dn()),oo(Fn())]},Ei=function(n,e){e.ignore||(Eo(n.element),e.onFocus(n))},Ci=Object.freeze({__proto__:null,focus:Ei,blur:function(n,e){e.ignore||Co(n.element)},isFocused:function(n){return e=n.element,t=je(e).dom,e.dom===t.activeElement;var e,t}}),Mi=Object.freeze({__proto__:null,exhibit:function(n,e){var t=e.ignore?{}:{attributes:{tabindex:"-1"}};return lo(t)},events:function(n){return Jr([Zr(Un(),(function(e,t){Ei(e,n),t.stop()}))].concat(n.stopMousedown?[Zr(Fn(),(function(n,e){e.event.prevent()}))]:[]))}}),Di=[Zo("onFocus"),Lr("stopMousedown",!1),Lr("ignore",!1)],_i=wo({fields:Di,name:"focusing",active:Mi,apis:Ci}),Ii=function(n){return void 0!==n.style&&I(n.style.getPropertyValue)},Fi=function(n,e,t){if(!E(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Ii(n)&&n.style.setProperty(e,t)},Ri=function(n,e,t){var r=n.dom;Fi(r,e,t)},Vi=function(n,e){var t=n.dom;nt(e,(function(n,e){Fi(t,e,n)}))},Bi=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||Le(n)?r:Ai(t,e)},Ai=function(n,e){return Ii(n)?n.style.getPropertyValue(e):""},ji=function(n,e){var t=n.dom,r=Ai(t,e);return O.from(r).filter((function(n){return 0<n.length}))},Ni=function(n,e){var t,r,o=n.dom;r=e,Ii(t=o)&&t.style.removeProperty(r),dt(n,"style").map(an).is("")&&gt(n,"style")},Pi=function(n){return n.dom.offsetWidth};function Hi(n,e){var t=function(t){var r=e(t);if(r<=0||null===r){var o=Bi(t,n);return parseFloat(o)||0}return r},r=function(n,e){return L(e,(function(e,t){var r=Bi(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)};return{set:function(e,t){if(!F(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom;Ii(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return o<e?e-o:0}}}var zi=Hi("height",(function(n){var e=n.dom;return Le(n)?e.getBoundingClientRect().height:e.offsetHeight})),Li=function(n){return zi.get(n)},Gi=function(n,e,t){return H(function(n,e){for(var t=I(e)?e:h,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=le.fromDom(i);if(o.push(u),!0===t(u))break;r=i}return o}(n,t),e)},$i=function(n,e){return H(ke(t=n).map(Ee).map((function(n){return H(n,(function(n){return!ve(t,n)}))})).getOr([]),e);var t},Ui=function(n,e){return ge(e,n)};function Wi(n,e,t,r,o){return n(t,r)?O.some(t):I(o)&&o(t)?O.none():e(t,r,o)}var Xi,qi,Yi=function(n,e,t){for(var r=n.dom,o=I(t)?t:h;r.parentNode;){r=r.parentNode;var i=le.fromDom(r);if(e(i))return O.some(i);if(o(i))break}return O.none()},Ki=function(n){return pe(n)},Ji=function(n,e,t){return Yi(n,(function(n){return de(n,e)}),t)},Qi=function(n,e){return pe(e,n)},Zi=function(n,e,t){return Wi(de,Ji,n,e,t)},nu=[8],eu=[9],tu=[13],ru=[27],ou=[32],iu=[37],uu=[38],cu=[39],au=[40],fu=function(n,e,t){var r=q(n.slice(0,e)),o=q(n.slice(e+1));return G(r.concat(o),t)},su=function(n,e,t){var r=q(n.slice(0,e));return G(r,t)},lu=function(n,e,t){var r=n.slice(0,e),o=n.slice(e+1);return G(o.concat(r),t)},du=function(n,e,t){var r=n.slice(e+1);return G(r,t)},mu=function(n){return function(e){var t=e.raw;return A(n,t.which)}},gu=function(n){return function(e){return X(n,(function(n){return n(e)}))}},pu=function(n){return!0===n.raw.shiftKey},vu=function(n){return!0===n.raw.ctrlKey},hu=g(pu),yu=function(n,e){return{matches:n,classification:e}},bu=function(n,e,t,r){var o=n+e;return r<o?t:o<t?r:o},xu=function(n,e,t){return Math.min(Math.max(n,e),t)},wu=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Su=function(n,e,t,r){var o=Ui(n.element,"."+e.highlightClass);P(o,(function(t){j(r,(function(n){return n.element===t}))||(wt(t,e.highlightClass),n.getSystem().getByDom(t).each((function(t){e.onDehighlight(n,t),ie(t,oe())})))}))},Ou=function(n,e,t,r){Su(n,e,0,[r]),Tu(n,e,t,r)||(bt(r.element,e.highlightClass),e.onHighlight(n,r),ie(r,re()))},Tu=function(n,e,t,r){return St(r.element,e.highlightClass)},ku=function(n,e,t,r){var o=Ui(n.element,"."+e.itemClass);return O.from(o[r]).fold((function(){return Ct.error("No element found with index "+r)}),n.getSystem().getByDom)},Eu=function(n,e,t){return Qi(n.element,"."+e.itemClass).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))},Cu=function(n,e,t){var r=Ui(n.element,"."+e.itemClass);return(0<r.length?O.some(r[r.length-1]):O.none()).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))},Mu=function(n,e,t,r){var o=Ui(n.element,"."+e.itemClass);return $(o,(function(n){return St(n,e.highlightClass)})).bind((function(e){var t=bu(e,r,0,o.length-1);return n.getSystem().getByDom(o[t]).toOptional()}))},Du=function(n,e,t){var r=Ui(n.element,"."+e.itemClass);return wu(N(r,(function(e){return n.getSystem().getByDom(e).toOptional()})))},_u=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return Su(n,e,0,[])},dehighlight:function(n,e,t,r){Tu(n,e,t,r)&&(wt(r.element,e.highlightClass),e.onDehighlight(n,r),ie(r,oe()))},highlight:Ou,highlightFirst:function(n,e,t){Eu(n,e).each((function(r){Ou(n,e,t,r)}))},highlightLast:function(n,e,t){Cu(n,e).each((function(r){Ou(n,e,t,r)}))},highlightAt:function(n,e,t,r){ku(n,e,t,r).fold((function(n){throw new Error(n)}),(function(r){Ou(n,e,t,r)}))},highlightBy:function(n,e,t,r){var o=Du(n,e);G(o,r).each((function(r){Ou(n,e,t,r)}))},isHighlighted:Tu,getHighlighted:function(n,e,t){return Qi(n.element,"."+e.highlightClass).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))},getFirst:Eu,getLast:Cu,getPrevious:function(n,e,t){return Mu(n,e,0,-1)},getNext:function(n,e,t){return Mu(n,e,0,1)},getCandidates:Du}),Iu=[Br("highlightClass"),Br("itemClass"),Zo("onHighlight"),Zo("onDehighlight")],Fu=wo({fields:Iu,name:"highlighting",apis:_u}),Ru=function(n,e,t){e.exists((function(n){return t.exists((function(e){return ve(e,n)}))}))||ue(n,te(),{prevFocus:e,newFocus:t})},Vu=function(){var n=function(n){return Do(n.element)};return{get:n,set:function(e,t){var r=n(e);e.getSystem().triggerFocus(t,e.element);var o=n(e);Ru(e,r,o)}}};(qi=Xi=Xi||{}).OnFocusMode="onFocus",qi.OnEnterOrSpaceMode="onEnterOrSpace",qi.OnApiMode="onApi";var Bu,Au,ju,Nu,Pu,Hu,zu,Lu,Gu,$u,Uu,Wu,Xu,qu,Yu=function(n,e,t,r,o){var i=function(n,e,t,r,o){var i,u,c=t(n,e,r,o);return i=c,u=e.event,G(i,(function(n){return n.matches(u)})).map((function(n){return n.classification})).bind((function(t){return t(n,e,r,o)}))},u={schema:function(){return n.concat([Lr("focusManager",Vu()),Gr("focusInside","onFocus",Er((function(n){return A(["onFocus","onEnterOrSpace","onApi"],n)?Ct.value(n):Ct.error("Invalid value for focusInside")}))),ri("handler",u),ri("state",e),ri("sendFocusIn",o)])},processKey:i,toEvents:function(n,e){var u=n.focusInside!==Xi.OnFocusMode?O.none():o(n).map((function(t){return Zr(Un(),(function(r,o){t(r,n,e),o.stop()}))})),c=[Zr(An(),(function(r,u){i(r,u,t,n,e).fold((function(){var t,i,c;t=r,i=u,c=mu(ou.concat(tu))(i.event),n.focusInside===Xi.OnEnterOrSpaceMode&&c&&qr(t,i)&&o(n).each((function(r){r(t,n,e),i.stop()}))}),(function(n){u.stop()}))})),Zr(jn(),(function(t,o){i(t,o,r,n,e).each((function(n){o.stop()}))}))];return Jr(u.toArray().concat(c))}};return u},Ku=function(n){var e=[Nr("onEscape"),Nr("onEnter"),Lr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Lr("firstTabstop",0),Lr("useTabstopAt",y),Nr("visibilitySelector")].concat([n]),t=function(n,e){var t=n.visibilitySelector.bind((function(n){return Zi(e,n)})).getOr(e);return 0<Li(t)},r=function(n,e,r){var o,i,u;o=e,i=Ui(n.element,o.selector),u=H(i,(function(n){return t(o,n)})),O.from(u[o.firstTabstop]).each((function(t){e.focusManager.set(n,t)}))},o=function(n,e,r,o,i){return i(e,r,(function(n){return t(e=o,r=n)&&e.useTabstopAt(r);var e,r})).fold((function(){return o.cyclic?O.some(!0):O.none()}),(function(e){return o.focusManager.set(n,e),O.some(!0)}))},u=function(n,e,t,r){var i,u,a=Ui(n.element,t.selector);return i=n,(u=t).focusManager.get(i).bind((function(n){return Zi(n,u.selector)})).bind((function(e){return $(a,c(ve,e)).bind((function(e){return o(n,a,e,t,r)}))}))},a=i([yu(gu([pu,mu(eu)]),(function(n,e,t){var r=t.cyclic?fu:su;return u(n,0,t,r)})),yu(mu(eu),(function(n,e,t){var r=t.cyclic?lu:du;return u(n,0,t,r)})),yu(mu(ru),(function(n,e,t){return t.onEscape.bind((function(t){return t(n,e)}))})),yu(gu([hu,mu(tu)]),(function(n,e,t){return t.onEnter.bind((function(t){return t(n,e)}))}))]),f=i([]);return Yu(e,ho.init,a,f,(function(){return O.some(r)}))},Ju=Ku($r("cyclic",h)),Qu=Ku($r("cyclic",y)),Zu=function(n){return"input"===he(n)&&"radio"!==lt(n,"type")||"textarea"===he(n)},nc=function(n,e,t){return Zu(t)&&mu(ou)(e.event)?O.none():(ae(n,t,Yn()),O.some(!0))},ec=function(n,e){return O.some(!0)},tc=[Lr("execute",nc),Lr("useSpace",!1),Lr("useEnter",!0),Lr("useControlEnter",!1),Lr("useDown",!1)],rc=function(n,e,t){return t.execute(n,e,n.element)},oc=Yu(tc,ho.init,(function(n,e,t,r){var o=t.useSpace&&!Zu(n.element)?ou:[],i=t.useEnter?tu:[],u=t.useDown?au:[],c=o.concat(i).concat(u);return[yu(mu(c),rc)].concat(t.useControlEnter?[yu(gu([vu,mu(tu)]),rc)]:[])}),(function(n,e,t,r){return t.useSpace&&!Zu(n.element)?[yu(mu(ou),ec)]:[]}),(function(){return O.none()})),ic=function(){var n=ko(O.none());return yo({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set(O.some({numRows:e,numColumns:t}))},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})},uc=Object.freeze({__proto__:null,flatgrid:ic,init:function(n){return n.state(n)}}),cc=function(n,e){return function(t){return"rtl"===ac(t)?e:n}},ac=function(n){return"rtl"===Bi(n,"direction")?"rtl":"ltr"},fc=function(n){return function(e,t,r,o){var i=n(e.element);return mc(i,e,t,r,o)}},sc=function(n,e){var t=cc(n,e);return fc(t)},lc=function(n,e){var t=cc(e,n);return fc(t)},dc=function(n){return function(e,t,r,o){return mc(n,e,t,r,o)}},mc=function(n,e,t,r,o){return r.focusManager.get(e).bind((function(t){return n(e.element,t,r,o)})).map((function(n){return r.focusManager.set(e,n),!0}))},gc=dc,pc=dc,vc=dc,hc=function(n){return!((e=n.dom).offsetWidth<=0&&e.offsetHeight<=0);var e},yc=function(n,e,t){var r,o=Ui(n,t),i=H(o,hc);return $(r=i,(function(n){return ve(n,e)})).map((function(n){return{index:n,candidates:r}}))},bc=function(n,e){return $(n,(function(n){return ve(e,n)}))},xc=function(n,e,t,r){return r(Math.floor(e/t),e%t).bind((function(e){var r=e.row*t+e.column;return 0<=r&&r<n.length?O.some(n[r]):O.none()}))},wc=function(n,e,t,r,o){return xc(n,e,r,(function(e,i){var u=e===t-1?n.length-e*r:r,c=bu(i,o,0,u-1);return O.some({row:e,column:c})}))},Sc=function(n,e,t,r,o){return xc(n,e,r,(function(e,i){var u=bu(e,o,0,t-1),c=u===t-1?n.length-u*r:r,a=xu(i,0,c-1);return O.some({row:u,column:a})}))},Oc=[Br("selector"),Lr("execute",nc),ni("onEscape"),Lr("captureTab",!1),ii()],Tc=function(n,e,t){Qi(n.element,e.selector).each((function(t){e.focusManager.set(n,t)}))},kc=function(n){return function(e,t,r,o){return yc(e,t,r.selector).bind((function(e){return n(e.candidates,e.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},Ec=function(n,e,t){return t.captureTab?O.some(!0):O.none()},Cc=kc((function(n,e,t,r){return wc(n,e,t,r,-1)})),Mc=kc((function(n,e,t,r){return wc(n,e,t,r,1)})),Dc=kc((function(n,e,t,r){return Sc(n,e,t,r,-1)})),_c=kc((function(n,e,t,r){return Sc(n,e,t,r,1)})),Ic=i([yu(mu(iu),sc(Cc,Mc)),yu(mu(cu),lc(Cc,Mc)),yu(mu(uu),gc(Dc)),yu(mu(au),pc(_c)),yu(gu([pu,mu(eu)]),Ec),yu(gu([hu,mu(eu)]),Ec),yu(mu(ru),(function(n,e,t){return t.onEscape(n,e)})),yu(mu(ou.concat(tu)),(function(n,e,t,r){return o=n,(i=t).focusManager.get(o).bind((function(n){return Zi(n,i.selector)})).bind((function(r){return t.execute(n,e,r)}));var o,i}))]),Fc=i([yu(mu(ou),ec)]),Rc=Yu(Oc,ic,Ic,Fc,(function(){return O.some(Tc)})),Vc=function(n,e,t,r){var o=function(n,e,t){var i,u=bu(e,r,0,t.length-1);return u===n?O.none():(i=t[u],"button"===he(i)&&"disabled"===lt(i,"disabled")?o(n,u,t):O.from(t[u]))};return yc(n,t,e).bind((function(n){var e=n.index,t=n.candidates;return o(e,e,t)}))},Bc=[Br("selector"),Lr("getInitial",O.none),Lr("execute",nc),ni("onEscape"),Lr("executeOnMove",!1),Lr("allowVertical",!0)],Ac=function(n,e,t){return r=n,(o=t).focusManager.get(r).bind((function(n){return Zi(n,o.selector)})).bind((function(r){return t.execute(n,e,r)}));var r,o},jc=function(n,e,t){e.getInitial(n).orThunk((function(){return Qi(n.element,e.selector)})).each((function(t){e.focusManager.set(n,t)}))},Nc=function(n,e,t){return Vc(n,t.selector,e,-1)},Pc=function(n,e,t){return Vc(n,t.selector,e,1)},Hc=function(n){return function(e,t,r,o){return n(e,t,r,o).bind((function(){return r.executeOnMove?Ac(e,t,r):O.some(!0)}))}},zc=function(n,e,t){return t.onEscape(n,e)},Lc=i([yu(mu(ou),ec)]),Gc=Yu(Bc,ho.init,(function(n,e,t,r){var o=iu.concat(t.allowVertical?uu:[]),i=cu.concat(t.allowVertical?au:[]);return[yu(mu(o),Hc(sc(Nc,Pc))),yu(mu(i),Hc(lc(Nc,Pc))),yu(mu(tu),Ac),yu(mu(ou),Ac),yu(mu(ru),zc)]}),Lc,(function(){return O.some(jc)})),$c=function(n,e,t){return O.from(n[e]).bind((function(n){return O.from(n[t]).map((function(n){return{rowIndex:e,columnIndex:t,cell:n}}))}))},Uc=function(n,e,t,r){var o=n[e].length,i=bu(t,r,0,o-1);return $c(n,e,i)},Wc=function(n,e,t,r){var o=bu(t,r,0,n.length-1),i=n[o].length,u=xu(e,0,i-1);return $c(n,o,u)},Xc=function(n,e,t,r){var o=n[e].length,i=xu(t+r,0,o-1);return $c(n,e,i)},qc=function(n,e,t,r){var o=xu(t+r,0,n.length-1),i=n[o].length,u=xu(e,0,i-1);return $c(n,o,u)},Yc=[jr("selectors",[Br("row"),Br("cell")]),Lr("cycles",!0),Lr("previousSelector",O.none),Lr("execute",nc)],Kc=function(n,e,t){e.previousSelector(n).orThunk((function(){var t=e.selectors;return Qi(n.element,t.cell)})).each((function(t){e.focusManager.set(n,t)}))},Jc=function(n,e){return function(t,r,o){var i=o.cycles?n:e;return Zi(r,o.selectors.row).bind((function(n){var e=Ui(n,o.selectors.cell);return bc(e,r).bind((function(e){var r=Ui(t,o.selectors.row);return bc(r,n).bind((function(n){var t,u=(t=o,N(r,(function(n){return Ui(n,t.selectors.cell)})));return i(u,n,e).map((function(n){return n.cell}))}))}))}))}},Qc=Jc((function(n,e,t){return Uc(n,e,t,-1)}),(function(n,e,t){return Xc(n,e,t,-1)})),Zc=Jc((function(n,e,t){return Uc(n,e,t,1)}),(function(n,e,t){return Xc(n,e,t,1)})),na=Jc((function(n,e,t){return Wc(n,t,e,-1)}),(function(n,e,t){return qc(n,t,e,-1)})),ea=Jc((function(n,e,t){return Wc(n,t,e,1)}),(function(n,e,t){return qc(n,t,e,1)})),ta=i([yu(mu(iu),sc(Qc,Zc)),yu(mu(cu),lc(Qc,Zc)),yu(mu(uu),gc(na)),yu(mu(au),pc(ea)),yu(mu(ou.concat(tu)),(function(n,e,t){return Do(n.element).bind((function(r){return t.execute(n,e,r)}))}))]),ra=i([yu(mu(ou),ec)]),oa=Yu(Yc,ho.init,ta,ra,(function(){return O.some(Kc)})),ia=[Br("selector"),Lr("execute",nc),Lr("moveOnTab",!1)],ua=function(n,e,t){return t.focusManager.get(n).bind((function(r){return t.execute(n,e,r)}))},ca=function(n,e,t){Qi(n.element,e.selector).each((function(t){e.focusManager.set(n,t)}))},aa=function(n,e,t){return Vc(n,t.selector,e,-1)},fa=function(n,e,t){return Vc(n,t.selector,e,1)},sa=i([yu(mu(uu),vc(aa)),yu(mu(au),vc(fa)),yu(gu([pu,mu(eu)]),(function(n,e,t,r){return t.moveOnTab?vc(aa)(n,e,t,r):O.none()})),yu(gu([hu,mu(eu)]),(function(n,e,t,r){return t.moveOnTab?vc(fa)(n,e,t,r):O.none()})),yu(mu(tu),ua),yu(mu(ou),ua)]),la=i([yu(mu(ou),ec)]),da=Yu(ia,ho.init,sa,la,(function(){return O.some(ca)})),ma=[ni("onSpace"),ni("onEnter"),ni("onShiftEnter"),ni("onLeft"),ni("onRight"),ni("onTab"),ni("onShiftTab"),ni("onUp"),ni("onDown"),ni("onEscape"),Lr("stopSpaceKeyup",!1),Nr("focusIn")],ga=Yu(ma,ho.init,(function(n,e,t){return[yu(mu(ou),t.onSpace),yu(gu([hu,mu(tu)]),t.onEnter),yu(gu([pu,mu(tu)]),t.onShiftEnter),yu(gu([pu,mu(eu)]),t.onShiftTab),yu(gu([hu,mu(eu)]),t.onTab),yu(mu(uu),t.onUp),yu(mu(au),t.onDown),yu(mu(iu),t.onLeft),yu(mu(cu),t.onRight),yu(mu(ou),t.onSpace),yu(mu(ru),t.onEscape)]}),(function(n,e,t){return t.stopSpaceKeyup?[yu(mu(ou),ec)]:[]}),(function(n){return n.focusIn})),pa=Ju.schema(),va=Qu.schema(),ha=Gc.schema(),ya=Rc.schema(),ba=oa.schema(),xa=oc.schema(),wa=da.schema(),Sa=ga.schema(),Oa=($u=_r("Creating behaviour: "+(Bu={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:pa,cyclic:va,flow:ha,flatgrid:ya,matrix:ba,execution:xa,menu:wa,special:Sa}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(n,e,t){e.sendFocusIn(e).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(r){r(n,e,t)}))},setGridSize:function(n,e,t,r,o){ct(t,"setGridSize")?t.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:uc}).name,So,Bu),Au=Fr($u.branchKey,$u.branches),ju=$u.name,Nu=$u.active,Pu=$u.apis,Hu=$u.extra,zu=$u.state,Gu=Hr(ju,[Pr("config",Lu=Au)]),vo(Lu,Gu,ju,Nu,Pu,Hu,zu)),Ta=function(n,e){return t=n,r={},o=N(e,(function(e){return t=e.name(),r="Cannot configure "+e.name()+" for "+n,Sr(t,t,Zt(),vr((function(n){return Ht("The field: "+t+" is forbidden. "+r)})));var t,r})).concat([$r("dump",u)]),Gr(t,r,yr(o));var t,r,o},ka=function(n){return n.dump},Ea=function(e,t){return n(n({},e.dump),bo(t))},Ca=Ta,Ma=Ea,Da="placeholder",_a=Ut([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Ia=function(n){return ut(n,"uiType")},Fa=function(n,e,t,r){return Ia(t)&&t.uiType===Da?(u=t,c=r,(o=n).exists((function(n){return n!==u.owner}))?_a.single(!0,i(u)):it(c,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+Qe(c)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(n){return n.replace()}))):_a.single(!1,i(t));var o,u,c},Ra=function(e,t,r,o){return Fa(e,0,r,o).fold((function(i,u){var c=Ia(r)?u(t,r.config,r.validated):u(t),a=it(c,"components").getOr([]),f=W(a,(function(n){return Ra(e,t,n,o)}));return[n(n({},c),{components:f})]}),(function(n,e){if(Ia(r)){var o=e(t,r.config,r.validated);return r.validated.preprocess.getOr(u)(o)}return e(t)}))},Va=function(n,e,t,r){var o,u,c,a=et(r,(function(n,e){return r=n,o=!1,{name:i(t=e),required:function(){return r.fold((function(n,e){return n}),(function(n,e){return n}))},used:function(){return o},replace:function(){if(o)throw new Error("Trying to use the same placeholder more than once: "+t);return o=!0,r}};var t,r,o})),f=(o=n,u=e,c=a,W(t,(function(n){return Ra(o,u,n,c)})));return nt(a,(function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))})),f},Ba=_a.single,Aa=_a.multiple,ja=i(Da),Na=0,Pa=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Na+String(e)},Ha=Ut([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),za=Lr("factory",{sketch:u}),La=Lr("schema",[]),Ga=Br("name"),$a=Sr("pname","pname",nr((function(n){return"<alloy."+Pa(n.name)+">"})),Rr()),Ua=$r("schema",(function(){return[Nr("preprocess")]})),Wa=Lr("defaults",i({})),Xa=Lr("overrides",i({})),qa=yr([za,La,Ga,$a,Wa,Xa]),Ya=yr([za,La,Ga,Wa,Xa]),Ka=yr([za,La,Ga,$a,Wa,Xa]),Ja=yr([za,Ua,Ga,Br("unit"),$a,Wa,Xa]),Qa=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},Za=function(n,e){return function(t){var r=_r("Converting part type",e,t);return n(r)}},nf=Za(Ha.required,qa),ef=(Za(Ha.external,Ya),Za(Ha.optional,Ka)),tf=Za(Ha.group,Ja),rf=i("entirety"),of=function(n,e,t,r){return qt(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},uf=function(e,t){var r={};return P(t,(function(t){t.fold(O.some,O.none,O.some,O.some).each((function(t){var o=cf(e,t.pname);r[t.name]=function(r){var i=_r("Part: "+t.name+" in "+e,yr(t.schema),r);return n(n({},o),{config:r,validated:i})}}))})),r},cf=function(n,e){return{uiType:ja(),owner:n,name:e}},af=function(n,e,t){return r=e,o={},u={},P(t,(function(n){n.fold((function(n){o[n.pname]=Ba(!0,(function(e,t,r){return n.factory.sketch(of(e,n,t,r))}))}),(function(n){var e=r.parts[n.name];u[n.name]=i(n.factory.sketch(of(r,n,e[rf()]),e))}),(function(n){o[n.pname]=Ba(!1,(function(e,t,r){return n.factory.sketch(of(e,n,t,r))}))}),(function(n){o[n.pname]=Aa(!0,(function(e,t,r){var o=e[n.name];return N(o,(function(t){return n.factory.sketch(qt(n.defaults(e,t,r),t,n.overrides(e,t)))}))}))}))})),{internals:i(o),externals:i(u)};var r,o,u},ff=function(n,e,t){return Va(O.some(n),e,e.components,t)},sf=function(n,e,t){var r=e.partUids[t];return n.getSystem().getByUid(r).toOptional()},lf=function(n,e,t){return sf(n,e,t).getOrDie("Could not find part: "+t)},df=function(n,e){var t=N(e,Qa);return ir(N(t,(function(e){return{key:e,value:n+"-"+e}})))},mf=function(n){return Sr("partUids","partUids",er((function(e){return df(e.uid,n)})),Rr())},gf=Pa("alloy-premade"),pf=function(n){return or(gf,n)},vf=function(n){return e=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return n.apply(void 0,t([e.getApis(),e],r))},r=n.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:fo(u.slice(1))}},e;var e,r,o,i,u},hf=i("alloy-id-"),yf=i("data-alloy-id"),bf=hf(),xf=yf(),wf=function(n,e){Object.defineProperty(n.dom,xf,{value:e,writable:!0})},Sf=function(n){var e=be(n)?n.dom[xf]:null;return O.from(e)},Of=Pa,Tf=function(n,e,t,r,o){var i,u,c=(u=o,(0<(i=r).length?[jr("parts",i)]:[]).concat([Br("uid"),Lr("dom",{}),Lr("components",[]),oi("originalSpec"),Lr("debug.sketcher",{})]).concat(u));return _r(n+" [SpecSchema]",hr(c.concat(e)),t)},kf=function(n,e,t,r,o){var i=Ef(o),u=W(t,(function(n){return n.fold(O.none,O.some,O.none,O.none).map((function(n){return jr(n.name,n.schema.concat([oi(rf())]))})).toArray()})),c=mf(t),a=Tf(n,e,i,u,[c]),f=af(0,a,t);return r(a,ff(n,a,f.internals()),i,f.externals())},Ef=function(e){return ut(e,"uid")?e:n(n({},e),{uid:Of("uid")})},Cf=hr([Br("name"),Br("factory"),Br("configFields"),Lr("apis",{}),Lr("extraApis",{})]),Mf=hr([Br("name"),Br("factory"),Br("configFields"),Br("partFields"),Lr("apis",{}),Lr("extraApis",{})]),Df=function(e){var t=_r("Sketcher for "+e.name,Cf,e),r=et(t.apis,vf),o=et(t.extraApis,so);return n(n({name:t.name,configFields:t.configFields,sketch:function(n){return e=t.name,r=t.configFields,o=t.factory,i=Ef(n),o(Tf(e,r,i,[],[]),i);var e,r,o,i}},r),o)},_f=function(e){var t=_r("Sketcher for "+e.name,Mf,e),r=uf(t.name,t.partFields),o=et(t.apis,vf),i=et(t.extraApis,so);return n(n({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(n){return kf(t.name,t.configFields,t.partFields,t.factory,n)},parts:r},o),i)},If=Df({name:"Button",factory:function(e){var t,r=(t=e.action,Jr(U([t.map((function(n){return ao((function(e,t){n(e),t.stop()}))})).toArray(),ki()]))),o=e.dom.tag,i=function(n){return it(e.dom,"attributes").bind((function(e){return it(e,n)}))};return{uid:e.uid,dom:e.dom,components:e.components,events:r,behaviours:Ma(e.buttonBehaviours,[_i.config({}),Oa.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:i("role").getOr("button")};var e=i("type").getOr("button"),t=i("role").map((function(n){return{role:n}})).getOr({});return n({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[Lr("uid",void 0),Br("dom"),Lr("components",[]),Ca("buttonBehaviours",[_i,Oa]),Nr("action"),Nr("role"),Lr("eventOrder",{})]}),Ff=wo({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Jr([Qr(Ln(),y)])},exhibit:function(){return lo({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Rf=function(e){var t,r,o,i=le.fromHtml(e),u=Ee(i),c=(r=void 0!==(t=i).dom.attributes?t.dom.attributes:[],L(r,(function(e,t){var r;return"class"===t.name?e:n(n({},e),((r={})[t.name]=t.value,r))}),{})),a=(o=i,Array.prototype.slice.call(o.dom.classList,0)),f=0===u.length?{}:{innerHtml:jo(i)};return n({tag:he(i),classes:a,attributes:c},f)},Vf=function(n){var e=un(n,{prefix:Oi});return Rf(e)},Bf=function(n){return{dom:Vf(n)}},Af=function(n){return bo([bi.config({toggleClass:Ti("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),xi(n,(function(n,e){(e?bi.on:bi.off)(n)}))])},jf=function(n,e,t,r){var o=Af(t);return Pf(e,r,o,n)},Nf=function(n,e){var t=e.ui.registry.getAll().icons;return O.from(t[n]).fold((function(){return Vf('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')}),(function(n){return Vf('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")}))},Pf=function(n,e,t,r){return If.sketch({dom:Nf(n,r),action:e,buttonBehaviours:qt(bo([Ff.config({})]),t)})},Hf=ef({schema:[Br("dom")],name:"label"}),zf=function(n){return ef({name:n+"-edge",overrides:function(e){return e.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:Jr([no(Dn(),(function(e,t,r){return n(e,r)}),[e]),no(Fn(),(function(e,t,r){return n(e,r)}),[e]),no(Rn(),(function(e,t,r){r.mouseIsDown.get()&&n(e,r)}),[e])])}}))}})},Lf=zf("top-left"),Gf=zf("top"),$f=zf("top-right"),Uf=zf("right"),Wf=zf("bottom-right"),Xf=zf("bottom"),qf=zf("bottom-left"),Yf=[Hf,zf("left"),Uf,Gf,Xf,Lf,$f,qf,Wf,nf({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Jr([ro(Dn(),n,"spectrum"),ro(_n(),n,"spectrum"),ro(In(),n,"spectrum"),ro(Fn(),n,"spectrum"),ro(Rn(),n,"spectrum"),ro(Vn(),n,"spectrum")])}}}),nf({schema:[$r("mouseIsDown",(function(){return ko(!1)}))],name:"spectrum",overrides:function(n){var e=n.model.manager,t=function(t,r){return e.getValueFromEvent(r).map((function(r){return e.setValueFrom(t,n,r)}))};return{behaviours:bo([Oa.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),_i.config({})]),events:Jr([Zr(Dn(),t),Zr(_n(),t),Zr(Fn(),t),Zr(Rn(),(function(e,r){n.mouseIsDown.get()&&t(e,r)}))])}}})],Kf=function(n,e,t){e.store.manager.onLoad(n,e,t)},Jf=function(n,e,t){e.store.manager.onUnload(n,e,t)},Qf=Object.freeze({__proto__:null,onLoad:Kf,onUnload:Jf,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),Zf=Object.freeze({__proto__:null,events:function(n,e){var t=n.resetOnDom?[io((function(t,r){Kf(t,n,e)})),uo((function(t,r){Jf(t,n,e)}))]:[mo(n,e,Kf)];return Jr(t)}}),ns=function(){var n=ko(null);return yo({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},es=function(){var e=ko({}),t=ko({});return yo({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},lookup:function(n){return it(e.get(),n).orThunk((function(){return it(t.get(),n)}))},update:function(r){var o=e.get(),i=t.get(),u={},c={};P(r,(function(n){u[n.value]=n,it(n,"meta").each((function(e){it(e,"text").each((function(e){c[e]=n}))}))})),e.set(n(n({},o),u)),t.set(n(n({},i),c))},clear:function(){e.set({}),t.set({})}})},ts=Object.freeze({__proto__:null,memory:ns,dataset:es,manual:function(){return yo({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),rs=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},os=[Nr("initialValue"),Br("getFallbackEntry"),Br("getDataKey"),Br("setValue"),ri("manager",{setValue:rs,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(n){return n}))},onLoad:function(n,e,t){e.store.initialValue.each((function(r){rs(n,e,t,r)}))},onUnload:function(n,e,t){t.clear()},state:es})],is=[Br("getValue"),Lr("setValue",r),Nr("initialValue"),ri("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(n,e,t){e.store.initialValue.each((function(t){e.store.setValue(n,t)}))},onUnload:r,state:ho.init})],us=[Nr("initialValue"),ri("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each((function(n){t.isNotSet()&&t.set(n)}))},onUnload:function(n,e,t){t.clear()},state:ns})],cs=[Gr("store",{mode:"memory"},Fr("mode",{memory:us,manual:is,dataset:os})),Zo("onSetValue"),Lr("resetOnDom",!1)],as=wo({fields:cs,name:"representing",active:Zf,apis:Qf,extra:{setValueFrom:function(n,e){var t=as.getValue(e);as.setValue(n,t)}},state:ts}),fs=Hi("width",(function(n){return n.dom.offsetWidth})),ss=function(n,e){return fs.set(n,e)},ls=function(n){return fs.get(n)},ds=function(n,e){return{left:n,top:e,translate:function(t,r){return ds(n+t,e+r)}}},ms=ds,gs=i("slider.change.value"),ps=function(n){var e=n.event.raw;return-1===e.type.indexOf("touch")?void 0!==e.clientX?O.some(e).map((function(n){return ms(n.clientX,n.clientY)})):O.none():void 0!==e.touches&&1===e.touches.length?O.some(e.touches[0]).map((function(n){return ms(n.clientX,n.clientY)})):O.none()},vs=function(n){return n.model.minX},hs=function(n){return n.model.minY},ys=function(n){return n.model.minX-1},bs=function(n){return n.model.minY-1},xs=function(n){return n.model.maxX},ws=function(n){return n.model.maxY},Ss=function(n){return n.model.maxX+1},Os=function(n){return n.model.maxY+1},Ts=function(n,e,t){return e(n)-t(n)},ks=function(n){return Ts(n,xs,vs)},Es=function(n){return Ts(n,ws,hs)},Cs=function(n){return ks(n)/2},Ms=function(n){return Es(n)/2},Ds=function(n){return n.stepSize},_s=function(n){return n.snapToGrid},Is=function(n){return n.snapStart},Fs=function(n){return n.rounded},Rs=function(n,e){return void 0!==n[e+"-edge"]},Vs=function(n){return Rs(n,"left")},Bs=function(n){return Rs(n,"right")},As=function(n){return Rs(n,"top")},js=function(n){return Rs(n,"bottom")},Ns=function(n){return n.model.value.get()},Ps=function(n){return{x:n}},Hs=function(n){return{y:n}},zs=function(n,e){return{x:n,y:e}},Ls=function(n,e){ue(n,gs(),{value:e})},Gs=function(n,e,t,r){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-r)},$s=function(n,e,t,r){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+r)},Us=function(n,e,t){return Math.max(e,Math.min(t,n))},Ws=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?e-1:e,p=s?t+1:t;if(o<l)return g;if(d<o)return p;var v,h,y,b,x,w,S,O=(x=o,w=l,S=d,Math.min(S,Math.max(x,w))-w),T=Us(O/m*r+e,g,p);return u&&e<=T&&T<=t?(v=T,h=e,y=t,b=i,c.fold((function(){var n=v-h,e=Math.round(n/b)*b;return Us(h+e,h-1,y+1)}),(function(n){var e=(v-n)%b,t=Math.round(e/b),r=Math.floor((v-n)/b),o=Math.floor((y-n)/b),i=n+Math.min(o,r+t)*b;return Math.max(n,i)}))):a?Math.round(T):T},Xs=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<e?i?0:f:t<o?u?c:s:(o-e)/r*a},qs="left",Ys=function(n){return n.element.dom.getBoundingClientRect()},Ks=function(n,e){return n[e]},Js=function(n){var e=Ys(n);return Ks(e,qs)},Qs=function(n){var e=Ys(n);return Ks(e,"right")},Zs=function(n){var e=Ys(n);return Ks(e,"top")},nl=function(n){var e=Ys(n);return Ks(e,"bottom")},el=function(n){var e=Ys(n);return Ks(e,"width")},tl=function(n){var e=Ys(n);return Ks(e,"height")},rl=function(n,e,t){return(n+e)/2-t},ol=function(n,e){var t=Ys(n),r=Ys(e),o=Ks(t,qs),i=Ks(t,"right"),u=Ks(r,qs);return rl(o,i,u)},il=function(n,e){var t=Ys(n),r=Ys(e),o=Ks(t,"top"),i=Ks(t,"bottom"),u=Ks(r,"top");return rl(o,i,u)},ul=function(n,e){ue(n,gs(),{value:e})},cl=function(n){return{x:n}},al=function(n,e,t){var r={min:vs(e),max:xs(e),range:ks(e),value:t,step:Ds(e),snap:_s(e),snapStart:Is(e),rounded:Fs(e),hasMinEdge:Vs(e),hasMaxEdge:Bs(e),minBound:Js(n),maxBound:Qs(n),screenRange:el(n)};return Ws(r)},fl=function(n){return function(e,t){return r=e,i=(0<n?$s:Gs)(Ns(o=t).x,vs(o),xs(o),Ds(o)),ul(r,cl(i)),O.some(i).map((function(){return!0}));var r,o,i}},sl=function(n,e,t,r,o,i){var u,c,a,f,s,l,d,m,g,p=(c=i,a=t,f=r,s=o,l=el(u=e),d=f.bind((function(n){return O.some(ol(n,u))})).getOr(0),m=s.bind((function(n){return O.some(ol(n,u))})).getOr(l),g={min:vs(c),max:xs(c),range:ks(c),value:a,hasMinEdge:Vs(c),hasMaxEdge:Bs(c),minBound:Js(u),minOffset:0,maxBound:Qs(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},Xs(g));return Js(e)-Js(n)+p},ll=fl(-1),dl=fl(1),ml=O.none,gl=O.none,pl={"top-left":O.none(),top:O.none(),"top-right":O.none(),right:O.some((function(n,e){Ls(n,Ps(Ss(e)))})),"bottom-right":O.none(),bottom:O.none(),"bottom-left":O.none(),left:O.some((function(n,e){Ls(n,Ps(ys(e)))}))},vl=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=al(n,e,t),o=cl(r);return ul(n,o),r},setToMin:function(n,e){var t=vs(e);ul(n,cl(t))},setToMax:function(n,e){var t=xs(e);ul(n,cl(t))},findValueOfOffset:al,getValueFromEvent:function(n){return ps(n).map((function(n){return n.left}))},findPositionOfValue:sl,setPositionFromValue:function(n,e,t,r){var o=Ns(t),i=sl(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=ls(e.element)/2;Ri(e.element,"left",i-u+"px")},onLeft:ll,onRight:dl,onUp:ml,onDown:gl,edgeActions:pl}),hl=function(n,e){ue(n,gs(),{value:e})},yl=function(n){return{y:n}},bl=function(n,e,t){var r={min:hs(e),max:ws(e),range:Es(e),value:t,step:Ds(e),snap:_s(e),snapStart:Is(e),rounded:Fs(e),hasMinEdge:As(e),hasMaxEdge:js(e),minBound:Zs(n),maxBound:nl(n),screenRange:tl(n)};return Ws(r)},xl=function(n){return function(e,t){return r=e,i=(0<n?$s:Gs)(Ns(o=t).y,hs(o),ws(o),Ds(o)),hl(r,yl(i)),O.some(i).map((function(){return!0}));var r,o,i}},wl=function(n,e,t,r,o,i){var u,c,a,f,s,l,d,m,g,p=(c=i,a=t,f=r,s=o,l=tl(u=e),d=f.bind((function(n){return O.some(il(n,u))})).getOr(0),m=s.bind((function(n){return O.some(il(n,u))})).getOr(l),g={min:hs(c),max:ws(c),range:Es(c),value:a,hasMinEdge:As(c),hasMaxEdge:js(c),minBound:Zs(u),minOffset:0,maxBound:nl(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},Xs(g));return Zs(e)-Zs(n)+p},Sl=O.none,Ol=O.none,Tl=xl(-1),kl=xl(1),El={"top-left":O.none(),top:O.some((function(n,e){Ls(n,Hs(bs(e)))})),"top-right":O.none(),right:O.none(),"bottom-right":O.none(),bottom:O.some((function(n,e){Ls(n,Hs(Os(e)))})),"bottom-left":O.none(),left:O.none()},Cl=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=bl(n,e,t),o=yl(r);return hl(n,o),r},setToMin:function(n,e){var t=hs(e);hl(n,yl(t))},setToMax:function(n,e){var t=ws(e);hl(n,yl(t))},findValueOfOffset:bl,getValueFromEvent:function(n){return ps(n).map((function(n){return n.top}))},findPositionOfValue:wl,setPositionFromValue:function(n,e,t,r){var o=Ns(t),i=wl(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),u=Li(e.element)/2;Ri(e.element,"top",i-u+"px")},onLeft:Sl,onRight:Ol,onUp:Tl,onDown:kl,edgeActions:El}),Ml=function(n,e){ue(n,gs(),{value:e})},Dl=function(n,e){return{x:n,y:e}},_l=function(n,e){return function(t,r){return i=t,u=r,c=0<n?$s:Gs,a=(o=e)?Ns(u).x:c(Ns(u).x,vs(u),xs(u),Ds(u)),f=o?c(Ns(u).y,hs(u),ws(u),Ds(u)):Ns(u).y,Ml(i,Dl(a,f)),O.some(a).map((function(){return!0}));var o,i,u,c,a,f}},Il=ps,Fl=_l(-1,!1),Rl=_l(1,!1),Vl=_l(-1,!0),Bl=_l(1,!0),Al={"top-left":O.some((function(n,e){Ls(n,zs(ys(e),bs(e)))})),top:O.some((function(n,e){Ls(n,zs(Cs(e),bs(e)))})),"top-right":O.some((function(n,e){Ls(n,zs(Ss(e),bs(e)))})),right:O.some((function(n,e){Ls(n,zs(Ss(e),Ms(e)))})),"bottom-right":O.some((function(n,e){Ls(n,zs(Ss(e),Os(e)))})),bottom:O.some((function(n,e){Ls(n,zs(Cs(e),Os(e)))})),"bottom-left":O.some((function(n,e){Ls(n,zs(ys(e),Os(e)))})),left:O.some((function(n,e){Ls(n,zs(ys(e),Ms(e)))}))},jl=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=al(n,e,t.left),o=bl(n,e,t.top),i=Dl(r,o);return Ml(n,i),i},setToMin:function(n,e){var t=vs(e),r=hs(e);Ml(n,Dl(t,r))},setToMax:function(n,e){var t=xs(e),r=ws(e);Ml(n,Dl(t,r))},getValueFromEvent:Il,setPositionFromValue:function(n,e,t,r){var o=Ns(t),i=sl(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=wl(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),c=ls(e.element)/2,a=Li(e.element)/2;Ri(e.element,"left",i-c+"px"),Ri(e.element,"top",u-a+"px")},onLeft:Fl,onRight:Rl,onUp:Vl,onDown:Bl,edgeActions:Al}),Nl=[Lr("stepSize",1),Lr("onChange",r),Lr("onChoose",r),Lr("onInit",r),Lr("onDragStart",r),Lr("onDragEnd",r),Lr("snapToGrid",!1),Lr("rounded",!0),Nr("snapStart"),Ar("model",Fr("mode",{x:[Lr("minX",0),Lr("maxX",100),$r("value",(function(n){return ko(n.mode.minX)})),Br("getInitialValue"),ri("manager",vl)],y:[Lr("minY",0),Lr("maxY",100),$r("value",(function(n){return ko(n.mode.minY)})),Br("getInitialValue"),ri("manager",Cl)],xy:[Lr("minX",0),Lr("maxX",100),Lr("minY",0),Lr("maxY",100),$r("value",(function(n){return ko({x:n.mode.minX,y:n.mode.minY})})),Br("getInitialValue"),ri("manager",jl)]})),Ta("sliderBehaviours",[Oa,as]),$r("mouseIsDown",(function(){return ko(!1)}))],Pl=i("mouse.released"),Hl=_f({name:"Slider",configFields:Nl,partFields:Yf,factory:function(n,e,t,r){var o,i=function(e){return lf(e,n,"thumb")},u=function(e){return lf(e,n,"spectrum")},c=function(e){return sf(e,n,"left-edge")},a=function(e){return sf(e,n,"right-edge")},f=function(e){return sf(e,n,"top-edge")},s=function(e){return sf(e,n,"bottom-edge")},l=n.model,d=l.manager,m=function(e,t){d.setPositionFromValue(e,t,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:u})},g=function(e,t){l.value.set(t);var r=i(e);return m(e,r),n.onChange(e,r,t),O.some(!0)},p=function(e){var t=n.mouseIsDown.get();n.mouseIsDown.set(!1),t&&sf(e,n,"thumb").each((function(t){var r=l.value.get();n.onChoose(e,t,r)}))},v=function(e,t){t.stop(),n.mouseIsDown.set(!0),n.onDragStart(e,i(e))},h=function(e,t){t.stop(),n.onDragEnd(e,i(e)),p(e)};return{uid:n.uid,dom:n.dom,components:e,behaviours:Ea(n.sliderBehaviours,[Oa.config({mode:"special",focusIn:function(e){return sf(e,n,"spectrum").map(Oa.focusIn).map(y)}}),as.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),ci.config({channels:((o={})[Pl()]={onReceive:p},o)})]),events:Jr([Zr(gs(),(function(n,e){g(n,e.event.value)})),io((function(e,t){var r=l.getInitialValue();l.value.set(r);var o=i(e);m(e,o);var c=u(e);n.onInit(e,o,c,l.value.get())})),Zr(Dn(),v),Zr(In(),h),Zr(Fn(),v),Zr(Vn(),h)]),apis:{resetToMin:function(e){d.setToMin(e,n)},resetToMax:function(e){d.setToMax(e,n)},changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),zl=function(n,e,t,r){return Pf(e,(function(){var r=t();n.setContextToolbar([{label:e+" group",items:r}])}),{},r)},Ll=function(n){return[(e=n,t=function(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"},Hl.sketch({dom:Vf('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Hl.parts["left-edge"](Bf('<div class="${prefix}-hue-slider-black"></div>')),Hl.parts.spectrum({dom:Vf('<div class="${prefix}-slider-gradient-container"></div>'),components:[Bf('<div class="${prefix}-slider-gradient"></div>')],behaviours:bo([bi.config({toggleClass:Ti("thumb-active")})])}),Hl.parts["right-edge"](Bf('<div class="${prefix}-hue-slider-white"></div>')),Hl.parts.thumb({dom:Vf('<div class="${prefix}-slider-thumb"></div>'),behaviours:bo([bi.config({toggleClass:Ti("thumb-active")})])})],onChange:function(n,r,o){var i=t(o.x());Ri(r.element,"background-color",i),e.onChange(n,r,i)},onDragStart:function(n,e){bi.on(e)},onDragEnd:function(n,e){bi.off(e)},onInit:function(n,e,r,o){var i=t(o.x());Ri(e.element,"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:e.getInitialValue()}}},sliderBehaviours:bo([wi(Hl.refresh)])}))];var e,t},Gl=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],$l=function(n,e){return(be(e)?O.some(e):ke(e).filter(be)).map((function(e){return Wi((function(n,e){return e(n)}),Yi,e,(function(n){return ji(n,"font-size").isSome()}),n).bind((function(n){return ji(n,"font-size")})).getOrThunk((function(){return Bi(e,"font-size")}))})).getOr("")},Ul=function(n){var e=n.selection.getStart(),t=le.fromDom(e),r=le.fromDom(n.getBody()),o=$l((function(n){return ve(r,n)}),t);return G(Gl,(function(n){return o===n})).getOr("medium")},Wl=function(n){var e,t=Ul(n);return e=t,$(Gl,(function(n){return n===e})).getOr(2)},Xl=function(n,e){var t;t=e,O.from(Gl[t]).each((function(e){var t,r;r=e,Ul(t=n)!==r&&t.execCommand("fontSize",!1,r)}))},ql=i(Gl),Yl=hr([Br("getInitialValue"),Br("onChange"),Br("category"),Br("sizes")]),Kl=function(n){var e=_r("SizeSlider",Yl,n);return Hl.sketch({dom:{tag:"div",classes:[Ti("slider-"+e.category+"-size-container"),Ti("slider"),Ti("slider-size-container")]},onChange:function(n,t,r){var o,i=r.x();0<=(o=i)&&o<e.sizes.length&&e.onChange(i)},onDragStart:function(n,e){bi.on(e)},onDragEnd:function(n,e){bi.off(e)},model:{mode:"x",minX:0,maxX:e.sizes.length-1,getInitialValue:function(){return{x:e.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:bo([wi(Hl.refresh)]),components:[Hl.parts.spectrum({dom:Vf('<div class="${prefix}-slider-size-container"></div>'),components:[Bf('<div class="${prefix}-slider-size-line"></div>')]}),Hl.parts.thumb({dom:Vf('<div class="${prefix}-slider-thumb"></div>'),behaviours:bo([bi.config({toggleClass:Ti("thumb-active")})])})]})},Jl=ql(),Ql=function(n){return[Bf('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),Kl({onChange:(e=n).onChange,sizes:Jl,category:"font",getInitialValue:e.getInitialValue}),Bf('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var e},Zl=function(e){var t=void 0!==e.uid&&ct(e,"uid")?e.uid:Of("memento");return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).toOptional()},asSpec:function(){return n(n({},e),{uid:t})}}},nd=window.Promise?window.Promise:(Uu=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],cd(n,ed(rd,this),ed(od,this))},Wu=window,Xu=Uu.immediateFn||"function"==typeof Wu.setImmediate&&Wu.setImmediate||function(n){setTimeout(n,1)},qu=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Uu.prototype["catch"]=function(n){return this.then(null,n)},Uu.prototype.then=function(n,e){var t=this;return new Uu((function(r,o){td.call(t,new ud(n,e,r,o))}))},Uu.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Array.prototype.slice.call(1===n.length&&qu(n[0])?n[0]:n);return new Uu((function(n,e){if(0===t.length)return n([]);for(var r=t.length,o=0;o<t.length;o++)!function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),e)}t[i]=u,0==--r&&n(t)}catch(l){e(l)}}(o,t[o])}))},Uu.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Uu?n:new Uu((function(e){e(n)}))},Uu.reject=function(n){return new Uu((function(e,t){t(n)}))},Uu.race=function(n){return new Uu((function(e,t){for(var r=0,o=n;r<o.length;r++)o[r].then(e,t)}))},Uu);function ed(n,e){return function(){return n.apply(e,arguments)}}function td(n){var e=this;null!==this._state?Xu((function(){var t,r=e._state?n.onFulfilled:n.onRejected;if(null!==r){try{t=r(e._value)}catch(s){return void n.reject(s)}n.resolve(t)}else(e._state?n.resolve:n.reject)(e._value)})):this._deferreds.push(n)}function rd(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void cd(ed(e,n),ed(rd,this),ed(od,this))}this._state=!0,this._value=n,id.call(this)}catch(s){od.call(this,s)}}function od(n){this._state=!1,this._value=n,id.call(this)}function id(){for(var n=0,e=this._deferreds;n<e.length;n++){var t=e[n];td.call(this,t)}this._deferreds=[]}function ud(n,e,t,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=r}function cd(n,e,t){var r=!1;try{n((function(n){r||(r=!0,e(n))}),(function(n){r||(r=!0,t(n))}))}catch(d){if(r)return;r=!0,t(d)}}function ad(n){return e=n,new nd((function(n){var t=new FileReader;t.onloadend=function(){n(t.result)},t.readAsDataURL(e)})).then((function(n){return n.split(",")[1]}));var e}var fd,sd,ld,dd,md,gd=ad,pd=function(n){var e=Zl({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Jr([oo(Hn()),Zr(Pn(),(function(e,t){var r,o;r=t.event.raw,o=r.target.files||r.dataTransfer.files,O.from(o[0]).each((function(e){var t,r;t=n,gd(r=e).then((function(n){t.undoManager.transact((function(){var e=t.editorUpload.blobCache,o=e.create(Pa("mceu"),r,n);e.add(o);var i=t.dom.createHTML("img",{src:o.blobUri()});t.insertContent(i)}))}))}))}))])});return If.sketch({dom:Nf("image",n),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}})},vd=function(n){return n.dom.textContent},hd=function(n){return 0<n.length},yd=function(n){return void 0===n||null===n?"":n},bd=function(n){return Sd(n).fold((function(){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:O.none()}}),(function(n){return t=vd(e=n),r=lt(e,"href"),o=lt(e,"title"),i=lt(e,"target"),{url:yd(r),text:t!==r?yd(t):"",title:yd(o),target:yd(i),link:O.some(e)};var e,t,r,o,i}))},xd=function(n,e,t){return t.text.toOptional().filter(hd).fold((function(){return lt(t=n,"href")===vd(t)?O.some(e):O.none();var t}),O.some)},wd=function(n,e){e.url.toOptional().filter(hd).fold((function(){var t;t=n,e.link.bind(u).each((function(n){t.execCommand("unlink")}))}),(function(t){var r,o,i=(r=e,(o={}).href=t,r.title.toOptional().filter(hd).each((function(n){o.title=n})),r.target.toOptional().filter(hd).each((function(n){o.target=n})),o);e.link.bind(u).fold((function(){var r=e.text.toOptional().filter(hd).getOr(t);n.insertContent(n.dom.createHTML("a",i,n.dom.encode(r)))}),(function(n){var r=xd(n,t,e);st(n,i),r.each((function(e){var t;t=e,n.dom.textContent=t}))}))}))},Sd=function(n){var e=le.fromDom(n.selection.getStart());return Zi(e,"a")},Od=Cn(),Td=function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)},kd=function(n,e){var t,r;return{key:n,value:{config:{},me:(t=n,r=Jr(e),wo({fields:[Br("enabled")],name:t,active:{events:i(r)}})),configAsRaw:i({}),initialConfig:{},state:ho}}},Ed=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),Cd=[Br("find")],Md=wo({fields:Cd,name:"composing",apis:Ed}),Dd=Df({name:"Container",factory:function(t){var r=t.dom,o=r.attributes,i=e(r,["attributes"]);return{uid:t.uid,dom:n({tag:"div",attributes:n({role:"presentation"},o)},i),components:t.components,behaviours:ka(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Lr("components",[]),Ta("containerBehaviours",[]),Lr("events",{}),Lr("domModification",{}),Lr("eventOrder",{})]}),_d=Df({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:Ma(n.dataBehaviours,[as.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),Md.config({find:O.some})]),events:Jr([io((function(e,t){as.setValue(e,n.getInitialValue())}))])}},configFields:[Br("uid"),Br("dom"),Br("getInitialValue"),Ca("dataBehaviours",[as,Md])]}),Id=function(n){return n.dom.value},Fd=function(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom.value=e},Rd=i([Nr("data"),Lr("inputAttributes",{}),Lr("inputStyles",{}),Lr("tag","input"),Lr("inputClasses",[]),Zo("onSetValue"),Lr("styles",{}),Lr("eventOrder",{}),Ta("inputBehaviours",[as,_i]),Lr("selectOnFocus",!0)]),Vd=function(e){return n(n({},(t=e,bo([_i.config({onFocus:t.selectOnFocus?function(n){var e=n.element,t=Id(e);e.dom.setSelectionRange(0,t.length)}:r})]))),Ea(e.inputBehaviours,[as.config({store:n(n({mode:"manual"},e.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return Id(n.element)},setValue:function(n,e){Id(n.element)!==e&&Fd(n.element,e)}}),onSetValue:e.onSetValue})]));var t},Bd=Df({name:"Input",configFields:Rd(),factory:function(e,t){return{uid:e.uid,dom:{tag:(r=e).tag,attributes:n({type:"text"},r.inputAttributes),styles:r.inputStyles,classes:r.inputClasses},components:[],behaviours:Vd(e),eventOrder:e.eventOrder};var r}}),Ad=Object.freeze({__proto__:null,exhibit:function(n,e){return lo({attributes:ir([{key:e.tabAttr,value:"true"}])})}}),jd=[Lr("tabAttr","data-alloy-tabstop")],Nd=wo({fields:jd,name:"tabstopping",active:Ad}),Pd=tinymce.util.Tools.resolve("tinymce.util.I18n"),Hd=function(n,e){var t=Zl(Bd.sketch({inputAttributes:{placeholder:Pd.translate(e)},onSetValue:function(n,e){ie(n,Nn())},inputBehaviours:bo([Md.config({find:O.some}),Nd.config({}),Oa.config({mode:"execution"})]),selectOnFocus:!1})),r=Zl(If.sketch({dom:Vf('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);as.setValue(e,"")}}));return{name:n,spec:Dd.sketch({dom:Vf('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),r.asSpec()],containerBehaviours:bo([bi.config({toggleClass:Ti("input-container-empty")}),Md.config({find:function(n){return O.some(t.get(n))}}),kd("input-clearing",[Zr(Nn(),(function(n){var e=t.get(n);(0<as.getValue(e).length?bi.off:bi.on)(n)}))])])})}},zd=["input","button","textarea","select"],Ld=function(n,e,t){(e.disabled()?qd:Yd)(n,e)},Gd=function(n,e){return!0===e.useNative&&A(zd,he(n.element))},$d=function(n){ft(n.element,"disabled","disabled")},Ud=function(n){gt(n.element,"disabled")},Wd=function(n){ft(n.element,"aria-disabled","true")},Xd=function(n){ft(n.element,"aria-disabled","false")},qd=function(n,e,t){e.disableClass.each((function(e){bt(n.element,e)})),(Gd(n,e)?$d:Wd)(n),e.onDisabled(n)},Yd=function(n,e,t){e.disableClass.each((function(e){wt(n.element,e)})),(Gd(n,e)?Ud:Xd)(n),e.onEnabled(n)},Kd=function(n,e){return Gd(n,e)?mt(n.element,"disabled"):"true"===lt(n.element,"aria-disabled")},Jd=Object.freeze({__proto__:null,enable:Yd,disable:qd,isDisabled:Kd,onLoad:Ld,set:function(n,e,t,r){(r?qd:Yd)(n,e)}}),Qd=Object.freeze({__proto__:null,exhibit:function(n,e){return lo({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(n,e){return Jr([Qr(Yn(),(function(e,t){return Kd(e,n)})),mo(n,e,Ld)])}}),Zd=[Gr("disabled",h,Vr),Lr("useNative",!0),Nr("disableClass"),Zo("onDisabled"),Zo("onEnabled")],nm=wo({fields:Zd,name:"disabling",active:Qd,apis:Jd}),em=[Ta("formBehaviours",[as])],tm=function(n){return"<alloy.field."+n+">"},rm=function(n,e){return{uid:n.uid,dom:n.dom,components:e,behaviours:Ea(n.formBehaviours,[as.config({store:{mode:"manual",getValue:function(e){var t,r,o=(t=n,r=e.getSystem(),et(t.partUids,(function(n,e){return i(r.getByUid(n))})));return et(o,(function(n,e){return n().bind((function(n){var t,r,o=Md.getCurrent(n);return t=o,r=new Error("Cannot find a current component to extract the value from for form part '"+e+"': "+Ho(n.element)),t.fold((function(){return Ct.error(r)}),Ct.value)})).map(as.getValue)}))},setValue:function(e,t){nt(t,(function(t,r){sf(e,n,r).each((function(n){Md.getCurrent(n).each((function(n){as.setValue(n,t)}))}))}))}}})]),apis:{getField:function(e,t){return sf(e,n,t).bind(Md.getCurrent)}}}},om=(vf((function(n,e,t){return n.getField(e,t)})),function(n){var e,t=(e=[],{field:function(n,t){return e.push(n),r="form",o=tm(n),i=t,{uiType:ja(),owner:r,name:o,config:i,validated:{}};var r,o,i},record:function(){return e}}),r=n(t),o=t.record(),i=N(o,(function(n){return nf({name:n,pname:tm(n)})}));return kf("form",em,i,rm,r)}),im=function(){var n=ko(O.none()),e=function(){return n.get().each((function(n){return n.destroy()}))};return{clear:function(){e(),n.set(O.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(O.some(t))},run:function(e){return n.get().each(e)}}},um=function(){var n=ko(O.none());return{clear:function(){return n.set(O.none())},set:function(e){return n.set(O.some(e))},isSet:function(){return n.get().isSome()},on:function(e){return n.get().each(e)}}},cm=function(n){var e="navigateEvent",t=yr([Br("fields"),Lr("maxFieldIndex",n.fields.length-1),Br("onExecute"),Br("getInitialValue"),$r("state",(function(){return{dialogSwipeState:um(),currentScreen:ko(0)}}))]),r=_r("SerialisedDialog",t,n),o=function(n,t,r){return If.sketch({dom:Vf('<span class="${prefix}-icon-'+t+' ${prefix}-icon"></span>'),action:function(t){ue(t,e,{direction:n})},buttonBehaviours:bo([nm.config({disableClass:Ti("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},i=function(n,e){var t=Ui(n.element,"."+Ti("serialised-dialog-screen"));Qi(n.element,"."+Ti("serialised-dialog-chain")).each((function(n){0<=r.state.currentScreen.get()+e&&r.state.currentScreen.get()+e<t.length&&(ji(n,"left").each((function(r){var o=parseInt(r,10),i=ls(t[0]);Ri(n,"left",o-e*i+"px")})),r.state.currentScreen.set(r.state.currentScreen.get()+e))}))},u=function(n){var e=Ui(n.element,"input");O.from(e[r.state.currentScreen.get()]).each((function(e){n.getSystem().getByDom(e).each((function(e){var t,r;t=n,r=e.element,t.getSystem().triggerFocus(r,t.element)}))}));var t=a.get(n);Fu.highlightAt(t,r.state.currentScreen.get())},c=Zl(om((function(n){return{dom:Vf('<div class="${prefix}-serialised-dialog"></div>'),components:[Dd.sketch({dom:Vf('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:N(r.fields,(function(e,t){return t<=r.maxFieldIndex?Dd.sketch({dom:Vf('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[o(-1,"previous",0<t),n.field(e.name,e.spec),o(1,"next",t<r.maxFieldIndex)]}):n.field(e.name,e.spec)}))})],formBehaviours:bo([wi((function(n,e){var t;t=e,Qi(n.element,"."+Ti("serialised-dialog-chain")).each((function(n){Ri(n,"left",-r.state.currentScreen.get()*t.width+"px")}))})),Oa.config({mode:"special",focusIn:function(n,e){u(n)},onTab:function(n,e){return i(n,1),O.some(!0)},onShiftTab:function(n,e){return i(n,-1),O.some(!0)}}),kd("form-events",[io((function(n,e){r.state.currentScreen.set(0),r.state.dialogSwipeState.clear();var t=a.get(n);Fu.highlightFirst(t),r.getInitialValue(n).each((function(e){as.setValue(n,e)}))})),ao(r.onExecute),Zr(zn(),(function(n,e){"left"===e.event.raw.propertyName&&u(n)})),Zr(e,(function(n,e){var t=e.event.direction;i(n,t)}))])])}}))),a=Zl({dom:Vf('<div class="${prefix}-dot-container"></div>'),behaviours:bo([Fu.config({highlightClass:Ti("dot-active"),itemClass:Ti("dot-item")})]),components:W(r.fields,(function(n,e){return e<=r.maxFieldIndex?[Bf('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]}))});return{dom:Vf('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:bo([Oa.config({mode:"special",focusIn:function(n){var e=c.get(n);Oa.focusIn(e)}}),kd("serializer-wrapper-events",[Zr(Dn(),(function(n,e){var t=e.event;r.state.dialogSwipeState.set({xValue:t.raw.touches[0].clientX,points:[]})})),Zr(_n(),(function(n,e){var t=e.event;r.state.dialogSwipeState.on((function(n){e.event.prevent(),r.state.dialogSwipeState.set(function(n,e){if(e===n.xValue)return n;var t=0<e-n.xValue?1:-1,r={direction:t,xValue:e};return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([r])}}(n,t.raw.touches[0].clientX))}))})),Zr(In(),(function(n,e){r.state.dialogSwipeState.on((function(e){var t=c.get(n),r=-1*function(n){if(0===n.points.length)return 0;var e=n.points[0].direction,t=n.points[n.points.length-1].direction;return-1===e&&-1===t?-1:1===e&&1===t?1:0}(e);i(t,r)}))}))])])}},am=b((function(n,e){return[{label:"the link group",items:[cm({fields:[Hd("url","Type or paste URL"),Hd("text","Link text"),Hd("title","Link title"),Hd("target","Link target"),{name:"link",spec:_d.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return O.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return O.some(bd(e))},onExecute:function(t,r){var o=as.getValue(t);wd(e,o),n.restoreToolbar(),e.focus()}})]}]})),fm=function(n,e){return jf(e,"link","link",(function(){var t,r,o=am(n,e);n.setContextToolbar(o),t=e,r=function(){n.focusToolbar()},(Od.os.isAndroid()?Td:v)(r,t),Sd(e).each((function(n){e.selection.select(n.dom)}))}))},sm=Jr([{key:Un(),value:Yr({can:function(n,e){var t,r,o=e.event,i=o.originator,u=o.target;return r=u,!(ve(t=i,n.element)&&!ve(t,r))||(console.warn(Un()+" did not get interpreted by the desired target. \nOriginator: "+Ho(i)+"\nTarget: "+Ho(u)+"\nCheck the "+Un()+" event handlers"),!1)}})}]),lm=Object.freeze({__proto__:null,events:sm}),dm=u,mm=function(n){var e=function(e){return function(){throw new Error("The component must be in a context to send: "+e+(n?"\n"+Ho(n().element)+" is not in context.":""))}};return{debugInfo:i("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:h}},gm=mm(),pm=function(n,e){var t={};return nt(n,(function(n,r){nt(n,(function(n,o){var i=it(t,o).getOr([]);t[o]=i.concat([e(r,n)])}))})),t},vm=function(n,e,t,r){try{var o=(i=t,u=function(t,o){var i=t[e],u=o[e],c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0},(c=R.call(i,0)).sort(u),c);return Ct.value(o)}catch(m){return Ct.error([m])}var i,u,c},hm=function(n,e){return{cHandler:c.apply(void 0,[n.handler].concat(e)),purpose:n.purpose}},ym=function(n){return n.cHandler},bm=function(n,e){return{name:n,handler:e}},xm=function(e,t,r){var o,i,u=n(n({},r),(o=e,i={},P(t,(function(n){i[n.name()]=n.handlers(o)})),i));return pm(u,bm)},wm=function(n){var e,t=I(e=n)?{can:i(!0),abort:i(!1),run:e}:e;return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,e].concat(r);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},Sm=function(n,e,t){var r,o,i=e[t];return i?vm("Event: "+t,"name",n,i).map((function(n){var e=N(n,(function(n){return n.handler}));return Kr(e)})):(r=t,o=n,Ct.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(N(o,(function(n){return n.name})),null,2)]))},Om=function(n,e){var t=ot(n,(function(n,t){return(1===n.length?Ct.value(n[0].handler):Sm(n,e,t)).map((function(r){var o=wm(r),i=1<n.length?H(e[t],(function(e){return j(n,(function(n){return n.name===e}))})).join(" > "):n[0].name;return or(t,{handler:o,purpose:i})}))}));return ur(t,{})},Tm="alloy.base.behaviour",km=function(n){var e,t;return Mr("custom.definition",yr([Sr("dom","dom",Qt(),yr([Br("tag"),Lr("styles",{}),Lr("classes",[]),Lr("attributes",{}),Nr("value"),Nr("innerHtml")])),Br("components"),Br("uid"),Lr("events",{}),Lr("apis",{}),Sr("eventOrder","eventOrder",((e={})[Yn()]=["disabling",Tm,"toggling","typeaheadevents"],e[Un()]=[Tm,"focusing","keying"],e[Zn()]=[Tm,"disabling","toggling","representing"],e[Nn()]=[Tm,"representing","streaming","invalidating"],e[ee()]=[Tm,"representing","item-events","tooltipping"],e[Fn()]=["focusing",Tm,"item-type-events"],e[Dn()]=["focusing",Tm,"item-type-events"],e[Bn()]=["item-type-events","tooltipping"],e[qn()]=["receiving","reflecting","tooltipping"],t=e,Kt.mergeWithThunk(i(t))),Rr()),Nr("domModification")]),n)},Em=function(n,e){P(e,(function(e){bt(n,e)}))},Cm=function(n,e){P(e,(function(e){wt(n,e)}))},Mm=function(n,e){return t=n,o=N(r=e,(function(n){return Hr(n.name(),[Br("config"),Lr("state",ho)])})),i=Mr("component.behaviours",yr(o),t.behaviours).fold((function(n){throw new Error(Ir(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),(function(n){return n})),{list:r,data:et(i,(function(n){var e=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return e}}))};var t,r,o,i},Dm=function(n){var e,t,r=(e=it(n,"behaviours").getOr({}),t=H(Qe(e),(function(n){return void 0!==e[n]})),N(t,(function(n){return e[n].me})));return Mm(n,r)},_m=function(e,t,r){var o,i,u,c=n(n({},(o=e).dom),{uid:o.uid,domChildren:N(o.components,(function(n){return n.element}))}),a=e.domModification.fold((function(){return lo({})}),lo),f={"alloy.base.modification":a},s=0<t.length?function(e,t,r,o){var i=n({},t);P(r,(function(n){i[n.name()]=n.exhibit(e,o)}));var u=pm(i,(function(n,e){return{name:n,modification:e}})),c=function(e){return z(e,(function(e,t){return n(n({},t.modification),e)}),{})},a=z(u.classes,(function(n,e){return e.modification.concat(n)}),[]),f=c(u.attributes),s=c(u.styles);return lo({classes:a,attributes:f,styles:s})}(r,f,t,c):a;return u=s,n(n({},i=c),{attributes:n(n({},i.attributes),u.attributes),styles:n(n({},i.styles),u.styles),classes:i.classes.concat(u.classes)})},Im=function(n,e,t){var r,o,i,u={"alloy.base.behaviour":n.events};return r=t,o=n.eventOrder,i=xm(r,e,u),Om(i,o).getOrDie()},Fm=function(n){var e=function(){return s},t=ko(gm),r=Dr(km(n)),o=Dm(n),i=o.list,u=o.data,c=function(n){var e=le.fromTag(n.tag);st(e,n.attributes),Em(e,n.classes),Vi(e,n.styles),n.innerHtml.each((function(n){return No(e,n)}));var t=n.domChildren;return Fe(e,t),n.value.each((function(n){Fd(e,n)})),n.uid,wf(e,n.uid),e}(_m(r,i,u)),a=Im(r,i,u),f=ko(r.components),s={getSystem:t.get,config:function(e){var t=u;return(I(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return I(u[n.name()])},spec:n,readState:function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return r.apis},connect:function(n){t.set(n)},disconnect:function(){t.set(mm(e))},element:c,syncComponents:function(){var n=Ee(c),e=W(n,(function(n){return t.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));f.set(e)},components:f.get,events:a};return s},Rm=function(t){var r,o=dm(t),i=o.events,u=e(o,["events"]),c=(r=it(u,"components").getOr([]),N(r,jm)),a=n(n({},u),{events:n(n({},lm),i),components:c});return Ct.value(Fm(a))},Vm=function(n){var e=le.fromText(n);return Bm({element:e})},Bm=function(n){var e=_r("external.component",hr([Br("element"),Nr("uid")]),n),t=ko(mm());e.uid.each((function(n){wf(e.element,n)}));var o={getSystem:t.get,config:O.none,hasConfigured:h,connect:function(n){t.set(n)},disconnect:function(){t.set(mm((function(){return o})))},getApis:function(){return{}},element:e.element,spec:n,readState:i("No state"),syncComponents:r,components:i([]),events:{}};return pf(o)},Am=Of,jm=function(e){return it(e,gf).fold((function(){var t=e.hasOwnProperty("uid")?e:n({uid:Am("")},e);return Rm(t).getOrDie()}),(function(n){return n}))},Nm=pf,Pm="alloy.item-hover",Hm="alloy.item-focus",zm=function(n){(Do(n.element).isNone()||_i.isFocused(n))&&(_i.isFocused(n)||_i.focus(n),ue(n,Pm,{item:n}))},Lm=function(n){ue(n,Hm,{item:n})},Gm=i(Pm),$m=i(Hm),Um=[Br("data"),Br("components"),Br("dom"),Lr("hasSubmenu",!1),Nr("toggling"),Ca("itemBehaviours",[bi,_i,Oa,as]),Lr("ignoreFocus",!1),Lr("domModification",{}),ri("builder",(function(e){return{dom:e.dom,domModification:n(n({},e.domModification),{attributes:n(n(n({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ma(e.itemBehaviours,[e.toggling.fold(bi.revoke,(function(e){return bi.config(n({aria:{mode:"checked"}},e))})),_i.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(n){Lm(n)}}),Oa.config({mode:"execution"}),as.config({store:{mode:"memory",initialValue:e.data}}),kd("item-type-events",t(ki(),[Zr(Bn(),zm),Zr(Kn(),_i.focus)]))]),components:e.components,eventOrder:e.eventOrder}})),Lr("eventOrder",{})],Wm=[Br("dom"),Br("components"),ri("builder",(function(n){return{dom:n.dom,components:n.components,events:Jr([(e=Kn(),Zr(e,(function(n,e){e.stop()})))])};var e}))],Xm=function(){return"item-widget"},qm=i([nf({name:"widget",overrides:function(n){return{behaviours:bo([as.config({store:{mode:"manual",getValue:function(e){return n.data},setValue:function(){}}})])}}})]),Ym=[Br("uid"),Br("data"),Br("components"),Br("dom"),Lr("autofocus",!1),Lr("ignoreFocus",!1),Ca("widgetBehaviours",[as,_i,Oa]),Lr("domModification",{}),mf(qm()),ri("builder",(function(n){var e=af(Xm(),n,qm()),t=ff(Xm(),n,e.internals()),r=function(e){return sf(e,n,"widget").map((function(n){return Oa.focusIn(n),n}))},o=function(e,t){return Zu(t.event.target)||n.autofocus&&t.setSource(e.element),O.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:Jr([ao((function(n,e){r(n).each((function(n){e.stop()}))})),Zr(Bn(),zm),Zr(Kn(),(function(e,t){n.autofocus?r(e):_i.focus(e)}))]),behaviours:Ma(n.widgetBehaviours,[as.config({store:{mode:"memory",initialValue:n.data}}),_i.config({ignore:n.ignoreFocus,onFocus:function(n){Lm(n)}}),Oa.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:Oo(),onLeft:o,onRight:o,onEscape:function(e,t){return _i.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),O.none()):(_i.focus(e),O.some(!0))}})])}}))],Km=Fr("type",{widget:Ym,item:Um,separator:Wm}),Jm=i([tf({factory:{sketch:function(n){var e=_r("menu.spec item",Km,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:n(n({},t),{uid:Of("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Qm=i([Br("value"),Br("items"),Br("dom"),Br("components"),Lr("eventOrder",{}),Ta("menuBehaviours",[Fu,as,Md,Oa]),Gr("movement",{mode:"menu",moveOnTab:!0},Fr("mode",{grid:[ii(),ri("config",(function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}}))],matrix:[ri("config",(function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Br("rowSelector")],menu:[Lr("moveOnTab",!0),ri("config",(function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}}))]})),Ar("markers",Ko()),Lr("fakeFocus",!1),Lr("focusManager",Vu()),Zo("onHighlight")]),Zm=i("alloy.menu-focus"),ng=_f({name:"Menu",configFields:Qm(),partFields:Jm(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Ea(n.menuBehaviours,[Fu.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),as.config({store:{mode:"memory",initialValue:n.value}}),Md.config({find:O.some}),Oa.config(n.movement.config(n,n.movement))]),events:Jr([Zr($m(),(function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each((function(t){Fu.highlight(n,t),e.stop(),ue(n,Zm(),{menu:n,item:t})}))})),Zr(Gm(),(function(n,e){var t=e.event.item;Fu.highlight(n,t)}))]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),eg=function(n,e){var t=je(e),o=Mo(t).bind((function(n){var t,r,o=function(e){return ve(n,e)};return o(e)?O.some(e):(t=o,(r=function(n){for(var e=0;e<n.childNodes.length;e++){var o=le.fromDom(n.childNodes[e]);if(t(o))return O.some(o);var i=r(n.childNodes[e]);if(i.isSome())return i}return O.none()})(e.dom))})),i=n(e);return o.each((function(n){Mo(t).filter((function(e){return ve(e,n)})).fold((function(){Eo(n)}),r)})),i},tg=function(n,e,t,r){var o=n.getSystem().build(r);Ye(n,o,t)},rg=function(n,e,t,r){var o=og(n);G(o,(function(n){return ve(r.element,n.element)})).each(Ke)},og=function(n,e){return n.components()},ig=function(n,e,t,r,o){var i=og(n);return O.from(i[r]).map((function(e){return rg(n,0,0,e),o.each((function(e){tg(n,0,(function(n,e){var t,o;o=e,Ce(t=n,r).fold((function(){Ie(t,o)}),(function(n){Me(n,o)}))}),e)})),e}))},ug=wo({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,r){tg(n,0,Ie,r)},prepend:function(n,e,t,r){tg(n,0,_e,r)},remove:rg,replaceAt:ig,replaceBy:function(n,e,t,r,o){var i=og(n);return $(i,r).bind((function(e){return ig(n,0,0,e,o)}))},set:function(n,e,t,r){eg((function(){var e=N(r,n.getSystem().build);qe(n,e)}),n.element)},contents:og})}),cg=function(n,e,t,r){return it(t,r).bind((function(r){return it(n,r).bind((function(r){var o=cg(n,e,t,r);return O.some([r].concat(o))}))})).getOr([])},ag=function(n,e){var t={};nt(n,(function(n,e){P(n,(function(n){t[n]=e}))}));var r=e,o=tt(e,(function(n,e){return{k:n,v:e}})),i=et(o,(function(n,e){return[e].concat(cg(t,r,o,e))}));return et(t,(function(n){return it(i,n).getOr([n])}))},fg=function(n){return"prepared"===n.type?O.some(n.menu):O.none()},sg={init:function(){var e=ko({}),t=ko({}),r=ko({}),o=ko(O.none()),i=ko({}),u=function(n){return function(n,e){for(var t=Qe(n),r=0,o=t.length;r<o;r++){var i=t[r],u=n[i];if(e(u,i,n))return O.some(u)}return O.none()}(e.get(),(function(e,t){return e===n}))},c=function(n){return a(n).bind(fg)},a=function(n){return it(t.get(),n)},f=function(n){return it(e.get(),n)};return{setMenuBuilt:function(e,r){var o;t.set(n(n({},t.get()),((o={})[e]={type:"prepared",menu:r},o)))},setContents:function(n,u,c,a){o.set(O.some(n)),e.set(c),t.set(u),i.set(a);var f=ag(a,c);r.set(f)},expand:function(n){return it(e.get(),n).map((function(e){var t=it(r.get(),n).getOr([]);return[e].concat(t)}))},refresh:function(n){return it(r.get(),n)},collapse:function(n){return it(r.get(),n).bind((function(n){return 1<n.length?O.some(n.slice(1)):O.none()}))},lookupMenu:a,lookupItem:f,otherMenus:function(n){var e=i.get();return Y(Qe(e),n)},getPrimary:function(){return o.get().bind(c)},getMenus:function(){return t.get()},clear:function(){e.set({}),t.set({}),r.set({}),o.set(O.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,e){var t=H(f(n).toArray(),(function(n){return c(n).isSome()}));return it(r.get(),n).bind((function(n){var r=q(t.concat(n));return function(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.isSome())return O.none();e.push(r.getOrDie())}return O.some(e)}(W(r,(function(n,t){return i=n,a=e,f=r.slice(0,t+1),c(i).bind((function(n){return u(i).bind((function(e){return a(e).map((function(e){return{triggeredMenu:n,triggeringItem:e,triggeringPath:f}}))}))})).fold((function(){return o.get().is(n)?[]:[O.none()]}),(function(n){return[O.some(n)]}));var i,a,f})))}))}}},extractPreparedMenu:fg},lg=i("collapse-item"),dg=Df({name:"TieredMenu",configFields:[ti("onExecute"),ti("onEscape"),ei("onOpenMenu"),ei("onOpenSubmenu"),Zo("onRepositionMenu"),Zo("onCollapseMenu"),Lr("highlightImmediately",!0),jr("data",[Br("primary"),Br("menus"),Br("expansions")]),Lr("fakeFocus",!1),Zo("onHighlight"),Zo("onHover"),jr("markers",[Br("backgroundMenu")].concat(qo()).concat(Yo())),Br("dom"),Lr("navigateOnHover",!0),Lr("stayInDom",!1),Ta("tmenuBehaviours",[Oa,Fu,Md,ug]),Lr("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(e,t){var o,i,u=ko(O.none()),c=function(t,o,i){return et(i,(function(i,u){var c=function(){return ng.sketch(n(n({},i),{value:u,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:e.fakeFocus?{get:t=function(n){return Fu.getHighlighted(n).map((function(n){return n.element}))},set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(r,(function(e){Fu.highlight(n,e)}));var i=t(n);Ru(n,o,i)}}:Vu()}));var t};return u===o?{type:"prepared",menu:t.getSystem().build(c())}:{type:"notbuilt",nbMenu:c}}))},a=sg.init(),f=function(n){return as.getValue(n).value},s=function(n){return et(e.data.menus,(function(n,e){return W(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},l=function(n,e){Fu.highlight(n,e),Fu.getHighlighted(e).orThunk((function(){return Fu.getFirst(e)})).each((function(e){ae(n,e.element,Kn())}))},d=function(n,e){return wu(N(e,(function(e){return n.lookupMenu(e).bind((function(n){return"prepared"===n.type?O.some(n.menu):O.none()}))})))},m=function(n,t,r){var o=d(t,t.otherMenus(r));P(o,(function(t){Cm(t.element,[e.markers.backgroundMenu]),e.stayInDom||ug.remove(n,t)}))},g=function(n,t){var r,o=(r=n,u.get().getOrThunk((function(){var n={},t=Ui(r.element,"."+e.markers.item),o=H(t,(function(n){return"true"===lt(n,"aria-haspopup")}));return P(o,(function(e){r.getSystem().getByDom(e).each((function(e){var t=f(e);n[t]=e}))})),u.set(O.some(n)),n})));nt(o,(function(n,e){var r=A(t,e);ft(n.element,"aria-expanded",r)}))},p=function(n,t,r){return O.from(r[0]).bind((function(o){return t.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return O.none();var i=o.menu,u=d(t,r.slice(1));return P(u,(function(n){bt(n.element,e.markers.backgroundMenu)})),Le(i.element)||ug.append(n,Nm(i)),Cm(i.element,[e.markers.backgroundMenu]),l(n,i),m(n,t,r),O.some(i)}))}))};(i=o=o||{})[i.HighlightSubmenu=0]="HighlightSubmenu",i[i.HighlightParent=1]="HighlightParent";var v=function(n,t,r){void 0===r&&(r=o.HighlightSubmenu);var i=f(t);return a.expand(i).bind((function(i){return g(n,i),O.from(i[0]).bind((function(u){return a.lookupMenu(u).bind((function(c){var f=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return a.setMenuBuilt(e,r),r}(n,u,c);return Le(f.element)||ug.append(n,Nm(f)),e.onOpenSubmenu(n,t,f,q(i)),r===o.HighlightSubmenu?(Fu.highlightFirst(f),p(n,a,i)):(Fu.dehighlightAll(f),O.some(t))}))}))}))},h=function(n,t){var r=f(t);return a.collapse(r).bind((function(r){return g(n,r),p(n,a,r).map((function(r){return e.onCollapseMenu(n,t,r),r}))}))},y=function(n){return function(t,r){return Zi(r.getSource(),"."+e.markers.item).bind((function(e){return t.getSystem().getByDom(e).toOptional().bind((function(e){return n(t,e).map((function(){return!0}))}))}))}},b=Jr([Zr(Zm(),(function(n,e){var t=e.event.item;a.lookupItem(f(t)).each((function(){var t=e.event.menu;Fu.highlight(n,t);var r=f(e.event.item);a.refresh(r).each((function(e){return m(n,a,e)}))}))})),ao((function(n,t){var r=t.event.target;n.getSystem().getByDom(r).each((function(t){0===f(t).indexOf("collapse-item")&&h(n,t),v(n,t,o.HighlightSubmenu).fold((function(){e.onExecute(n,t)}),(function(){}))}))})),io((function(n,t){var r,o;r=c(n,e.data.primary,e.data.menus),o=s(),a.setContents(e.data.primary,r,e.data.expansions,o),a.getPrimary().each((function(t){ug.append(n,Nm(t)),e.onOpenMenu(n,t),e.highlightImmediately&&l(n,t)}))}))].concat(e.navigateOnHover?[Zr(Gm(),(function(n,t){var r,i,u=t.event.item;r=n,i=f(u),a.refresh(i).bind((function(n){return g(r,n),p(r,a,n)})),v(n,u,o.HighlightParent),e.onHover(n,u)}))]:[])),x=function(n){return Fu.getHighlighted(n).bind(Fu.getHighlighted)},w={collapseMenu:function(n){x(n).each((function(e){h(n,e)}))},highlightPrimary:function(n){a.getPrimary().each((function(e){l(n,e)}))},repositionMenus:function(n){a.getPrimary().bind((function(e){return x(n).bind((function(n){var e,t=f(n),r=(e=a.getMenus(),ot(e,(function(n){return n}))),o=wu(N(r,sg.extractPreparedMenu));return a.getTriggeringPath(t,(function(n){return e=n,J(o,(function(n){if(!n.getSystem().isConnected())return O.none();var t=Fu.getCandidates(n);return G(t,(function(n){return f(n)===e}))}));var e}))})).map((function(n){return{primary:e,triggeringPath:n}}))})).fold((function(){var t;t=n,O.from(t.components()[0]).filter((function(n){return"menu"===lt(n.element,"role")})).each((function(t){e.onRepositionMenu(n,t,[])}))}),(function(t){var r=t.primary,o=t.triggeringPath;e.onRepositionMenu(n,r,o)}))}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Ea(e.tmenuBehaviours,[Oa.config({mode:"special",onRight:y((function(n,e){return Zu(e.element)?O.none():v(n,e,o.HighlightSubmenu)})),onLeft:y((function(n,e){return Zu(e.element)?O.none():h(n,e)})),onEscape:y((function(n,t){return h(n,t).orThunk((function(){return e.onEscape(n,t).map((function(){return n}))}))})),focusIn:function(n,e){a.getPrimary().each((function(e){ae(n,e.element,Kn())}))}}),Fu.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),Md.config({find:function(n){return Fu.getHighlighted(n)}}),ug.config({})]),eventOrder:e.eventOrder,apis:w,events:b}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:or(n,e),expansions:{}}},collapseItem:function(n){return{value:Pa(lg()),meta:{text:n}}}}}),mg=function(n,e,t,r){return it(e.routes,r.start).bind((function(n){return it(n,r.destination)}))},gg=function(n,e,t,r){return mg(0,e,0,r).bind((function(n){return n.transition.map((function(e){return{transition:e,route:n}}))}))},pg=function(n,e,t){var r,o,i;i=t,vg(r=n,o=e).bind((function(n){return gg(r,o,i,n)})).each((function(t){var r=t.transition;wt(n.element,r.transitionClass),gt(n.element,e.destinationAttr)}))},vg=function(n,e,t){var r=n.element;return dt(r,e.destinationAttr).map((function(t){return{start:lt(n.element,e.stateAttr),destination:t}}))},hg=function(n,e,t,r){pg(n,e,t),mt(n.element,e.stateAttr)&&lt(n.element,e.stateAttr)!==r&&e.onFinish(n,r),ft(n.element,e.stateAttr,r)},yg=Object.freeze({__proto__:null,findRoute:mg,disableTransition:pg,getCurrentRoute:vg,jumpTo:hg,progressTo:function(n,e,t,r){var o,i;i=e,mt((o=n).element,i.destinationAttr)&&(dt(o.element,i.destinationAttr).each((function(n){ft(o.element,i.stateAttr,n)})),gt(o.element,i.destinationAttr));var u,c,a=(u=e,c=r,{start:lt(n.element,u.stateAttr),destination:c});gg(n,e,t,a).fold((function(){hg(n,e,t,r)}),(function(o){pg(n,e,t);var i=o.transition;bt(n.element,i.transitionClass),ft(n.element,e.destinationAttr,r)}))},getState:function(n,e,t){return dt(n.element,e.stateAttr)}}),bg=Object.freeze({__proto__:null,events:function(n,e){return Jr([Zr(zn(),(function(t,r){var o=r.event.raw;vg(t,n).each((function(r){mg(0,n,0,r).each((function(i){i.transition.each((function(i){o.propertyName===i.property&&(hg(t,n,e,r.destination),n.onTransition(t,r))}))}))}))})),io((function(t,r){hg(t,n,e,n.initialState)}))])}}),xg=[Lr("destinationAttr","data-transitioning-destination"),Lr("stateAttr","data-transitioning-state"),Br("initialState"),Zo("onTransition"),Zo("onFinish"),Ar("routes",Cr(Ct.value,Cr(Ct.value,hr([zr("transition",[Br("property"),Br("transitionClass")])]))))],wg=wo({fields:xg,name:"transitioning",active:bg,apis:yg,extra:{createRoutes:function(n){var e={};return nt(n,(function(n,t){var r=t.split("<->");e[r[0]]=or(r[1],n),e[r[1]]=or(r[0],n)})),e},createBistate:function(n,e,t){return ir([{key:n,value:or(e,t)},{key:e,value:or(n,t)}])},createTristate:function(n,e,t,r){return ir([{key:n,value:ir([{key:e,value:r},{key:t,value:r}])},{key:e,value:ir([{key:n,value:r},{key:t,value:r}])},{key:t,value:ir([{key:n,value:r},{key:e,value:r}])}])}}}),Sg=Ti("scrollable"),Og=function(n){bt(n,Sg)},Tg=function(n){wt(n,Sg)},kg=Sg,Eg=function(n){return it(n,"format").getOr(n.title)},Cg=function(n,e,t,r,o){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:o?[Ti("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Ti("format-matches"),selected:t},itemBehaviours:bo(o?[]:[xi(n,(function(n,e){(e?bi.on:bi.off)(n)}))]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},Mg=function(n,e,t,r){return{value:n,dom:{tag:"div"},components:[If.sketch({dom:{tag:"div",classes:[Ti("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[Ti("styles-collapse-icon")]}},Vm(n)]:[Vm(n)],action:function(n){var e;r&&(e=t().get(n),dg.collapseMenu(e))}}),{dom:{tag:"div",classes:[Ti("styles-menu-items-container")]},components:[ng.parts.items({})],behaviours:bo([kd("adhoc-scrollable-menu",[io((function(n,e){Ri(n.element,"overflow-y","auto"),Ri(n.element,"-webkit-overflow-scrolling","touch"),Og(n.element)})),uo((function(n){Ni(n.element,"overflow-y"),Ni(n.element,"-webkit-overflow-scrolling"),Tg(n.element)}))])])}],items:e,menuBehaviours:bo([wg.config({initialState:"after",routes:wg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Dg=function(n){var e,t,r,o,i,u=(e=n.formats,t=function(){return c},r=Mg("Styles",[].concat(N(e.items,(function(n){return Cg(Eg(n),n.title,n.isSelected(),n.getPreview(),ct(e.expansions,Eg(n)))}))),t,!1),o=et(e.menus,(function(n,r){var o=N(n,(function(n){return Cg(Eg(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",ct(e.expansions,Eg(n)))}));return Mg(r,o,t,!0)})),i=qt(o,or("styles",r)),{tmenu:dg.tieredData("styles",i,e.expansions)}),c=Zl(dg.sketch({dom:{tag:"div",classes:[Ti("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,t){var r=as.getValue(t);return n.handle(t,r.value),O.none()},onEscape:function(){return O.none()},onOpenMenu:function(n,e){var t=ls(n.element);ss(e.element,t),wg.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var r=ls(n.element),o=Ji(e.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();ss(t.element,r),wg.progressTo(i,"before"),wg.jumpTo(t,"after"),wg.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var r=Ji(e.element,'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();wg.progressTo(o,"after"),wg.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:u.tmenu,markers:{backgroundMenu:Ti("styles-background-menu"),menu:Ti("styles-menu"),selectedMenu:Ti("styles-selected-menu"),item:Ti("styles-item"),selectedItem:Ti("styles-selected-item")}}));return c.asSpec()},_g=function(n){return ct(n,"items")?(t=qt(rr(e=n,["items"]),{menu:!0}),r=Ig(e.items),{item:t,menus:qt(r.menus,or(e.title,r.items)),expansions:qt(r.expansions,or(e.title,e.title))}):{item:n,menus:{},expansions:{}};var e,t,r},Ig=function(n){return z(n,(function(n,e){var t=_g(e);return{menus:qt(n.menus,t.menus),items:[t.item].concat(n.items),expansions:qt(n.expansions,t.expansions)}}),{menus:{},expansions:{},items:[]})},Fg=function(n){var e=function(e){return function(){return n.formatter.match(e)}},t=function(e){return function(){return n.formatter.getCssText(e)}},r=function(o){return N(o,(function(o){if(ct(o,"items")){var u=r(o.items);return qt(qt(o,{isSelected:h,getPreview:i("")}),{items:u})}return ct(o,"format")?qt(s=o,{isSelected:e(s.format),getPreview:t(s.format)}):(a=Pa((c=o).title),f=qt(c,{format:a,isSelected:e(a),getPreview:t(a)}),n.formatter.register(a,f),f);var c,a,f,s}))};return r(n.getParam("style_formats",Fo,"array"))},Rg=function(n,e,t){var r,o,i,u=(r=n,i=(o=function(n){return W(n,(function(n){return void 0===n.items?!ct(n,"format")||r.formatter.canApply(n.format)?[n]:[]:0<o(n.items).length?[n]:[]}))})(e),Ig(i));return Dg({formats:u,handle:function(e,r){n.undoManager.transact((function(){bi.isOn(e)?n.formatter.remove(r):n.formatter.apply(r)})),t()}})},Vg=function(n){var e=n.replace(/\|/g," ").trim();return 0<e.length?e.split(/\s+/):[]},Bg=function(n){return W(n,(function(n){return(M(n)?Bg:Vg)(n)}))},Ag=function(n){var e=n.getParam("toolbar",Ro,"array");return(M(e)?Bg:Vg)(e)},jg=function(n,e){var t=function(n){return function(){return Pf(r=n,(function(){t.execCommand(r)}),{},t=e);var t,r}},r=function(n){return function(){return t=e,o=Af(r=n),Pf(r,(function(){t.execCommand(r)}),o,t);var t,r,o}},o=function(n,t,r){return function(){return jf(e,n,t,r)}},i=t("undo"),u=t("redo"),c=r("bold"),a=r("italic"),f=r("underline"),s=t("removeformat"),l=o("unlink","link",(function(){e.execCommand("unlink",null,!1)})),d=o("unordered-list","ul",(function(){e.execCommand("InsertUnorderedList",null,!1)})),m=o("ordered-list","ol",(function(){e.execCommand("InsertOrderedList",null,!1)})),g=Fg(e),p=function(){return Rg(e,g,(function(){e.fire("scrollIntoView")}))},v=function(n,t){return{isSupported:function(){var t=e.ui.registry.getAll().buttons;return n.forall((function(n){return ct(t,n)}))},sketch:t}};return{undo:v(O.none(),i),redo:v(O.none(),u),bold:v(O.none(),c),italic:v(O.none(),a),underline:v(O.none(),f),removeformat:v(O.none(),s),link:v(O.none(),(function(){return fm(n,e)})),unlink:v(O.none(),l),image:v(O.none(),(function(){return pd(e)})),bullist:v(O.some("bullist"),d),numlist:v(O.some("numlist"),m),fontsizeselect:v(O.none(),(function(){return r={onChange:function(n){Xl(t,n)},getInitialValue:function(){return Wl(t)}},zl(n,"font-size",(function(){return Ql(r)}),t=e);var t,r})),forecolor:v(O.none(),(function(){return r={onChange:function(n,e,r){t.undoManager.transact((function(){t.formatter.apply("forecolor",{value:r}),t.nodeChanged()}))},getInitialValue:function(){return-1}},zl(n,"color-levels",(function(){return Ll(r)}),t=e);var t,r})),styleselect:v(O.none(),(function(){return Pf("style-formats",(function(t){e.fire("toReading"),n.dropup.appear(p,bi.on,t)}),bo([bi.config({toggleClass:Ti("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ci.config({channels:ir([Si(Bo,bi.off),Si(Ao,bi.off)])})]),e)}))}},Ng=function(n,e){return function(t){var r,i,u,c,a;n(t)&&e((r=t,i=le.fromDom(He(r).getOr(r.target)),a=o(c=function(){return r.preventDefault()},u=function(){return r.stopPropagation()}),{target:i,x:r.clientX,y:r.clientY,stop:u,prevent:c,kill:a,raw:r}))}},Pg=function(n,e,t,r,o){var i=Ng(t,r);return n.dom.addEventListener(e,i,o),{unbind:c(Hg,n,e,i,o)}},Hg=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},zg=y,Lg=function(n,e,t){return Pg(n,e,zg,t,!1)},Gg=function(n,e,t){return Pg(n,e,zg,t,!0)},$g=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ug=function(n){var e=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:i(e)}},Wg=function(n,e){var t=le.fromDom(n),r=null,o=Lg(t,"orientationchange",(function(){$g.clearInterval(r);var t=Ug(n);e.onChange(t),i((function(){e.onReady(t)}))})),i=function(e){$g.clearInterval(r);var t=n.innerHeight,o=0;r=$g.setInterval((function(){t!==n.innerHeight?($g.clearInterval(r),e(O.some(n.innerHeight))):20<o&&($g.clearInterval(r),e(O.none())),o++}),50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},Xg=function(n,e,t){var r,o,i=n.document.createRange();return r=i,e.fold((function(n){r.setStartBefore(n.dom)}),(function(n,e){r.setStart(n.dom,e)}),(function(n){r.setStartAfter(n.dom)})),o=i,t.fold((function(n){o.setEndBefore(n.dom)}),(function(n,e){o.setEnd(n.dom,e)}),(function(n){o.setEndAfter(n.dom)})),i},qg=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(r.dom,o),i},Yg=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Kg=Ut([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Jg=function(n,e,t){return e(le.fromDom(t.startContainer),t.startOffset,le.fromDom(t.endContainer),t.endOffset)},Qg=function(n,e){var t,r,o,u=(t=n,e.match({domRange:function(n){return{ltr:i(n),rtl:O.none}},relative:function(n,e){return{ltr:b((function(){return Xg(t,n,e)})),rtl:b((function(){return O.some(Xg(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:b((function(){return qg(t,n,e,r,o)})),rtl:b((function(){return O.some(qg(t,r,o,n,e))}))}}}));return(o=(r=u).ltr()).collapsed?r.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Kg.rtl(le.fromDom(n.endContainer),n.endOffset,le.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Jg(0,Kg.ltr,o)})):Jg(0,Kg.ltr,o)},Zg=(Kg.ltr,Kg.rtl,function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}}),np=(fd=xe,sd="text",{get:function(n){if(!fd(n))throw new Error("Can only get "+sd+" value of a "+sd+" node");return ld(n).getOr("")},getOption:ld=function(n){return fd(n)?O.from(n.dom.nodeValue):O.none()},set:function(n,e){if(!fd(n))throw new Error("Can only set raw "+sd+" value of a "+sd+" node");n.dom.nodeValue=e}}),ep=function(n){return"img"===he(n)?1:(e=n,np.getOption(e).fold((function(){return Ee(n).length}),(function(n){return n.length})));var e},tp=Ut([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),rp={before:tp.before,on:tp.on,after:tp.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(u,u,u)}},op=Ut([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ip={domRange:op.domRange,relative:op.relative,exact:op.exact,exactFromRange:function(n){return op.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e,t=n.match({domRange:function(n){return le.fromDom(n.startContainer)},relative:function(n,e){return rp.getStart(n)},exact:function(n,e,t,r){return n}});return e=t,le.fromDom(Te(e).dom.defaultView)},range:Zg},up=function(n,e){var t=he(n);return"input"===t?rp.after(n):A(["br","img"],t)?0===e?rp.before(n):rp.after(n):rp.on(n,e)},cp=function(n,e,t,r){var o,i,u,c,a,f=(i=e,u=t,c=r,(a=Oe(o=n).dom.createRange()).setStart(o.dom,i),a.setEnd(u.dom,c),a),s=ve(n,t)&&e===r;return f.collapsed&&!s},ap=function(n){return O.from(n.getSelection())},fp=function(n,e,t,r,o){var i,u=qg(n,e,t,r,o);i=u,ap(n).each((function(n){n.removeAllRanges(),n.addRange(i)}))},sp=function(n,e){return Qg(n,e).match({ltr:function(e,t,r,o){fp(n,e,t,r,o)},rtl:function(e,r,o,i){ap(n).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(e.dom,r,o.dom,i);else if(u.extend)try{a=e,f=r,s=o,l=i,(c=u).collapse(a.dom,f),c.extend(s.dom,l)}catch(t){fp(n,o,i,e,r)}else fp(n,o,i,e,r);var c,a,f,s,l}))}})},lp=function(n,e,t,r,o){var i,u,c,a,f=(i=r,u=o,c=up(e,t),a=up(i,u),ip.relative(c,a));sp(n,f)},dp=function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return O.some(Zg(le.fromDom(e.startContainer),e.startOffset,le.fromDom(t.endContainer),t.endOffset))}return O.none()},mp=function(n){if(null===n.anchorNode||null===n.focusNode)return dp(n);var e=le.fromDom(n.anchorNode),t=le.fromDom(n.focusNode);return cp(e,n.anchorOffset,t,n.focusOffset)?O.some(Zg(e,n.anchorOffset,t,n.focusOffset)):dp(n)},gp=function(n){return ap(n).filter((function(n){return 0<n.rangeCount})).bind(mp)},pp=function(n,e){var t,r,o,i,u=Qg(t=n,e).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(r.dom,o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom,o),i.setEnd(n.dom,e),i}});return o=(r=u).getClientRects(),0<(i=0<o.length?o[0]:r.getBoundingClientRect()).width||0<i.height?O.some(i).map(Yg):O.none()},vp=function(n){return O.from(n.dom.contentWindow)},hp=function(n){return vp(n).bind(gp)},yp=function(n){return n.getFrame()},bp=function(n,e,t,r){return n[t].getOrThunk((function(){return function(n){return Lg(e,r,n)}}))},xp=function(n){var e,t=yp(n);return e=t,O.some(le.fromDom(e.dom.contentWindow.document.body)).bind((function(e){return r=t,O.some(le.fromDom(r.dom.contentWindow.document)).bind((function(r){return vp(t).map((function(o){var i=le.fromDom(r.dom.documentElement),u=n.getCursorBox.getOrThunk((function(){return function(){return gp(o).map((function(n){return ip.exact(n.start,n.soffset,n.finish,n.foffset)})).bind((function(n){return pp(o,n).orThunk((function(){return gp(o).filter((function(n){return ve(n.start,n.finish)&&n.soffset===n.foffset})).bind((function(n){var e=n.start.dom.getBoundingClientRect();return 0<e.width||0<e.height?O.some(e):O.none()}))}))}))}})),a=n.setSelection.getOrThunk((function(){return function(n,e,t,r){lp(o,n,e,t,r)}})),f=n.clearSelection.getOrThunk((function(){return function(){ap(o).each((function(n){return n.removeAllRanges()}))}}));return{body:e,doc:r,win:o,html:i,getSelection:c(hp,t),setSelection:a,clearSelection:f,frame:t,onKeyup:bp(n,r,"onKeyup","keyup"),onNodeChanged:bp(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}}))}));var r}))},wp=(dd="getWin",md=vp,function(n){return n[dd].getOrThunk((function(){var e=yp(n);return function(){return md(e)}}))()}),Sp=function(){var n=Ki("head").getOrDie(),e=Ki('meta[name="viewport"]').getOrThunk((function(){var e=le.fromTag("meta");return ft(e,"name","viewport"),Ie(n,e),e})),t=lt(e,"content");return{maximize:function(){ft(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){void 0!==t&&null!==t&&0<t.length?ft(e,"content",t):ft(e,"content","user-scalable=yes")}}},Op="data-ephox-mobile-fullscreen-style",Tp="position:absolute!important;",kp="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Ep=Cn().os.isAndroid(),Cp=function(n,e){var t,r,o,i=function(n){return function(e){var t=lt(e,"style"),r=void 0===t?"no-styles":t.trim();r!==n&&(ft(e,Op,r),ft(e,"style",n))}},u=(t="*",Gi(n,(function(n){return de(n,t)}),r)),c=W(u,(function(n){return e="*",$i(n,(function(n){return de(n,e)}));var e})),a=void 0!==(o=Bi(e,"background-color"))&&""!==o?"background-color:"+o+"!important":"background-color:rgb(255,255,255)!important;";P(c,i("display:none!important;")),P(u,i(Tp+kp+a)),i((!0===Ep?"":Tp)+kp+a)(n)},Mp=function(){var n=ge("["+Op+"]");P(n,(function(n){var e=lt(n,Op);"no-styles"!==e?ft(n,"style",e):gt(n,"style"),gt(n,Op)}))},Dp=function(n){var e=n.raw;return void 0===e.touches||1!==e.touches.length?O.none():O.some(e.touches[0])},_p=function(n){var e,t,r,o=ko(O.none()),i=ko(!1),u=(e=function(e){n.triggerEvent(Qn(),e),i.set(!0)},t=400,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];r=setTimeout((function(){e.apply(null,n),r=null}),t)}}),c=ir([{key:Dn(),value:function(n){return Dp(n).each((function(e){u.cancel();var t={x:e.clientX,y:e.clientY,target:n.target};u.schedule(n),i.set(!1),o.set(O.some(t))})),O.none()}},{key:_n(),value:function(n){return u.cancel(),Dp(n).each((function(n){o.get().each((function(e){var t,r,i,u;t=n,r=e,i=Math.abs(t.clientX-r.x),u=Math.abs(t.clientY-r.y),(5<i||5<u)&&o.set(O.none())}))})),O.none()}},{key:In(),value:function(e){return u.cancel(),o.get().filter((function(n){return ve(n.target,e.target)})).map((function(t){return i.get()?(e.prevent(),!1):n.triggerEvent(Jn(),e)}))}}]);return{fireIfReady:function(n,e){return it(c,e).bind((function(e){return e(n)}))}}},Ip=function(n){var e=_p({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return Lg(n.body,"touchend",(function(n){e.fireIfReady(n,"touchend")}))},onTouchmove:function(){return Lg(n.body,"touchmove",(function(n){e.fireIfReady(n,"touchmove")}))}}},Fp=6<=Cn().os.version.major,Rp=function(n,e,t){var o=Ip(n),i=Oe(e),u=function(n){return!ve(n.start,n.finish)||n.soffset!==n.foffset},c=function(){var r=n.doc.dom.hasFocus()&&n.getSelection().exists(u);t.getByDom(e).each(!0===(r||Mo(i).filter((function(n){return"input"===he(n)})).exists((function(n){return n.dom.selectionStart!==n.dom.selectionEnd})))?bi.on:bi.off)},a=[Lg(n.body,"touchstart",(function(e){n.onTouchContent(),o.fireTouchstart(e)})),o.onTouchmove(),o.onTouchend(),Lg(e,"touchstart",(function(e){n.onTouchToolstrip()})),n.onToReading((function(){Co(n.body)})),n.onToEditing(r),n.onScrollToCursor((function(e){e.preventDefault(),n.getCursorBox().each((function(e){var t=n.win,r=e.top>t.innerHeight||e.bottom>t.innerHeight?e.bottom-t.innerHeight+50:0;0!=r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)}))}))].concat(1==Fp?[]:[Lg(le.fromDom(n.win),"blur",(function(){t.getByDom(e).each(bi.off)})),Lg(i,"select",c),Lg(n.doc,"selectionchange",c)]);return{destroy:function(){P(a,(function(n){n.unbind()}))}}},Vp=function(n,e){var t=parseInt(lt(n,e),10);return isNaN(t)?0:t},Bp=function(e){return n(n({},e),{width:2})},Ap=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},jp=function(n){var e=n.getSelection();return void 0!==e&&0<e.rangeCount?function(n){if(n.collapsed){var e=le.fromDom(n.startContainer);return ke(e).bind((function(t){var r=ip.exact(e,n.startOffset,t,ep(t));return pp(n.startContainer.ownerDocument.defaultView,r).map(Bp).map(K)})).getOr([])}return N(n.getClientRects(),Ap)}(e.getRangeAt(0)):[]},Np=function(n){n.focus();var e=le.fromDom(n.document.body);(Mo().exists((function(n){return A(["input","textarea"],he(n))}))?function(n){$g.setTimeout((function(){n()}),0)}:v)((function(){Mo().each(Co),Eo(e)}))},Pp="data-"+Ti("last-outer-height"),Hp=function(n,e){ft(n,Pp,e)},zp=function(n){return{top:n.top,bottom:n.top+n.height}},Lp=function(n,e){var t=Vp(e,Pp),r=n.innerHeight;return r<t?O.some(t-r):O.none()},Gp=function(n,e){var t=le.fromDom(e.document.body),r=Lg(le.fromDom(n),"resize",(function(){Lp(n,t).each((function(n){var t;(0<(t=jp(e)).length?O.some(t[0]).map(zp):O.none()).each((function(t){var r,o,i,u=(r=e,i=n,(o=t).top>r.innerHeight||o.bottom>r.innerHeight?Math.min(i,o.bottom-r.innerHeight+50):0);0!==u&&e.scrollTo(e.pageXOffset,e.pageYOffset+u)}))})),Hp(t,n.innerHeight)}));return Hp(t,n.innerHeight),{toEditing:function(){Np(e)},destroy:function(){r.unbind()}}},$p=function(n,e){var t=null;return{cancel:function(){null!==t&&(clearTimeout(t),t=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==t&&clearTimeout(t),t=setTimeout((function(){n.apply(null,r),t=null}),e)}}},Up=function(n,e){var t,r,o,i=Zl(Dd.sketch({dom:Vf('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:bo([bi.config({toggleClass:Ti("mask-tap-icon-selected"),toggleOnExecute:!1})])})),u=(t=n,r=200,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null===o&&(o=setTimeout((function(){t.apply(null,n),o=null}),r))}});return Dd.sketch({dom:Vf('<div class="${prefix}-disabled-mask"></div>'),components:[Dd.sketch({dom:Vf('<div class="${prefix}-content-container"></div>'),components:[If.sketch({dom:Vf('<div class="${prefix}-content-tap-section"></div>'),components:[i.asSpec()],action:function(n){u.throttle()},buttonBehaviours:bo([bi.config({toggleClass:Ti("mask-tap-icon-selected")})])})]})]})},Wp=i({unbind:r}),Xp=yr([jr("editor",[Br("getFrame"),Nr("getBody"),Nr("getDoc"),Nr("getWin"),Nr("getSelection"),Nr("setSelection"),Nr("clearSelection"),Nr("cursorSaver"),Nr("onKeyup"),Nr("onNodeChanged"),Nr("getCursorBox"),Br("onDomChanged"),Lr("onTouchContent",r),Lr("onTapContent",r),Lr("onTouchToolstrip",r),Lr("onScrollToCursor",Wp),Lr("onScrollToElement",Wp),Lr("onToEditing",Wp),Lr("onToReading",Wp),Lr("onToolbarScrollStart",u)]),Br("socket"),Br("toolstrip"),Br("dropup"),Br("toolbar"),Br("container"),Br("alloy"),$r("win",(function(n){return Oe(n.socket).dom.defaultView})),$r("body",(function(n){return le.fromDom(n.socket.dom.ownerDocument.body)})),Lr("translate",u),Lr("setReadOnly",r),Lr("readOnlyOnInit",y)]),qp=function(n){var e=_r("Getting AndroidWebapp schema",Xp,n);Ri(e.toolstrip,"width","100%");var t=jm(Up((function(){e.setReadOnly(e.readOnlyOnInit()),s.enter()}),e.translate));e.alloy.add(t);var o={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}};Ie(e.container,t.element);var i,u,c,a,f,s=(i=e,u=o,c=Sp(),a=im(),f=im(),{enter:function(){u.hide(),bt(i.container,Ti("fullscreen-maximized")),bt(i.container,Ti("android-maximized")),c.maximize(),bt(i.body,Ti("android-scroll-reload")),a.set(Gp(i.win,wp(i.editor).getOrDie("no"))),xp(i.editor).each((function(n){Cp(i.container,n.body),f.set(Rp(n,i.toolstrip,i.alloy))}))},exit:function(){c.restore(),u.show(),wt(i.container,Ti("fullscreen-maximized")),wt(i.container,Ti("android-maximized")),Mp(),wt(i.body,Ti("android-scroll-reload")),f.clear(),a.clear()}});return{setReadOnly:e.setReadOnly,refreshStructure:r,enter:s.enter,exit:s.exit,destroy:r}},Yp=i([Br("dom"),Lr("shell",!0),Ta("toolbarBehaviours",[ug])]),Kp=i([ef({name:"groups",overrides:function(){return{behaviours:bo([ug.config({})])}}})]),Jp=_f({name:"Toolbar",configFields:Yp(),partFields:Kp(),factory:function(n,e,t,r){var o=function(e){return n.shell?O.some(e):sf(e,n,"groups")},i=n.shell?{behaviours:[ug.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:Ea(n.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,e){o(n).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){ug.set(n,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),Qp=i([Br("items"),jr("markers",N(["itemSelector"],Br)),Ta("tgroupBehaviours",[Oa])]),Zp=i([tf({name:"items",unit:"item"})]),nv=_f({name:"ToolbarGroup",configFields:Qp(),partFields:Zp(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,components:e,behaviours:Ea(n.tgroupBehaviours,[Oa.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),ev="data-"+Ti("horizontal-scroll"),tv=function(n){return"true"===lt(n,ev)?0<(t=n).dom.scrollLeft||function(n){n.dom.scrollLeft=1;var e=0!==n.dom.scrollLeft;return n.dom.scrollLeft=0,e}(t):0<(e=n).dom.scrollTop||function(n){n.dom.scrollTop=1;var e=0!==n.dom.scrollTop;return n.dom.scrollTop=0,e}(e);var e,t},rv=function(){var n=function(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Vf('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:bo([kd("adhoc-scrollable-toolbar",!0===n.scrollable?[co((function(n,e){var t;Ri(n.element,"overflow-x","auto"),t=n.element,ft(t,ev,"true"),Og(n.element)}))]:[])]),components:[Dd.sketch({components:[nv.parts.items({})]})],markers:{itemSelector:"."+Ti("toolbar-group-item")},items:n.items}},e=jm(Jp.sketch({dom:Vf('<div class="${prefix}-toolbar"></div>'),components:[Jp.parts.groups({})],toolbarBehaviours:bo([bi.config({toggleClass:Ti("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Oa.config({mode:"cyclic"})]),shell:!0})),t=jm(Dd.sketch({dom:{classes:[Ti("toolstrip")]},components:[Nm(e)],containerBehaviours:bo([bi.config({toggleClass:Ti("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){Jp.setGroups(e,i.get()),bi.off(e)},i=ko([]);return{wrapper:t,toolbar:e,createGroups:function(e){return N(e,o(nv.sketch,n))},setGroups:function(n){i.set(n),r()},setContextToolbar:function(n){bi.on(e),Jp.setGroups(e,n)},restoreToolbar:function(){bi.isOn(e)&&r()},refresh:function(){},focus:function(){Oa.focusIn(e)}}},ov=function(n){return jm(If.sketch({dom:Vf('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run((function(n){n.setReadOnly(!1)}))}}))},iv=function(){return jm(Dd.sketch({dom:Vf('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:bo([ug.config({})])}))},uv=function(n,e){ug.append(n,Nm(e))},cv=function(n,e){ug.remove(n,e)},av=function(n,e,t,r){(!0===t?To.toAlpha:To.toOmega)(r),(t?uv:cv)(n,e)},fv=function(n,e){return e.getAnimationRoot.fold((function(){return n.element}),(function(e){return e(n)}))},sv=function(n){return n.dimension.property},lv=function(n,e){return n.dimension.getDimension(e)},dv=function(n,e){var t=fv(n,e);Cm(t,[e.shrinkingClass,e.growingClass])},mv=function(n,e){wt(n.element,e.openClass),bt(n.element,e.closedClass),Ri(n.element,sv(e),"0px"),Pi(n.element)},gv=function(n,e){wt(n.element,e.closedClass),bt(n.element,e.openClass),Ni(n.element,sv(e))},pv=function(n,e,t,r){t.setCollapsed(),Ri(n.element,sv(e),lv(e,n.element)),Pi(n.element),dv(n,e),mv(n,e),e.onStartShrink(n),e.onShrunk(n)},vv=function(n,e,t,r){var o=r.getOrThunk((function(){return lv(e,n.element)}));t.setCollapsed(),Ri(n.element,sv(e),o),Pi(n.element);var i=fv(n,e);wt(i,e.growingClass),bt(i,e.shrinkingClass),mv(n,e),e.onStartShrink(n)},hv=function(n,e,t){var r=lv(e,n.element);("0px"===r?pv:vv)(n,e,t,O.some(r))},yv=function(n,e,t){var r=fv(n,e),o=St(r,e.shrinkingClass),i=lv(e,n.element);gv(n,e);var u=lv(e,n.element);(o?function(){Ri(n.element,sv(e),i),Pi(n.element)}:function(){mv(n,e)})(),wt(r,e.shrinkingClass),bt(r,e.growingClass),gv(n,e),Ri(n.element,sv(e),u),t.setExpanded(),e.onStartGrow(n)},bv=function(n,e,t){var r=fv(n,e);return!0===St(r,e.growingClass)},xv=function(n,e,t){var r=fv(n,e);return!0===St(r,e.shrinkingClass)},wv=Object.freeze({__proto__:null,refresh:function(n,e,t){var r;t.isExpanded()&&(Ni(n.element,sv(e)),r=lv(e,n.element),Ri(n.element,sv(e),r))},grow:function(n,e,t){t.isExpanded()||yv(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&hv(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&pv(n,e,t,O.none())},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:bv,isShrinking:xv,isTransitioning:function(n,e,t){return!0===bv(n,e)||!0===xv(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?hv:yv)(n,e,t)},disableTransitions:dv}),Sv=Object.freeze({__proto__:null,exhibit:function(n,e,t){var r=e.expanded;return lo(r?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:or(e.dimension.property,"0px")})},events:function(n,e){return Jr([(t=zn(),eo(t)((function(t,r){r.event.raw.propertyName===n.dimension.property&&(dv(t,n),e.isExpanded()&&Ni(t.element,n.dimension.property),(e.isExpanded()?n.onGrown:n.onShrunk)(t))})))]);var t}}),Ov=[Br("closedClass"),Br("openClass"),Br("shrinkingClass"),Br("growingClass"),Nr("getAnimationRoot"),Zo("onShrunk"),Zo("onStartShrink"),Zo("onGrown"),Zo("onStartGrow"),Lr("expanded",!1),Ar("dimension",Fr("property",{width:[ri("property","width"),ri("getDimension",(function(n){return ls(n)+"px"}))],height:[ri("property","height"),ri("getDimension",(function(n){return Li(n)+"px"}))]}))],Tv=wo({fields:Ov,name:"sliding",active:Sv,apis:wv,state:Object.freeze({__proto__:null,init:function(n){var e=ko(n.expanded);return yo({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:c(e.set,!1),setExpanded:c(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),kv=function(n,e){var t=jm(Dd.sketch({dom:{tag:"div",classes:[Ti("dropup")]},components:[],containerBehaviours:bo([ug.config({}),Tv.config({closedClass:Ti("dropup-closed"),openClass:Ti("dropup-open"),shrinkingClass:Ti("dropup-shrinking"),growingClass:Ti("dropup-growing"),dimension:{property:"height"},onShrunk:function(t){n(),e(),ug.set(t,[])},onGrown:function(t){n(),e()}}),wi((function(n,e){o(r)}))])})),o=function(n){window.requestAnimationFrame((function(){n(),Tv.shrink(t)}))};return{appear:function(n,e,r){!0===Tv.hasShrunk(t)&&!1===Tv.isTransitioning(t)&&window.requestAnimationFrame((function(){e(r),ug.set(t,[n()]),Tv.grow(t)}))},disappear:o,component:t,element:t.element}},Ev=function(n){var e,t;return n.raw.which===nu[0]&&!A(["input","textarea"],he(n.target))&&(e=n.target,!Zi(e,'[contenteditable="true"]',t).isSome())},Cv=function(){return Cn().browser.isFirefox()},Mv=hr([Ar("triggerEvent",Vr),Lr("stopBackspace",!0)]),Dv=function(n,e){var t,r,o,i,u=_r("Getting GUI events settings",Mv,e),c=_p(u),a=N(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(e){return Lg(n,e,(function(n){c.fireIfReady(n,e).each((function(e){e&&n.kill()})),u.triggerEvent(e,n)&&n.kill()}))})),f=ko(O.none()),s=Lg(n,"paste",(function(n){c.fireIfReady(n,"paste").each((function(e){e&&n.kill()})),u.triggerEvent("paste",n)&&n.kill(),f.set(O.some(setTimeout((function(){u.triggerEvent(Xn(),n)}),0)))})),l=Lg(n,"keydown",(function(n){u.triggerEvent("keydown",n)?n.kill():!0===u.stopBackspace&&Ev(n)&&n.prevent()})),d=(t=n,r=function(n){u.triggerEvent("focusin",n)&&n.kill()},Cv()?Gg(t,"focus",r):Lg(t,"focusin",r)),m=ko(O.none()),g=(o=n,i=function(n){u.triggerEvent("focusout",n)&&n.kill(),m.set(O.some(setTimeout((function(){u.triggerEvent(Wn(),n)}),0)))},Cv()?Gg(o,"blur",i):Lg(o,"focusout",i));return{unbind:function(){P(a,(function(n){n.unbind()})),l.unbind(),d.unbind(),g.unbind(),s.unbind(),f.get().each(clearTimeout),m.get().each(clearTimeout)}}},_v=function(n,e){var t=it(n,"target").getOr(e);return ko(t)},Iv=Ut([{stopped:[]},{resume:["element"]},{complete:[]}]),Fv=function(n,e,t,r,o,i){var u,c,a,f,s=n(e,r),l=(u=t,c=o,a=ko(!1),f=ko(!1),{stop:function(){a.set(!0)},cut:function(){f.set(!0)},isStopped:a.get,isCut:f.get,event:u,setSource:c.set,getSource:c.get});return s.fold((function(){return i.logEventNoHandlers(e,r),Iv.complete()}),(function(n){var t=n.descHandler;return ym(t)(l),l.isStopped()?(i.logEventStopped(e,n.element,t.purpose),Iv.stopped()):l.isCut()?(i.logEventCut(e,n.element,t.purpose),Iv.complete()):ke(n.element).fold((function(){return i.logNoParent(e,n.element,t.purpose),Iv.complete()}),(function(r){return i.logEventResponse(e,n.element,t.purpose),Iv.resume(r)}))}))},Rv=function(n,e,t,r,o,i){return Fv(n,e,t,r,o,i).fold((function(){return!0}),(function(r){return Rv(n,e,t,r,o,i)}),(function(){return!1}))},Vv=function(n,e,t){var o,i,u=(o=e,i=ko(!1),{stop:function(){i.set(!0)},cut:r,isStopped:i.get,isCut:h,event:o,setSource:p("Cannot set source of a broadcasted event"),getSource:p("Cannot get source of a broadcasted event")});return P(n,(function(n){var e=n.descHandler;ym(e)(u)})),u.isStopped()},Bv=function(n,e,t,r,o){var i=_v(t,r);return Rv(n,e,t,r,i,o)},Av=function(n,e){return{element:n,descHandler:e}},jv=function(n,e){return{id:n,descHandler:e}};function Nv(){var n={};return{registerId:function(e,t,r){nt(r,(function(r,o){var i=void 0!==n[o]?n[o]:{};i[t]=hm(r,e),n[o]=i}))},unregisterId:function(e){nt(n,(function(n,t){n.hasOwnProperty(e)&&delete n[e]}))},filterByType:function(e){return it(n,e).map((function(n){return ot(n,(function(n,e){return jv(e,n)}))})).getOr([])},find:function(e,t,r){var o=it(n,t);return Xr(r,(function(n){return e=o,Sf(t=n).fold((function(){return O.none()}),(function(n){return e.bind((function(e){return it(e,n)})).map((function(n){return Av(t,n)}))}));var e,t}),e)}}}function Pv(){var n=Nv(),e={},t=function(n){var e=n.element;return Sf(e).fold((function(){return e="uid-",t=n.element,r=Pa(bf+e),wf(t,r),r;var e,t,r}),(function(n){return n}))},r=function(t){Sf(t.element).each((function(t){delete e[t],n.unregisterId(t)}))};return{find:function(e,t,r){return n.find(e,t,r)},filter:function(e){return n.filterByType(e)},register:function(o){var i=t(o);ct(e,i)&&function(n,t){var o=e[t];if(o!==n)throw new Error('The tagId "'+t+'" is already used by: '+Ho(o.element)+"\nCannot use it for: "+Ho(n.element)+"\nThe conflicting element is"+(Le(o.element)?" ":" not ")+"already in the DOM");r(n)}(o,i);var u=[o];n.registerId(u,i,o.events),e[i]=o},unregister:r,getById:function(n){return it(e,n)}}}var Hv=function(n){var e=function(e){return ke(n.element).fold((function(){return!0}),(function(n){return ve(e,n)}))},t=Pv(),o=function(n,r){return t.find(e,n,r)},u=Dv(n.element,{triggerEvent:function(n,e){return Wo(n,e.target,(function(t){return i=t,Bv(o,n,r=e,r.target,i);var r,i}))}}),c={debugInfo:i("real"),triggerEvent:function(n,e,t){Wo(n,e,(function(r){return Bv(o,n,t,e,r)}))},triggerFocus:function(n,e){Sf(n).fold((function(){Eo(n)}),(function(t){Wo(Un(),n,(function(t){var i,u,c,a,f,s;return i=o,u=Un(),f=t,s=_v(c={originator:e,kill:r,prevent:r,target:n},a=n),Fv(i,u,c,a,s,f),!1}))}))},triggerEscape:function(n,e){c.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return v(n)},getByDom:function(n){return h(n)},build:jm,addToGui:function(n){s(n)},removeFromGui:function(n){l(n)},addToWorld:function(n){a(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){m(n)},broadcastOn:function(n,e){g(n,e)},broadcastEvent:function(n,e){p(n,e)},isConnected:y},a=function(n){n.connect(c),xe(n.element)||(t.register(n),P(n.components(),a),c.triggerEvent(Zn(),n.element,{target:n.element}))},f=function(n){xe(n.element)||(P(n.components(),f),t.unregister(n)),n.disconnect()},s=function(e){Ye(n,e,Ie)},l=function(n){Ke(n)},d=function(n){var e=t.filter(qn());P(e,(function(e){var t=e.descHandler;ym(t)(n)}))},m=function(n){d({universal:!0,data:n})},g=function(n,e){d({universal:!1,channels:n,data:e})},p=function(n,e){var r=t.filter(n);return Vv(r,e)},v=function(n){return t.getById(n).fold((function(){return Ct.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),Ct.value)},h=function(n){var e=Sf(n).getOr("not found");return v(e)};return a(n),{root:n,element:n.element,destroy:function(){u.unbind(),Ve(n.element)},add:s,remove:l,getByUid:v,getByDom:h,addToWorld:a,removeFromWorld:f,broadcast:m,broadcastOn:g,broadcastEvent:p}},zv=Ti("readonly-mode"),Lv=Ti("edit-mode");function Gv(n){var e=jm(Dd.sketch({dom:{classes:[Ti("outer-container")].concat(n.classes)},containerBehaviours:bo([To.config({alpha:zv,omega:Lv})])}));return Hv(e)}var $v,Uv,Wv,Xv,qv=function(n,e){var t=le.fromTag("input");Vi(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),Ie(n,t),Eo(t),e(t),Ve(t)},Yv=function(n){var e,t,r=n.getSelection();0<r.rangeCount&&(e=r.getRangeAt(0),(t=n.document.createRange()).setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),r.removeAllRanges(),r.addRange(t))},Kv=function(n,e){Mo().each((function(n){ve(n,e)||Co(n)})),n.focus(),Eo(le.fromDom(n.document.body)),Yv(n)},Jv=function(n,e,t,r){var o=function(){Kv(e,r)},i=Lg(t,"keydown",(function(n){A(["input","textarea"],he(n.target))||o()}));return{toReading:function(){qv(n,Co)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},Qv=function(n,e,t,r,o){var i=function(){e.run((function(n){n.refreshSelection()}))},u=function(n,t){var o=n-r.dom.scrollTop;e.run((function(n){n.scrollIntoView(o,o+t)}))},c=function(){e.run((function(n){n.clearSelection()}))},a=function(){n.getCursorBox().each((function(n){u(n.top,n.height)})),e.run((function(n){n.syncHeight()}))},f=Ip(n),s=$p(a,300),l=[n.onKeyup((function(){c(),s.throttle()})),n.onNodeChanged(i),n.onDomChanged(s.throttle),n.onDomChanged(i),n.onScrollToCursor((function(n){n.preventDefault(),s.throttle()})),n.onScrollToElement((function(n){n.element,u(e,r)})),n.onToEditing((function(){e.run((function(n){n.toEditing()}))})),n.onToReading((function(){e.run((function(n){n.toReading()}))})),Lg(n.doc,"touchend",(function(e){ve(n.html,e.target)||ve(n.body,e.target)})),Lg(t,"transitionend",(function(n){var r;"height"===n.raw.propertyName&&(r=Li(t),e.run((function(n){n.setViewportOffset(r)})),i(),a())})),Gg(t,"touchstart",(function(t){var r;e.run((function(n){n.highlightSelection()})),r=t,e.run((function(n){n.onToolbarTouch(r)})),n.onTouchToolstrip()})),Lg(n.body,"touchstart",(function(e){c(),n.onTouchContent(),f.fireTouchstart(e)})),f.onTouchmove(),f.onTouchend(),Lg(n.body,"click",(function(n){n.kill()})),Lg(t,"touchmove",(function(){n.onToolbarScrollStart()}))];return{destroy:function(){P(l,(function(n){n.unbind()}))}}},Zv={},nh={exports:Zv};$v=void 0,Uv=Zv,Wv=nh,Xv=void 0,function(n){"object"==typeof Uv&&void 0!==Wv?Wv.exports=n():"function"==typeof $v&&$v.amd?$v([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}((function(){return function n(e,t,r){function o(u,c){if(!t[u]){if(!e[u]){var a="function"==typeof Xv&&Xv;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var s=t[u]={exports:{}};e[u][0].call(s.exports,(function(n){return o(e[u][1][n]||n)}),s,s.exports,n,e,t,r)}return t[u].exports}for(var i="function"==typeof Xv&&Xv,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,e,t){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{o(n)}catch(e){try{return o.call(null,n)}catch(e){return o.call(this,n)}}}(n)}}function p(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new p(n,e)),1!==s.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,e,t){(function(n){function t(){}function r(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function o(n,e){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,r._immediateFn((function(){var t,r=1===n._state?e.onFulfilled:e.onRejected;if(null!==r){try{t=r(n._value)}catch(l){return void u(e.promise,l)}i(e.promise,t)}else(1===n._state?i:u)(e.promise,n._value)}))):n._deferreds.push(e)}function i(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof r)return n._state=3,n._value=e,void c(n);if("function"==typeof t)return void f((o=t,a=e,function(){o.apply(a,arguments)}),n)}n._state=1,n._value=e,c(n)}catch(i){u(n,i)}var o,a}function u(n,e){n._state=2,n._value=e,c(n)}function c(n){2===n._state&&0===n._deferreds.length&&r._immediateFn((function(){n._handled||r._unhandledRejectionFn(n._value)}));for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function a(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var r=!1;try{n((function(n){r||(r=!0,i(e,n))}),(function(n){r||(r=!0,u(e,n))}))}catch(t){if(r)return;r=!0,u(e,t)}}var s,l;s=this,l=setTimeout,r.prototype["catch"]=function(n){return this.then(null,n)},r.prototype.then=function(n,e){var r=new this.constructor(t);return o(this,new a(n,e,r)),r},r.all=function(n){var e=Array.prototype.slice.call(n);return new r((function(n,r){if(0===e.length)return n([]);for(var o=e.length,i=0;i<e.length;i++)!function i(u,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var a=c.then;if("function"==typeof a)return void a.call(c,(function(n){i(u,n)}),r)}e[u]=c,0==--o&&n(e)}catch(t){r(t)}}(i,e[i])}))},r.resolve=function(n){return n&&"object"==typeof n&&n.constructor===r?n:new r((function(e){e(n)}))},r.reject=function(n){return new r((function(e,t){t(n)}))},r.race=function(n){return new r((function(e,t){for(var r=0,o=n.length;r<o;r++)n[r].then(e,t)}))},r._immediateFn="function"==typeof n?function(e){n(e)}:function(n){l(n,0)},r._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},r._setImmediateFn=function(n){r._immediateFn=n},r._setUnhandledRejectionFn=function(n){r._unhandledRejectionFn=n},void 0!==e&&e.exports?e.exports=r:s.Promise||(s.Promise=r)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,e,t){(function(e,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function f(n,e){this._id=n,this._clearFn=e}t.setTimeout=function(){return new f(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new f(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(n){n.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},t.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},t._unrefActive=t.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),e))},t.setImmediate="function"==typeof e?e:function(n){var e=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[e]=!0,o((function(){c[e]&&(r?n.apply(null,r):n.call(null),t.clearImmediate(e))})),e},t.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}));var eh,th=nh.exports.boltExport,rh=function(n){var e=O.none(),t=[],r=function(n){o()?u(n):t.push(n)},o=function(){return e.isSome()},i=function(n){P(n,u)},u=function(n){e.each((function(e){setTimeout((function(){n(e)}),0)}))};return n((function(n){o()||(e=O.some(n),i(t),t=[])})),{get:r,map:function(n){return rh((function(e){r((function(t){e(n(t))}))}))},isReady:o}},oh={nu:rh,pure:function(n){return rh((function(e){e(n)}))}},ih=function(n){setTimeout((function(){throw n}),0)},uh=function(n){var e=function(e){n().then(e,ih)};return{map:function(e){return uh((function(){return n().then(e)}))},bind:function(e){return uh((function(){return n().then((function(n){return e(n).toPromise()}))}))},anonBind:function(e){return uh((function(){return n().then((function(){return e.toPromise()}))}))},toLazy:function(){return oh.nu(e)},toCached:function(){var e=null;return uh((function(){return null===e&&(e=n()),e}))},toPromise:n,get:e}},ch=function(n){return uh((function(){return new th(n)}))},ah=function(n){return uh((function(){return th.resolve(n)}))},fh=function(n,e){return J([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],(function(t){return r=n<=t.width&&e<=t.height,o=t.keyboard,r?O.some(o):O.none();var r,o})).getOr({portrait:e/5,landscape:n/4})},sh=function(n){var e,t=Ug(n).isPortrait(),r=fh((e=n).screen.width,e.screen.height),o=t?r.portrait:r.landscape;return(t?n.screen.height:n.screen.width)-n.innerHeight>o?0:o},lh=function(n,e){var t=Oe(n).dom.defaultView;return Li(n)+Li(e)-sh(t)},dh=function(n,e,t){var r=lh(e,t),o=Li(e)+Li(t)-r;Ri(n,"padding-bottom",o+"px")},mh=Ut([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),gh="data-"+Ti("position-y-fixed"),ph="data-"+Ti("y-property"),vh="data-"+Ti("scrolling"),hh="data-"+Ti("last-window-height"),yh=function(n){return Vp(n,gh)},bh=function(n,e){var t=lt(n,ph);return mh.fixed(n,t,e)},xh=function(n,e){return mh.scroller(n,e)},wh=function(n){var e=yh(n);return("true"===lt(n,vh)?xh:bh)(n,e)},Sh=function(n,e,t){var r=Oe(n).dom.defaultView.innerHeight;return ft(n,hh,r+"px"),r-e-t},Oh=function(n,e,t,r){var o=Oe(n).dom.defaultView,i=function(n){var e=lt(n,"style");return Vi(n,{position:"absolute",top:"0px"}),ft(n,gh,"0px"),ft(n,ph,"top"),{restore:function(){ft(n,"style",e||""),gt(n,gh),gt(n,ph)}}}(t),u=Li(t),c=Li(r),a=function(n,e,t){var r=lt(t,"style");return Og(t),Vi(t,{position:"absolute",height:e+"px",width:"100%",top:n+"px"}),ft(t,gh,n+"px"),ft(t,vh,"true"),ft(t,ph,"top"),{restore:function(){Tg(t),ft(t,"style",r||""),gt(t,gh),gt(t,vh),gt(t,ph)}}}(u,Sh(n,u,c),n),f=function(n){var e=lt(n,"style");return Vi(n,{position:"absolute",bottom:"0px"}),ft(n,gh,"0px"),ft(n,ph,"bottom"),{restore:function(){ft(n,"style",e||""),gt(n,gh),gt(n,ph)}}}(r),s=!0,l=function(){var e=o.innerHeight;return Vp(n,hh)<e},d=function(){var o,i,u;s&&(o=Li(t),i=Li(r),u=Sh(n,o,i),ft(n,gh,o+"px"),Ri(n,"height",u+"px"),dh(e,n,r))};return dh(e,n,r),{setViewportOffset:function(e){ft(n,gh,e+"px"),d()},isExpanding:l,isShrinking:g(l),refresh:d,restore:function(){s=!1,i.restore(),a.restore(),f.restore()}}},Th=(eh=null,{animate:function(n,e,t,r,o,i){var u=!1,c=function(n){u=!0,o(n)};$g.clearInterval(eh);var a=function(n){$g.clearInterval(eh),c(n)};eh=$g.setInterval((function(){var o,i,f,s=n();o=s,i=e,f=t,(Math.abs(o-i)<=f?O.none():o<i?O.some(o+f):O.some(o-f)).fold((function(){$g.clearInterval(eh),c(e)}),(function(t){var o;r(t,a),u||((o=n())!==t||Math.abs(o-e)>Math.abs(s-e))&&($g.clearInterval(eh),c(e))}))}),i)}}),kh="data-"+Ti("last-scroll-top"),Eh=function(n){var e=ji(n,"top").getOr("0");return parseInt(e,10)},Ch=function(n){return parseInt(n.dom.scrollTop,10)},Mh=function(n,e){return ch((function(t){var r=c(Ch,n);ft(n,kh,r());var o=Math.abs(e-r()),i=Math.ceil(o/10);Th.animate(r,e,i,(function(e,t){Vp(n,kh)!==n.dom.scrollTop?t(n.dom.scrollTop):(n.dom.scrollTop=e,ft(n,kh,e))}),(function(){n.dom.scrollTop=e,ft(n,kh,e),t(e)}),10)}))},Dh=function(n,e){var t=e+yh(n)+"px";Ri(n,"top",t)},_h=function(n,e){return e((function(e){var t=[],r=0;0===n.length?e([]):P(n,(function(o,i){var u;o.get((u=i,function(o){t[u]=o,++r>=n.length&&e(t)}))}))}))},Ih=function(n,e,t){var r,o,i,u=e+t,a=ji(n,"top").getOr(t),f=u-parseInt(a,10),s=n.dom.scrollTop+f;return r=n,o=s,i=u,ch((function(n){var e=c(Ch,r);Th.animate(e,o,15,(function(n){r.dom.scrollTop=n,Ri(r,"top",Eh(r)+15+"px")}),(function(){r.dom.scrollTop=o,Ri(r,"top",i+"px"),n(o)}),10)}))},Fh=function(n,e){return n.fold((function(n,t,r){return Ri(n,t,e+(o=r)+"px"),ah(o);var o}),(function(n,t){return Ih(n,e,t)}))},Rh=function(n,e){var t,r=(t=Ui(n,"["+gh+"]"),N(t,wh)),o=N(r,(function(n){return Fh(n,e)}));return _h(o,ch)},Vh=function(n,e,t,r,o,i){var c,a,f=(c=function(t){return o=e,i=t,u=Oe(r=n).dom.defaultView,ch((function(n){Dh(r,i),Dh(o,i),u.scrollTo(0,i),n(i)}));var r,o,i,u},a=ko(oh.pure({})),{start:function(n){var e=oh.nu((function(e){return c(n).get(e)}));a.set(e)},idle:function(n){a.get().get((function(){n()}))}}),s=$p((function(){f.idle((function(){Rh(t,r.pageYOffset).get((function(){var n;(n=jp(i),O.from(n[0]).bind((function(n){var t=n.top-e.dom.scrollTop;return t>r.innerHeight+5||t<-5?O.some({top:t,bottom:t+n.height}):O.none()}))).each((function(n){e.dom.scrollTop=e.dom.scrollTop+n.top})),f.start(0),o.refresh()}))}))}),1e3),l=Lg(le.fromDom(r),"scroll",(function(){r.pageYOffset<0||s.throttle()}));return Rh(t,r.pageYOffset).get(u),{unbind:l.unbind}},Bh=function(n){var e=n.cWin,t=n.ceBody,o=n.socket,i=n.toolstrip,a=n.contentElement,f=n.keyboardType,s=n.outerWindow,l=n.dropup,d=n.outerBody,m=Oh(o,t,i,l),g=f(d,e,Ge(),a),p=Wg(s,{onChange:r,onReady:m.refresh});p.onAdjustment((function(){m.refresh()}));var v=Lg(le.fromDom(s),"resize",(function(){m.isExpanding()&&m.refresh()})),h=Vh(i,o,d,s,m,e),y=function(n,e){var t=n.document,r=le.fromTag("div");bt(r,Ti("unfocused-selections")),Ie(le.fromDom(t.documentElement),r);var o=Lg(r,"touchstart",(function(t){t.prevent(),Kv(n,e),u()})),i=function(n){var e=le.fromTag("span");return Em(e,[Ti("layer-editor"),Ti("unfocused-selection")]),Vi(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e},u=function(){Re(r)};return{update:function(){u();var e=jp(n),t=N(e,i);Fe(r,t)},isActive:function(){return 0<Ee(r).length},destroy:function(){o.unbind(),Ve(r)},clear:u}}(e,a),b=function(){y.clear()};return{toEditing:function(){g.toEditing(),b()},toReading:function(){g.toReading()},onToolbarTouch:function(n){g.onToolbarTouch()},refreshSelection:function(){y.isActive()&&y.update()},clearSelection:b,highlightSelection:function(){y.update()},scrollIntoView:function(n,t){var r,i,u,a,f,s;r=e,u=n,a=t,f=lh(i=o,l),s=c(Yv,r),f<u||f<a?Mh(i,i.dom.scrollTop-f+a).get(s):u<0&&Mh(i,i.dom.scrollTop+u).get(s)},updateToolbarPadding:r,setViewportOffset:function(n){var e,t;m.setViewportOffset(n),e=o,t=n,ch((function(n){var r=c(Eh,e),o=function(n){Ri(e,"top",n+"px")},i=Math.abs(t-r()),u=Math.ceil(i/10);Th.animate(r,t,u,o,(function(){o(t),n(t)}),10)})).get(u)},syncHeight:function(){Ri(a,"height",a.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:m.refresh,destroy:function(){m.restore(),p.destroy(),h.unbind(),v.unbind(),g.destroy(),y.destroy(),qv(Ge(),Co)}}},Ah=function(n,e){var t=Sp(),o=um(),i=um(),u=im(),c=im();return{enter:function(){e.hide();var a=le.fromDom(document);xp(n.editor).each((function(e){var f;o.set({socketHeight:ji(n.socket,"height"),iframeHeight:ji(e.frame,"height"),outerScroll:document.body.scrollTop}),i.set({exclusives:(f="."+kg,Lg(a,"touchmove",(function(n){Zi(n.target,f).filter(tv).fold((function(){n.prevent()}),r)})))}),bt(n.container,Ti("fullscreen-maximized")),Cp(n.container,e.body),t.maximize(),Ri(n.socket,"overflow","scroll"),Ri(n.socket,"-webkit-overflow-scrolling","touch"),Eo(e.body),u.set(Bh({cWin:e.win,ceBody:e.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:e.frame,outerBody:n.body,outerWindow:n.win,keyboardType:Jv})),u.run((function(n){n.syncHeight()})),c.set(Qv(e,u,n.toolstrip,n.socket,n.dropup))}))},refreshStructure:function(){u.run((function(n){n.refreshStructure()}))},exit:function(){t.restore(),c.clear(),u.clear(),e.show(),o.on((function(e){e.socketHeight.each((function(e){Ri(n.socket,"height",e)})),e.iframeHeight.each((function(e){Ri(n.editor.getFrame(),"height",e)})),document.body.scrollTop=e.scrollTop})),o.clear(),i.on((function(n){n.exclusives.unbind()})),i.clear(),wt(n.container,Ti("fullscreen-maximized")),Mp(),Tg(n.toolbar),Ni(n.socket,"overflow"),Ni(n.socket,"-webkit-overflow-scrolling"),Co(n.editor.getFrame()),xp(n.editor).each((function(n){n.clearSelection()}))}}};function jh(n){var e=Gv({classes:[Ti("ios-container")]}),t=rv(),o=im(),i=ov(o),u=iv(),c=kv((function(){o.run((function(n){n.refreshStructure()}))}),n);return e.add(t.wrapper),e.add(u),e.add(c.component),{system:e,element:e.element,init:function(n){o.set(function(n){var e=_r("Getting IosWebapp schema",Xp,n);Ri(e.toolstrip,"width","100%"),Ri(e.container,"position","relative");var t=jm(Up((function(){e.setReadOnly(e.readOnlyOnInit()),i.enter()}),e.translate));e.alloy.add(t);var o={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}},i=Ah(e,o);return{setReadOnly:e.setReadOnly,refreshStructure:i.refreshStructure,enter:i.enter,exit:i.exit,destroy:r}}(n))},exit:function(){o.run((function(n){ug.remove(u,i),n.exit()}))},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){av(u,i,n,e.root)},socket:u,dropup:c}}var Nh=tinymce.util.Tools.resolve("tinymce.EditorManager"),Ph=function(n,e,t){n.system.broadcastOn([Vo],{command:e,state:t})},Hh=function(n){return function(){var e=function(){n._skinLoaded=!0,n.fire("SkinLoaded")};n.initialized?e():n.on("init",e)}},zh="toReading",Lh="toEditing",Gh=function(n){return{getNotificationManagerImpl:function(){return{open:i({progressBar:{value:r},close:r,text:r,getEl:i(null),moveTo:r,moveRel:r,settings:{}}),close:r,reposition:r,getArgs:i({})}},renderUI:function(){var e,t,o,i=n.getElement(),u=(e=n,{content:(t=O.from(e.getParam("skin_url")).fold((function(){return Nh.baseURL+"/skins/ui/oxide"}),(function(n){return n})))+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"});0==(!1===n.getParam("skin"))?(o=_o.DOM.styleSheetLoader,n.contentCSS.push(u.content),o.load(u.ui,Hh(n)),n.on("remove",(function(){return o.unload(u.ui)}))):Hh(n)();var c,a,f,s,l,d,m,g,p,v=function(){n.fire("ScrollIntoView")},h=Cn().os.isAndroid()?(c=v,a=Gv({classes:[Ti("android-container")]}),f=rv(),s=im(),l=ov(s),d=iv(),m=kv(r,c),a.add(f.wrapper),a.add(d),a.add(m.component),{system:a,element:a.element,init:function(n){s.set(qp(n))},exit:function(){s.run((function(n){n.exit(),ug.remove(d,l)}))},setToolbarGroups:function(n){var e=f.createGroups(n);f.setGroups(e)},setContextToolbar:function(n){var e=f.createGroups(n);f.setContextToolbar(e)},focusToolbar:function(){f.focus()},restoreToolbar:function(){f.restoreToolbar()},updateMode:function(n){av(d,l,n,a.root)},socket:d,dropup:m}):jh(v),y=le.fromDom(i);g=y,p=h.system,Je(g,p,De);var b=i.ownerDocument.defaultView,x=Wg(b,{onChange:function(){var n,e,t;h.system.broadcastOn([Bo],{width:(n=b,e=Cn().os.isiOS(),t=Ug(n).isPortrait(),e&&!t?n.screen.height:n.screen.width)})},onReady:r}),w=function(e,t,r,o){!1===o&&n.selection.collapse();var i=S(e,t,r);h.setToolbarGroups(!0===o?i.readOnly:i.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?zh:Lh),h.updateMode(o)},S=function(n,e,t){var r=n.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(t.get())}},T=function(e,t){return n.on(e,t),{unbind:function(){n.off(e)}}};return n.on("init",(function(){h.init({editor:{getFrame:function(){return le.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:r}},onToReading:function(n){return T(zh,n)},onToEditing:function(n){return T(Lh,n)},onScrollToCursor:function(e){return n.on("ScrollIntoView",(function(n){e(n)})),{unbind:function(){n.off("ScrollIntoView"),x.destroy()}}},onTouchToolstrip:function(){a()},onTouchContent:function(){var e=le.fromDom(n.editorContainer.querySelector("."+Ti("toolbar")));Do(e).bind((function(n){return h.system.getByDom(n).toOptional()})).each(ce),h.restoreToolbar(),a()},onTapContent:function(e){var t=e.target;"img"===he(t)?(n.selection.select(t.dom),e.kill()):"a"===he(t)&&h.system.getByDom(le.fromDom(n.editorContainer)).each((function(n){To.isAlpha(n)&&function(n){var e=document.createElement("a");e.target="_blank",e.href=n.href,e.rel="noreferrer noopener";var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(t),document.body.removeChild(e)}(t.dom)}))}},container:le.fromDom(n.editorContainer),socket:le.fromDom(n.contentAreaContainer),toolstrip:le.fromDom(n.editorContainer.querySelector("."+Ti("toolstrip"))),toolbar:le.fromDom(n.editorContainer.querySelector("."+Ti("toolbar"))),dropup:h.dropup,alloy:h.system,translate:r,setReadOnly:function(n){w(v,p,g,n)},readOnlyOnInit:function(){return!1}});var e,t,o,i,u,c,a=function(){h.dropup.disappear((function(){h.system.broadcastOn([Ao],{})}))},f={label:"The first group",scrollable:!1,items:[Pf("back",(function(){n.selection.collapse(),h.exit()}),{},n)]},s={label:"Back to read only",scrollable:!1,items:[Pf("readonly-back",(function(){w(v,p,g,!0)}),{},n)]},l=jg(h,n),d=(e=l,t=Ag(n),o={},W(t,(function(n){var t=!ct(o,n)&&ct(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return o[n]=!0,t}))),m={label:"The extra group",scrollable:!1,items:[]},g=ko([{label:"the action group",scrollable:!0,items:d},m]),p=ko([{label:"The read only mode group",scrollable:!0,items:[]},m]),v=ko({backToMask:[f],backToReadOnly:[s]});i=h,c=Qe((u=n).formatter.get()),P(c,(function(n){u.formatter.formatChanged(n,(function(e){Ph(i,n,e)}))})),P(["ul","ol"],(function(n){u.selection.selectorChanged(n,(function(e,t){Ph(i,n,e)}))}))})),n.on("remove",(function(){h.exit()})),n.on("detach",(function(){var n,e;n=h.system,e=Ee(n.element),P(e,(function(e){n.getByDom(e).each(Ue)})),Ve(n.element),h.system.destroy()})),{iframeContainer:h.socket.element.dom,editorContainer:h.element.dom}}}};Io.add("mobile",Gh)}();